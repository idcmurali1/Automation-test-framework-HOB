functions:
  # CheckOut
  - name: ca.test.functions.checkout.placeOrder
    platform: android
    flow:
      - verifyIdentifier:
         present:
            - identifier: ca.test.mappings.checkOutPage.reviewOrderText
      - click:
          identifier: ca.test.mappings.checkOut.placeOrder
      - sleep:
          duration: 5000

  # CheckOut with validation, mobile number and card CVV
  - name: ca.test.functions.checkout.placeOrderWithCvv
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.reviewOrderText
      # Add pickUp person name if not present
      - executeFunction:
          name: ca.test.functions.checkOut.addAPickupPerson
      # PickUp page validation
      - executeFunction:
          name: ca.test.functions.checkOut.validateOrderDetails
      - scroll:
          direction: down
          untilIdentifier: ca.test.mappings.checkOut.cardCVV
      - click:
          identifier: ca.test.mappings.checkOut.cardCVV
      - enterText:
          identifier: ca.test.mappings.checkOut.cardCVV
          string: ${cvv}
      - hideKeyboard: true
      - scroll:
          direction: down
          untilIdentifier: ca.test.mapping.checkOut.phoneTextField
      - click:
          identifier: ca.test.mapping.checkOut.phoneTextField
      - enterText:
          identifier: ca.test.mapping.checkOut.phoneTextField
          string: ${phoneNumber}
      - hideKeyboard: true
      - click:
          identifier: ca.test.mappings.checkOut.placeOrder
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.placeOrder.alertBox
          then:
            - getString:
                identifier: ca.test.mappings.global.errorBoxTitle
                attribute: text
                storeIn: errorMessage
            - click:
                identifier: ca.test.mappings.acceptAlertBox
            - log: ${errorMessage}

  - name: ca.test.functions.checkOut.validateOrderDetails
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.reviewOrderText
            - identifier: ca.test.mappings.checkOutPage.inStorePickUpText
            - identifier: ca.test.mappings.checkOutPage.deliveryPickUpDate
            - identifier: ca.test.mappings.checkOutPage.pickUpPersonTextView
            - identifier: ca.test.mappings.checkOutPage.orderItemsEditButton
            - identifier: ca.test.mappings.checkOutPage.pickUpPersonEditButton
            - identifier: ca.test.mappings.checkOutPage.placeOrderButton

  # Add pickup person if not present
  - name: ca.test.functions.checkOut.addAPickupPerson
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.pickUpPersonTextView
          then:
            - loop:
                begin: 1
                end: 4
                mode: increment
                flow: 
                  - click:
                      identifier: ca.test.mappings.checkOutPage.pickUpPersonEditButton
                  - verifyIdentifier:
                      present:
                        - identifier: ca.test.mappings.checkOut.addPickupPersonDetails
                  - enterText:
                      identifier: ca.test.mappings.checkOut.firstNamePickupPerson
                      string: Walmart
                  - enterText:
                      identifier: ca.test.mappings.checkOut.lastNamePickupPerson
                      string: Tester
                  - enterText:
                      identifier: ca.test.mappings.checkOut.emailPickupPerson
                      string: walmart.tester@test.com
                  - click:
                      identifier: ca.test.mappings.deliveryAddress.add.saveButton
                  - sleep:
                      duration: 10000
                  - if:
                      identifier:
                        notPresent:
                          - identifier: ca.test.mappings.deliveryAddress.add.saveButton
                      then:
                        - break: true
                      else:
                        - click:
                            identifier: ca.test.mappings.global.closeIcon
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.pickUp.pickUpPersonTextView
              equals: Walmart Tester
        

  # Checkout page validation
  - name: ca.test.functions.checkOut.validateCheckOutOrderCard
    platform: android
    flow:
      - loop:
          begin: 1
          end: 4
          mode: increment
          flow:
            - try:
                flow:
                  - verifyIdentifier:
                      text:
                        - identifier: ca.test.mappings.checkOutPage.reviewOrderText
                          contains: Checkout
                  - if:
                      condition: ${fulfillment} == 'PickUp'
                      then:
                        - verifyIdentifier:
                            present:
                              - identifier: ca.test.mappings.checkOutPage.reviewOrderText
                              - identifier: ca.test.mappings.checkOutPage.inStorePickUpText
                              - identifier: ca.test.mappings.checkOutPage.deliveryPickUpDate
                              #- identifier: ca.test.mappings.checkOutPage.pickUp.pickUpPersonTextView
                              # - identifier: ca.test.mappings.checkOutPage.orderItemsEditButton
                              # - identifier: ca.test.mappings.checkOutPage.pickUp.pickUpPersonEditButton
                              - identifier: ca.test.mappings.checkOut.placeOrder
                        - verifyIdentifier:
                            text:
                              - identifier: ca.test.mappings.checkOutPage.inStorePickUpText
                                contains: Pickup
                        - break: true
                  - if:
                      condition: ${fulfillment} == 'Shipping'
                      then:        
                        - verifyIdentifier:
                            present:
                              - identifier: ca.test.mappings.checkOutPage.reviewOrderText
                              - identifier: ca.test.mappings.checkOutPage.delivery.deliverySectionText
                              - identifier: ca.test.mappings.checkOutPage.deliveryPickUpDate
                              - identifier: ca.test.mappings.checkOutPage.orderItemsEditButton
                              - identifier: ca.test.mappings.checkOut.placeOrder
                        - verifyIdentifier:
                            text:
                              - identifier: ca.test.mappings.checkOutPage.delivery.deliverySectionText
                                contains: Shipping
                        - break: true
                catch:
                  flow:
                    - scroll:
                        direction: down
                        scrollLimit: 1


  # Check out payment method validation
  - name: ca.test.functions.checkOut.paymentOptions
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.changePaymentButton
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.changePaymentButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.payment.cvvHintImage
            - identifier: ca.test.mappings.checkOutPage.payment.totalCartValue
            - identifier: ca.test.mappings.checkOutPage.payment.cardEndingNumber
            - identifier: ca.test.mappings.checkOut.cardCVV
            - identifier: ca.test.mappings.checkOutPage.changePaymentButton
            - identifier: ca.test.mappings.checkOutPage.payment.cvvMessage
            - identifier: ca.test.mappings.checkOutPage.payment.enterCVVTitle

  # Check out payment method validation
  - name: ca.test.functions.checkoutPage.validatePaymentDetails
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.changePaymentButton
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.changePaymentButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkoutPage.payment.title
            - identifier: ca.test.mappings.checkoutPage.payment.cvvAlertMessage
            - identifier: ca.test.mappings.checkoutPage.payment.cardLastFourdigits
            - identifier: ca.test.mappings.checkoutPage.payment.cardIcon
            - identifier: ca.test.mappings.checkoutPage.payment.estimateTotal
            - identifier: ca.test.mappings.checkoutPage.payment.enterCvvMessage
            - identifier: ca.test.mappings.checkoutPage.payment.cvvTextField

  # Add card CVV
  - name: ca.test.functions.checkOut.payment.addCVV
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.changePaymentButton
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.changePaymentButton
                position: center
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.cardCVV
          then:
            - click:
                identifier: ca.test.mappings.checkOut.cardCVV
            - enterText:
                identifier: ca.test.mappings.checkOut.cardCVV
                string: ${cvv}
            - hideKeyboard: true

  # Mobile number validation
  - name: ca.test.functions.checkOut.mobileContactValidation
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mapping.checkOutPage.mobileContact.phoneTextField
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mapping.checkOutPage.mobileContact.phoneTextField
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.mobileContact.title
            - identifier: ca.test.mapping.checkOutPage.mobileContact.phoneTextField
            #- identifier: ca.test.mappings.checkOutPage.mobileContact.checkBox
            #- identifier: ca.test.mappings.checkOutPage.mobileContact.mobileAlertTerms

  # mobile number enter in check out
  - name: ca.test.functions.checkOut.mobileContact.enterMobileNumber
    platform: android
    flow:
      - sleep:
          duration: 10000
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mapping.checkOutPage.mobileContact.phoneTextField
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mapping.checkOutPage.mobileContact.phoneTextField
                scrollLimit: 2
                # position: center
      - click:
          identifier: ca.test.mapping.checkOutPage.mobileContact.phoneTextField
      - enterText:
          identifier: ca.test.mapping.checkOutPage.mobileContact.phoneTextField
          string: ${phoneNumber}
      - hideKeyboard: true
      # - scroll:
      #     direction: down
      

  # Promo Code header validation
  - name: ca.test.functions.checkOut.promoCodeValidation
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.promoCodeTitle
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.promoCodeTitle
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.promoCodeTitle
            - identifier: ca.test.mappings.global.indicatorIcon

  # # Check out sub total validation
  # - name: ca.test.functions.checkOut.subTotalValidation
  #   platform: android
  #   flow:
  #     - if:
  #         identifier:
  #           notPresent:
  #             - identifier: ca.test.mappings.checkOutPage.estimatedTotalText
  #         then:
  #           - scroll:
  #               direction: down
  #               untilIdentifier: ca.test.mappings.checkOutPage.estimatedTotalText
  #     - verifyIdentifier:
  #         present:
  #           - identifier: ca.test.mappings.checkOutPage.subTotalText
  #           - identifier: ca.test.mappings.checkOutPage.walmartShippingText
  #           - identifier: ca.test.mappings.checkOutPage.taxesText
  #     - verifyIdentifier:
  #         text:
  #           - identifier: ca.test.mappings.checkOutPage.walmartShippingValue
  #             contains: "FREE"
  #     - verifyIdentifier:
  #         text:
  #           - identifier: ca.test.mappings.checkOutPage.subTotalValue
  #             contains: ${subTotal}
  #     - verifyIdentifier:
  #         text:
  #           - identifier: ca.test.mappings.checkOutPage.estimatedTotalValue
  #             contains: ${subTotal}
  #     - verifyIdentifier:
  #         text:
  #           - identifier: ca.test.mappings.checkOutPage.taxesValue
  #             contains: "$0"
  
  # Checkout
  - name: ca.test.functions.checkOut.PlacingOrder 
    platform: android
    flow:
      - verifyIdentifier:
         present:
            - identifier: ca.test.mappings.checkOut.placeOrder
      - click:
          identifier: ca.test.mappings.checkOut.placeOrder
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.placeOrder.alertBox
          then:
            - getString:
                identifier: ca.test.mappings.global.errorBoxTitle
                attribute: text
                storeIn: errorMessage
            - click:
                identifier: ca.test.mappings.acceptAlertBox
            - log: ${errorMessage}
      - verifyIdentifier:
          timeout: 30000
          present:
            - identifier: ca.test.mappings.orderConformation.continueShoppingButton

  # Order Confirmation screen validation
  - name: ca.test.functions.checkOut.orderConfirmationValidation
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.orderConfirmation.tickImage
            - identifier: ca.test.mappings.orderConfirmation.thanks
            - identifier: ca.test.mappings.orderConfirmation.orderNumber
            - identifier: ca.test.mappings.orderConfirmation.orderAmount
            - identifier: ca.test.mappings.orderConfirmation.charity
            #- identifier: ca.test.mappings.orderConfirmation.confirmationAlert
            - identifier: ca.test.mappings.orderConfirmation.fulfillmentType
            - identifier: ca.test.mappings.orderConfirmation.fulfillmentTime
            - identifier: ca.test.mappings.orderConfirmation.ozarkPromise
            - identifier: ca.test.mappings.orderConfirmation.fulfillmentAddress
            - identifier: ca.test.mappings.orderConfirmation.arrivalDate
            - identifier: ca.test.mappings.orderConfirmation.itemsCount
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.orderConfirmation.feedbackCTA
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.orderConfirmation.feedbackCTA
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.orderConfirmation.recyclerView
            - identifier: ca.test.mappings.orderConfirmation.adMessage
            - identifier: ca.test.mappings.orderConfirmation.bannerTitle
            - identifier: ca.test.mappings.orderConfirmation.bannerMessage
            - identifier: ca.test.mappings.orderConfirmation.bannerImage
            - identifier: ca.test.mappings.orderConfirmation.feedbackTitle
            - identifier: ca.test.mappings.orderConfirmation.feedbackCTA
            - identifier: ca.test.mappings.continueShopping

  - name: ca.test.functions.checkOut.estimateTotalAssertion
    platform: android
    flow:
      - verifyIdentifier:
          present:
             - identifier: ca.test.mappings.checkOutPage.estimatedTotalValue
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.estimatedTotalValue
              contains: ${estimate_total}
      - log: 
          message: Check out page estimate total validation successful
          color: GREEN_BOLD

# Checkout page validation
  - name: ca.test.functions.checkOut.validateCheckOutOrderCartIos
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.reviewOrderText
      - if:
          condition: ${fulfillment} == 'PickUp'
          then:
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOutPage.reviewOrderText
                  - identifier: ca.test.mappings.checkOutPage.pickUp.inStorePickUpText
                  - identifier: ca.test.mappings.checkOutPage.deliveryPickUpDate
                  # - identifier: ca.test.mappings.checkOutPage.pickUp.pickUpPersonTextView
                  # - identifier: ca.test.mappings.checkOutPage.pickUp.pickUpPersonEditButton
                  # - identifier: ca.test.mappings.checkOut.pickUp.itemsNumber
                  - identifier: ca.test.mappings.checkOut.placeOrder
            - verifyIdentifier:
                label:
                  - identifier: ca.test.mappings.checkOutPage.pickUp.inStorePickUpText
                    contains: In-store pickup
      - if:
          condition: ${fulfillment} == 'Shipping'
          then:        
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOutPage.reviewOrderText
                  - identifier: ca.test.mappings.checkOutPage.delivery.deliverySectionText
                  - identifier: ca.test.mappings.checkOutPage.deliveryPickUpDate
                  # - identifier: ca.test.mappings.checkOutPage.addDeliveryInstruction
                  - identifier: ca.test.mappings.checkOutPage.orderItemsView
                  - identifier: ca.test.mappings.checkOut.placeOrder
            - verifyIdentifier:
                label:
                  - identifier: ca.test.mappings.checkOutPage.delivery.deliverySectionText
                    contains: ca.test.data.ShippingText # Shipping

  - name: ca.test.functions.checkOut.verifyCardMxDeliveryFromStore
    platform: ios
    flow:
      - loop:
          begin: 1
          end: 3
          mode: increment
          flow:
            - sleep:
                duration: 5000
            - try:
                flow:
                  - if:
                      condition: ${fulfillment} == 'Delivery from store'
                      then:        
                        - verifyIdentifier:
                            present:
                              - identifier: ca.test.mappings.checkOutPage.delivery.deliverySectionText
                              - identifier: ca.test.mappings.checkOutPage.deliveryPickUpTime
                              # - identifier: ca.test.mappings.checkOutPage.addDeliveryInstruction
                              - identifier: ca.test.mappings.checkOutPage.orderItemsEdit
                              - identifier: ca.test.mappings.checkOut.placeOrder
                        - verifyIdentifier:
                            label:
                              - identifier: ca.test.mappings.checkOutPage.delivery.deliverySectionText
                                contains: Delivery from store           
                  - break: true
                catch:
                  flow:
                    - scroll:
                        direction: up
                        untilIdentifier: ca.test.mappings.checkOutPage.delivery.deliverySectionText   

  - name: ca.test.functions.checkOut.verifyCardMxShipping
    platform: ios
    flow:
      - loop:
          begin: 1
          end: 3
          mode: increment
          flow:
            - sleep:
                duration: 5000
            - try:
                flow:
                  - if:
                      condition: ${fulfillment} == 'Shipping'
                      then:        
                        - verifyIdentifier:
                            present:
                               - identifier: ca.test.mappings.checkOutPage.delivery.deliverySectionText
                               - identifier: ca.test.mappings.checkOutPage.deliveryPickUpDate
                              #  - identifier: ca.test.mappings.checkOutPage.addDeliveryInstruction
                               - identifier: ca.test.mappings.checkOutPage.orderItemsView
                               - identifier: ca.test.mappings.checkOut.placeOrder
                        - verifyIdentifier:
                            label:
                              - identifier: ca.test.mappings.checkOutPage.delivery.deliverySectionText
                                contains: Shipping        
                  - break: true
                catch:
                  flow:
                    - scroll:
                        direction: down
                        untilIdentifier: ca.test.mappings.checkOutPage.delivery.deliverySectionText                  

  - name: ca.test.functions.checkOut.paymentOptionsIos
    platform: ios
    flow:
      - if:
          identifier:
           present:
              - identifier: ca.test.mappings.checkOutPage.cardSummaryContainer  
          then:
              - verifyIdentifier:
                  present:
                    # - identifier: ca.test.mappings.checkOutPage.payment.cvvTitleLabel
                  # - identifier: ca.test.mappings.checkOutPage.payment.totalCartValue -- locators issue
                    - identifier: ca.test.mappings.checkOutPage.payment.cardEndingNumber
                    # - identifier: ca.test.mappings.checkOut.cardCvv
                    - identifier: ca.test.mappings.checkOutPage.changePaymentButton


  - name: ca.test.functions.checkOut.addNewPaymentPaymentIos
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.validation.signInFromAccount.wallet
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.addPaymentMethod  #ca.test.validation.signInFromAccount.wallet
          else:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.addPaymentMethod  #ca.test.validation.signInFromAccount.wallet
      - verifyIdentifier:
          present:
              - identifier: ca.test.validation.signInFromAccount.wallet
              - identifier:  ca.test.mappings.checkOutPage.addPaymentMethod  #ca.test.mappings.checkOutPage.addNewPaymentButton #

# Add card CVV
  - name: ca.test.functions.checkOut.payment.addCvvIos
    platform: ios
    flow:      
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.cardCvv
          then:    
            - enterText:
                identifier: ca.test.mappings.checkOut.cardCvv
                string: ${CVV}
        # - if:
        #     identifier:
        #       present:
        #         - identifier: ca.test.mapping.checkout.keyboard
        #     then:
            - click: 
                identifier: ca.test.mapping.checkout.keyboard
        # - hideKeyboard: true


# Mobile number validation
  - name: ca.test.functions.checkOut.mobileContactValidationIos
    platform: ios
    flow:
      - scroll:
          direction: down
          position: center
          untilIdentifier: ca.test.mappings.checkOut.promoCode
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.mobileContact.title
            - identifier: ca.test.mapping.checkOut.phoneTextField
            - identifier: ca.test.mappings.checkOutPage.mobileContact.mobileContactText
            # - identifier: ca.test.mappings.checkOutPage.mobileContact.mobileNumberLimitText

# Mobile number and Checkout
  - name: ca.test.functions.checkout.mobileNumberIos
    platform: ios
    flow:
      - verifyIdentifier:
         timeout: 10000
         present:
            - identifier: ca.test.mapping.checkOut.phoneTextField                    
      - enterText:
          identifier: ca.test.mapping.checkOut.phoneTextField
          string: ${phoneNumber}
      - if:
          identifier:
            present:
              - identifier: ca.test.mapping.checkout.keyboard 
            timeout: 5000
          then:
            - click: 
                identifier: ca.test.mapping.checkout.keyboard 
      - hideKeyboard: true

# Checkout
  - name: ca.test.functions.checkOut.PlacingOrder 
    platform: ios
    flow:
      - verifyIdentifier:
         present:
            - identifier: ca.test.mappings.checkOut.placeOrder
      - click:
          identifier: ca.test.mappings.checkOut.placeOrder    

# Check out sub total validation
  - name: ca.test.functions.checkOut.subTotalValidation
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.estimatedTotalText
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.estimatedTotalText
                timeout: 15000
      - verifyIdentifier:
          present:
             - identifier: ca.test.mappings.checkOutPage.subTotalText        
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.subTotalValue
              contains: ${subTotal}
      - log: 
          message: "checkout Page Subtotal Assertion Sucessful"
          color: GREEN_BOLD

  # Shipping fee assertion
  - name: ca.test.functions.checkOut.walmartShippingAssertion
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.walmartShippingText
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.walmartShippingText
      - verifyIdentifier:
          present:
             - identifier: ca.test.mappings.checkOutPage.walmartShippingText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.walmartShippingValue
              contains: ${walmartShipping}             
      - log: 
          message: "Checkout Page Shipping Fee Assertion Successful"
          color: GREEN_BOLD

  # Taxes assertion
  - name: ca.test.functions.checkOut.taxesAssertion
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.taxesValue
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.taxesValue
      - verifyIdentifier:
          present:
             - identifier: ca.test.mappings.checkOutPage.taxesValue
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.taxesValue
              contains: ${total_tax}
      - log: 
          message: "Checkout Page Tax Assertion Successful"
          color: GREEN_BOLD

 # HST assertion
  - name: ca.test.functions.checkOut.hstAssertion
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkout.subTotal.cartHstText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkout.subTotal.cartHstText
              contains: ${hst_percentage}
            - identifier: ca.test.mappings.checkout.subTotal.cartHst
              contains: ${hst_tax_value}
      - log: 
          message: "Checkout Page HST Tax Assertion Successful"
          color: GREEN_BOLD

  # Associate discount assertion
  - name: ca.test.functions.checkout.associateDiscount
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkout.associateDiscountText
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkout.associateDiscountText
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkout.associateDiscountText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkout.associateDiscountValue 
              contains: ${associate_discount}     
      - log: 
          message: "Checkout Page Associate Discount Assertion Successful"
          color: GREEN_BOLD

  # Estimated total assertion
  - name: ca.test.functions.checkOut.estimateTotalAssertion
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.estimatedTotalText
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.estimatedTotalText
      - verifyIdentifier:
          present:
             - identifier: ca.test.mappings.checkOutPage.estimatedTotalValue
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.estimatedTotalValue
              contains: ${estimate_total}  
      - log: 
          message: "Checkout Page Estimated Total Assertion Successful"
          color: GREEN_BOLD

  # validate CRF fees in checkout
  - name: ca.test.functions.checkout.validateCrfFees
    platform: ios
    flow:
      - verifyIdentifier:
          present: 
            - identifier: ca.test.mappings.cart.CRFText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.cart.CRFValue
              contains: ${crf_fee} 
      - log: "Checkout Page crf fee Assertion Sucessful"        

  # validate eco fees in checkout
  - name: ca.test.functions.checkout.validateEcoHandlingFeesIos
    platform: ios
    flow:
      - verifyIdentifier:
          present: 
            - identifier: ca.test.mappings.checkOut.ecoHandling
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOut.ecoHandlingValue
              contains: ${eco_fee} 
      - log: "CheckOut Page eco handling fee Assertion Sucessful" 

   # validate Bev fees in checkOut
  - name: ca.test.functions.checkOut.validateBevFees
    platform: ios
    flow:
      - verifyIdentifier:
          present: 
            - identifier: ca.test.mappings.checkOut.BevDeposit                           
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOut.BevDepositValue
              contains: ${bev_fee} 
      - log: "Cart Page Bev fee Assertion Sucessful"  

   # validate handling fees in cart
  - name: ca.test.functions.checkOut.HandlingFee
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.handlingFee 
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.handlingFee 
      - verifyIdentifier:
          present: 
            - identifier: ca.test.mappings.checkOut.handlingFee                         
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOut.handlingFeeValue
              contains: ${handling_fee} 
      - log: 
          message: "Cart Page handling fee Assertion Sucessful"
          color: GREEN_BOLD

  # validate gst in cart
  - name: ca.test.functions.checkOut.gstAssertion
    platform: ios
    flow:
      - verifyIdentifier:
          present: 
            - identifier: ca.test.mappings.checkOut.gst                         
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOut.gst
              contains: ${gst_percentage}
            - identifier: ca.test.mappings.checkOut.gstValue
              contains: ${tax_gst} 
      - log: 
          message: "Cart Page gst Assertion Sucessful"
          color: GREEN_BOLD

  # validate grocery pickup fees in checkout
  - name: ca.test.functions.checkOut.validateGroceryPickupFees
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.groceryPickupText
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.groceryPickupText
      - verifyIdentifier:
          present: 
            - identifier: ca.test.mappings.checkOut.groceryPickupText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOut.groceryPickupValue
              contains: ${grocery_pickup} 
      - log: "Cart Page groceryPickup fee Assertion Sucessful"  

  # validate grocery pickup fees in checkout
  - name: ca.test.functions.checkOut.subTotal.scheduleOrderFee
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.scheduledOrderFeeText
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.scheduledOrderFeeText
                position: center
                timeout: 15000
      - verifyIdentifier:
          present: 
            - identifier: ca.test.mappings.checkOut.scheduledOrderFeeText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOut.scheduledOrderFeeValue
              contains: ${scheduledOrderFeeValue} 
      - log: 
          message: "Cart Page groceryPickup fee Assertion Sucessful"  
          color: GREEN_BOLD

  # validate walmart pickup fees in checkout
  - name: ca.test.functions.checkOut.validateWalmartPickupFees
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.walmartPickupText
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.walmartPickupText
      - verifyIdentifier:
          present: 
            - identifier: ca.test.mappings.checkOut.walmartPickupText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOut.walmartPickupValue
              contains: ${walmart_pickup} 
      - log: "Checkout Page Walmart Pickup fee Assertion Sucessful"

  - name: ca.test.functions.checkOutPage.sellerShipping
    platform: ios
    flow:

      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.seller2PickupText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkoutPage.seller2PickupValue
              contains: ${seller_pickup} 
      - log: "CheckOut Page seller shipping Assertion Sucessful"             

  - name: ca.test.functions.checkOut.hdePickup
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkout.hDEPickupText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkout.hDEPickupValue
              contains: ${hde_pickup} 
      - log: "Checkout Page HDE Pickup Assertion Sucessful" 

    # Checkout page validation
  - name: ca.test.functions.checkOut.validateCheckOutOrderCardPickUpMerchandise
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.reviewOrderText
            - identifier: ca.test.mappings.checkOutPage.pickUpText
            - identifier: ca.test.mappings.checkOutPage.deliveryPickUpDate
            - identifier: ca.test.mappings.checkOutPage.orderItemsEditButton
            - identifier: ca.test.mappings.checkOut.placeOrder
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.pickUpText
              contains: Pickup

    # Checkout page validation
  - name: ca.test.functions.checkOut.validateCheckOutOrderCardPickUpGrocery
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.reviewOrderText
            - identifier: ca.test.mappings.checkOutPage.pickUpText
            - identifier: ca.test.mappings.checkOutPage.deliveryPickUpDate
            - identifier: ca.test.mappings.checkOutPage.orderItemsEditButton
            - identifier: ca.test.mappings.checkOutPage.pickUpPersonEditButton
            - identifier: ca.test.mappings.checkOut.placeOrder
            - identifier: ca.test.mappings.checkOutPage.pickUpPersonText
            - identifier: ca.test.mappings.orderConfirmation.recyclerView
            - identifier: ca.test.mappings.orderConformation.actionableArea
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.pickUpText
              contains: In-store pickup

  - name: ca.test.functions.checkOut.assertingStoreAddress
    platform: android
    flow:
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOut.pickupStoreName
              contains: ${storeName}
            - identifier: ca.test.mappings.checkOut.pickUpStoreAddress
              contains: ${storeAddress}

  - name: ca.test.functions.checkOut.assertingStoreAddress
    platform: ios
    flow:
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkout.fulfillmentTypes.fulfillmentStoreName
              contains: ${storeName}
            - identifier: ca.test.mappings.checkout.fulfillmentTypes.fulfillmentAddress
              contains: ${storeAddress}

#-------------------------CheckOut Page Sub Total Validation----------------------------------

  # Check out sub total validation
  - name: ca.test.functions.checkOut.subTotalValidation
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.estimatedTotalValue
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.estimatedTotalText
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.subTotalAfterSavings
          then:
            - verifyIdentifier:
                text:
                  - identifier: ca.test.mappings.checkOutPage.subTotalAfterSavings
                    contains: ${subTotal} 
          else:
            - verifyIdentifier:
                text:
                  - identifier: ca.test.mappings.checkOutPage.subTotalValue
                    contains: ${subTotal}
      - log: 
          message: Check out page sub total validation successful
          color: GREEN_BOLD

  - name: ca.test.functions.checkOut.subTotalValidationWithSaving
    platform: android
    flow: 
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.estimatedTotalValue
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.estimatedTotalValue
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.subTotalText
            - identifier: ca.test.mappings.checkOutPage.totalSavingsText
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.subTotalValue
              contains: ${subTotal}
            - identifier: ca.test.mappings.checkOutPage.priceAfterSavings
              contains: ${priceAfterSavings}
      - executeNode:
          file: ca/test/helpers/stringComparison.js
          args:
            - value: savings
            - value: ca.test.mappings.checkOutPage.totalSavingsValue
          getResponse:
            storeIn: flag
      - if:
          condition: ${flag} == true
          then:
            - verifyIdentifier:
                text:
                - identifier: ca.test.mappings.checkOutPage.totalSavingsValue
                  contains: ${savings}        
  
  - name: ca.test.functions.checkOut.totalTaxesAssertion
    platform: android
    flow:
      - verifyIdentifier:
          present:
             - identifier: ca.test.mappings.checkOutPage.taxesValue
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.taxesValue
              contains: ${total_tax}
      - log: 
          message: Check out page total tax validation successful
          color: GREEN_BOLD
  
  - name: ca.test.functions.checkOut.taxesAssertion
    platform: android
    flow:
      - verifyIdentifier:
          present:
             - identifier: ca.test.mappings.checkOutPage.taxText
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.taxValue
              contains: ${tax_value}
      - log: 
          message: Check out page tax validation successful
          color: GREEN_BOLD
          
  
  - name: ca.test.functions.checkOut.estimateTotalAssertion
    platform: android
    flow:
      - verifyIdentifier:
          present:
             - identifier: ca.test.mappings.checkOutPage.estimatedTotalValue
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.estimatedTotalValue
              contains: ${estimate_total}
      - log: 
          message: Check out page estimate total validation successful
          color: GREEN_BOLD

  - name: ca.test.functions.checkOut.associateDiscountAssertion
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.associateDiscountText
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOut.associateDiscountValue
              contains: ${associate_discount}
      - log: 
          message: Check out page associate discount validation successful
          color: GREEN_BOLD

  - name: ca.test.functions.checkOut.associateAndPromoDiscountAssertion
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.associateDiscountText
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOut.associateDiscountValue
              contains: ${associate_discount}
      - log:
          message: Check out page associate discount validation successful
          color: GREEN_BOLD
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOut.associateDiscountText
              contains: ${promoCodeText}
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOut.associateDiscountValue
              contains: ${promoCodeValue}
      - log:
          message: Applied Promo Code & Promo Discount Validation is successful
          color: GREEN_BOLD
  
  - name: ca.test.functions.checkOut.groceryPickupAndWalmartShippingFee
    platform: android
    flow:
#      - if:
#          condition: ${slotPrice} == 'null' || ${slotPrice} == '$0' || ${slotPrice} == 0
#          then:
#            - storeIn:
#                key: slotPrice
#                value: FREE
#      - if:
#          condition: ${slotPrice} == '0 $'
#          then:
#            - storeIn:
#                key: slotPrice
#                value: GRATUIT
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.groceryPickupAndWalmartShppingFee
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOut.groceryPickupAndWalmartShppingFeeValue
              contains: ${pickupAndShippingFee}
      - log:
          message: Check out page grocery pick up and walmart shipping charges validation successful
          color: GREEN_BOLD

  - name: ca.test.functions.checkOut.minimumFeeTile
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.minimumFeeChargesText
          text:
            - identifier: ca.test.mappings.checkOut.minimumFeeChargesValue
              contains: ${walmartShippingFee}
  
  - name: ca.test.functions.checkOut.shippingCharges
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.walmartShippingText
          text:
            - identifier: ca.test.mappings.checkOutPage.walmartShippingValue
              contains: ${shippingFee}
  
  # validate grocery pickup fees in checkout
  - name: ca.test.functions.checkOut.validateGroceryDeliveryFees
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.groceryDeliveryText
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.groceryDeliveryText
      - verifyIdentifier:
          present: 
            - identifier: ca.test.mappings.checkOut.groceryDeliveryText
      - if:
          condition: ${clearPrice} == '$0'
          then:
            - verifyIdentifier:
                label:
                  - identifier: ca.test.mappings.checkOut.groceryDeliveryValue
                    contains: ca.test.data.freeSlotText  
          else:
            - verifyIdentifier:
                label:
                  - identifier: ca.test.mappings.checkOut.groceryDeliveryValue
                    contains: ${grocery_delivery} 
            - log: "Cart Page grocery delivery fee Assertion Sucessful"                  
          
  # Order Confirmation screen validation
  - name: ca.test.functions.checkOut.orderConfirmationValidationIos
    platform: ios
    flow:
      - sleep:
          duration: 20000
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.tapToRateAppStore
          then:
            - click:
               identifier: ca.test.mappings.checkOut.tapToRateAppStore
      - sleep:
          duration: 5000         
      - verifyIdentifier: 
          present:
            - identifier: ca.test.mappings.orderConfirmation.tickImage
            - identifier: ca.test.mappings.orderConfirmation.thanks
            - identifier: ca.test.mappings.orderConfirmation.orderNumber
            - identifier: ca.test.mappings.orderConfirmation.orderAmount
            - identifier: ca.test.mappings.orderConfirmation.fulfillmentType
            - identifier: ca.test.mappings.orderConfirmation.fulfillmentAddress
            - identifier: ca.test.mappings.orderConfirmation.arrivalDate
            - identifier: ca.test.mappings.orderConfirmation.continueShopping
            - identifier: ca.test.mappings.orderConfirmation.emailId
            
  - name: ca.test.functions.checkOut.groceryDeliveryFee
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.groceryDeliveryText
      - if:
          condition: ${slotPrice} == '$0' || ${slotPrice} == '0 $'
          then:
            - verifyIdentifier:
                text:
                  - identifier: ca.test.mappings.cart.groceryDeliveryFeeValue
                    contains: ca.test.data.freeSlotText
          else:
            - verifyIdentifier:
                text:
                  - identifier: ca.test.mappings.checkOut.groceryDeliveryValue
                    contains: ${groceryDeliveryFee}
#---------------------------------------------------------------------------------------------

  - name: ca.test.functions.checkout.placeOrderButton
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.placeOrder
      - click:
          identifier: ca.test.mappings.checkOut.placeOrder
      - verifyIdentifier:
          timeout: 30000
          present:
            - identifier: ca.test.mappings.orderConformation.continueShoppingButton

  - name: ca.test.functions.orderConformationValidation
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier: ca.test.mappings.orderConformation.tickSign
            - identifier: ca.test.mappings.orderConformation.text
            - identifier: ca.test.mappings.orderConformation.orderId
            - identifier: ca.test.mappings.orderConformation.fulfillment
            - identifier: ca.test.mappings.orderConformation.actionableArea
            - identifier: ca.test.mappings.cart.scheduledPickup.slotDetails
            - identifier: ca.test.mappings.orderConformation.continueShoppingButton
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.orderConformation.subTotal
              contains: ${estimate_total}
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.orderConformation.address
              contains: ${addressFirstLine}

  - name: ca.test.functions.checkOut.assertingDeliveryAddress
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.android.data.checkOut.shippingHeader
          then:
             - scroll:
                direction: down
                untilIdentifier: ca.test.android.data.checkOut.shippingHeader
                position: center
      - verifyIdentifier:
          text:
            - identifier: ca.test.mapppings.checkOutPage.deliveryAddress
              contains: ${addressFirstLine}

  - name: ca.test.functions.checkOut.validateCheckOutCardGroceryDelivery
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.mappings.checkOutPage.reviewOrderText
            - identifier: ca.test.mappings.cart.delivery.cardTitle
            - identifier: ca.test.mappings.checkOutPage.deliveryPickUpDate
            - identifier: ca.test.mapppings.checkOutPage.deliveryAddress
            - identifier: ca.test.mappings.checkOutPage.deliveryInstructionsLabel
            - identifier: ca.test.mappings.checkOutPage.addDeliveryInstructions
            - identifier: ca.test.mappings.checkOutPage.deliveryInstructionsText
            - identifier: ca.test.mappings.checkOutPage.leaveAtMyDoor
            #- identifier: ca.test.mappings.checkOutPage.deliveryInstructionsDisclaimer
            - identifier: ca.test.mappings.orderConformation.actionableArea
  
  - name: ca.test.functions.checkOut.validatingDeliveryNote
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.addDeliveryInstructions
      - click:
          identifier: ca.test.mappings.checkOut.deliveryInstructionEditButton
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.mappings.checkOut.DeliveryInstructions
      - enterText:
          identifier: ca.test.mappings.checkOut.deliveryNote
          clearField: true
          string: ${deliveryNote}
      - click:
          identifier: ca.test.mappings.checkOutPage.saveButton
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.deliveryInstructionsText
              contains: ${deliveryNote}
      - log:
          message: Leave at door steps validation completed
          color: GREEN_BOLD     

    # Checkout page validation
  - name: ca.test.functions.checkOut.validateCheckOutOrderCardPickUpMerchandiseios
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.checkoutText
            - identifier: ca.test.mappings.checkOutPage.pickUpText
            - identifier: ca.test.mappings.checkOutPage.deliveryPickUpDate
            - identifier: ca.test.mappings.checkOut.placeOrder
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.pickUpText
              contains: Pickup

  - name: ca.test.functions.checkOut.hstAssertion5%
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkoutPage.subTotal.cartHstText5%
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkoutPage.subTotal.cartHstText5%
              contains: ${hst_percentage}
            - identifier: ca.test.mappings.checkout.subTotal.cartHst5%
              contains: ${hst_tax_value}
      - log: "Checkout Page HST Tax Assertion Successful"

  # Check out payment method validation
  - name: ca.test.functions.checkOut.paymentOptions
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.changePaymentButton 
          then:
            - sleep:
                duration: 1000
            - scroll:
                direction: down
                position: center
                untilIdentifier: ca.test.mappings.checkOutPage.changePaymentButton 
      - verifyIdentifier:
          present:
#            - identifier: ca.test.mappings.checkOutPage.payment.cvvTitleLabel
            - identifier: ca.test.mappings.checkOutPage.payment.cardEndingNumber
            # - identifier: ca.test.mappings.checkOut.cardCvv
            - identifier: ca.test.mappings.checkOutPage.editPaymentButton
            # - identifier: ca.test.mappings.checkOutPage.payment.cvvMessage
            # - identifier: ca.test.mappings.checkOutPage.payment.enterCVVTitle

  - name: ca.test.functions.checkOut.associateDiscountAssertion
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkout.associateDiscountText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkout.associateDiscountValue
              contains: ${associateDiscount}
      - log: 
          message: "Checkout Page Associate Discount Assertion Successful"
          color: GREEN_BOLD

  - name: ca.test.functions.checkOut.WalmartPickupCharge
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.WalmartPickupChargeText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.WalmartPickupCharge
              contains: ${WalmartPickupCharge}
      - log: "Checkout Page Walmart Pickup Charge Assertion Successful"

  - name: ca.test.functions.checkOut.walmartShippingAssertion
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.walmartShippingText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.walmartShippingValue
              contains: ${walmartShipping}
      - log: "Checkout Page Walmart Shipping Fee Assertion Successful"

  - name: ca.test.functions.checkOut.babyHavenShipping
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.babyHaven.shippingFeeText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.babyHaven.shippingFee
              contains: ${shippingFee}
      - log: "Checkout Page BabyHaven Shipping Fee Assertion Successful"
  
  # Checking mobile number feild
  - name: ca.test.functions.checkout.checkingMobileNumberIos
    platform: ios
    flow:
      - loop:
          begin: 0
          end: 5
          mode: increment 
          flow:        
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mapping.checkOut.phoneTextField
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mapping.checkout.phoneNumber
                then:
                  - click:
                      identifier: ca.test.mapping.checkOut.phoneTextField 
                  - enterText:
                      identifier: ca.test.mapping.checkOut.phoneTextField
                      string: ${phoneNumber}   
                  - sleep:
                      duration: 5000
                  - if:
                      identifier:
                        present:
                          - identifier: ca.test.mapping.checkout.keyboard 
                      then:
                        - click: 
                            identifier: ca.test.mapping.checkout.keyboard 
                  - hideKeyboard: true
                else: 
                  - break: true  
  - name: ca.test.functions.checkOut.groceryDelivery
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.groceryPickupFeeText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.groceryPickupFee
              contains: ${groceryFee}
      - log: "Checkout Grocery Fee Assertion Successful"

  - name: ca.test.functions.checkOutPage.babyHavenPickup
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.babyHavenPickup
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.babyHavenPickupFee
              contains: ${babyHaven_Pickup}
      - log: "Checkout BabyHavenPickup Assertion Successful" 

  # Hde Shipping Assertion
  - name: ca.test.functions.checkOutPage.hdeShipping
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.hdeShipping
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.hdeShippingValue
              contains: ${hde_Shipping} 
      - log: "CheckOut Page hde_Shipping Assertion Sucessful"         

  - name: ca.test.functions.checkOut.assertingExpressSlot
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.cart.fulfillmentBannerInfo


  - name: ca.test.functions.checkOut.assertingSelectedSlot
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.deliveryPickUpDate
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.deliveryPickUpDate
              contains: ${selected_delivery_slot}

  - name: ca.test.functions.checkOut.subTotalValidationWithSaving
    platform: android
    flow: 
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.estimatedTotalValue
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.estimatedTotalValue
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.subTotalText
            - identifier: ca.test.mappings.checkOutPage.totalSavingsText
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.subTotalValue
              contains: ${subTotal}
            - identifier: ca.test.mappings.checkOutPage.totalSavingsValue
              contains: ${savings}
            - identifier: ca.test.mappings.checkOutPage.priceAfterSavings
              contains: ${priceAfterSavings}

  - name: ca.test.functions.checkOut.orderConformation.orderIdExtraction
    platform: android
    flow:
      - sleep:
          duration: 20000
      - getString:
          identifier: ca.test.mappings.orderConformation.orderId
          attribute: text
          storeIn: orderId

  # Checkout page validation
  - name: ca.test.functions.checkOut.validateCheckOutOrderCard
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.reviewOrderText
          timeout: 5000
      - if:
          condition: ${fulfillmentType} == 'In-store pickup' || ${fulfillmentType} == 'Cueillette en magasin'
          then:
            - storeIn:
                key: viewHolder
                value: PickupViewController.titleViewHolder
            - storeIn:
                key: containerView
                value: PickupViewController.containerView
            - verifyIdentifier:
                present:
                  # In-store pickup
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.fulfillmentStoreName
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.inStorePickup.pickupPersonText
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.inStorePickup.pickupPerson
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.inStorePickup.pickupPerson.changeButton
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.viewButton
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkout.fulfillmentTypes.inStorePickup.substitutionNotEligible
                then:
                  - log:
                      message: "No preferred substitution for product in cart"
                      color: GREEN_BOLD
                else:
                  - if:
                      identifier:
                        present:
                          - identifier: ca.test.mappings.checkout.fulfillmentTypes.inStorePickup.substitutionEligible
                      then:
                        - log:
                            message: "Preferred substitution available for product."
                            color: GREEN_BOLD
                      else:
                        - failTest:
                            message: "Preferred substitution not present."
      - if:
          condition: ${fulfillmentType} == 'Shipping' || ${fulfillmentType} == 'Expédition'
          then:
            - storeIn:
                key: viewHolder
                value: DeliveryViewController.titleView
            - storeIn:
                key: containerView
                value: DeliveryViewController.containerView
            - verifyIdentifier:
                present: 
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.unscheduledFulfillment.userName
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.viewButton
      - if:
          condition: ${fulfillmentType} == 'Delivery from store'
          then:
            - storeIn:
                key: viewHolder
                value: DeliveryViewController.titleView
            - storeIn:
                key: containerView
                value: DeliveryViewController.containerView
            - verifyIdentifier:
                present: 
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.unscheduledFulfillment.userName
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.deliveryFromStore.deliveryInstructions
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.deliveryFromStore.deliveryDisclaimer
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.deliveryFromStore.leaveAtDoor
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.deliveryFromStore.signForMyOrder
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.deliveryFromStore.driverTipText
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.deliveryFromStore.driverTipAmount
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.deliveryFromStore.driverTip.iButton
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.deliveryFromStore.driverTip.disclaimer
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.deliveryFromStore.driverTip.customTip
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.viewButton
            - numberOfChildElements:
                identifier: ca.test.mappings.checkout.fulfillmentTypes.deliveryFromStore.driverTipContainer
                storeIn: customOption
                filterBy: ca.test.mappings.checkout.fulfillmentTypes.deliveryFromStore.driverTipButton
            - log:
                message: ${customOption}
                color: GREEN_BOLD
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkout.fulfillmentTypes.inStorePickup.substitutionNotEligible
                then:
                  - log:
                      message: "No preferred substitution for product in cart"
                      color: GREEN_BOLD
                else:
                  - if:
                      identifier:
                        present:
                          - identifier: ca.test.mappings.checkout.fulfillmentTypes.inStorePickup.substitutionEligible
                      then:
                        - log:
                            message: "Preferred substitution available for product."
                            color: GREEN_BOLD
                      else:
                        - failTest:
                            message: "Preferred substitution not present."
      - if:
          condition: ${fulfillmentType} == 'Pickup'
          then:
            - storeIn:
                key: viewHolder
                value: PickupViewController.titleViewHolder
            - storeIn:
                key: containerView
                value: PickupViewController.containerView
            - verifyIdentifier:
                present:
                  # In-store pickup
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.fulfillmentStoreName
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.inStorePickup.pickupPersonText
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.inStorePickup.pickupPerson
                  - identifier: ca.test.mappings.checkout.fulfillmentTypes.inStorePickup.pickupPerson.changeButton
                  # - identifier: ca.test.mappings.checkout.fulfillmentTypes.viewButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkout.fulfillmentTypes.fulfillmentText
            # - identifier: ca.test.mappings.checkout.fulfillmentTypes.fulfillmentLogo
            - identifier: ca.test.mappings.checkout.fulfillmentTypes.fulfillmentDetailsContainer
            - identifier: ca.test.mappings.checkout.fulfillmentTypes.fulfillmentEta
            - identifier: ca.test.mappings.checkout.fulfillmentTypes.fulfillmentAddress
            - identifier: ca.test.mappings.checkout.fulfillmentTypes.itemsDetails
            - identifier: ca.test.mappings.checkout.fulfillmentTypes.itemsCounts
            - identifier: ca.test.mappings.checkout.fulfillmentTypes.productImage

  - name: ca.test.functions.checkOut.preferredSubstitution
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.reviewOrderText
      - if:
          condition: ${fulfillmentType} == 'In-store pickup' || ${fulfillmentType} == 'Delivery from store'
          then:
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkoutPage.preferredSubstitutionLogo
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkoutPage.preferredSubstitutionLogo
            - click:
                identifier: ca.test.mappings.checkOutPage.substitutionPreferencesLink
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOutPage.SubstitutionPreferrenceTitle
                  - identifier: ca.test.mappings.checkOutPage.allowSubstitutionToggleLabel
                  - identifier: ca.test.mappings.checkOutPage.allowSubstitutionToggleButton
                  - identifier: ca.test.mappings.checkOutPage.defaultSubstitution
                  - identifier: ca.test.mappings.checkOutPage.substitutionProductListWithDetails
            
      - loop:
          begin: 1
          storeIndex: i
          mode: increment
          end: 3
          flow:
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkOut.substitutionPreferrences.productName
                then:
                  - log: 
                      message: inside if
                      color: GREEN_BOLD
                  - getString:
                      identifier: ca.test.mappings.checkOut.substitutionPreferrences.productName
                      attribute: text
                      storeIn: ProductNameToBeSubstituted
                  - log: 
                      message: ${ProductNameToBeSubstituted} 
                      color: GREEN_BOLD
                  - executeFunction:
                     name: ca.test.functions.checkOut.preferredSubstitutionOptions
                     params:
                       - name: productName
                         string: ${ProductNameToBeSubstituted}
                       - name: i
                         string: ${i}
                  

  - name: ca.test.functions.checkOut.preferredSubstitutionOptions
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.substitutionPreferrences.productName
            - identifier: ca.test.mappings.checkOut.substitutionPreferrences.pricePerUnit
            - identifier: ca.test.mappings.checkOut.susbstitutionPreferrences.price
            - identifier: ca.test.mappings.checkOut.susbstitutionPreferrences.quantity
      - click: 
          identifier: ca.test.mappings.checkOut.susbstitutionPreferrences.editButton
      - scroll:
          direction: down
          untilIdentifier: ca.test.mappings.checkOut.susbstitutionPreferrences.replaceWithFirstProductName
      - if:
          condition: "${i}==1"
          then:
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOut.susbstitutionPreferrences.replaceWithFirstProductName
            - click:
               identifier: ca.test.mappings.checkOut.susbstitutionPreferrences.replaceWithFirstProductName
            - getString:
                identifier: ca.test.mappings.checkOut.susbstitutionPreferrences.replaceWithFirstProductName
                attribute: text
                storeIn: substitutedProductName
            - log: 
                message: The product is substituted with ${substitutedProductName}
                color: GREEN_BOLD

            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.susbstitutionPreferrences.selectButton
            - click:
                identifier: ca.test.mappings.checkOut.susbstitutionPreferrences.selectButton
          else:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.substitutionPreferences.doNotReplaceButton
            - click: 
               identifier: ca.test.mappings.checkOut.substitutionPreferences.doNotReplaceButton
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.susbstitutionPreferrences.selectButton
            - click:
                identifier: ca.test.mappings.checkOut.susbstitutionPreferrences.selectButton
            - click:
                identifier: ca.test.mappings.checkOut.substitutionPreferences.doneButton
            - verifyIdentifier:
                present:
                - identifier: ca.test.mappings.checkOutPage.reviewOrderText    
                
  - name: ca.test.functions.checkOut.VerifySavedSunstitutionPreferrences
    platform: android
    flow:
      - sleep:
          duration: 2000
      - click:
          identifier: ca.test.mappings.checkOutPage.substitutionPreferencesLink
      - sleep:
         duration: 1000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.SubstitutionPreferrenceTitle
            - identifier: ca.test.mappings.checkOutPage.substitutionProductListWithDetails
            - identifier: ca.test.mappings.checkOut.substitutionPreferences.allFilter
      - log: 
          message: Verifying products substituted with another product
          color: GREEN_BOLD
      - click:
          identifier: ca.test.mappings.checkOut.substitutionPreferences.preferredSubstitutionFilter
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.substitutionPreferences.ifUnavailableReplaceWithText
            - identifier: ca.test.mappings.checkOut.substitutionPreferences.currentSubstitutionPreview
            - identifier: ca.test.mappings.checkOut.substitutionPreferences.substitutedProductImage
            - identifier: ca.test.mappings.checkOut.substitutionPreferences.substitutedProductDescription
            - identifier: ca.test.mappings.checkOut.substitutionPreferences.substitutedProductPricePerUnit
            - identifier: ca.test.mappings.checkOut.substitutionPreferences.substitutedProductQuantity
            - identifier: ca.test.mappings.checkOut.substitutionPreferences.substitutedProductPrice
            - identifier: ca.test.mappings.checkOut.substitutionPreferences.substitutedProductEditButton

      - log: 
          message: Verifying Don't replace products
          color: GREEN_BOLD
      - click:
          identifier: ca.test.mappings.checkOut.substitutionPreferences.bestMatchFilter
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.substitutionPreferences.bestMatchText
      - log: 
          message: Verifying best match products
          color: GREEN_BOLD
      - click:
          identifier: ca.test.mappings.checkOut.substitutionPreferences.noSubstitutionFilter
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.substitutionPreferences.dontReplaceFilter
  
  
  # Asserting Delivery Address
  - name: ca.test.functions.checkOut.assertingDeliveryAddress
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkout.fulfillmentTypes.fulfillmentAddress
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkout.fulfillmentTypes.fulfillmentAddress
              contains: ${addressFirstLine}
      - log:
          message: "Address Assertion is Successful - ${addressFirstLine} "
          color: GREEN_BOLD

  - name: ca.test.functions.checkOut.pickupCharge
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.pickupChargeText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.pickupCharge
              contains: ${pickupCharge}
      - log: "Checkout Page Pickup Charge Assertion Successful"

  - name: ca.test.functions.checkOut.groceryPickup
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.groceryFeeText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.groceryFee
              contains: ${groceryFee}
      - log: "Checkout Grocery Fee Assertion Successful"

  - name: ca.test.functions.checkOut.urbanDealsShipping
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.urbanDeal.shippingFeeText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.urbanDeal.shippingFee
              contains: ${shippingFee}
      - log: "Checkout Seller Shipping Fee Assertion Successful"

  - name: ca.test.functions.checkOut.paymentOptionsIosWithoutCvv
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.editPaymentButton
          then:
            - scroll:
                direction: down
                position: center
                untilIdentifier: ca.test.mappings.checkOutPage.editPaymentButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.payment.cardEndingNumber
            - identifier: ca.test.mappings.checkOutPage.editPaymentButton
        
  - name: ca.test.functions.checkout.validatingFulfillmentCard
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 60000
          present:
            - identifier: ca.test.mappings.checkOutPage.fulfillmentCard
      - if:
          condition: ${fulfillmentType} == 'In-store pickup' || ${fulfillmentType} ==  'Cueillette en magasin' || ${fulfillmentType} ==  'Express Pickup'
          then:
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOut.fulfillmentTitle
                  - identifier: ca.test.mappings.checkOut.scheduledOrderFulfillmentTime
                  - identifier: ca.test.mappings.checkOut.pickupStoreName
                  - identifier: ca.test.mappings.checkOut.pickUpStoreAddress
                  - identifier: ca.test.mappings.checkOut.pickUpPersonText
                  - identifier: ca.test.mappings.checkOut.pickupPersonName
                  - identifier: ca.test.mappings.checkOut.pickUpNameEditButton
                  - identifier: ca.test.mappings.checkOut.inStorePickup.itemsDetails
                  - identifier: ca.test.mappings.checkOut.inStorePickup.orderItemCount
                  - identifier: ca.test.mappings.checkOut.inStorePickup.orderItemDetailsButton
                  - identifier: ca.test.mappings.checkOut.inStorePickup.substituteImage
                  - identifier: ca.test.mappings.checkOut.inStorePickup.substituteText
      - if:
          condition: ${fulfillmentType} == 'Shipping' || ${fulfillmentType} == 'Expédition' 
          then:
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.checkOut.shippingOrderItemReview
                then:
                  - scroll:
                      direction: down
                      untilIdentifier: ca.test.mappings.checkOut.orderItemDetailsButton #ca.test.mappings.checkOut.shippmentArrivesBy
                      timeout: 3000
                      scrollLimit: 2
                      # position: center
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOut.fulfillmentTitle
                  - identifier: ca.test.mappings.checkOut.shippingItemDetails
                  - identifier: ca.test.mappings.checkOut.shippingCustomerName
                  - identifier: ca.test.mappings.checkOut.shippingCustomerAddress
                  - identifier: ca.test.mappings.checkOut.shippmentArrivesBy
                  - identifier: ca.test.mappings.checkOut.shppingItemOuantity
                  - identifier: ca.test.mappings.checkOut.orderItemDetailsButton
                  - identifier: ca.test.mappings.checkOut.shippingOrderItemReview
      - if:
          condition: ${fulfillmentType} == 'Delivery from store' || ${fulfillmentType} == 'Livraison depuis un magasin'
          then:
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOut.fulfillmentTitle
                  - identifier: ca.test.mappings.checkOut.scheduledOrderFulfillmentTime
                  - identifier: ca.test.mappings.checkOut.shippingCustomerName
                  - identifier: ca.test.mappings.checkOut.shippingCustomerAddress
                  - identifier: ca.test.mappings.checkOut.deliveryNoteText
                  - identifier: ca.test.mappings.checkOut.deliveryInstructionText
                  - identifier: ca.test.mappings.checkOut.deliveryFromStore.leaveAtDoorButton
                  - identifier: ca.test.mappings.checkOut.deliveryFromStore.meetAtDoorButton
                  - identifier: ca.test.mappings.checkOut.deliveryFromStore.itemsDetails
                  - identifier: ca.test.mappings.checkOut.deliveryFromStore.orderItemCount
                  - identifier: ca.test.mappings.checkOut.deliveryFromStore.itemViewButton
                  - identifier: ca.test.mappings.checkOut.deliveryFromStore.substituteImage
                  - identifier: ca.test.mappings.checkOut.deliveryFromStore.substituteText
      - if:
          condition: ${fulfillmentType} == 'Pickup' || ${fulfillmentType} == 'Cueillette'
          then:
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.checkOut.shippingOrderItemReview
                then:
                  - scroll:
                      direction: down
                      untilIdentifier: ca.test.mappings.checkOut.orderItemDetailsButton
                      scrollLimit: 1
                      position: center
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOut.fulfillmentTitle
                  - identifier: ca.test.mappings.checkOut.scheduledOrderFulfillmentTime
                  - identifier: ca.test.mappings.checkOut.pickupStoreName
                  - identifier: ca.test.mappings.checkOut.pickUpStoreAddress
                  - identifier: ca.test.mappings.checkOut.shppingItemOuantity
                  - identifier: ca.test.mappings.checkOut.orderItemDetailsButton
                  - identifier: ca.test.mappings.checkOut.shippingOrderItemReview
                  - identifier: ca.test.mappings.checkOut.itemsDetails
  
  - name: ca.test.functions.checkOut.walmartMinShippingFee
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.belowMinFeeText
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOut.belowMinFeeValue
              contains: ${walmartMinFee}

  - name: ca.test.functions.checkOut.HandlingFee
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.walmartShippingText
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.walmartShippingValue
              contains: ${handlingFee}

  - name: ca.test.functions.checkOut.editPayment
    platform: android
    flow:
      - sleep:
          duration: 5000
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.changePaymentButton
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.changePaymentButton
                position: center
      - click:
          identifier: ca.test.mappings.checkOutPage.changePaymentButton
      - verifyIdentifier:
          timeout: 10000
          notPresent:
            - identifier: ca.test.mappings.AddNewPaymentMethod

  - name: ca.test.functions.checkOut.addNewPayment
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.addNewPaymentButton
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.addNewPaymentButton
                position: center
      - click:
          identifier: ca.test.mappings.checkOutPage.addNewPaymentButton
      - verifyIdentifier:
          timeout: 10000
          notPresent:
            - identifier: ca.test.mappings.checkOutPage.addNewPaymentButton

  - name: ca.test.functions.checkOut.promoCodeAvailabilityCheck
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.promoCode
          then:
            - log:
                message: Promo Code can be redeemed
                color: GREEN_BOLD

  - name: ca.test.functions.checkOut.editPayment
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.addPaymentMethod
          then:
            - click:
                identifier: ca.test.mappings.checkout.addPaymentMethod
          else:
            - scroll:
                direction: down
                untilIdentifier: cca.test.mappings.checkout.addPaymentMethod
                position: center 
                scrollLimit: 1
                timeout: 10000
            - if: 
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkout.addPaymentMethod
                then:
                  - click:
                      identifier: ca.test.mappings.checkout.addPaymentMethod
                else:
                  - scroll:
                      direction: up
                      untilIdentifier: ca.test.mappings.checkOutPage.editPaymentButton
                      position: center 
                      scrollLimit: 1
                      timeout: 10000
                  - click:
                      identifier: ca.test.mappings.checkOutPage.editPaymentButton
                  - sleep:
                      duration: 10000 
      - executeFunction:
         name: ca.test.functions.checkout.unableToLoadWallet

  - name: ca.test.functions.checkOut.paymentOptions.clickOnEditPayment
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkout.paymentOptions.title
            timeout: 7000
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkout.paymentOptions.title
                position: center
                scrollLimit: 2
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.paymentOptions.editPayment
          then:
            - click:
                identifier: ca.test.mappings.checkout.paymentOptions.editPayment
            - verifyIdentifier:
                timeout: 10000
                present:
                  - identifier: ca.test.mappings.checkout.paymentOptions.editPayment
          else:
            - click:
                identifier: ca.test.mappings.checkout.paymentMethod.addPaymentMethod
            - verifyIdentifier:
                timeout: 10000
                present:
                  - identifier: ca.test.mappings.checkout.paymentMethod.editPayment.walletTitle

  - name: ca.test.functions.checkOut.paymentOptions.removeExistingCard
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.paymentMethod.editPayment.creditCardTitle
              - identifier: ca.test.mappings.checkout.paymentMethod.editPayment.creditCardContainer
              - identifier: ca.test.mappings.walletPage.title
              - identifier: ca.test.mappings.checkout.paymentMethod.editPayment.estimateTotal
          then:
            - click:
                identifier: ca.test.mappings.global.editButton
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkout.paymentethod.editPayment.editCardButton
            - click:
                identifier: ca.test.mappings.checkout.editPayment.editCardButton.deleteButton
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkout.editPayment.editCardButton.delete.removeCardTitle
                  - identifier: ca.test.mappings.checkout.editPayment.editCardButton.delete.removeCard.confirmationText
            - click:
                identifier: ca.test.mappings.checkout.editPayment.editCardButton.delete.removeCard.primaryButton
            - sleep:
                duration: 5000
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkout.editPayment.cardRemoveSuccessMessage

  - name: ca.test.functions.checkOut.addNewPayment
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.addNewPayment
          then:
            - click:
                identifier: ca.test.mappings.checkOut.addNewPayment
            - sleep:
                duration: 6000

  - name: ca.test.functions.checkOut.closePaymentOption
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.paymentOptionClose
          then:
            - click:
                identifier: ca.test.mappings.checkOut.paymentOptionClose
            - sleep:
                duration: 3000

  - name: ca.test.functions.checkoutPage.otherFee
    platform: android
    flow:
#      - if:
#          condition: ${slotPrice} == 'null' || ${slotPrice} == '$0' || ${slotPrice} == 0
#          then:
#            - storeIn:
#                key: slotPrice
#                value: FREE
#      - if:
#          condition: ${slotPrice} == '0 $'
#          then:
#            - storeIn:
#                key: slotPrice
#                value: GRATUIT
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkoutPage.otherFeeText
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkoutPage.otherFeeValue
              contains: ${additionalFee}

  - name: ca.test.functions.checkOut.orderConfirmation.continueShoppingButton
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.orderConformation.continueShoppingButton
      - click:
          identifier: ca.test.mappings.orderConformation.continueShoppingButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.home.searchBarSelected
            - identifier: ca.test.mappings.home.seeTimes

  - name: ca.test.functions.orderConfirmation.continueShopping
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.orderConfirmation.continueShipping
          then:
            - click:
                identifier: ca.test.mappings.orderConfirmation.continueShipping
            - sleep:
                duration: 10000

  - name: ca.test.functions.orderConfirmation.orderIdExtraction
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.orderConfirmation.orderNumber
          then:
            - getString:
                identifier: ca.test.mappings.orderConfirmation.orderNumber
                attribute: label
                storeIn: orderId
            - arithmetic:
                expression: ${orderId}
                storeIn: orderNumber

  - name: ca.test.functions.checkOut.promoCodeRedeem
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.promoCodeField
          then:
            - click:
                identifier: ca.test.mappings.checkOut.promoCodeField
            - click:
                identifier: ca.test.mappings.checkOut.promoCodeTextField
            - enterText:
                identifier: ca.test.mappings.checkOut.promoCodeTextField
                string: ${PromoCode}
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mapping.checkout.keyboard
                then:
                  - click:
                      identifier: ca.test.mapping.checkout.keyboard
            - hideKeyboard: true
      - click:
          identifier: ca.test.mappings.checkOut.PromoCodeApply
      - sleep:
          duration: 10000    
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.errorBoxTitle
          then:
            - click:
                identifier: ca.test.mappings.acceptAlertBox    
      - executeFunction:
          name: ca.test.functions.checkOut.promoCodeRedeemStatus

  - name: ca.test.functions.checkOut.redeemPromoCode
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.promoCodeField
          then:
            - log:  
                message: "Clicking down arrow to expand promo code field."
                color: GREEN_BOLD
            - click:
                identifier: ca.test.mappings.checkOut.promoCodeField
            - click:
                identifier: ca.test.mappings.checkOut.promoCodeTextField
            - log:  
                message: "Entering promo code."
                color: GREEN_BOLD
            - enterText:
                identifier: ca.test.mappings.checkOut.promoCodeTextField
                string: ${PromoCode}
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mapping.checkout.keyboard
                then:
                  - click:
                      identifier: ca.test.mapping.checkout.keyboard
            - hideKeyboard: true
      - log:  
          message: "Clicking on promo code apply button"
          color: GREEN_BOLD
      - click:
          identifier: ca.test.mappings.checkOut.PromoCodeApply
      - sleep:
          duration: 10000    
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.errorBoxTitle
          then:
            - click:
                identifier: ca.test.mappings.acceptAlertBox    
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOut.promoCodeRedeemStatus
              contains: ${promoCodeText}

  - name: ca.test.functions.checkOut.promoCodeRedeemStatus
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.promoCodeRedeemStatus
          then:
            - getString:
                identifier: ca.test.mappings.checkOut.promoCodeRedeemStatus
                attribute: label
                storeIn: promoStatus
            - log:
                message: $promoStatus
                color: GREEN_BOLD
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.promoCodeRedeemStatusNegative
          then:
            - getString:
                identifier: ca.test.mappings.checkOut.promoCodeRedeemStatusNegative
                attribute: label
                storeIn: promoStatus
            - log:
                message: $promoStatus
                color: RED_BOLD


  # Shipping fee assertion
  - name: ca.test.functions.checkOut.promoDiscount
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.promoCodeDiscount
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.promoCodeDiscount
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.promoCodeDiscount
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.promoCodeDiscountTxt
          then:
            - getString:
                identifier: ca.test.mappings.checkOutPage.promoCodeDiscountTxt
                attribute: label
                storeIn: promoApplied
            - log:
                message: $promoApplied discount applied
                color: GREEN_BOLD

  # Shipping fee assertion
  - name: ca.test.functions.checkout.moneyBox.promoCodeDiscount
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: //XCUIElementTypeStaticText[contains(@label,"${promoCodeText},")]
          then:
            - scroll:
                direction: down
                untilIdentifier: //XCUIElementTypeStaticText[contains(@label,"${promoCodeText},")]
      - verifyIdentifier:
          present:
            - identifier: //XCUIElementTypeStaticText[contains(@label,"${promoCodeText},")]
      - verifyIdentifier:
          label:
            - identifier: //XCUIElementTypeStaticText[contains(@label,"${promoCodeText},")]/following-sibling::XCUIElementTypeStaticText
              contains: ${promoCodeValue}

  - name: ca.test.functions.checkOut.backToCart
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.promoCodeRedeemStatusNegative
          then:
            - click:
                identifier: ca.test.mappings.checkOut.promoCodeRedeemStatusNegative
            - click:
                identifier: ca.test.mappings.checkOutPage.leaveAnyway
            - sleep:
                duration: 8000

  # validate CRF fees in checkout
  - name: ca.test.functions.orderConfirmation.orderPriceValidation
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.orderConfirmation.orderPrice
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.orderConfirmation.orderPrice
              contains: ${orderPrice} 
      - log:
          message: Order Price is validated
          color: GREEN_BOLD

  # Continue Shopping
  - name: ca.test.functions.checkOut.continueShopping
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.orderConfirmation.continueShopping
      - click:
          identifier: ca.test.mappings.orderConfirmation.continueShopping
      - sleep: 
          duration: 5000      

  - name: ca.test.functions.checkOut.applyPromoCode
    platform: android
    flow:
      - click:
          identifier: ca.test.mappings.global.indicatorIcon
      - loop:
          begin: 1
          end: 4
          mode: increment
          flow:
            - try:
                flow:
                  - verifyIdentifier:
                      present:
                        - identifier: ca.test.mappings.checkOutPage.promoCodeTitle
                  - enterText:
                      identifier: ca.test.mappings.checkOutPage.promoCodeField
                      string: ${promoCode}
                      clickFirst: true
                      clearField: true
                  - click:
                      identifier: ca.test.mappings.checkOutPage.promoCodeApplyButton
                  - hideKeyboard: true    
                  - try:
                      flow:
                        - verifyIdentifier:
                            timeout: 10000
                            present:
                              - identifier: ca.test.mappings.checkOutPage.promoCode.promoAppliedText
                      catch:
                        flow:
                          - hideKeyboard: true
                          - scroll:
                              direction: down
                              untilIdentifier: ca.test.mappings.checkOutPage.promoCode.promoAppliedText
                  - verifyIdentifier:
                      timeout: 120000
                      present:
                        - identifier: ca.test.mappings.checkOutPage.removePromoCodebutton
                  - hideKeyboard: true
                  - verifyIdentifier:
                      text:
                        - identifier: ca.test.mappings.checkOutPage.promoCode.promoAppliedText
                          contains: ${promoCodeText}
                  - break: true
                catch:
                  flow:
                    - if:
                        identifier:
                          notPresent:
                            - identifier: ca.test.mappings.checkOutPage.promoCodeField
                        then:
                          - click:
                              identifier: ca.test.mappings.global.indicatorIcon

  - name: ca.test.functions.checkOut.removePromoCode
    platform: android
    flow:
      - click:
          identifier: ca.test.mappings.checkOutPage.removePromoCodebutton
      - verifyIdentifier:
          timeout: 30000
          present:
            - identifier: ca.test.mappings.checkOutPage.promoCodeApplyButton

  - name: ca.test.functions.checkOut.subTotal.promoCodeValidation
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.promoCodeAppliedText
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.promoCodeAppliedValue
              contains: ${promoCodeValue}
           
  # Scroll to avoid technical issue    
  - name: ca.test.functions.purchaseHistory.navigationBack
    platform: ios
    flow:
      - click:
          identifier: ca.test.mappings.navigationBack
      - click:
          identifier: ca.test.mappings.dontSave

  - name: ca.test.functions.checkOut.assertPhoneNumberIsDisplayed
    platform: ios
    flow:
      - getString:
          identifier: ca.test.mapping.checkOut.phoneTextField
          attribute: value
          storeIn: currentDisplayedPhoneNumber
      - log: 
          message: "Current displayed Phone Number: ${currentDisplayedPhoneNumber}"
          color: GREEN_BOLD
  
  # Order Confirmation screen validation
  - name: ca.test.functions.checkOut.orderConfirmationValidationIos1
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.orderConfirmation.tickImage
            - identifier: ca.test.mappings.orderConfirmation.thanks
            - identifier: ca.test.mappings.orderConfirmation.emailId
            - identifier: ca.test.mappings.orderConfirmation.orderNumber
            - identifier: ca.test.mappings.orderConfirmation.orderAmount
            - identifier: ca.test.mappings.orderConfirmation.fulfillmentType
            - identifier: ca.test.mappings.orderConfirmation.fulfillmentAddress
            - identifier: ca.test.mappings.orderConfirmation.arrivalDate
            - identifier: ca.test.mappings.orderConfirmation.continueShopping
            - identifier: ca.test.mappings.orderConfirmation.emailId
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.estimatedTotalValue    
              contains: ${estimate_total}
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.orderConfirmation.address
              contains: ${addressFirstLine}  
  
  # Order Confirmation screen validation
  - name: ca.test.functions.checkOut.orderConfirmationValidation
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.orderConfirmation.tickImage
            - identifier: ca.test.mappings.orderConfirmation.thanks
            - identifier: ca.test.mappings.orderConfirmation.emailId
            - identifier: ca.test.mappings.orderConfirmation.orderNumber
            - identifier: ca.test.mappings.orderConfirmation.orderAmount
            - identifier: ca.test.mappings.orderConfirmation.fulfillmentType
            - identifier: ca.test.mappings.orderConfirmation.fulfillmentAddress
            - identifier: ca.test.mappings.orderConfirmation.arrivalDate
            - identifier: ca.test.mappings.orderConfirmation.userName
            - identifier: ca.test.mappings.orderConfirmation.productTitleContainer
            - identifier: ca.test.mappings.orderConfirmation.continueShopping
            - identifier: ca.test.mappings.orderConfirmation.emailId
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.orderConfirmation.orderAmount   
              contains: ${estimate_total}
            - identifier: ca.test.mappings.orderConfirmation.emailId
              contains: ${emailId}
            - identifier: ca.test.mappings.orderConfirmation.address
              contains: ${addressFirstLine}

  - name: ca.test.functions.checkOut.editPayment.choosePaypal
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.mappings.walletPage.title
            - identifier: ca.test.mappings.AddNewPaymentMethod
      - sleep:
          duration: 5000
      - click:
          identifier: ca.test.mappings.AddNewPaymentMethod
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier: ca.test.mappings.addPaymentOptions.title
            - identifier: ca.test.mappings.addPaymentOptions.paypal
      - click:
          identifier: ca.test.mappings.addPaymentOptions.paypal
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalLogo
            - identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalText
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.editPayment.paypal.acceptPaypalCookies
          then:
            - click:
                identifier: ca.test.mappings.checkOut.editPayment.paypal.acceptAllCookies
      - enterText:
          identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalEmailBox
          string: ${userName}
      - click:
          identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalNextbutton
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalPasswordTag
            - identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalPassword
      - enterText:
          identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalPassword
          string: ${password}
      - click:
          identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalLogInButton
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalPageCart
      # - click:
      #     identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalSelectCard
      - click:
          identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalPaymentSubmit
      - sleep:
          duration: 5000
      - executeFunction:
          name: ca.test.functions.escape-route.handleUnableToLoadWalletPopup
      - verifyIdentifier:
          timeout: 15000
          notPresent:
            - identifier: ca.test.mappings.checkOut.editPayment.paypal.walletSuccessMessage
            - identifier: ca.test.mappings.walletPage.title
      - log:
          message: ---------------------------Payment Option PayPal Selected Successful---------------------------
          color: GREEN_BOLD
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.validation.signInFromAccount.wallet
            - identifier: ca.test.mappings.checkOut.paymentCardLogo
            - identifier: ca.test.mappings.checkOut.paymentCardPaypalAccount
            - identifier: ca.test.mappings.checkOutPage.payment.totalCartValue
            - identifier: ca.test.mappings.checkOutPage.changePaymentButton
      - log:
          message: ----------------------------CheckOut Page Payment Card Validation Successsful----------------------------
          color: GREEN_BOLD

  - name: ca.test.functions.checkOut.paypalExistingUserExperience
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.validation.signInFromAccount.wallet
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.validation.signInFromAccount.wallet
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mapppings.checkOut.paypalUserName
          then:
            - executeFunction:
                name: ca.test.functions.checkOut.editPayment
            - executeFunction:
                name: ca.test.functions.checkOut.editPayment.choosePaypal
          else:
            - log:
                message: "---------------------Paypal Selected Successful---------------------"
                color: GREEN_BOLD
  
  - name: ca.test.functions.accountPage.removePromoCode
    platform: android
    flow:
      - sleep:
          duration: 10000
      - if:
          identifier:
            timeout: 20000
            notPresent:
              - identifier: ca.test.mappings.orderConfirmation.orderNumber
          then:
            - executeFunction:
                name: ca.test.functions.global.openApp
            - executeFunction:
                name: ca.test.functions.global.navigation.goToCart
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mapping.cart.proceedToCheckOutButton
                then:
                  - executeFunction:
                      name: ca.test.functions.cart.proceedToCheckOut
                  - sleep:
                      duration: 15000
                  - scroll:
                      direction: down
                      untilIdentifier: ca.walmart.ecommerceapp.qa:id/checkout_pos_module
                      position: center
                  - if:
                      identifier:
                        present:
                          - identifier: ca.walmart.ecommerceapp.qa:id/promo_code_applied_view
                      then:
                        - click:
                            identifier: ca.walmart.ecommerceapp.qa:id/promo_remove_button
                        - sleep:
                            duration: 10000

  - name: ca.test.functions.checkOut.ONEnvHandlingFee
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.ONEnvText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOut.ONEnvValue
              contains: ${ON_Env}
      - log: "ChckOut Page ON Env Handling Fee Assertion Sucessful" 

  - name: ca.test.functions.checkOut.orderConfirmationValidationMxOrder
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.mappings.orderConfirmation.fulfillmentCardTitle
      - if:
          condition: ${fulfillmentType} == 'In-store pickup'
          then:
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.orderConfirmation.productDetails
                then: 
                  - scroll:
                      direction: down
                      untilIdentifier: ca.test.mappings.orderConfirmation.productDetails
                      position: center
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.orderConfirmation.scheduledOrderFulfillmentTime
                  - identifier: ca.test.mappings.orderConfirmation.storeName
                  - identifier: ca.test.mappings.orderConfirmation.storeAddress
                  - identifier: ca.test.mappings.orderConfirmation.itemCount
                  - identifier: ca.test.mappings.orderConfirmation.productDetails
      - if:
          condition: ${fulfillmentType} == 'Shipping'
          then:
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.orderConfirmation.productDetails
                then:
                  - scroll:
                      direction: down
                      untilIdentifier: ca.test.mappings.orderConfirmation.productDetails
                      position: center
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.orderConfirmation.scheduledOrderFulfillmentTime
                  - identifier: ca.test.mappings.orderConfirmation.storeName
                  - identifier: ca.test.mappings.orderConfirmation.storeAddress
                  - identifier: ca.test.mappings.orderConfirmation.productDetails
                  - identifier: ca.test.mappings.orderConfirmation.arrivalTime
                  - identifier: ca.test.mappings.orderConfirmation.shippingItemCount

# Add card Giftcard
  - name: ca.test.functions.checkOut.payment.addGiftcardios
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.editPaymentButton
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.editPaymentButton
                position: center
      - click:
          identifier: ca.test.mappings.checkOutPage.editPaymentButton
      - sleep:
          duration: 10000  
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.addPaymentButton
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.addPaymentButton
                position: center
      - click:
          identifier: ca.test.mappings.checkOutPage.addPaymentButton             
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.giftCardButton
          then:
            - click: 
                identifier: ca.test.mappings.checkOutPage.giftCardButton                
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.giftCard.cardNumber
              - identifier: ca.test.mappings.checkOutPage.giftCard.cardPin
          then:    
            - enterText:
                identifier: ca.test.mappings.checkOutPage.giftCard.cardNumber
                string: ${cardNumber}       
            - enterText:
                identifier: ca.test.mappings.checkOutPage.giftCard.cardPin
                string: ${cardPin}
      - click: 
          identifier: ca.test.mapping.checkout.keyboard
      - click:
          identifier: ca.test.mappings.checkOut.giftCard.saveCard

  - name: ca.test.functions.checkOut.paypalExistingUserExperience
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.validation.signInFromAccount.wallet
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.validation.signInFromAccount.wallet
      - executeFunction:
          name: ca.test.functions.checkOut.editPayment
      - if:
          identifier:
            present:
              - identifier: ca.test.mapppings.checkOut.paypalUserName
          then:
            - executeFunction:
                name: ca.test.functions.checkOut.editPaymentAndContinue
      - executeFunction:
          name: ca.test.functions.checkOut.editPayment.choosePaypal
      - log:
          message: "---------------------Paypal Selected Successful---------------------"
          color: GREEN_BOLD
                
  - name: ca.test.functions.checkOut.editPayment.choosePaypal
    platform: ios
    flow:
      - sleep:
          duration: 10000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.walletPage.title
            - identifier: ca.test.mappings.AddNewPaymentMethod
      - sleep:
          duration: 5000
      - click:
          identifier: ca.test.mappings.AddNewPaymentMethod
      - sleep:
          duration: 5000    
      - verifyIdentifier:
          present:   
            - identifier: ca.test.mappings.addPaymentOptions.title
            - identifier: ca.test.mappings.addPaymentOptions.paypal
      - click:
          identifier: ca.test.mappings.addPaymentOptions.paypal
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.confirmBtn
          then:
            - click:
                identifier: ca.test.mappings.checkOut.confirmBtn 
      - sleep:
          duration: 5000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalLogo
            - identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalText
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.editPayment.paypal.acceptPaypalCookies
          then:
            - click:
                identifier: ca.test.mappings.checkOut.editPayment.paypal.acceptAllCookies
      - enterText:
          identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalEmailBox
          string: ${userName}
      - if:
          identifier:
            present:
              - identifier: ca.test.mapping.checkout.keyboard
          then:
            - click: 
                identifier: ca.test.mapping.checkout.keyboard
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalNextbutton
          then:
            - click: 
                identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalNextbutton
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalPasswordTag
            - identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalPassword
      - enterText:
          identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalPassword
          string: ${payPalPassword}
      - if:
          identifier:
            present:
              - identifier: ca.test.mapping.checkout.keyboard 
          then:
            - click: 
                identifier: ca.test.mapping.checkout.keyboard  
      - click:
          identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalLogInButton
      - sleep:
          duration: 5000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalPageCart
      - click:
          identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalSelectCard
      - click:
          identifier: ca.test.mappings.checkOut.editPayment.paypal.paypalPaymentSubmit
      - sleep:
          duration: 10000
      - verifyIdentifier:
          timeout: 15000
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.paypal.walletSuccessMessage
            - identifier: ca.test.mappings.walletPage.title
      - sleep:
          duration: 10000
      - click:
          identifier: ca.test.mappings.global.continueButton
      - log:
          message: ---------------------------Payment Option PayPal Selected Successful---------------------------
          color: GREEN_BOLD
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.validation.signInFromAccount.wallet
            - identifier: ca.test.mappings.checkOut.paymentCardLogo
            - identifier: ca.test.mappings.checkOut.paymentCardPaypalAccount
            - identifier: ca.test.mappings.checkOutPage.payment.totalCartValue
            - identifier: ca.test.mappings.checkOutPage.changePaymentButton
      - log:
          message: ----------------------------CheckOut Page Payment Card Validation Successsful----------------------------
          color: GREEN_BOLD

  - name: ca.test.functions.checkOut.paymentOptions.editPayments.removeGiftCard
    platform: ios
    flow:
      - sleep:
          duration: 15000
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.paymentOptions.editPayment.giftCardContainer
          then:
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkout.paymentOptions.editPayment.giftCardCount
                then:
                  - getString:
                      identifier: ca.test.mappings.checkout.paymentOptions.editPayment.giftCardCount
                      attribute: value
                      storeIn: cardCarousel
                  - executeNode:
                      file: ca/test/helpers/CheckOut/GiftCardCount.js
                      args:
                        - value: ${cardCarousel}
                      getResponse:
                        storeIn: cardCount
                else:
                  - storeIn:
                      key: cardCount
                      value: 1
            - log: 
                message: "${cardCount}"
                color: GREEN_BOLD
            - loop:
                begin: 0
                end: ${cardCount}
                storeIndex: j
                mode: increment
                flow:
                  - if:
                      identifier:
                        present:
                          - identifier: ca.test.mappings.checkout.paymentOptions.editPayment.giftCard.deleteButton
                      then:
                        - click:
                            identifier: ca.test.mappings.checkout.paymentOptions.editPayment.giftCard.deleteButton
                      else:
                        - failTest:
                            message: "Gift card delete button not found"
                  - verifyIdentifier:
                      timeout: 10000
                      present:
                        - identifier: ca.test.mappings.checkout.paymentOptions.editPayment.giftCard.removePopUp
                  - click:
                      identifier: ca.test.mappings.checkout.paymentOptions.editPayment.giftCard.removePopUp.confirmButton
                  - sleep:
                      duration: 10000
          else:
            - log:
                message: "No gift card to remove"
                color: GREEN_BOLD

# Add card single Giftcard
  - name: ca.test.functions.checkOut.payment.addSingleGC
    platform: ios
    flow:
    # Add GC
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.addPaymentMethod
          then:
            - click:
                identifier: ca.test.mappings.checkOutPage.addPaymentMethod
          else:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.addPaymentMethod
                position: center
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkOutPage.addPaymentMethod
                then:
                    - click:
                        identifier: ca.test.mappings.checkOutPage.addPaymentMethod
                else:
                - scroll:
                    direction: up
                    untilIdentifier: ca.test.mappings.checkOutPage.editPaymentButton
                - click:
                    identifier: ca.test.mappings.checkOutPage.editPaymentButton
      - sleep:
          duration: 5000
      # delete card
      - if: 
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.GC
          then:
            - click:
                identifier: ca.test.mappings.checkout.GC
            - verifyIdentifier:
                present:
                  - identifier:  ca.test.mappings.checkout.delete
            - click:
                identifier:  ca.test.mappings.checkout.delete
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOut.confirmBtn
            - click:
                identifier: ca.test.mappings.checkOut.confirmBtn
            - sleep:
                duration: 1000
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.giftCardButton
          then:
            - click: 
                identifier: ca.test.mappings.checkOutPage.giftCardButton   
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.whereIsPinText
            - identifier: ca.test.mappings.checkOut.don'tHavePin                 
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.giftCard.cardNumber
              - identifier: ca.test.mappings.checkOutPage.giftCard.cardPin
          then:    
            - enterText:
                identifier: ca.test.mappings.checkOutPage.giftCard.cardNumber
                string: ${cardNumber}       
            - enterText:
                identifier: ca.test.mappings.checkOutPage.giftCard.cardPin
                string: ${cardPin}
      - click: 
          identifier: ca.test.mapping.checkout.keyboard
      - click:
          identifier: ca.test.mappings.checkOut.giftCard.saveCard
      - sleep:
          duration: 1000
      # - click:
      #     identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton

#Add next GC
  - name: ca.test.functions.checkOut.payment.nextGC
    platform: ios
    flow:
    # Add GC
      # - if:
      #     identifier:
      #       notPresent:
      #         - identifier: ca.test.mappings.checkOutPage.changePaymentButton
      #     then:
      #       - scroll:
      #           direction: down
      #           untilIdentifier: ca.test.mappings.checkOutPage.changePaymentButton
      #           position: center
      # - click:
      #     identifier: ca.test.mappings.checkOutPage.changePaymentButton
      # - sleep:
      #     duration: 5000  
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.addNewPaymentButton #ca.test.mappings.checkOutPage.addPaymentMethod
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.addNewPaymentButton #ca.test.mappings.checkOutPage.addPaymentMethod
                position: center
      - click:
          identifier: ca.test.mappings.checkOutPage.addNewPaymentButton #ca.test.mappings.checkOutPage.addPaymentMethod
      - sleep:
          duration: 5000  
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.giftCardButton
          then:
            - click: 
                identifier: ca.test.mappings.checkOutPage.giftCardButton   
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.whereIsPinText
            - identifier: ca.test.mappings.checkOut.don'tHavePin                 
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.giftCard.cardNumber
              - identifier: ca.test.mappings.checkOutPage.giftCard.cardPin
          then:    
            - enterText:
                identifier: ca.test.mappings.checkOutPage.giftCard.cardNumber
                string: ${cardNumber}       
            - enterText:
                identifier: ca.test.mappings.checkOutPage.giftCard.cardPin
                string: ${cardPin}
      - click: 
          identifier: ca.test.mapping.checkout.keyboard
      - click:
          identifier: ca.test.mappings.checkOut.giftCard.saveCard
      - click:
          identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton

# Add card multiple Giftcard(addig 2 gc)
  - name: ca.test.functions.checkOut.payment.addMultipleGC
    platform: ios
    flow:
        - executeFunction:
            name: ca.test.functions.checkOut.payment.addSingleGC
        - sleep:
            duration: 5000
        - executeFunction:
            name: ca.test.functions.checkOut.payment.nextGC

# Add card multiple Giftcard(addig 4 gc)
  - name: ca.test.functions.checkOut.payment.addFourGC
    platform: ios
    flow:
        - executeFunction:
            name: ca.test.functions.checkOut.payment.addSingleGC
        - sleep:
            duration: 5000
        - executeFunction:
            name: ca.test.functions.checkOut.payment.nextGC
        - sleep:
            duration: 5000
        - executeFunction:
            name: ca.test.functions.checkOut.payment.nextGC
        - sleep:
            duration: 5000
        - executeFunction:
            name: ca.test.functions.checkOut.payment.nextGC
        - if:
            identifier:
              notPresent:
                - identifier: ca.test.mappings.checkOutPage.addNewPaymentButton
            then:
              - scroll:
                  direction: down
                  untilIdentifier: ca.test.mappings.checkOutPage.addNewPaymentButton
                  position: center
        - click:
            identifier: ca.test.mappings.checkOutPage.addNewPaymentButton    
        - sleep:
            duration: 5000  
        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.giftCardButton  
              - identifier:  ca.test.mappings.payment.GCmaxQtyText
        - goBack: true
        - click:
            identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton
        # - goBack: true            

  - name: ca.test.functions.checkOut.payment.addGC_CC
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.editPaymentButton
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.editPaymentButton
                position: center
      - click:
          identifier: ca.test.mappings.checkOutPage.editPaymentButton
      - sleep:
          duration: 5000  
      # delete card
      - if: 
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.GC
          then:
            - verifyIdentifier:
                present:
                  - identifier:  ca.test.mappings.checkout.delete
            - click:
                identifier:  ca.test.mappings.checkout.delete
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOut.confirmBtn
            - click:
                identifier: ca.test.mappings.checkOut.confirmBtn
            - sleep:
                duration: 500
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.addNewPaymentButton
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.addNewPaymentButton
                position: center
      - click:
          identifier: ca.test.mappings.checkOutPage.addNewPaymentButton    
      - sleep:
          duration: 5000  
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.giftCardButton
          then:
            - click: 
                identifier: ca.test.mappings.checkOutPage.giftCardButton   
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.whereIsPinText
            - identifier: ca.test.mappings.checkOut.don'tHavePin                 
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.giftCard.cardNumber
              - identifier: ca.test.mappings.checkOutPage.giftCard.cardPin
          then:    
            - enterText:
                identifier: ca.test.mappings.checkOutPage.giftCard.cardNumber
                string: ${cardNumber}       
            - enterText:
                identifier: ca.test.mappings.checkOutPage.giftCard.cardPin
                string: ${cardPin}
      - click: 
          identifier: ca.test.mapping.checkout.keyboard
      - click:
          identifier: ca.test.mappings.checkOut.giftCard.saveCard
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.gc.cvvPin #ca.test.mappings.checkOutPage.giftCard.cardPin
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.gc.cvvPin #ca.test.mappings.checkOutPage.giftCard.cardPin
            - enterText:
                identifier: ca.test.mappings.checkOutPage.gc.cvvPin # ca.test.mappings.checkOutPage.giftCard.cardPin
                string: ca.test.data.CVV
            - click:
                identifier: ca.test.mappings.wallet.done
          else:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.gc.cvvPin #ca.test.mappings.checkOutPage.giftCard.cardPin
            - enterText:
                identifier: ca.test.mappings.checkOutPage.gc.cvvPin #ca.test.mappings.checkOutPage.giftCard.cardPin
                string: ca.test.data.CVV
            - click:
                identifier: ca.test.mappings.wallet.done
      - click:
          identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton

# CC +GC +RR
# CC is already added to the particular flow , RR is pending
  - name: ca.test.functions.checkOut.payment.addGC_CC_RR
    platform: ios
    flow:
      - executeFunction:
          name: ca.test.functions.checkOut.payment.addGC_CC
      #reward card

# GC+RR
# RR is pending
  - name: ca.test.functions.checkOut.payment.addGC_RR
    platform: ios
    flow:
    # Add GC
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.addPaymentMethod
          then:
            - click:
                identifier: ca.test.mappings.checkOutPage.addPaymentMethod
          else:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.AddNewPaymentMethodBtn
                position: center
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkOutPage.addPaymentMethod
                then:
                    - click:
                        identifier: ca.test.mappings.checkOutPage.addPaymentMethod
                else:
                - scroll:
                    direction: up
                    untilIdentifier: ca.test.mappings.checkOutPage.editPaymentButton
                - click:
                    identifier: ca.test.mappings.checkOutPage.editPaymentButton
      # - click:
      #     identifier:  ca.test.mappings.checkout.addPaymentMethod # ca.test.mappings.checkOutPage.addNewPaymentButton    
      # delete card
      - if: 
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.GC
          then:
            - verifyIdentifier:
                present:
                  - identifier:  ca.test.mappings.checkout.delete
            - click:
                identifier:  ca.test.mappings.checkout.delete
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOut.confirmBtn
            - click:
                identifier: ca.test.mappings.checkOut.confirmBtn
            - sleep:
                duration: 5000
      #........     
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.giftCardButton
          then:
            - click: 
                identifier: ca.test.mappings.checkOutPage.giftCardButton  
          else:
              - sleep:
                 duration: 1000
              - click: 
                  identifier: ca.test.mappings.checkOutPage.giftCardButton  
      - verifyIdentifier:
          present:
            # - identifier: ca.test.mappings.checkOutPage.giftCardButton
            - identifier: ca.test.mappings.checkOut.whereIsPinText
            - identifier: ca.test.mappings.checkOut.don'tHavePin                 
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.giftCard.cardNumber
              - identifier: ca.test.mappings.checkOutPage.giftCard.cardPin
          then:    
            - enterText:
                identifier: ca.test.mappings.checkOutPage.giftCard.cardNumber
                string: ${cardNumber}       
            - enterText:
                identifier: ca.test.mappings.checkOutPage.giftCard.cardPin
                string: ${cardPin}
      - click: 
          identifier: ca.test.mapping.checkout.keyboard
      - click:
          identifier: ca.test.mappings.checkOut.giftCard.saveCard
      - click:
          identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton
    # Add RR

# shipping  and EED Assertion
  - name: ca.test.functions.checkout.shippingEEDAssertion
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkout.shippingDateInfo
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkout.shippingDateInfo
              contains: ${checkOutProductEED}
      - log:
          message: Asserting delivery time in checkout for ${productName} and is expected by ${checkOutProductEED}.
          color: GREEN_BOLD

  - name: ca.test.functions.checkout.navigateToCart
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.reviewOrderText
      - click:
          identifier: ca.test.mappings.checkout.navigateBackToCart
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.yourAlmostTherePopUp
          then: 
            - click: 
                identifier: ca.test.mappings.checkout.leaveAnywayButton
      - verifyIdentifier:
          timeout: 15000
          present:
            - identifier: ca.test.mappings.cart.fulfillmentMethod
      - sleep:
          duration: 10000

  - name: ca.test.functions.checkout.assertingFulfillmentDate
    platform: ios
    flow:
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkout.product1fulfillment
              contains: ${product1fulfillment}
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkout.product2fulfillment
              contains: ${product2fulfillment}

# navigate from checkout to cart
  - name: ca.test.functions.checkout.navigateToCart
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.reviewOrderText
      - click:
          identifier: ca.test.mappings.checkout.navigateBackToCart
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.yourAlmostTherePopUp
          then: 
            - click: 
                identifier: ca.test.mappings.checkout.leaveAnywayButton
      - verifyIdentifier:
          timeout: 15000
          present:
            - identifier: ca.test.mappings.cart.fulfillmentMethod     

#unable to load wallet page
  - name: ca.test.functions.checkout.unableToLoadWallet
    platform: ios
    flow:
      - loop:
          begin: 0
          end: 3
          mode: increment
          flow:
            - if:
                identifier:
                  present:
                  - identifier: ca.test.mappings.checkOut.unableLoadWallet 
                then:
                  - click:
                      identifier: ca.test.mappings.checkOut.acceptUnableLoadWallet
                  - sleep:
                      duration: 5000
                  - click:
                      identifier: ca.test.mappings.checkOutPage.editPaymentButton 
                else:
                  - break: true

  - name: ca.test.functions.checkout.assertingFulfillmentDatePickUp
    platform: ios
    flow:
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkout.product1fulfillment1
              contains: ${product1fulfillment}
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkout.product2fulfillment2
              contains: ${product2fulfillment}

  - name: ca.test.functions.accountPage.removePromoCodeios
    platform: ios
    flow:
      - sleep:
          duration: 10000
      - if:
          identifier:
            timeout: 20000
            notPresent:
              - identifier: ca.test.mappings.orderConfirmation.orderNumber
          then:
            - executeFunction:
                name: ca.test.functions.utils.terminateApp
            - executeFunction:
                name: ca.test.functions.utils.relaunchApp
            - executeFunction:
                name: ca.test.functions.global.navigation.goToCartIos
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mapping.cart.proceedToCheckOutButton
                then:
                  - executeFunction:
                      name: ca.test.functions.cart.proceedToCheckOutIos
                  - sleep:
                      duration: 15000
                  - scroll:
                      direction: down
                      untilIdentifier: ca.test.mappings.reviewOrder.promocode.appliedText 
                      position: center
                  - if:
                      identifier:
                        present:
                          - identifier: ca.test.mappings.reviewOrder.promocode.appliedText 
                      then:
                        - click:
                            identifier: ca.test.mappings.reviewOrder.promocode.remove
                        - sleep:
                            duration: 10000  
                            

  - name: ca.test.functions.checkOut.editPayment.chooseGiftCard
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.mappings.walletPage.title
            - identifier: ca.test.mappings.AddNewPaymentMethod
      - sleep:
          duration: 5000
      - scroll:
          direction: down
      - click:
          identifier: ca.test.mappings.AddNewPaymentMethod
      - sleep:
          duration: 5000
      - verifyIdentifier:
          timeout: 10000
          present:
#            - identifier: ca.test.mappings.addpaymentOptions.smartWaysToPayText
            - identifier: ca.test.mappings.addPaymentOptions.giftCard
      - click:
          identifier: ca.test.mappings.addPaymentOptions.giftCard
      - sleep:
          duration: 5000
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.title
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.requiredFieldText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.cardNumberText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.cardPinText
      - enterText:
          identifier: ca.test.mappings.checkOut.editPayment.giftCard.numberField
          string: ${cardNumber}
          clearField: true
          clickFirst: true
          pressEnter: true
      - enterText:
          identifier: ca.test.mappings.checkOut.editPayment.giftCard.pinField
          string: ${cardPin}
          clearField: true
          clickFirst: true
          pressEnter: true
      - goBack: true
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.whereIsPinText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.physicalGiftCardText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.findPinText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.image
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.saveButton
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.donotPinButton
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.findPinMailText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.eGiftCardText
      - click:
          identifier: ca.test.mappings.checkOut.editPayment.giftCard.saveButton
      - loop:
          begin: 0
          end: 3
          mode: increment
          flow:
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkOut.paymentMethod.addgiftCard.errorText
                then:
                  - click:
                      identifier: ca.test.mappings.checkOut.editPayment.giftCard.saveButton
            - sleep:
                duration: 10000
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.checkOut.paymentMethod.addgiftCard.errorText
                then:
                  - break: true
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.paymentMethod.addgiftCard.errorText
          then:
            - executeFunction:
                name: ca.test.functions.escape-route.handleGiftCardTechnicalIssue
            # - getString:
            #     identifier: ca.test.mappings.checkOut.paymentMethod.addgiftCard.errorText
            #     attribute: text
            #     storeIn: gcError
            # - log: $gcError
            # - failTest: true
          else:
            - verifyIdentifier:
                timeout: 30000
                present:
                  - identifier: ca.test.mappings.checkOut.editpayment.addGiftCardSuccessText
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.checkOut.cardCVV
                then:
                  - scroll:
                      direction: down
                      untilIdentifier: ca.test.mappings.checkOut.cardCVV
                      position: center
                  - enterText:
                      identifier: ca.test.mappings.checkOut.cardCVV
                      string: ${cvvNumber}
                  - click:
                      identifier: ca.test.mappings.checkOut.editpayment.continueButton
 
  - name: ca.test.functions.checkOut.editPayment.addNewGiftCard
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 10000
          present:
#            - identifier: ca.test.mappings.addpaymentOptions.smartWaysToPayText
            - identifier: ca.test.mappings.addPaymentOptions.giftCard
      - click:
          identifier: ca.test.mappings.addPaymentOptions.giftCard
      - sleep:
          duration: 5000
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.title
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.requiredFieldText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.cardNumberText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.cardPinText
      - enterText:
          identifier: ca.test.mappings.checkOut.editPayment.giftCard.numberField
          string: ${giftCardNumber}
          clearField: true
          clickFirst: true
          pressEnter: true
      - enterText:
          identifier: ca.test.mappings.checkOut.editPayment.giftCard.pinField
          string: ${giftCardPin}
          clearField: true
          clickFirst: true
          pressEnter: true
      - goBack: true
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.whereIsPinText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.physicalGiftCardText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.findPinText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.image
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.saveButton
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.donotPinButton
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.findPinMailText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.eGiftCardText
      - click:
          identifier: ca.test.mappings.checkOut.editPayment.giftCard.saveButton
      - loop:
          begin: 0
          end: 5
          mode: increment
          flow:
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkOut.paymentMethod.addgiftCard.errorText
                then:
                  - click:
                      identifier: ca.test.mappings.checkOut.editPayment.giftCard.saveButton
            - sleep:
                duration: 10000
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.checkOut.paymentMethod.addgiftCard.errorText
                then:
                  - break: true
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.paymentMethod.addgiftCard.errorText
          then:
            - executeFunction:
                name: ca.test.functions.escape-route.handleGiftCardTechnicalIssue
            - verifyIdentifier:
                timeout: 30000
                present:
                  - identifier: ca.test.mappings.checkOut.editpayment.addGiftCardSuccessText

  - name: ca.test.functions.checkOut.editPayment.addNewGiftCard
    platform: ios
    flow:
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.mappings.addPaymentOptions.giftCard
      - click:
          identifier: ca.test.mappings.addPaymentOptions.giftCard
      - sleep:
          duration: 5000
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.title
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.cardNumberText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.cardPinText
      - enterText:
          identifier: ca.test.mappings.checkOut.editPayment.giftCard.numberField
          string: ${giftCardNumber}
          clearField: true
          clickFirst: true
          pressEnter: true
      - enterText:
          identifier: ca.test.mappings.checkOut.editPayment.giftCard.pinField
          string: ${giftCardPin}
          clearField: true
          clickFirst: true
          pressEnter: true
      - click:
          identifier: ca.test.mappings.global.doneButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.pinDetails
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.pinRecoveryDetails
      - click:
          identifier: ca.test.mappings.checkOut.editPayment.giftCard.saveButton
      - loop:
          begin: 0
          end: 5
          mode: increment
          flow:
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkOut.paymentMethod.addgiftCard.errorText
                then:
                  - click:
                      identifier: ca.test.mappings.checkOut.editPayment.giftCard.saveButton
            - sleep:
                duration: 10000
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.checkOut.paymentMethod.addgiftCard.errorText
                then:
                  - break: true
      - verifyIdentifier:
          timeout: 30000
          present:
            - identifier: ca.test.mappings.checkOut.editpayment.addGiftCardSuccessText

  - name: ca.test.functions.checkOut.editPayment.validatingGCDisabled
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 10000
          present:
#            - identifier: ca.test.mappings.addpaymentOptions.smartWaysToPayText
            - identifier: ca.test.mappings.addPaymentOptions.giftCard
      - getString:
          identifier: ca.test.mappings.checkOutPage.giftCard
          attribute: enabled
          storeIn: boolean
      - log: 
          message: ${boolean}
          color: GREEN_BOLD
      - if:
          condition: ${boolean} == false
          then:
            - log:
                message: Gift card is disabled in wallet page for digital item.
                color: GREEN_BOLD
          else:
            - failTest:
                message: Gift card is enabled in wallet page for digital item.

  - name: ca.test.functions.checkout.placeorderwithoutmob
    platform: ios
    flow:
      - loop:
          begin: 0
          end: 4
          mode: increment
          flow:
            - click:
                identifier: ca.test.mappings.checkOut.placeOrder
            - if:
                identifier: 
                  notPresent:
                    - identifier: ca.test.mappings.checkOut.placeOrder   
                then:
                  - break: true                    
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.placeOrder.correctError
          then:
            - getString:
                identifier: ca.test.mappings.placeOrder.correctError
                attribute: label
                storeIn: errorMessage
            - click:
                identifier: ca.test.mappings.placeOrder.correctError
            - log: ${errorMessage}        

# check the checkbox of WMC in checkout page
  - name: ca.test.functions.checkout.checkTheCheckbox
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.Checkout.WRFcheckboxHeading
          then:    
          - scroll:
              direction: down
              untilIdentifier: ca.test.mappings.Checkout.WRFcheckboxHeading
          - verifyIdentifier:
              present:
                - identifier: ca.test.mappings.Checkout.WRFcheckboxHeading
                - identifier: ca.test.mappings.Checkout.WRFcheckbox
          - click:
              identifier: ca.test.mappings.Checkout.WRFcheckbox
          - if:
              identifier:
                present:
                  - identifier: ca.test.mappings.Checkout.WRFcheckboxHeading
              then:
                - click: 
                    identifier: ca.test.mappings.Checkout.WRFcheckbox
              else:
                - scroll:
                    direction: up
                    untilIdentifier: ca.test.mappings.Checkout.WRFcheckboxHeading
                - click:
                    identifier: ca.test.mappings.Checkout.WRFcheckbox
          else:
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.Checkout.WRFcheckboxHeading
                    - identifier: ca.test.mappings.Checkout.WRFcheckbox
              - click:
                  identifier: ca.test.mappings.Checkout.WRFcheckbox

# check the checkbox of WMC in checkout page
  - name: ca.test.functions.checkout.validateCheckbox
    platform: ios
    flow:
        - scroll:
            direction: down
            untilIdentifier: ca.test.mappings.Checkout.WRFcheckboxHeading
        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.Checkout.WRFcheckboxHeading
              - identifier: ca.test.mappings.Checkout.WRFcheckbox
              - identifier: ca.test.mappings.Checkout.WRFcheckboxFL
              - identifier: ca.test.mappings.checkout.WRFCheckboxLL

# validating Sales financing details in checkout subtotal session
  - name: ca.test.functions.checkout.validateSFunderSubtotal
    platform: ios
    flow:
        - scroll:
            direction: down
            untilIdentifier: ca.test.mapping.checkout.SFmonths
        - verifyIdentifier:
            present:
              - identifier: ca.test.mapping.checkout.SFmonths
              - identifier: ca.test.mapping.checkout.SFmonthlyPayments
              - identifier: ca.test.mapping.checkout.SFmonthlyPayments


  - name: ca.test.functions.checkout.addCardDetailsAndAddress
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.accountPage.walletPageTitle
      - sleep:
          duration: 10000
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.AddNewPaymentMethod
          then:
            - click:
                identifier: ca.test.mappings.AddNewPaymentMethod
          else:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.AddNewPaymentMethod
            - click:
                identifier: ca.test.mappings.AddNewPaymentMethod
      - sleep:
          duration: 10000
      # - verifyIdentifier:
      #     present:
      #       - identifier: ca.test.mappings.addPaymentOptions.title
      - click:
          identifier: ca.test.mappings.checkout.wallet.creditCardButton
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.cardNumberField
          string: ${number}
          pressEnter: true
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.paymentMethod.addPayment.overlay.expiry
          then:
            - click:
                identifier: ca.test.mappings.paymentMethod.addPayment.overlay.expiry
      
            - enterText:
                identifier: ca.test.mappings.paymentMethod.addPayment.overlay.expiry
                string: ${expiration}
                clearField: true
                clickFirst: true
                pressEnter: true
      - click:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.securityCodeField
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.securityCodeField
          string: ${cvv}
          pressEnter: true
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.deliveryAddress.add.firstName
      - enterText:
          identifier: ca.test.mappings.deliveryAddress.add.firstName
          string: ${fName}
          clearField: true
          clickFirst: true
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.LastName
      - enterText:
          identifier: ca.test.mappings.LastName
          string: ${lName}
          clearField: true
          clickFirst: true
      - goBack: true
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.accountPage.mobilePhone
      - enterText:
          identifier: ca.test.mappings.accountPage.mobilePhone
          string: ${mobileNumber}
          pressEnter: true
      - goBack: true
      - scroll:
           direction: down
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.streetAddressField
          string: ${streetAddress}
      - goBack: true
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.cityField
          string: ${city}
      - goBack: true
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.stateDropdown
          string: ${state}
      - goBack: true
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.zipCodeField
          string: ${zipcode}
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.paymentMethod.addPayment.overlay.saveButton
          then:
            - click:
                identifier: ca.test.mappings.paymentMethod.addPayment.overlay.saveButton
      - sleep:
          duration: 15000
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.errorBoxTitle
          then:
            - failTest:
                message: Wallet is throwing technical issues.
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkout.wallet.creditCard.successMessage
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkout.wallet.creditCard.number
              contains: ${cardLast4digits}
      - sleep:
          duration: 5000
      - click:
          identifier: ca.mappings.global.authentication.signIn.continueButton
      - log:
          message: "--------------------Credit Card Added Successfully--------------------"
          color: GREEN_BOLD
      - sleep:
          duration: 10000
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.errorBoxTitle
          then:
            - failTest:
                message: Wallet is throwing technical issues.
       

  - name: ca.test.functions.checkOut.salesFinancing.selectingSaleFinancing
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.salesFinancing.checkBox
          then:
            - log: 
                message: Scrolling down to sales financing options in checkout.
                color: GREEN_BOLD
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.salesFinancing.checkBox
                position: center
      - verifyPresent:
          identifier: ca.test.mappings.checkOut.salesFinancing.selectSalesFinancing
      - log:
          message: Sales financing option present in checkout page.
          color: GREEN_BOLD
      - verifyPresent:
          identifier: ca.test.mappings.checkOut.salesFinancing.title
      - log:
          message: Sales financing title present in checkout page.
          color: GREEN_BOLD
      - verifyPresent:
          identifier: ca.test.mappings.checkOut.salesFinancing.description
      - log:
          message: Sales financing description present in checkout page.
          color: GREEN_BOLD
      - verifyPresent:
          identifier: ca.test.mappings.checkOut.salesFinancing.checkBox
      - log:
          message: Sales financing checkbox present in checkout page.
          color: GREEN_BOLD
      - click:
          identifier: ca.test.mappings.checkOut.salesFinancing.checkBox
      - log:
          message: Sales financing options selected.
          color: GREEN_BOLD

  - name: ca.test.functions.checkOut.subTotal.salesFinancingDetails
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.subtotal.processingFee
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.subtotal.processingFee
                position: center
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.subtotal.financeDurationTitle
            - identifier: ca.test.mappings.checkOut.subtotal.financeDurationValue
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOut.subtotal.financeDurationValue
              contains: ${tenure}
      - log:
          message: Finacing duration details present in checkout page subtotal.
          color: GREEN_BOLD
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.subtotal.montlyPaymentTitle
            - identifier: ca.test.mappings.checkOut.subtotal.montlyPaymentValue
            - identifier: ca.test.mappings.checkOut.subtotal.processingFee
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOut.subtotal.montlyPaymentValue
              contains: ${monthlyPayment}
            - identifier: ca.test.mappings.checkOut.subtotal.processingFee
              contains: ${processingFee}
      - log:
          message: Monthly payments details and processing fee present in checkout page subtotal.
          color: GREEN_BOLD

  - name: ca.test.functions.checkout.assertingMobileNumberMandatoryForPlacingOrder
    platform: android
    flow:
      - try:
          flow:
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.checkOut.requriedFieldError
                then:
                  - log:
                      message: Scrolling down to mobile text field.
                      color: GREEN_BOLD
                  - scroll:
                      direction: down
                      untilIdentifier: ca.test.mappings.checkOut.requriedFieldError
                      position: center
                      scrollLimit: 5
                  - verifyIdentifier:
                      present:
                        - identifier: ca.test.mapping.checkOut.phoneTextField
          catch:
            flow:
              - log:
                  message: Scrolling down to mobile text field
                  color: GREEN_BOLD
              - scroll:
                  direction: up
                  untilIdentifier: ca.test.mapping.checkOut.phoneTextField
                  position: center
                  scrollLimit: 5
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mapping.checkOut.phoneTextField
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkout.errorMessage
            - identifier: ca.test.mappings.checkout.errorMessageText
            - identifier: ca.test.mappings.checkOut.requriedFieldError
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.pickUpText
          then:
            - scroll:
                direction: up
                untilIdentifier: ca.test.mappings.checkOutPage.pickUpText
                position: center
      - getString:
          identifier: ca.test.mappings.checkOutPage.pickUpText
          attribute: text
          storeIn: fulfillmentType
      - log:
          message: Mobile Field is mandatory for ${fulfillmentType} orders.
          color: GREEN_BOLD


# validate the mobile number errors

  - name: ca.functions.checkout.validateMobileErrors
    platform: ios
    flow:
        - click:
            identifier: ca.test.mappings.checkOut.placeOrder
        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.placeOrder.correctError
        - log:
            message: "Please correct the errors below"
            color: GREEN_BOLD
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.pleaseEnterMobileNumError
            then:
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.checkout.pleaseEnterMobileNumError
              - log:
                  message: please enter a valid phone number - validated
            else:
              - scroll:
                  direction: down
                  untilIdentifier: ca.test.mappings.checkout.pleaseEnterMobileNumError
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.checkout.pleaseEnterMobileNumError
              - log:
                  message: please enter a valid phone number - validated             

# Go back again to key board
  - name: ca.functions.checkout.goBackToCartAgain
    platform: ios
    flow:
        - goBack: true
        - click:
            identifier: ca.test.mappings.checkOutPage.leaveAnyway
        - sleep:
            duration: 500

  # mobile number enter in check out
  - name: ca.test.functions.checkOut.enterMobileNumber
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mapping.checkOut.phoneTextField
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mapping.checkOut.phoneTextField
                position: center
            - click:
                identifier: ca.test.mapping.checkOut.phoneTextField
            - enterText:
                identifier: ca.test.mapping.checkOut.phoneTextField
                string: ${phoneNumber}
            - hideKeyboard: true
          else:
            - click:
                identifier: ca.test.mapping.checkOut.phoneTextField
            - enterText:
                identifier: ca.test.mapping.checkOut.phoneTextField
                string: ${phoneNumber}
            # - hideKeyboard: true
            - click:
                identifier: ca.test.mappings.cart.done

# check disabled GC
  - name: ca.test.functions.checkOut.payment.giftCard.disabledForDigitalProducts
    platform: ios
    flow:
     - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.addPaymentMethod
          then:
            - click:
                identifier: ca.test.mappings.checkOutPage.addPaymentMethod
          else:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.addPaymentMethod
                position: center
                scrollLimit: 3
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkOutPage.addPaymentMethod
                then:
                    - click:
                        identifier: ca.test.mappings.checkOutPage.addPaymentMethod
                else:
                - scroll:
                    direction: up
                    untilIdentifier: ca.test.mappings.checkOutPage.editPaymentButton
                    scrollLimit: 3
                - click:
                    identifier: ca.test.mappings.checkOutPage.editPaymentButton
     - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.giftCardButton
          then:
            - click: 
                identifier: ca.test.mappings.checkOutPage.giftCardButton  
            - if: 
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.checkOut.giftCard.saveCard
                then:
                  - log: 
                      message: GC disabled for digital items - Validated!
                      color: GREEN_BOLD
                  - click:
                      identifier: ca.test.mappings.checkOut.paymentOptionClose

  # Continue to CheckOut
  - name: ca.test.functions.checkout.DFTB.productTileValidation
    platform: android
    flow:
      - click:
          identifier: ca.test.mappings.checkOutPage.orderItemsEditButton
      - getString:
          identifier: ca.test.mappings.DFTB.productDescription
          attribute: text
          storeIn: itemNameCheckout
      - log:
          message: "Items added from DFTB: $itemNameCheckout"
          color: GREEN_BOLD
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.DFTB.productDescription
              contains: ${itemName}
      - log:
          message: "--------------------Items added from DFTB reflecting in checkout page--------------------"
          color: GREEN_BOLD
      - click:
          identifier: ca.test.mappings.global.closeIcon

  - name: ca.test.functions.checkOut.estimateTotalExtraction
    platform: android
    flow:
      - getString:
          identifier: ca.test.mappings.checkOutPage.estimatedTotalValue
          attribute: text
          storeIn: estimateTotal
  
  - name: ca.test.functions.checkOut.promoCodeDontQualify
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
          then:
              - getString:
                  identifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
                  attribute: label
                  storeIn: errorMsg
              - log: 
                  message: $errorMsg - is displayed
                  color: GREEN_BOLD
          else:
            - failTest:
                message: No Error Message after applying GO Voucher on GM order
      - sleep:
          duration: 10000

  # Selecting driver tip
  - name: ca.test.functions.checkOut.selectingDriverTip
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.selectDriverTipOption
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.selectDriverTipOption
                position: center
      - click:
          identifier: ca.test.mappings.checkOut.selectDriverTipOption
      - getString:
          identifier: ca.test.mappings.checkOut.selectDriverTipAmount
          attribute: text
          storeIn: driverTip
      - sleep:
          duration: 6000

  - name: ca.test.functions.orderConfirmationValidation
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier: ca.test.mappings.orderConformation.tickSign
            - identifier: ca.test.mappings.orderConformation.text
            - identifier: ca.test.mappings.orderConformation.orderId
            - identifier: ca.test.mappings.orderConformation.fulfillment
            - identifier: ca.test.mappings.orderConformation.continueShoppingButton

#remove a WMC card
  - name: ca.test.functions.checkout.removeCardDetailsAndAddress
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.paymentMethod.addPayment.edit
          then:
            - click:
                identifier: ca.test.mappings.paymentMethod.addPayment.edit
            - sleep:
                duration: 1000
            - click:
                identifier: ca.test.mappings.paymentMethod.addPayment.removeCard
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.paymentMethod.addPayment.removeCardtitle
            - click:
                identifier: ca.test.mappings.checkOut.confirmBtn
            - sleep:
                duration: 1000

# add a WMC card
  - name: ca.test.functions.checkout.addCardDetailsAndAddress
    platform: ios
    flow:
      # - verifyIdentifier:
      #     present:
      #       - identifier: ca.test.mappings.accountPage.walletPageTitle
      - sleep:
          duration: 10000
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.AddNewPaymentMethod
          then:
            - click:
                identifier: ca.test.mappings.AddNewPaymentMethod
      # - verifyIdentifier:
      #     present:
      #       - identifier: ca.test.mappings.addPaymentOptions.title
      - sleep:
          duration: 1000
      - click:
          identifier: ca.test.mappings.checkout.wallet.creditCardButton
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.cardNumberField
          string: ${number}
          pressEnter: true
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.paymentMethod.addPayment.overlay.expiry
          then:
            - click:
                identifier: ca.test.mappings.paymentMethod.addPayment.overlay.expiry
            - enterText:
                identifier: ca.test.mappings.paymentMethod.addPayment.overlay.expiry
                string: ${expiration}
                # clearField: true
                # clickFirst: true
                # pressEnter: true
      - click:
         identifier: ca.test.mappings.wallet.done
      - click:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.securityCodeField
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.securityCodeField
          string: ${cvv}
          pressEnter: true
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.accountPage.mobilePhone
      - enterText:
          identifier: ca.test.mappings.accountPage.mobilePhone
          string: ${mobileNumber}
          pressEnter: true
      - click:
          identifier: ca.test.mappings.cart.deliveryFromStore.addNewAddress
      - scroll:
           direction: down
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.streetAddressField
          string: ${streetAddress}
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.cityField
          string: ${city}
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.provinceField
          string: ${state}
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.postalCodeField
          string: ${zipcode}
      - click:
         identifier: ca.test.mappings.wallet.done
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.giftCard.saveCard
          then:
            - click:
                identifier: ca.test.mappings.checkOut.giftCard.saveCard
                wait: 3000
      # - verifyIdentifier:
      #     timeout: 15000
      #     present:
      #       - identifier: ca.test.mappings.checkout.wallet.creditCard.successMessage
      # - verifyIdentifier:
      #     text:
      #       - identifier: ca.test.mappings.checkout.wallet.creditCard.number
      #         contains: ${cardLast4digits}
      - sleep:
          duration: 5000
      - click:
          identifier: ca.test.mappings.checkOut.paymentOptionClose #ca.test.mappings.global.closeIcon
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.gc.cvvPin
          then:
            - enterText:
                identifier: ca.test.mappings.checkOutPage.gc.cvvPin
                string: ${wmcPin}
      - log:
          message: "--------------------Credit Card Added Successfully--------------------"
          color: GREEN_BOLD

  - name: ca.test.functions.checkOut.moneyBoxDriverTip
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkout.driverTip.titleText
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkout.driverTip.titleText
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkout.driverTip.percentage
            - identifier: ca.test.mappings.checkout.driverTip.amount

  # Selecting driver tip
  - name: ca.test.functions.checkOut.validatingDriverTipDefaultSelection
    platform: android
    flow:
      - getString:
          identifier: ca.test.mappings.checkOut.Select3rdDriverTip
          attribute: selected
          storeIn: thirdOption
      - if:
          condition: ${thirdOption} == true
          then:
            - log:
                message: By default, 3rd option is selected for Driver Tip
                color: GREEN_BOLD
          else:
            - failTest:
                message: By default, 3rd option is not selected for Driver Tip

  # Selecting driver tip Custom
  - name: ca.test.functions.checkOut.selectingDriverTipCustom
    platform: android
    flow:
      - sleep:
          duration: 10000
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.selectDriverTip4thOption
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.selectDriverTip4thOption
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.selectDriverTipCustomOption
          then:
            - click:
                identifier: ca.test.mappings.checkOut.selectDriverTipCustomOption
          else:
            - click:
                identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
      # - scroll:
      #     direction: down
      - enterText:
          identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox
          string: '0'
      - hideKeyboard: true
      # - click:
      #     identifier: ca.test.mappings.global.closeIcon
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOut.selectDriverTipAmount
              contains: '$0'
      - log:
          message: Default custom value is $0
      - sleep:
          duration: 10000
      - executeFunction:
          name: ca.test.functions.checkOut.validatingDriverTipForZeroValue
      - scroll:
          direction: up
          untilIdentifier: ca.test.mappings.checkOut.editDriverTipCustomAmount

      - click:
          identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
      - enterText:
          clearField: true
          identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox
          string: ${customAmount}
          pressEnter: true
      - hideKeyboard: true     
      - sleep:
          duration: 10000
      - if:
          condition: ${customAmount} > 100
          then:
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.checkOut.selectDriverTipErrorAlert
                then:
                  - failTest:
                      message: Error message is not displayed for tip greater than 100
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOut.selectDriverTipErrorAlert
            - getString:
                identifier: ca.test.mappings.checkOut.selectDriverTipErrorAlert
                attribute: text
                storeIn: errorMsg
            - log:
                message: $errorMsg - Error Message is displayed
            - enterText:
                identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox
                string: '0'
                pressEnter: true                
            - hideKeyboard: true
      - if:
          condition: ${customAmount} > 0 && ${customAmount} < 101
          then:
            - getString:
                identifier: ca.test.mappings.checkOut.selectDriverTipAmount
                attribute: text
                storeIn: driverTip
            - verifyIdentifier:
                timeout: 20000
                present:
                  - identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
            - executeFunction:
                name: ca.test.functions.checkOut.validatingSelectedDriverTip
      - if:
          condition: ${customAmount} == 0
          then:
            - log:
                message: 0 is selected for driver tip
                color: GREEN_BOLD

  # Valiating driver tip Custom
  - name: ca.test.functions.checkOut.validatingDriverTipForZeroValue
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: ca.test.mappings.checkOutPage.estimatedTotalValue
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.priceSection.drivertipTitle
          then:
            - failTest:
                message: Driver Tip is visible for 0 value.

  # Valiating driver tip Custom
  - name: ca.test.functions.checkOut.validatingSelectedDriverTip
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: ca.test.mappings.checkOutPage.estimatedTotalValue
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOut.driverTip.driverTipAmount
              contains: ${customAmount}
      - log:
          message: ${driverTip} is visible
      - scroll:
          direction: up
          untilIdentifier: ca.test.mappings.checkOut.editDriverTipCustomAmount

  # Editing driver tip Custom
  - name: ca.test.functions.checkOut.editDriverTipCustom
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
      - click:
          identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
      - enterText:
          identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox
          string: '0'
          pressEnter: true
      - hideKeyboard: true
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOut.selectDriverTipAmount
              contains: '$0'
      - log:
          message: Default custom value is $0
      - sleep:
          duration: 10000
      - executeFunction:
          name: ca.test.functions.checkOut.validatingDriverTipForZeroValue
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
          then:
            - scroll:
                direction: up
                untilIdentifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
      - click:
          identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
      - enterText:
          clearField: true
          identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox
          string: ${customAmount}
          pressEnter: true
      - hideKeyboard: true
      - if: 
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
      - getString:
          identifier: ca.test.mappings.checkOut.selectDriverTipAmount
          attribute: text
          storeIn: driverTip
      - executeFunction:
          name: ca.test.functions.checkOut.validatingSelectedDriverTip

  - name: ca.test.functions.checkOut.removeGiftCard
    platform: android
    flow:
      - sleep:
          duration: 15000
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.wallet.giftCard.text
          then:
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkOut.wallet.giftCard.count
                then:
                  - getString:
                      identifier: ca.test.mappings.checkOut.wallet.giftCard.count
                      attribute: content-desc
                      storeIn: cardCarousel
                  - log: "${cardCarousel}"
                  - executeNode:
                      file: ca/test/helpers/CheckOut/GiftCardCount.js
                      args:
                        - value: ${cardCarousel}
                      getResponse:
                        storeIn: cardCount
                  - log: ${cardCount}
                else:
                  - storeIn:
                      key: cardCount
                      value: "1"
            - loop:
                begin: 0
                end: "$cardCount"
                mode: increment
                flow:
                  - if:
                      identifier:
                        present:
                          - identifier: ca.test.mappings.checkOut.paymentMethod.gc.deleteButton
                      then:
                        - try:
                            flow:
                              - click:
                                  identifier: ca.test.mappings.checkOut.paymentMethod.gc.deleteButton
                              - verifyIdentifier:
                                  present:
                                    - identifier: ca.test.mappings.checkOut.paymentMethod.gc.removeCardPopUp
                              - click:
                                  identifier: ca.test.mappings.checkOut.paymentMethod.gc.removeCardPopUp.removeButton
                              - sleep:
                                  duration: 20000
                              - scroll:
                                  direction: left
                                  withinIdentifier: ca.test.mappings.checkOut.paymentMethod.giftCardCarousel
                                  scrollLimit: 1
                            catch:
                              flow:
                                - scroll:
                                    direction: right
                                    withinIdentifier: ca.test.mappings.checkOut.paymentMethod.giftCardCarousel
                                    scrollLimit: 1
                                - sleep:
                                    duration: 3000
                                - click:
                                    identifier: ca.test.mappings.checkOut.paymentMethod.gc.deleteButton
                                - sleep:
                                    duration: 3000
                                - verifyIdentifier:
                                    present:
                                      - identifier: ca.test.mappings.checkOut.paymentMethod.gc.removeCardPopUp
                                - click:
                                    identifier: ca.test.mappings.checkOut.paymentMethod.gc.removeCardPopUp.removeButton
                                - sleep:
                                    duration: 15000
                                - scroll:
                                    direction: left
                                    withinIdentifier: ca.test.mappings.checkOut.paymentMethod.giftCardCarousel
                                    scrollLimit: 1


  - name: ca.test.functions.checkOut.navigateToWallet
    platform: android
    flow:
      - sleep:
          duration: 5000
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.mobileNumberText
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.mobileNumberText
                position: center
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.changePaymentButton
          then:
            - click:
                identifier: ca.test.mappings.checkOutPage.changePaymentButton
            - verifyIdentifier:
                timeout: 10000
                notPresent:
                  - identifier: ca.test.mappings.checkOutPage.changePaymentButton
          else:
            - click:
                identifier: ca.test.mappings.checkOutPage.addNewPaymentButton
            - verifyIdentifier:
                timeout: 10000
                notPresent:
                  - identifier: ca.test.mappings.checkOutPage.addNewPaymentButton

  - name: ca.test.functions.checkOut.salesFinancing.verifyDetailsNotPresent
    platform: android
    flow:
      - sleep:
          duration: 10000
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.changePaymentButton
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.changePaymentButton
                position: center
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.paymentMethod.creditCardIcon
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.salesFinancing.selectSalesFinancing
              - identifier: ca.test.mappings.checkOut.salesFinancing.title
              - identifier: ca.test.mappings.checkOut.salesFinancing.description
              - identifier: ca.test.mappings.checkOut.salesFinancing.checkBox
          then:
            - failTest:
                message: Sales Financing details present under payment method for ${cardType} card.
          else:
            - log:
                message: Sales Financing details not present under payment method.
                color: GREEN_BOLD

  # Order Id Assertion
  - name: ca.test.functions.checkOut.orderConformation.orderIdExtraction
    platform: ios
    flow:
      - sleep:
          duration: 20000
      - getString:
          identifier: ca.test.mappings.checkOut.orderConfirmation.orderId
          attribute: label
          extractNumbers: true
          storeIn: orderId
      - log: ${orderId}
      - log: "-------------------Order Id Stored Successfully--------------------"

  # Continue to CheckOut
  - name: ca.test.functions.checkout.DFTB.productTileValidation
    platform: ios
    flow:
      - click:
          identifier: ca.test.mappings.checkOutPage.orderItemsViewButton
      - getString:
          identifier: ca.test.mappings.DFTB.productDescription
          attribute: label
          storeIn: itemNameCheckout
      - log:
          message: "Items added from DFTB: $itemNameCheckout"
          color: GREEN_BOLD
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.DFTB.productDescription
              contains: ${itemName}
      - log:
          message: "--------------------Items added from DFTB reflecting in checkout page--------------------"
          color: GREEN_BOLD
      - click:
          identifier: ca.test.mappings.global.closeIcon
  
  - name: ca.test.functions.checkOut.paymentMethod.newgiftCard
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier: ca.test.mappings.addPaymentOptions.giftCard
      - click:
          identifier: ca.test.mappings.addPaymentOptions.giftCard
      - verifyIdentifier:
          timeout: 20000
          notPresent:
            - identifier: ca.test.mappings.addPaymentOptions.giftCard

  - name: ca.test.functions.checkOut.promoCodeDontQualify
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
          then:
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
            - getString:
                identifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
                attribute: text
                storeIn: errorMsg
            - log: 
                message: $errorMsg - is displayed
                color: GREEN_BOLD
          else:
            - failTest:
                message: No Error Message after applying GO Voucher on GM order

  - name: ca.test.functions.checkOut.addPaymentMethod
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.addPaymentMethodBtn
          then:
             - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.addPaymentMethodBtn
      - click:
         identifier: ca.test.mappings.checkOutPage.addPaymentMethodBtn
      - sleep:
          duration: 10000

  - name: ca.test.functions.checkOut.paymentMethod.addNewPaymentMethod
    flow:
      - if:
          identifier:  
            notPresent:
              - identifier: ca.test.mappings.AddNewPaymentMethod
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.AddNewPaymentMethod
                position: center
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier:  ca.test.mappings.AddNewPaymentMethod
      - click:
          identifier:  ca.test.mappings.AddNewPaymentMethod
      - verifyIdentifier:
          timeout: 20000
          notPresent:
            - identifier: ca.test.mappings.AddNewPaymentMethod
  
  - name: ca.test.functions.checkOut.paymentMethod.countinueButton
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier: ca.test.mappings.checkOut.editpayment.continueButton
      - click:
          identifier: ca.test.mappings.checkOut.editpayment.continueButton
      - verifyIdentifier:
          timeout: 20000
          notPresent:
            - identifier: ca.test.mappings.checkOut.editpayment.continueButton

  - name: ca.test.functions.checkOut.paymentMethod.countinueButton
    platform: ios
    flow:
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier: ca.test.mappings.global.continueButton
      - click:
          identifier: ca.test.mappings.global.continueButton
      - verifyIdentifier:
          timeout: 20000
          notPresent:
            - identifier: ca.test.mappings.global.continueButton

  - name: ca.test.functions.checkOut.paymentMethod.creditCard.cvv
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.cardCVV
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.cardCVV
                position: center
      - click:
          identifier: ca.test.mappings.checkOut.cardCVV
      - enterText:
          identifier: ca.test.mappings.checkOut.cardCVV
          string: ${cvv}

  - name: ca.test.functions.checkOut.associateDiscountNotPresentValidation
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.associateDiscountText
          then:
            - log:
                message: Associate Discount not present for 3P Item
                color: GREEN_BOLD
          else:
            - failTest:
                message: Associate Discount present for 3P Item     

  # Validating driver tip
  - name: ca.test.functions.checkOut.validatingDriverTip
    platform: ios
    flow:
      - verifyIdentifier:
          timeout: 60000
          present:
            - identifier: ca.test.mappings.checkOutPage.delivery.deliverySectionText
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.headingDriverTip
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.headingDriverTip
                position: center
          else:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.headingDriverTip
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.driverTippingAmount
            - identifier: ca.test.mappings.checkOut.driverTippingAmountOptions
            - identifier: ca.test.mappings.checkOut.headingDriverTip
            - identifier: ca.test.mappings.checkOut.driverTippingMoreInfo 
            - identifier: ca.test.mappings.checkOut.selectDriverTipSubtitle

  # Selecting driver tip
  - name: ca.test.functions.checkOut.validatingDriverTipDefaultSelection
    platform: ios
    flow:
      - getString:
          identifier: ca.test.mappings.checkOut.Select3rdDriverTip
          attribute: selected
          storeIn: thirdOption
      - if:
          condition: ${thirdOption} == true
          then:
            - log:
                message: By default, 3rd option is selected for Driver Tip
                color: GREEN_BOLD
          else:
            - failTest:
                message: By default, 3rd option is not selected for Driver Tip   

  # Selecting driver tip
  - name: ca.test.functions.checkOut.selectingDriverTip
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.selectDriverTipOption
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.selectDriverTipOption
                position: center
      - click:
          identifier: ca.test.mappings.checkOut.selectDriverTipOption
      - getString:
          identifier: ca.test.mappings.checkOut.selectDriverTipAmount
          attribute: label
          storeIn: driverTip
      - log:
          message: ${driverTip}
          color: RED_BOLD
      - sleep:
          duration: 6000        

  # Selecting driver tip Custom
  - name: ca.test.functions.checkOut.selectingDriverTipCustom
    platform: ios
    flow:
      - sleep:
          duration: 10000
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox #ca.test.mappings.checkOut.selectDriverTipCustomOption
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox #ca.test.mappings.checkOut.selectDriverTipCustomOption
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox #ca.test.mappings.checkOut.selectDriverTipCustomOption
          then:
            - click:
                identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox #ca.test.mappings.checkOut.selectDriverTipCustomOption
          else:
            - click:
                identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount 
      - executeFunction:
          name: ca.test.functions.global.keyboard.delete             
      - enterText:
          identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox # ca.test.mappings.checkOut.selectDriverTipCustomOption
          string: '0'
      - click:
          identifier: ca.test.mapping.checkout.keyboard
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOut.selectDriverTipAmount1
              contains: '0.00'
      - log:
          message: Default custom value is $0.00
      - sleep:
          duration: 10000
      - click:
          identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount 
      - sleep:
          duration: 5000  
      - executeFunction:
         name: ca.test.functions.global.keyboard.delete
      - enterText:
          identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox
          string: ${customAmount} 
      - sleep:
          duration: 5000      
      - click:
          identifier: ca.test.mapping.checkout.keyboard
      - sleep:
          duration: 10000
      - if:
          condition: ${customAmount} > 100
          then:
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.checkOut.selectDriverTipErrorAlert
                then:
                  - failTest:
                      message: Error message is not displayed for tip greater than 100
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkOut.selectDriverTipErrorAlert
            - getString:
                identifier: ca.test.mappings.checkOut.selectDriverTipErrorAlert
                attribute: label
                storeIn: errorMsg
            - log:
                message: $errorMsg - Error Message is displayed
            - executeFunction:
                name: ca.test.functions.global.keyboard.delete    
            - enterText:
                identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox
                string: '0'
            - click:
                identifier: ca.test.mapping.checkout.keyboard
      - if:
          condition: ${customAmount} < 101
          then:
            - getString:
                identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox
                attribute: label
                storeIn: driverTip
            - verifyIdentifier:
                timeout: 20000
                present:
                  - identifier: ca.test.mappings.checkOut.editDriverTipCustomAmount 

  - name: ca.test.functions.checkout.driverTip.validateDefultOptions
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: TippingContainerView.containerStackView
          then:
            - scroll:
                direction: down
                untilIdentifier: TippingContainerView.containerStackView
                timeout: 10000
                scrollLimit: 4
      - verifyIdentifier:
          present:
            - identifier: //XCUIElementTypeStaticText[@name="TippingContainerView.selectedTipAmountLabel"]
      - getString:
          identifier: //XCUIElementTypeStaticText[@name="TippingContainerView.selectedTipAmountLabel"]
          storeIn: defaultValue
          attribute: value
      - verifyIdentifier:
          label:
            - identifier: (//XCUIElementTypeOther[@name="TippingContainerView.tipButtonTopStackView"]//XCUIElementTypeButton)[3]/XCUIElementTypeStaticText
              contains: ${defaultValue}
      - log:
          message: "By default third option is selected for driver tip."
          color: GREEN_BOLD

  - name: ca.test.functions.checkout.driverTip.validateDriver
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox
      - click:
          identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox
      - loop:
          begin: 0
          end: 3
          mode: increment
          flow:
            - click:
                identifier: ca.test.mappings.keyboard.delete
      - enterText:
          identifier: ca.test.mappings.checkOut.selectDriverTipCustomOptionTxtBox
          string: ${tipAmount}
      - click:
          identifier: ca.test.mappings.global.doneButton
      - if:
          condition: ${tipAmount} > 100
          then:
            - verifyIdentifier:
                present:
                  - identifier: //XCUIElementTypeStaticText[@label="Tips can be up to $100."]
            - log:
                message: "Getting error message while tipping above $100."
                color: GREEN_BOLD
          else:
            - sleep:
                duration: 5000
            - verifyIdentifier:
                value:
                  - identifier: //XCUIElementTypeStaticText[@name="TippingContainerView.selectedTipAmountLabel"]
                    contains: ${tipAmount}
            - log:
                message: "$${tipAmount} tip added."
                color: GREEN_BOLD
            - if:
                condition: ${tipAmount} == 0
                then:
                  - verifyIdentifier:
                      notPresent:
                        - identifier: //XCUIElementTypeOther[contains(@name,"POSLineItemView.Drivertip")]
                  - log:
                      message: "Driver tip is not showing in money box."
                      color: GREEN_BOLD
                else:
                  - verifyIdentifier:
                      present:
                        - identifier: //XCUIElementTypeOther[contains(@name,"POSLineItemView.Drivertip")]

  - name: ca.test.functions.checkOut.editPaymentAndContinue
    platform: ios
    flow: 
      - click:
         identifier: ca.test.mappings.checkoutPage.wallet.selectCreditCard
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkoutPage.wallet.changePaymentMethodPop
            - identifier: ca.test.mappings.checkoutPage.wallet.changePaymentMethodPop.text
            - identifier: ca.test.mappings.checkoutPage.wallet.changePaymentMethodPop.confirm
      - click:
          identifier: ca.test.mappings.checkoutPage.wallet.changePaymentMethodPop.confirm
      - sleep:
          duration: 5000

  # Check out sub total validation
  - name: ca.test.functions.checkOut.driverTipValidation
    platform: ios
    flow:               
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.driverTipText       
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.driverTipValue
              contains: ${driverTip}
      - log: 
          message: "Checkout Page Driver Tip Assertion Sucessful"
          color: GREEN_BOLD

  - name: ca.test.functions.checkOut.associateDiscountNotPresentValidation
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkout.associateDiscountText
          then:
            - log:
                message: Associate Discount not present for 3P Item
                color: GREEN_BOLD
          else:
            - failTest:
                message: Associate Discount present for 3P Item

  - name: ca.test.functions.checkOut.editPayment.chooseGiftCard
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.AddNewPaymentMethod
          then:
            - click: 
                identifier: ca.test.mappings.AddNewPaymentMethod
          else:
            - break: true
      - sleep:
          duration: 5000
      - verifyIdentifier:
          timeout: 10000
          present:
            # - identifier: ca.test.mappings.addpaymentOptions.smartWaysToPayText
            - identifier: ca.test.mappings.addPaymentOptions.giftCard
      - click:
          identifier: ca.test.mappings.addPaymentOptions.giftCard
      - sleep:
          duration: 5000
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.title
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.cardNumberText
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.cardPinText
      - enterText:
          identifier: ca.test.mappings.checkOut.editPayment.giftCard.numberField
          string: ${cardNumber}
          clearField: true
          clickFirst: true
          pressEnter: true
      - enterText:
          identifier: ca.test.mappings.checkOut.editPayment.giftCard.pinField
          string: ${cardPin}
          clearField: true
          clickFirst: true
          pressEnter: true
      - click:
          identifier: ca.test.mappings.global.doneButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOut.editPayment.giftCard.whereIsPinText
            - identifier: ca.test.mappings.checkOut.giftCard.saveCard
            - identifier: ca.test.mappings.checkOut.don'tHavePin
      - click:
          identifier: ca.test.mappings.checkOut.giftCard.saveCard
      - loop:
          begin: 0
          end: 5
          mode: increment
          flow:
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkOut.paymentMethod.addgiftCard.errorText
                then:
                  - click:
                      identifier: ca.test.mappings.checkOut.giftCard.saveCard
            - sleep:
                duration: 10000
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.checkOut.paymentMethod.addgiftCard.errorText
                then:
                  - break: true
      - verifyIdentifier:
          timeout: 30000
          present:
            - identifier: ca.test.mappings.checkOut.editpayment.addGiftCardSuccessText
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOut.cardCVV
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.cardCVV
                position: center
                scrollLimit: 3
      
      - click:
            identifier: ca.test.mappings.checkOut.cardCvv
      - enterText:
          identifier: ca.test.mappings.checkOut.cardCvv
          string: ${cvvNumber}
      - if:
           identifier:
              present:
                - identifier: ca.test.mappings.global.doneButton
           then:
             - click:
                 identifier: ca.test.mappings.global.doneButton 

  - name: ca.test.functions.wallet.enterCVV
    platform: ios
    flow:
        - if: 
            identifier:
              present:
                - identifier: ca.test.mapping.wallet.invalidCVV
            then:
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.wallet.entercvvField
              - enterText:
                  identifier: ca.test.mappings.wallet.entercvvField
                  string: ${cc_cvv}
              - click:
                  identifier: ca.test.mappings.cart.url.done

  - name: ca.test.functions.checkOut.editPayment.chooseGiftCard_CC
    platform: ios
    flow:
      - executeFunction:
          name: ca.test.functions.checkOut.editPayment.chooseGiftCard
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkOut.cardCVV
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOut.cardCVV
                position: center
            - enterText:
                identifier: ca.test.mappings.checkOut.cardCVV
                string: ${cvvNumber}
      - click:
          identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton
      - if:
          identifier:
            present:
              - identifier: ca.test.mapping.wallet.invalidCVV
          then:
            - executeFunction: 
                name: ca.test.functions.wallet.enterCVV
            - click:
                identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton
            - sleep:
                duration: 1000

  - name: ca.test.functions.wallet.multiplegc
    platform: ios
    flow:
      - executeFunction:
          name:  ca.test.functions.astroUrl.createGiftCard
          params:
            - name: giftCardAmount
              string: ${gcAmount1}
      - executeFunction:
          name: ca.test.functions.checkOut.editPayment.chooseGiftCard
          params:
            - name: cardNumber
              string: ${giftCardNumber}
            - name: cardPin
              string: ${giftCardPin}
      - executeFunction:
          name:  ca.test.functions.astroUrl.createGiftCard
          params:
            - name: giftCardAmount
              string: ${gcAmount2}
      - executeFunction:
          name: ca.test.functions.checkOut.editPayment.chooseGiftCard
          params:
            - name: cardNumber
              string: ${giftCardNumber}
            - name: cardPin
              string: ${giftCardPin}
      - executeFunction:
          name:  ca.test.functions.astroUrl.createGiftCard
          params:
            - name: giftCardAmount
              string: ${gcAmount3}
      - executeFunction:
          name: ca.test.functions.checkOut.editPayment.chooseGiftCard
          params:
            - name: cardNumber
              string: ${giftCardNumber}
            - name: cardPin
              string: ${giftCardPin}
      - executeFunction:
          name:  ca.test.functions.astroUrl.createGiftCard
          params:
            - name: giftCardAmount
              string: ${gcAmount4}
      - executeFunction:
          name: ca.test.functions.checkOut.editPayment.chooseGiftCard
          params:
            - name: cardNumber
              string: ${giftCardNumber}
            - name: cardPin
              string: ${giftCardPin}
      - click:
          identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton
      - sleep:
          duration: 1000

  - name: ca.test.functions.wallet.twogc
    platform: ios
    flow:
      - executeFunction:
          name:  ca.test.functions.astroUrl.createGiftCard
          params:
            - name: giftCardAmount
              string: ${gcAmount1}
      - executeFunction:
          name: ca.test.functions.checkOut.editPayment.chooseGiftCard
          params:
            - name: cardNumber
              string: ${giftCardNumber}
            - name: cardPin
              string: ${giftCardPin}
      - executeFunction:
          name:  ca.test.functions.astroUrl.createGiftCard
          params:
            - name: giftCardAmount
              string: ${gcAmount2}
      - executeFunction:
          name: ca.test.functions.checkOut.editPayment.chooseGiftCard
          params:
            - name: cardNumber
              string: ${giftCardNumber}
            - name: cardPin
              string: ${giftCardPin}
      - click:
          identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton
      - sleep:
          duration: 1000
  
  - name: ca.test.functions.checkOut.fulfillmentCard.storeDetailsAssertion
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.pickUp.inStorePickUpText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.scheduledOrder.storeName
              contains: ${storeName}
            - identifier: ca.test.mappings.checkOutPage.scheduledOrder.storeAddress
              contains: ${storeAddress}

  - name: ca.test.functions.checkOut.paymentMethod.addNewCardAndAddress
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.accountPage.addPaymentMethod
          then:
            - click:
                identifier: ca.test.mappings.accountPage.addPaymentMethod
      - sleep:
          duration: 2000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.addPaymentOptions.title
      - click:
          identifier: ca.test.mappings.checkout.paymentMethod.editPayment.newCreditCard
      - verifyIdentifier:
          notPresent:
            - identifier: ca.test.mappings.checkout.paymentMethod.editPayment.newCreditCard
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.cardNumberField
          string: ${number}
          pressEnter: true
      - click:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.expiry
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.expiryMonth
          string: ${expirationMonth}
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.expiryDate
          string: ${expirationDate}
      - sleep: 
          duration: 3000
      - click:
          identifier: ca.test.mapping.checkout.keyboard 
      - sleep: 
          duration: 5000  
      - click:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.securityCodeField
      - enterText:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.securityCodeField
          string: ${cvv}
          pressEnter: true
      - enterText:
          identifier: ca.test.mappings.accountPage.mobilePhone
          string: ${mobileNumber}
          pressEnter: true
      # - sleep:
      #     duration: 5000
      # - if:
      #     identifier:
      #       present:
      #         - identifier: ca.test.mapping.checkout.keyboard
      #     then:
      #       - click:
      #           identifier: ca.test.mapping.checkout.keyboard
      - if:
          condition: ${addNewAddress} == Yes
          then:
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkout.paymentMethod.editPayment.newCreditCard.addNewAddress
            - click:
                identifier: ca.test.mappings.checkout.paymentMethod.editPayment.newCreditCard.addNewAddress
            - enterText:
                identifier: ca.test.mappings.paymentMethod.addPayment.overlay.streetAddressField
                string: ${streetAddress}
                pressEnter: true
            - enterText:
                identifier: ca.test.mappings.paymentMethod.addPayment.overlay.cityField
                string: ${city}
                pressEnter: true
            - click:
                identifier: ca.test.mappings.paymentMethod.addPayment.overlay.provinceField
            - sleep:
                duration: 2000
            - enterText:
                identifier: ca.test.mappings.paymentMethod.addPayment.overlay.postalCodeFieldPicker
                string: ${province}
            - enterText:
                identifier: ca.test.mappings.paymentMethod.addPayment.overlay.postalCodeField
                string: ${postalCode}
                pressEnter: true
      # - if:
      #     identifier:
      #       present:
      #         - identifier: ca.test.mapping.checkout.keyboard
      #     then:
      #       - click:
      #           identifier: ca.test.mapping.checkout.keyboard
      - click:
          identifier: ca.test.mappings.paymentMethod.addPayment.overlay.saveButton
      - sleep:
          duration: 5000
      - loop:
          begin: 1
          end: 4
          mode: increment
          flow:
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkout.editPayment.addCreditCard.errorMessage
                then:
                  - click:
                      identifier: ca.test.mappings.paymentMethod.addPayment.overlay.saveButton
                else:
                  - break: true
      - sleep:
          duration: 10000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkout.paymentMethods.editPayment.creditCardSuccessText
      - log:
          message: "Credit Card Added Successfully"
          color: GREEN_BOLD
      - enterText:
          identifier: ca.test.mappings.wallet.entercvvField
          string: ${cvv}
          pressEnter: true
          clickFirst: true
      - click:
          identifier: ca.test.mapping.checkout.keyboard
      - click:
         identifier: ca.test.mappings.global.continueButton
      - sleep:
          duration: 10000

  # Promo Code header validation
  - name: ca.test.functions.checkOut.viewPromoCodes
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.viewPromoCodes
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.viewPromoCodes
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.viewPromoCodes
      - click:
          identifier: ca.test.mappings.checkOutPage.viewPromoCodes
      - log:
          message: Promo Codes Page validation started
          color: YELLOW
      - verifyIdentifier:
          timeout: 15000
          present:
            - identifier: ca.test.mappings.checkOutPage.viewPromoCodes.promoCodeTitle
            - identifier: ca.test.mappings.checkOutPage.promoCode
            - identifier: ca.test.mappings.checkOutPage.promoCodeDetails
            - identifier: ca.test.mappings.global.closeIcon
            - identifier: ca.test.mappings.checkOutPage.viewPromoCodes.applyPromoCode
      - log:
          message: Successfully Validated Promo Code Page
          color: GREEN_BOLD

  # Promo Code header validation
  - name: ca.test.functions.checkOut.validatingAddedPromoCode
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.availablePromoCodes
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.availablePromoCodes
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.availablePromoCodes
              contains: ${promoCode}
      - log:
          message: ${promoCode} is visible to apply
          color: GREEN_BOLD

  # Promo Code header validation
  - name: ca.test.functions.checkOut.applyAnyPromoCode
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.applyPromoCode
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.applyPromoCode
                withinIdentifier: ca.test.mappings.checkOutPage.promoCode.promoCodeRecycler
      - click:
          identifier: ca.test.mappings.checkOutPage.applyPromoCode
      - sleep:
          duration: 10000
      - hideKeyboard: true

  - name: ca.test.functions.checkOut.validateAppliedPromoCode
    platform: android
    flow:
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.appliedPromoCode
              contains: ${appliedCode}
      - log:
          message: ${appliedCode} is applied
          color: GREEN_BOLD

  - name: ca.test.functions.checkOut.promoCode.close
    platform: android
    flow:
      - click:
          identifier: ca.test.mappings.global.closeIcon

  # Redeem Rewards Validation
  - name: ca.test.functions.checkOut.payment.redeemRewardsValidation
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.paymentMethods.redeemRewards
            - identifier: ca.test.mappings.checkOutPage.paymentMethods.redeemRewardsAvailableBalance
      - click:
          identifier: ca.test.mappings.checkOutPage.paymentMethods.redeemRewards
      - sleep:
          duration: 12000
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier: ca.test.mappings.checkOutPage.paymentMethods.redeemRewardsTextBox
            - identifier: ca.test.mappings.checkOutPage.paymentMethods.redeemRewardsText
            - identifier: ca.test.mappings.checkOutPage.paymentMethods.redeemRewards.termsAndConditions
      - getString:
          identifier: ca.test.mappings.checkOutPage.paymentMethods.redeemRewardsAvailableBalance
          attribute: text
          storeIn: availBalance
      - log:
          message: Available Balance:- $availBalance
          color: YELLOW
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.paymentMethods.redeemRewardsText
              contains: '$5'
      - verifyIdentifier:
          text:
            - identifier: ca.test.mappings.checkOutPage.paymentMethods.redeemRewardsText
              contains: ${estTotal}

  # Redeem Rewards Validation
  - name: ca.test.functions.checkOut.payment.redeemRewards.enterAmount
    platform: android
    flow:
      - enterText:
          identifier: ca.test.mappings.checkOutPage.paymentMethods.redeemRewardsTextBox
          string: ${amount}
          pressEnter: true
      - hideKeyboard: true
      - sleep:
          duration: 10000

  - name: ca.test.functions.checkOut.applyNewPromoCode
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.promoCodeTitle
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkOutPage.promoCodeField
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkOutPage.promoCodeField
                timeout: 3000
      - enterText:
          identifier: ca.test.mappings.checkOutPage.promoCodeField
          string: ${promoCode}
          clickFirst: true
          clearField: true
      - hideKeyboard: true
      - click:
          identifier: ca.test.mappings.checkOutPage.promoCodeApplyButton
      - sleep:
          duration: 12000
      - hideKeyboard: true

  # Promo Code header validation
  - name: ca.test.functions.checkOut.viewPromoCodes.noCodesAttachedToAccount
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkoutPage.havePromoCode
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkoutPage.havePromoCode
      - verifyIdentifier:
          notPresent:
            - identifier: ca.test.mappings.checkOutPage.viewPromoCodes
      - log:
          message: View Promo Codes Page when no promo codes are attached to account
          color: YELLOW

  # Promo Code header validation
  - name: ca.test.functions.checkOut.promoCodes.validateErrorMessages
    platform: android
    flow:
      - if:
          condition: ${errorType} == 'apply without any promo code'
          then:
            - click:
                identifier: ca.test.mappings.checkOutPage.promoCodeApplyButton
            - if:
                identifier:
                  notPresent:
                    - identifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
                then:
                  - scroll:
                      direction: down
                      untilIdentifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
                  - verifyIdentifier:
                      text:
                        - identifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
                          contains: 'Add promo code'
      - if:
          condition: ${errorType} == 'low order spent'
          then:
            - verifyIdentifier:
                text:
                  - identifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
                    contains: 'more to your cart to use this promo code'

      - if:
          condition: ${errorType} == 'not applicable for current order'
          then:
            - verifyIdentifier:
                text:
                  - identifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
                    contains: 'Promo code only applies to'

      - if:
          condition: ${errorType} == 'invalid promo'
          then:
            - enterText:
                identifier: ca.test.mappings.checkOutPage.promoCodeField
                string: ${promoCode}
                clickFirst: true
                clearField: true
            - hideKeyboard: true
            - click:
                identifier: ca.test.mappings.checkOutPage.promoCodeApplyButton
            - sleep:
                duration: 12000
            - verifyIdentifier:
                text:
                  - identifier: ca.test.mappings.checkOut.promoCodeDontQualifyValidation
                    contains: 'Sorry! This promo code is invalid'        
  
  # Promo Code header validation
  - name: ca.test.functions.checkOut.promoCode.validatingAddedPromoCode
    platform: ios
    flow:
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.availablePromoCodes
              contains: ${promoCode}
      - log:
          message: ${promoCode} is visible to apply
          color: GREEN_BOLD 

  # Promo Code header validation
  - name: ca.test.functions.checkOut.promoCode.applyAnyPromoCode
    platform: ios
    flow:
      - sleep:
          duration: 10000
      - click:
          identifier: ca.test.mappings.checkOutPage.applyPromoCode
      - sleep:
          duration: 10000
      - hideKeyboard: true  

  - name: ca.test.functions.checkOut.validateAppliedPromoCode
    platform: ios
    flow:
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.appliedPromoCode
              contains: ${appliedCode}
      - log:
          message: ${appliedCode} is applied
          color: GREEN_BOLD   

  - name: ca.test.functions.checkOut.subTotal.promoCodeValidation
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.promoCodeAppliedText
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.checkOutPage.promoCodeAppliedValue
              contains: ${promoCodeValue}                          

 # Promo Code header validation
  - name: ca.test.functions.checkOut.viewPromoCodes
    platform: ios
    flow:
      - if:
            identifier:
              notPresent:
                - identifier: ca.test.mappings.checkOut.promoCode #ca.test.mappings.checkOutPage.viewPromoCodes
            then:
              - scroll:
                  direction: down
                  untilIdentifier: ca.test.mappings.checkOut.promoCode
      - click:
            identifier: ca.test.mappings.checkOut.promoCode          
      - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.checkOutPage.viewPromoCodes
      - click:
            identifier: ca.test.mappings.checkOutPage.viewPromoCodes
      - click:
          identifier: ca.test.mappings.checkOutPage.openViewPromoCode
      - click:
          identifier: ca.test.mappings.checkOutPage.viewPromoCodes               
      - log:
          message: Promo Codes Page validation started       
      - log:
         message: View Promo Codes Page when no promo codes are attached to account
      - verifyIdentifier:
             present:   
              - identifier: ca.test.mappings.checkOutPage.viewPromoCodes.promoCodeTitle
              - identifier: ca.test.mappings.checkOutPage.promoCode
              - identifier: ca.test.mappings.checkOutPage.promoCodeDetails
              - identifier: ca.test.mappings.global.closeIcon
              - identifier: ca.test.mappings.checkOutPage.viewPromoCodes.applyPromoCode
      - log:
            message: Successfully Validated Promo Code Page
            color: GREEN_BOLD

  # Feedback popup
  - name: ca.test.functions.checkOut.feedback
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.orderConfirmation.feedbackPopUp
          then:           
            - click:
                identifier: ca.test.mappings.orderConfirmation.feedbackPopUp
            - sleep: 
                duration: 10000
            - click:
                identifier: ca.test.mappings.orderConfirmation.continueShopping
            - sleep: 
                duration: 5000     
                  
  
  # Remove promocode from checkout and open view promocode
  - name: ca.test.functions.checkOut.promoCode.remove
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.reviewOrder.promocode.appliedText 
      - click:
          identifier: ca.test.mappings.reviewOrder.promocode.remove
      - sleep:
          duration: 10000 
#            identifier: ca.test.mappings.checkOutPage.viewPromoCodes

  - name: ca.test.functions.checkout.phoneNumber.enterContactNumber
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.phoneNumberField
          then:
            - enterText:
                identifier: ca.test.mappings.checkout.phoneNumberField
                string: 9876543210
                clickFirst: true
                clearField: true
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.doneButton 
          then:
            - click:
                identifier: ca.test.mappings.global.doneButton
      - executeFunction:
          name: ca.test.functions.checkout.phoneNumber.checkingForCompleteNumber

  - name: ca.test.functions.checkout.phoneNumber.checkingForCompleteNumber
    flow:
      - loop:
          begin: 0
          end: 10
          mode: increment
          flow:
            - getString:
                identifier: ca.test.mappings.checkout.phoneNumberField
                attribute: value
                extractNumbers: true
                storeIn: numberMobile
            - log: ${numberMobile}
            - executeNode:
                file: ca/test/helpers/CheckOut/checkMobileNumberStringLength.js
                args:
                  - value: ${numberMobile}
                getResponse:
                  storeIn: boolean
            - if:
                condition: ${boolean} == true
                then:
                  - break: true
                else:
                  - enterText:
                      identifier: ca.test.mappings.checkout.phoneNumberField
                      string: 1111
                      clickFirst: true
                      clearField: false
                  - click:
                      identifier: Done

  # # Order Confirmation screen validation
  # - name: ca.test.functions.checkout.validateOrderConfirmationPage
  #   platform: ios
  #   flow:
  #     - sleep:
  #         duration: 20000
  #     - if:
  #         condition: ${associateUser} == 'true'
  #         then:
  #           - verifyIdentifier:
  #               present:
  #                 - identifier: //XCUIElementTypeStaticText[contains(@label,"You've saved ${associateDiscount} with your associate discount")]
  #           - log:
  #               message: "Saving banner for assoicate discount is present in order Confirmation."
  #               color: GREEN_BOLD
  #     - verifyIdentifier:
  #         present:
  #           - identifier: ca.test.mappings.orderConfirmation.tickImage
  #           - identifier: ca.test.mappings.orderConfirmation.thanks
  #           - identifier: ca.test.mappings.orderConfirmation.emailId
  #     - if:
  #         condition: ${fulfillmentType} == "In-store pickup"
  #         then:
  #           - identifier: //XCUIElementTypeStaticText[@label="In-store pickup"]
  #           - identifier: //XCUIElementTypeStaticText[@label="In-store pickup"]/following-sibling::XCUIElementTypeOther/XCUIElementTypeStaticText[@name="FulfillmentSummaryView.detailLabel"]
  #           - verifyIdentifier:
  #               label:
  #                 - identifier: //XCUIElementTypeStaticText[@label="In-store pickup"]/following-sibling::XCUIElementTypeOther/XCUIElementTypeStaticText[@name="FulfillmentSummaryView.nameLabel"]
  #                   contains: ${storeName}
  #           - verifyIdentifier:
  #               label:
  #                 - identifier: //XCUIElementTypeStaticText[@label="In-store pickup"]/following-sibling::XCUIElementTypeStaticText[@name="FulfillmentSummaryView.addressLabel"]
  #                   contains: ${storeAddress}
  #           - verifyIdentifier:
                
                
            # - identifier: ca.test.mappings.orderConfirmation.orderNumber
            # - identifier: ca.test.mappings.orderConfirmation.orderAmount
            # - identifier: ca.test.mappings.orderConfirmation.fulfillmentType
            # - identifier: ca.test.mappings.orderConfirmation.fulfillmentAddress
            # - identifier: ca.test.mappings.orderConfirmation.arrivalDate
            # - identifier: ca.test.mappings.orderConfirmation.continueShopping

  - name: ca.test.functions.orderConfirmation.appliedDiscountValidation
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.orderConfirmation.priceSavedText
      - getString:
          identifier: ca.test.mappings.orderConfirmation.priceSavedText
          attribute: text
          storeIn: successMsg
      - log:
          message: ${successMsg} is displayed
          color: GREEN_BOLD

  - name: ca.test.functions.checkOut.chooseSubstitutePreferences
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences
          then:
              - scroll:
                  direction: up
                  untilIdentifier: ca.test.mappings.checkout.chooseSubstitutionPreferences
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences_icon
      - click:
          identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences
      - sleep:
          duration: 5000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences_title
      
  - name: ca.test.functions.checkOut.chooseSubstitutePreferences_validation
    platform: ios
    flow:
        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences_title
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences_textfield
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.AllowsubstitutionText
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.AllowsubstitutioniBtn

  - name: ca.test.functions.checkOut.chooseSubstitutePreferences_ibuttonValidation
    platform: ios
    flow:
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.AllowsubstitutioniBtn
            then:
              - click:
                  identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.AllowsubstitutioniBtn
            else:
              - sleep:
                  duration: 2000
              - click:
                  identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.AllowsubstitutioniBtn
        - sleep:
            duration: 5000
        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.Aboutsubtitle
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.Infotitle
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.Infopoint1
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.Infopoint2
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.Infopoint3
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.Infopoint4
              # - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.Infopoint5
        - click:
            identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.back

  - name: ca.test.functions.checkOut.chooseSubstitutePreferences_disableValidation
    platform: ios
    flow:
        - sleep:
            duration: 1000
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.All
            then:
              - click:
                  identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.togglebuttton
        - sleep:
            duration: 1000
        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.noSubtext
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.noSubiBtn
        - if:
            identifier:
              notPresent:
                - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.editlink
            then:
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.doneBtn
        - click:
            identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.doneBtn
        - sleep:
            duration: 5000


  - name: ca.test.functions.checkOut.chooseSubstitutePreferences_enableValidation
    platform: ios
    flow:
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.noSubtext
            then:
              - click:
                  identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.togglebuttton
        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.All
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.BestMatch
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.editlink
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.doneBtn
              - identifier: ca.test.mappingscheckout.chooseSubstitutionPreferences.Replacetext
        - click:
            identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.BestMatch
        - click:
            identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.All

  - name: ca.test.functions.checkOut.chooseSubstitutePreferences.enable_edit
    platform: ios
    flow:
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.editlink
            then:
                - click:
                    identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.editlink
            else:
                - sleep:
                    duration: 2000
                - click:
                    identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.editlink
        - sleep:
            duration: 5000
        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.If_unavailable
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.If_unavailable_iBtn
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.cancelOption
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.ReplacewithRadioBtn
        - click:
            identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.ReplacewithRadioBtn
        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.All
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.BestMatch
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.If_item_unavailable
              - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.doneBtn
        - sleep:
            duration: 2000
        - click:
            identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.selectOption      
        - sleep:
            duration: 5000
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.editlink_2
            then:
                - click:
                    identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.editlink_2
            else:
                - sleep:
                    duration: 2000
                - click:
                    identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.editlink_2
        - sleep:
            duration: 10000
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.dontReplaceBtn
            then:
              - click:
                  identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.dontReplaceBtn
        - click:
            identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.selectOption
        - click:
            identifier: ca.test.mappings.checkout.chooseSubstitutionPreferences.doneBtn
        - sleep:
            duration: 5000
   
   # Validating Disabled Preferred Substitution option
  - name: ca.test.functions.checkout.disablePreferredSubstitution
    platform: android
    flow:
      - sleep:
          duration: 2000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkOutPage.reviewOrderText
            - identifier: ca.test.mappings.checkoutPage.fullfillmentType 
            - identifier: ca.test.mappings.checkoutPage.placeOrderButton
      - if: 
          identifier:
            notPresent:
              - identifier: ca.test.mappings.checkoutPage.preferredSubstitutionLink 
          then:
            - scroll:
                direction: down
                untilIdentifier: ca.test.mappings.checkoutPage.preferredSubstitutionLink
                timeout: 5000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkoutPage.preferredSubstitutionLogo 
            - identifier: ca.test.mappings.checkoutPage.preferredSubstitutionLink
      - click:
          identifier: ca.test.mappings.checkoutPage.preferredSubstitutionLink 
      - sleep:
          duration: 2000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.substitutionPreferencePage.SubPreferenceHeading 
            - identifier: ca.test.mappings.substitutionPreferencePage.closeButton 
            - identifier: ca.test.mappings.substitutionPreferencePage.subPrefText  
            - identifier: ca.test.mappings.substitutionPreferencePage.allowSubstitutionText  
            - identifier: ca.test.mappings.substitutionPreferencePage.aboutSubstitutionLink 
            - identifier: ca.test.mappings.substitutionPreferencePage.toggleButton 
            - identifier: ca.test.mappings.substitutionPreferencePage.FilterAll  
            - identifier: ca.test.mappings.substitutionPreferencePage.filterBestMatch  
            - identifier: ca.test.mappings.substitutionPreferencePage.editButton 
      - getString:
          identifier: ca.test.mappings.substitutionPreferencePage.subPrefText   
          attribute: text
          storeIn: subPreferencePopup
      - log:
          message: ${subPreferencePopup} 
          color: GREEN_BOLD
      - getString:
          identifier: ca.test.mappings.substitutionPreferencePage.allowSubstitutionText  
          attribute: text
          storeIn: substitutionHeading
      - log:
          message: ${substitutionHeading} 
          color: GREEN_BOLD
      - click:
          identifier: ca.test.mappings.substitutionPreferencePage.aboutSubstitutionLink  
      - sleep:
          duration: 2000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.aboutSubstitutionPage.aboutSubstitutionHeading   
            - identifier: ca.test.mappings.aboutSubstitutionPage.aboutSubstitutionText  
      - getString:
          identifier: ca.test.mappings.aboutSubstitutionPage.aboutSubstitutionHeading  
          attribute: text
          storeIn: aboutSubstitutionHeading
      - log:
          message: ${aboutSubstitutionHeading} 
          color: GREEN_BOLD
      - getString:
          identifier: ca.test.mappings.aboutSubstitutionPage.aboutSubstitutionText
          attribute: text
          storeIn: aboutSubstitutionText
      - log:
          message: ${aboutSubstitutionText} 
          color: GREEN_BOLD
      - loop:
           begin: 1
           end: 5
           storeIndex: i
           mode: increment
           flow:
             - getString:
                 identifier: (//android.widget.TextView[@resource-id="ca.walmart.ecommerceapp.qa:id/text"])[${i}]
                 attribute: text
                 storeIn: aboutSubstitutionPoints 
             - log: 
                 message: Print ${i} About Substitution Point
                 color: GREEN_BOLD
             - log: 
                 message: About Substitution Points are ${aboutSubstitutionPoints}
                 color: GREEN_BOLD 
      - goBack: true
      - sleep: 
          duration: 2000
      - click:
          identifier: ca.test.mappings.substitutionPreferencePage.toggleButton  
      - verifyIdentifier:
          notPresent:
            - identifier: ca.test.mappings.substitutionPreferencePage.FilterAll  
            - identifier: ca.test.mappings.substitutionPreferencePage.FilterBestMatch  
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.substitutionPreferencePage.noSubstitutionText 
            - identifier: ca.test.mappings.substitutionPreferencePage.doneButton  
      - verifyIdentifier:
          notPresent:
            - identifier: ca.test.mappings.substitutionPreferencePage.editButton  
      - click:
          identifier: ca.test.mappings.substitutionPreferencePage.doneButton 
      - sleep:
          duration: 2000
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.checkoutPage.preferredSubstitutionLogo 
            - identifier: ca.test.mappings.checkoutPage.preferredSubstitutionLink 
      - log:
          message: Preferred substitution logo and link are present 
          color: GREEN_BOLD
        
  - name: ca.test.functions.checkout.drivertipOptionValidation
    platform: ios
    flow:
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.driverTipHeading
            then:
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.checkout.driverTip.driverTipHeading
                    - identifier: ca.test.mappings.checkout.driverTip.iButton
                    - identifier: ca.test.mappings.checkout.driverTip.driverTipSubHeading
         
  - name: ca.test.functions.checkout.zeroDriverTip
    platform: ios
    flow:
        - scroll:
            direction: down
            scrollLimit: 1
        - sleep:
            duration: 500
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.customBox
            then:
              - click:
                  identifier: ca.test.mappings.checkout.driverTip.customBox
            else:
              - scroll:
                  direction: down
                  untilIdentifier: ca.test.mappings.checkout.driverTip.customBox
              - click:
                  identifier: ca.test.mappings.checkout.driverTip.customBox
        - loop:
            begin: 0
            end: 6
            mode: increment
            flow:
                - click:
                    identifier: ca.test.mappings.keyboard.delete
        - enterText:
            identifier: ca.test.mappings.checkout.driverTip.customBox
            clearField: true
            string: "0"
        - click:
            identifier: ca.test.mappings.wallet.done
        - sleep:
            duration: 5000
        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.checkout.driverTip.zeroUpdatedCustomizedBox
        # - hideKeyboard: true
        - scroll:
            direction: down
            untilIdentifier: ca.test.mappings.cart.estimatedTotalText
        - if:
            identifier:
              notPresent:
                - identifier: ca.test.mappings.checkout.driverTip.driverTipMoneyBox
            then:
              - log:
                  message: driver tip is not present in money box!

  - name: ca.test.functions.checkout.EnterdripvertipCustomBox
    platform: ios
    flow:
        - scroll:
            direction: down
            scrollLimit: 1
        - sleep:
            duration: 500
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.customBox
            then:
              - click:
                  identifier: ca.test.mappings.checkout.driverTip.customBox
            else:
              - scroll:
                  direction: down
                  untilIdentifier: ca.test.mappings.checkout.driverTip.customBox
              - click:
                  identifier: ca.test.mappings.checkout.driverTip.customBox
        - loop:
            begin: 0
            end: 6
            mode: increment
            flow:
                - click:
                    identifier: ca.test.mappings.keyboard.delete
        - enterText:
            identifier: ca.test.mappings.checkout.driverTip.customBox
            clearField: true
            string: ${CustomTipAmount}
        - click:
            identifier: ca.test.mappings.wallet.done
        - sleep:
            duration: 5000

  - name: ca.test.functions.checkout.dripvertipErrorMsgValidaion
    platform: ios
    flow:
        - executeFunction:
            name: ca.test.functions.checkout.EnterdripvertipCustomBox
        # - hideKeyboard: true
        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.checkout.driverTip.tipUpto100ErrorMsg

  - name: ca.test.functions.checkout.dripvertip100Scenario
    platform: ios
    flow:
        - executeFunction:
            name: ca.test.functions.checkout.EnterdripvertipCustomBox
        # - hideKeyboard: true
        - scroll:
            direction: down
            untilIdentifier: ca.test.mappings.cart.estimatedTotalText
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.driverTipMoneyBox
            then:
                - sleep:
                    duration: 1000
                - verifyIdentifier:
                    present:
                      - identifier: ca.test.mappings.checkout.driverTip.DTamountMB
                      - identifier: ca.test.mappings.checkout.driverTip.DTpercentageMB
        - log:
            message: driver tip is present in money box and the Amount is $ ${tipAmount} & the percentage is ${tipPercentage} %!

  - name: ca.test.functions.checkout.dripvertipMoneyBoxValidation
    platform: ios
    flow:
        - sleep:
            duration: 500
        - scroll:
            direction: down
            untilIdentifier: ca.test.mappings.cart.estimatedTotalText
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.driverTipMoneyBox
            then:
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.checkout.driverTip.DTamountMB
                    - identifier: ca.test.mappings.checkout.driverTip.DTpercentageMB
        - click:
            identifier: ca.test.mappings.checkOutPage.backToCart
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.yourAlmostTherePopUp
            then:
              - click:
                  identifier: ca.test.mappings.cart.leaveAnyWayBtn
        - sleep:
            duration: 5000
        - scroll:
            direction: down
            untilIdentifier: ca.test.mappings.cart.estimatedTotalText
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.driverTipMoneyBox
            then:
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.checkout.driverTip.DTamountMB
                    - identifier: ca.test.mappings.checkout.driverTip.DTpercentageMB


  - name: ca.test.functions.checkout.drivertipiBtnValidation
    platform: ios
    flow:
        - scroll:
            direction: up
            untilIdentifier: ca.test.mappings.checkout.driverTip.driverTipHeading
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.iButton
            then:
              - click: 
                    identifier: ca.test.mappings.checkout.driverTip.iButton
              - sleep:
                  duration: 500
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.checkout.driverTip.DTdetailsHeading
                    - identifier: ca.test.mappings.checkout.driverTip.DTdetails
                    - identifier: ca.test.mappings.filter.popUpClose
              - click:
                  identifier: ca.test.mappings.filter.popUpClose
        - sleep:
            duration: 1000
        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.checkout.driverTip.driverTipSubHeading
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.customTip
            then:
              - click: 
                    identifier: ca.test.mappings.checkout.driverTip.customTip
              - sleep:
                  duration: 1000
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.checkout.driverTip.enterCustomTip

  - name: ca.test.functions.checkout.drivertipPercentageValidation
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - scroll:
          direction: down
          untilIdentifier: ca.test.mappings.cart.subTotalText
      - sleep:
          duration: 5000
      - getString:
          identifier: ca.test.mappings.checkout.subTotalValue
          attribute: value
          storeIn: subTotal
      - log:
          message: subtotal is ${subTotal}
      - executeNode:
          file: ca/test/helpers/DriverTip/DTpercentageCalculation.js
          args:
            - value: ${subTotal}
          getResponse:
            storeIn: DTpriceinHeading
      - scroll:
          direction: up
          untilIdentifier: ca.test.mappings.checkout.driverTip.driverTipHeading
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.driverTip.driverTipHeading
          then:
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkout.driverTip.driverTipPrice
#2. Use this output value from .js file to validate default tip and % value on the checkout page.
#3. Validate the third value is defaulted and selected.
#4. Validate the third value(default selected value) is shown in money box with %.
      - log:
          message: calculated value and precentage was validated!
          color: GREEN_BOLD

  - name: ca.test.functions.checkout.drivertipOptionValidation
    platform: ios
    flow:
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.driverTipHeading
            then:
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.checkout.driverTip.driverTipHeading
                    - identifier: ca.test.mappings.checkout.driverTip.iButton
                    - identifier: ca.test.mappings.checkout.driverTip.driverTipSubHeading

  - name: ca.test.functions.checkout.zeroDriverTip
    platform: ios
    flow:
        - scroll:
            direction: down
            scrollLimit: 1
        - sleep:
            duration: 500
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.customBox
            then:
              - click:
                  identifier: ca.test.mappings.checkout.driverTip.customBox
            else:
              - scroll:
                  direction: down
                  untilIdentifier: ca.test.mappings.checkout.driverTip.customBox
              - click:
                  identifier: ca.test.mappings.checkout.driverTip.customBox
        - loop:
            begin: 0
            end: 6
            mode: increment
            flow:
                - click:
                    identifier: ca.test.mappings.keyboard.delete
        - enterText:
            identifier: ca.test.mappings.checkout.driverTip.customBox
            clearField: true
            string: "0"
        - click:
            identifier: ca.test.mappings.wallet.done
        - sleep:
            duration: 5000

        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.checkout.driverTip.zeroUpdatedCustomizedBox
        # - hideKeyboard: true
        - scroll:
            direction: down
            untilIdentifier: ca.test.mappings.cart.estimatedTotalText
        - if:
            identifier:
              notPresent:
                - identifier: ca.test.mappings.checkout.driverTip.driverTipMoneyBox
            then:
              - log:
                  message: driver tip is not present in money box!

  - name: ca.test.functions.checkout.EnterdripvertipCustomBox
    platform: ios
    flow:
        - scroll:
            direction: down
            scrollLimit: 1
        - sleep:
            duration: 500
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.customBox
            then:
              - click:
                  identifier: ca.test.mappings.checkout.driverTip.customBox
            else:
              - scroll:
                  direction: down
                  untilIdentifier: ca.test.mappings.checkout.driverTip.customBox
              - click:
                  identifier: ca.test.mappings.checkout.driverTip.customBox
        - loop:
            begin: 0
            end: 6
            mode: increment
            flow:
                - click:
                    identifier: ca.test.mappings.keyboard.delete
        - enterText:
            identifier: ca.test.mappings.checkout.driverTip.customBox
            clearField: true
            string: ${CustomTipAmount}
        - click:
            identifier: ca.test.mappings.wallet.done
        - sleep:
            duration: 5000

  - name: ca.test.functions.checkout.dripvertipErrorMsgValidaion	
    platform: ios	
    flow:
        - executeFunction:
            name: ca.test.functions.checkout.EnterdripvertipCustomBox	
        # - hideKeyboard: true
        - verifyIdentifier:
            present:
              - identifier:  ca.test.mappings.checkout.driverTip.tipUpto100ErrorMsg         

  - name: ca.test.functions.checkout.dripvertip100Scenario
    platform: ios
    flow:
        - executeFunction:
            name: ca.test.functions.checkout.EnterdripvertipCustomBox
        # - hideKeyboard: true
        - scroll:
            direction: down
            untilIdentifier: ca.test.mappings.cart.estimatedTotalText
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.driverTipMoneyBox
            then:
                - sleep:
                    duration: 1000
                - verifyIdentifier:
                    present:
                      - identifier: ca.test.mappings.checkout.driverTip.DTamountMB
                      - identifier: ca.test.mappings.checkout.driverTip.DTpercentageMB
        - log:
            message: driver tip is present in money box and the Amount is $ ${tipAmount} & the percentage is ${tipPercentage} %!

  - name: ca.test.functions.checkout.dripvertipMoneyBoxValidation
    platform: ios
    flow:
        - sleep:
            duration: 500
        - scroll:
            direction: down
            untilIdentifier: ca.test.mappings.cart.estimatedTotalText
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.driverTipMoneyBox
            then:
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.checkout.driverTip.DTamountMB
                    - identifier: ca.test.mappings.checkout.driverTip.DTpercentageMB
        - click:
            identifier: ca.test.mappings.checkOutPage.backToCart
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.yourAlmostTherePopUp
            then:
              - click:
                  identifier: ca.test.mappings.cart.leaveAnyWayBtn
        - sleep:
            duration: 5000
        - scroll:
            direction: down
            untilIdentifier: ca.test.mappings.cart.estimatedTotalText
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.driverTipMoneyBox
            then:
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.checkout.driverTip.DTamountMB
                    - identifier: ca.test.mappings.checkout.driverTip.DTpercentageMB


  - name: ca.test.functions.checkout.drivertipiBtnValidation
    platform: ios
    flow:
        - scroll:
            direction: up
            untilIdentifier: ca.test.mappings.checkout.driverTip.driverTipHeading
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.iButton
            then:
              - click: 
                    identifier: ca.test.mappings.checkout.driverTip.iButton
              - sleep:
                  duration: 500
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.checkout.driverTip.DTdetailsHeading
                    - identifier: ca.test.mappings.checkout.driverTip.DTdetails
                    - identifier: ca.test.mappings.filter.popUpClose
              - click:
                  identifier: ca.test.mappings.filter.popUpClose
        - sleep:
            duration: 1000
        - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.checkout.driverTip.driverTipSubHeading
        - if:
            identifier:
              present:
                - identifier: ca.test.mappings.checkout.driverTip.customTip
            then:
              - click: 
                    identifier: ca.test.mappings.checkout.driverTip.customTip
              - sleep:
                  duration: 1000
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.checkout.driverTip.enterCustomTip

#   - name: ca.test.functions.checkout.drivertipPercentageValidation
#     platform: ios
#     flow:
#       - sleep:
#           duration: 5000
#       - scroll:
#           direction: down
#           untilIdentifier: ca.test.mappings.cart.subTotalText
#       - sleep:
#           duration: 5000
#       - getString:
#           identifier: ca.test.mappings.checkout.subTotalValue
#           attribute: value
#           storeIn: subTotal
#       - log:
#           message: subtotal is ${subTotal}
#       - executeNode:
#           file: ca/test/helpers/DriverTip/DTpercentageCalculation.js
#           args:
#             - value: ${subTotal}
#           getResponse:
#             storeIn: DTpriceinHeading
#       - scroll:
#           direction: up
#           untilIdentifier: ca.test.mappings.checkout.driverTip.driverTipHeading
#       - if:
#           identifier:
#             present:
#               - identifier: ca.test.mappings.checkout.driverTip.driverTipHeading
#           then:
#             - verifyIdentifier:
#                 present:
#                   - identifier: ca.test.mappings.checkout.driverTip.driverTipPrice
# #2. Use this output value from .js file to validate default tip and % value on the checkout page.
# #3. Validate the third value is defaulted and selected.
# #4. Validate the third value(default selected value) is shown in money box with %.
#       - log:
#           message: calculated value and precentage was validated!
#           color: GREEN_BOLD

  - name: ca.test.functions.checkOut.driverTipPercentageCalculation
    platform: ios
    flow:
      - log:
          message: "Driver tip percentage calculation"
          color: GREEN_BOLD
      - sleep:
          duration: 5000
      - scroll:
          direction: down
          untilIdentifier: ca.test.mappings.cart.subTotalText
      - sleep:
          duration: 5000
      - getString:
          identifier: ca.test.mappings.checkout.subTotalValue
          attribute: value
          storeIn: subTotal
      - log:
          message: subtotal is ${subTotal}
      - sleep:
          duration: 5000
      - scroll:
          direction: up
          untilIdentifier: ca.test.mappings.checkout.driverTip.driverTipHeading
      - sleep:
          duration: 2000
      - loop:
          begin: 1
          storeIndex: i
          mode: increment
          end: 5
          flow:
            - sleep:
                duration: 1000
            - if:
                identifier:
                  present:
                    - identifier: ca.test.mappings.checkout.driverTipdefaultValues
                then:
                  - getString:
                      identifier: ca.test.mappings.checkout.driverTipdefaultValues
                      attribute: label
                      storeIn: defaultValue
                  - log:
                      message: default Value is ${defaultValue}
            - executeNode:
                file: ca/test/helpers/CheckOut/extractPriceandPercentage.js
                args:
                    - value: ${tipPercent}
                    - value: ${tipAmount}
                    - value: ${defaultValue}
            - log:
                message: ${tipPercent}
            - log:
                message: ${tipAmount}
            - executeNode:
                file: ca/test/helpers/CheckOut/driverTipCalculation.js
                args:
                    - value: ${tipPercent}
                    - value: ${tipAmount}
                    - value: ${subTotal}
                    - value: ${i}
                getResponse:
                  storeIn: flag
            - if:
                condition: ${flag} == "true"
                then:
                  - log:
                     message: Driver Tip amount is the expected value

  - name: ca.test.functions.checkOut.driverTipCalculation
    platform: android
    flow:
      - log:
          message: "Driver tip percentage calculation"
          color: GREEN_BOLD  
      - scroll:
          direction: down
          untilIdentifier: ca.test.mappings.checkout.driverTip.driverTipHeading
          timeout: 5000
      - loop:
          begin: 1          
          storeIndex: i
          mode: increment
          end: 5
          flow:
            - getString:
                identifier: ca.test.mappings.checkOut.driverTipPercent
                attribute: text
                storeIn: Percent
            - log:
                message: DriverTip is Percent ${Percent}
            - getString:
               identifier: ca.test.mappings.checkOut.driverTippingAmount
               attribute: text
               storeIn: Amount
            - log:
                message: Driver tip amount ${Amount}
            - executeNode:
                file: ca/test/helpers/CheckOut/driverTipCalculationvalidation.js
                args:
                  - value: ${Percent}
                  - value: ${Amount}
                  - value: ${subTotal}
                  - value: ${i}
                getResponse:
                  storeIn: flag
            - log:
                message: value returned from js file ${flag}                     
            - if:
                condition: "${flag} == true"
                then: 
                - log:
                    message: Driver Tip amount is the expected value
                else:
                  - log:
                      message: Test case failed
                  - failTest: true                    

  - name: ca.test.functions.cart.driverTip.moneyBoxValidation
    platform: android
    flow:
      - click:
          identifier: ca.test.mappings.checkOutPage.backToCart
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.yourAlmostTherePopUp
          then:
            - click:
                identifier: ca.test.mappings.cart.leaveAnyWayBtn
      - sleep:
          duration: 5000
      - scroll:
          direction: down
          untilIdentifier: ca.test.mappings.cart.estimatedTotalText
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.checkout.driverTip.driverTipMoneyBox
          then:
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.checkout.driverTip.amount
                  - identifier: ca.test.mappings.checkout.driverTip.percentage


  