functions:
  - name: ca.test.functions.global.onboarding.navigateOnboardingToHome
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
          then:
            - startActivity:
                packageName: ${APP_PACKAGE:ca.walmart.ecommerceapp.qa}
                activityName: com.walmart.glass.integration.splash.SplashActivity
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
          then:
            - click: 
                identifier: ca.test.mappings.global.onboarding.welcomeContinueButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.locationScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeButton  
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
      - enterText:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
          string: ca.test.data.onboarding.albertaPostalCode
      - hideKeyboard: true
      - click:
          wait: 5000
          identifier: ca.test.mappings.global.onboarding.searchButton
      - click:
          wait: 40000
          identifier: ca.test.mappings.personlaizeShoppingAllow
      - verifyIdentifier:
          timeout: 50000
          notPresent:
            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
      - executeFunction:
          name: ca.test.functions.utils.tryAgainWhenThereIsError
      - verifyIdentifier:
          present:
           - identifier: ca.test.mappings.home.signInButton

# Onboarding by sharing zip code
  - name: ca.test.functions.global.onboarding.navigateOnboardingToHome.paramZip
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
          then:
            - startActivity:
                packageName: ${APP_PACKAGE:ca.walmart.ecommerceapp.qa}
                activityName: com.walmart.glass.integration.splash.SplashActivity
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.mainScreenText
      - click: 
          identifier: ca.test.mappings.global.onboarding.welcomeContinueButton
      - log:
          message: "Click on contiune button"
          color: GREEN_BOLD
      - verifyIdentifier:
          notPresent:
            - identifier: ca.mappings.onboarding.continueButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.locationScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeButton 
      - log:
          message: "Clicking on enter zipCode button"
          color: GREEN_BOLD
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
      - enterText:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
          string: ${ZIP_CODE}
      - hideKeyboard: true
      - click:
          wait: 3000
          identifier: ca.test.mappings.global.onboarding.searchButton
      - log:
          message: "Clicked on the seach button"
          color: GREEN_BOLD
      - verifyIdentifier:
          timeout: 30000
          notPresent:
            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
      - executeFunction:
          name: ca.test.functions.utils.tryAgainWhenThereIsError
      - sleep:
          duration: 7000
      - executeFunction:
          name: ca.test.functions.utils.personalizedExperiencePopUp
      - verifyIdentifier:
          timeout: 15000
          present:
            - identifier: ca.test.mappings.home.signInButton
      - log:
          message: "Onboarding Successful."
          color: GREEN_BOLD
      - executeFunction:
          name: ca.test.functions.utils.restartapp      
  
  # - name: ca.test.functions.global.onboarding.navigateiosOnboardingToHome
  #   platform: ios
  #   flow:
  #     - if:
  #         identifier:
  #           present:
  #             - identifier: ca.test.mappings.global.onboarding.mainScreenText
  #         then:
  #           - click: 
  #               identifier: ca.test.mappings.global.onboarding.continue
  #     - verifyIdentifier:
  #         present:
  #           - identifier: ca.test.mappings.global.onboarding.notificationScreenText
  #           - identifier: ca.test.mappings.global.onboarding.getNotificationButton
  #     - click:
  #         identifier: ca.test.mappings.global.onboarding.mayBeLaterButton
  #     - verifyIdentifier:
  #         present:
  #           - identifier: ca.test.mappings.global.onboarding.locationScreenText
  #     - click:
  #         identifier: ca.test.mappings.global.onboarding.enterZipCodeButton  
  #     - verifyIdentifier:
  #         present:
  #           - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
  #           - identifier: ca.test.mappings.global.onboarding.useCurrentLocationLink
  #     - click:
  #         identifier: ca.test.mappings.global.onboarding.enterZipCodeField
  #     - enterText:
  #         identifier: ca.test.mappings.global.onboarding.enterZipCodeField
  #         string: ca.test.data.onboarding.zipcode
  #     - hideKeyboard: true
  #     - click:
  #         wait: 5000
  #         identifier: ca.test.mappings.global.onboarding.searchButton  
  #     - sleep:
  #        duration: 5000
  #     # - verifyIdentifier:
  #     #     # timeout: 50000
  #     #     notPresent:
  #     #       - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText 
  #     - if:
  #         identifier:
  #           present:
  #             - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText 
  #         then:
  #            - executeFunction:
  #                 name: ca.test.mappings.global.onboarding.relaunchApp      
  #         else: 
  #             - sleep:
  #                 duration: 5000
  #             - if:
  #                 identifier:
  #                   present:
  #                     - identifier: ca.test.mappings.global.onboarding.personalisedExperienceText
  #                 then:
  #                   - click: 
  #                       identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton     
  #             # - verifyIdentifier:
  #             #     present:
  #             #       - identifier: ca.test.mappings.global.onboarding.personalisedExperienceText
  #             # - click:
  #             #     identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton
  #             # - verifyIdentifier:
  #             #     present:
  #             #       - identifier: ca.test.mappings.global.onboarding.personaliseExperienceAllowtext
  #                   - click:
  #                       identifier: ca.test.mappings.global.onboarding.personaliseExperienceAllow
  #             - executeFunction:
  #                 name: ca.test.functions.utils.tryAgainWhenThereIsErrorIos
  #     # - executeFunction:
  #     #           name: ca.test.functions.global.navigation.goToDeepLink1
  #     # #terminate and relaunch the app
  #     # - executeFunction:
  #     #     name: ca.test.functions.utils.terminateApp
  #     # - executeFunction:
  #     #     name: ca.test.functions.utils.relaunchApp

  - name: ca.test.functions.global.onboarding.navigateiosOnboardingToHome
    platform: ios
    flow:
      - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
      - click: 
          identifier: ca.test.mappings.global.onboarding.continue
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.notificationScreenText
            - identifier: ca.test.mappings.global.onboarding.getNotificationButton
      - click:
          identifier: ca.test.mappings.global.onboarding.mayBeLaterButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.locationScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeButton  
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
            - identifier: ca.test.mappings.global.onboarding.useCurrentLocationLink
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
      - enterText:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
          string: ca.test.data.onboarding.zipcode
      - hideKeyboard: true
      - click:
          wait: 5000
          identifier: ca.test.mappings.global.onboarding.searchButton  
      - sleep:
         duration: 5000
      - loop:
          begin: 1
          end: 3
          mode: increment
          flow:
            - try:
                flow:
                  - verifyIdentifier:
                      timeout: 15000
                      notPresent:
                        - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText 
                  - break: true
                catch:
                  flow:
                    - if:
                        identifier:
                          present:
                            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText 
                        then:
                          - executeFunction:
                              name: ca.test.mappings.global.onboarding.relaunchApp  
                        else:
                          - failTest: true  
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.personalisedExperienceText
          then:
            - click: 
                identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton     
            - click:
                identifier: ca.test.mappings.global.onboarding.personaliseExperienceAllow
      - executeFunction:
          name: ca.test.functions.utils.tryAgainWhenThereIsErrorIos
      #terminate and relaunch the app
      - executeFunction:
          name: ca.test.functions.utils.terminateApp
      - executeFunction:
          name: ca.test.functions.utils.relaunchApp      

  #ios onboarding
  - name: ca.test.functions.global.onboarding.iosOnboarding
    platform: ios
    flow:
      - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
      - click: 
          identifier: ca.test.mappings.global.onboarding.continue
      - verifyIdentifier:
          present:
            - identifier: ca.mappings.global.onboarding.notificationScreenText
            - identifier: ca.test.mappings.global.onboarding.getNotificationButton
      - click:
          identifier: ca.test.mappings.global.onboarding.mayBeLaterButton

  #ios postal code entry
  - name: ca.test.functions.global.onboarding.postalCodeEntry
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.locationScreenText
          then:
            - click:
                identifier: ca.test.mappings.global.onboarding.enterZipCodeButton
            - enterText:
                identifier: ca.test.mappings.global.onboarding.enterZipCodeField
                string: ca.test.data.onboarding.zipcodeON
            - hideKeyboard: true
            - click:
                wait: 2000
                identifier: ca.mappings.global.onboarding.searchButton
            - verifyIdentifier:
                timeout: 50000
                notPresent:
                  - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
      - if:
          identifier:
            present:
              - identifier: ca.mappings.global.onboarding.enablePreciseLocationButton
          then:
            - click:
                identifier: ca.mappings.global.onboarding.enablePreciseLocationButton
            - click:
                identifier: ca.mappings.global.onboarding.personalizedScreen.allowButton
      - if:
          identifier:
            present:
              - identifier: ca.mappings.global.onboarding.personalizedScreen
          then:
            - click:
                identifier: ca.mappings.global.onboarding.continueButton
            - click:
                identifier: ca.mappings.global.onboarding.personalizedScreen.allowButton

  # Onboarding by sharing zip code
  - name: ca.test.functions.global.onboarding.navigateOnboardingToHome.usingShareLocation
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
          then:
            - startActivity:
                packageName: ${APP_PACKAGE:ca.walmart.ecommerceapp.qa}
                activityName: com.walmart.glass.integration.splash.SplashActivity
          else:
            - startActivity:
                packageName: ca.walmart.ecommerceapp.qa
                activityName: com.walmart.glass.integration.splash.SplashActivity
            - sleep:
                duration: 5000
            - log:
                message: "Onboarding displayed, flow will navigate through."
                color: CYAN
            - executeFunction:
                name: ca.functions.onboarding.tapContinueBtn
            # - failTest:
            #     message: "Onboarding not displayed."  
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
          then:
            - click: 
                identifier: ca.test.mappings.global.onboarding.welcomeContinueButton
      - verifyIdentifier:
          notPresent:
            - identifier: ca.test.mappings.global.onboarding.welcomeContinueButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.locationScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.sharePreciseLocation
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.allowDeviceLocationAccess
      - click:
          identifier: ca.test.mappings.deliveryAddress.add.allowLocationPermission
      - verifyIdentifier:
          timeout: 90000
          notPresent:
            - identifier: ca.test.mappings.deliveryAddress.add.allowLocationPermission
      - executeFunction:
          name: ca.test.functions.utils.tryAgainWhenThereIsError
      - sleep:
          duration: 7000
      - executeFunction:
          name: ca.test.functions.utils.personalizedExperiencePopUp
      - verifyIdentifier:
          timeout: 15000
          present:
            - identifier: ca.test.mappings.home.signInButton

# Onboarding by sharing zip code
  - name: ca.test.functions.global.onboarding.navigateOnboardingToHome.paramZipCode
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
          then:
            - log:
                message: Restarting app with different app package
                color: GREEN_BOLD
            - startActivity:
                packageName: ${APP_PACKAGE:ca.walmart.ecommerceapp.qa}
                activityName: com.walmart.glass.integration.splash.SplashActivity
      - verifyIdentifier:
          timeout: 20000
          present:
            - identifier: ca.test.mappings.global.onboarding.mainScreenText
      - click: 
          identifier: ca.test.mappings.global.onboarding.welcomeContinueButton
      - log:
          message: "Click on contiune button"
          color: GREEN_BOLD
      - verifyIdentifier:
          notPresent:
            - identifier: ca.test.mappings.global.onboarding.welcomeContinueButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.locationScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeButton 
      - log:
          message: "Clicking on enter zipCode button"
          color: GREEN_BOLD
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
      - enterText:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
          string: ${ZIP_CODE}
      - hideKeyboard: true
      - click:
          wait: 3000
          identifier: ca.test.mappings.global.onboarding.searchButton
      - log:
          message: "Clicked on the seach button"
          color: GREEN_BOLD

  - name: ca.test.functions.onboarding.enterZipCode
    flow:
      - verifyIdentifier: 
          present:
            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
      - enterText:
          identifier: ca.mappings.onboarding.sharePostalCode.title
          string: ${zipCode}
          clearField: true
      - hideKeyboard: true
      - click:
          wait: 5000
          identifier: ca.test.mappings.global.onboarding.searchButton
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.personalisedExperienceText   
          then:
            - click:
                identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton
      - sleep:
         duration: 3000
      - click:
          wait: 40000
          identifier: ca.test.mappings.personlaizeShoppingAllow 
      - verifyIdentifier:
          timeout: 50000
          notPresent:
            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
      - executeFunction:
          name: ca.test.functions.utils.tryAgainWhenThereIsError
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.home.searchBarSelected
            - identifier: ca.test.mappings.home.seeTimes
          
  - name: ca.test.functions.global.onboarding.onboardingIos
    platform: ios
    flow:
      - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
      - click: 
          identifier: ca.test.mappings.global.onboarding.continue
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.notificationScreenText
            - identifier: ca.test.mappings.global.onboarding.getNotificationButton
      - click:
          identifier: ca.test.mappings.global.onboarding.mayBeLaterButton
      - sleep:
         duration: 3000
      # - verifyIdentifier:
      #     present:
      #       - identifier: ca.test.mappings.global.onboarding.locationScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeButton  
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
            - identifier: ca.test.mappings.global.onboarding.useCurrentLocationLink
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
      - enterText:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
          string: ${zipCode}
      - hideKeyboard: true
      - click:
          wait: 2000
          identifier: ca.test.mappings.global.onboarding.searchButton
      - sleep:
         duration: 3000    

# Onboarding by sharing zip code
  - name: ca.test.functions.global.onboarding.navigateOnboardingToHome.usingShareLocation
    platform: ios
    flow:
      - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
      - click: 
          identifier: ca.test.mappings.global.onboarding.continue
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.notificationScreenText
            - identifier: ca.test.mappings.global.onboarding.getNotificationButton
      - click:
          identifier: ca.test.mappings.global.onboarding.mayBeLaterButton         
      - verifyIdentifier:
          timeout: 5000
          present:
            - identifier: ca.test.mappings.global.onboarding.locationScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.sharePreciseLocation
      - sleep:
          duration: 3000    
      - verifyIdentifier:
          present:
            - identifier: ca.mappings.global.onboarding.allowOnceButton
      - click:
          identifier: ca.mappings.global.onboarding.allowOnceButton         
      # - verifyIdentifier:
      #     timeout: 90000
      #     notPresent:
      #       - identifier: ca.test.mappings.global.onboarding.locationScreenText
      # - executeFunction:
      #     name: ca.test.functions.utils.tryAgainWhenThereIsErrorIos
      # - sleep:
      #     duration: 5000
      # - executeFunction:
      #     name: ca.test.functions.utils.personalizedExperiencePopUp
      - sleep:
         duration: 5000
      - loop:
          begin: 1
          end: 3
          mode: increment
          flow:
            - try:
                flow:
                  - verifyIdentifier:
                      timeout: 15000
                      notPresent:
                        - identifier: ca.test.mappings.global.onboarding.locationScreenText 
                  - break: true
                catch:
                  flow:
                    - if:
                        identifier:
                          present:
                            - identifier: ca.test.mappings.global.onboarding.locationScreenText
                        then:
                          - executeFunction:
                              name: ca.test.mappings.global.onboarding.relaunchApp2  
                        else:
                          - failTest: true  
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.personalisedExperienceText
          then:
            - click: 
                identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton     
            - click:
                identifier: ca.test.mappings.global.onboarding.personaliseExperienceAllow
      - executeFunction:
          name: ca.test.functions.utils.tryAgainWhenThereIsErrorIos 
      - sleep:
          duration: 3000
      - if:
          identifier:
            present:
              - identifier: GlobalIntentCenter.BannerExpandedChevron
          then:
            - click:
                identifier: GlobalIntentCenter.BannerExpandedChevron
      - verifyIdentifier:
          timeout: 15000
          present:   
            - identifier: ca.test.mappings.home.searchBarSelected
            - identifier: ca.test.mappings.home.seeTimes
      #terminate and relaunch the app
      - executeFunction:
          name: ca.test.functions.utils.terminateApp
      - executeFunction:
          name: ca.test.functions.utils.relaunchApp 
         
  - name: ca.test.functions.global.onboarding.navigateiosOnboardingToHomeparamZip
    platform: ios
    flow:     
      - verifyIdentifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
      - click: 
          identifier: ca.test.mappings.global.onboarding.continue
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.notificationScreenText
            - identifier: ca.test.mappings.global.onboarding.getNotificationButton
      - click:
          identifier: ca.test.mappings.global.onboarding.mayBeLaterButton

      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.locationScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
            - identifier: ca.test.mappings.global.onboarding.useCurrentLocationLink
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
      - enterText:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
          string: ${ZIP_CODE}
      - hideKeyboard: true
      - click:
          wait: 5000
          identifier: ca.test.mappings.global.onboarding.searchButton
      - sleep:
         duration: 5000
      - loop:
          begin: 1
          end: 3
          mode: increment
          flow:
            - try:
                flow:
                  - verifyIdentifier:
                      timeout: 15000
                      notPresent:
                        - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText 
                  - break: true
                catch:
                  flow:
                    - if:
                        identifier:
                          present:
                            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText 
                        then:
                          - executeFunction:
                              name: ca.test.mappings.global.onboarding.relaunchApp1
                        else:
                          - failTest: true  
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.personalisedExperienceText
          then:
            - click: 
                identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton     
            - click:
                identifier: ca.test.mappings.global.onboarding.personaliseExperienceAllow
      - executeFunction:
          name: ca.test.functions.utils.tryAgainWhenThereIsErrorIos 
      - if:
          identifier:
            timeout: 8000
            present:
              - identifier: GlobalIntentCenter.BannerExpandedChevron
          then:
            - click:
                identifier: GlobalIntentCenter.BannerExpandedChevron
      - executeFunction:
          name: ca.test.functions.utils.terminateApp
      - executeFunction:
          name: ca.test.functions.utils.relaunchApp                   
      # - verifyIdentifier:
      #     timeout: 50000
      #     notPresent:
      #       - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
      # - verifyIdentifier:
      #     present:
      #       - identifier: ca.test.mappings.global.onboarding.personalisedExperienceText
      # - click:
      #     identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton
      # - verifyIdentifier:
      #     present:
      #       - identifier: ca.test.mappings.global.onboarding.personaliseExperienceAllowtext
      # - click:
      #     identifier: ca.test.mappings.global.onboarding.personaliseExperienceAllow
      # - executeFunction:
      #     name: ca.test.functions.utils.tryAgainWhenThereIsErrorIos
      # - sleep:
      #     duration: 5000
      # - if:
      #     identifier:
      #       present:
      #         - identifier: GlobalIntentCenter.BannerExpandedChevron
      #     then:
      #       - click:
      #           identifier: GlobalIntentCenter.BannerExpandedChevron

# validate the store in HP

  # - name: ca.test.functions.HP.validateStoreinHP
  #   platform: ios
  #   flow:
  #     - if:
  #         identifier:
  #           notPresent:
  #             - identifier: ca.test.mappings.store.storeName
  #         then:
  #           - sleep:
  #               duration: 1000
  #           - verifyIdentifier:
  #               present:
  #                 - identifier: ca.test.mappings.store.storeName
  #         else:
  #           - verifyIdentifier:
  #               present:
  #                 - identifier: ca.test.mappings.store.storeName

# validate the store in cart

  - name: ca.test.functions.HP.validateStoreinCart
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.cart.pickupInstead
          then:
            - click:
                identifier: ca.test.mappings.cart.pickupInstead
            - sleep:
                duration: 500
          else:
              - verifyIdentifier:
                  present:
                    - identifier: ca.test.mappings.cart.pickupHeading
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mapping.cart.shippingAddressCart
          then:
            - sleep:
                duration: 1000
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mapping.cart.shippingAddressCart
                  - identifier: ca.test.mappings.cart.pickupStoreinCart
          else:
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mapping.cart.shippingAddressCart
                  - identifier: ca.test.mappings.cart.pickupStoreinCart

# # validate the address in HP

#   - name: ca.test.functions.HP.validateAddressinHP
#     platform: ios
#     flow:
#       - if:
#           identifier:
#             notPresent:
#               - identifier: ca.test.mappings.HP.address
#           then:
#             - sleep:
#                 duration: 1000
#             - verifyIdentifier:
#                 present:
#                   - identifier: ca.test.mappings.HP.address
#           else:
#             - verifyIdentifier:
#                 present:
#                   - identifier: ca.test.mappings.HP.address

# change Address in HP
  - name: ca.test.functions.HP.changeAddressinHP
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.HP.address
          then:
            - sleep:
                duration: 1000
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.HP.address
          else:
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.HP.address
            - click:
                identifier: ca.test.mappings.HP.address
            - click:
                identifier:  ca.test.mappings.cart.addressinCart_1
            - click:
                identifier: ca.test.mappings.amendOrder.saveButton

# validate the address in cart

  - name: ca.test.functions.HP.validateAddressinCart
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.cart.delivery.pickup.shipInstead
          then:
            - click:
                identifier: ca.test.mappings.cart.delivery.pickup.shipInstead
            - sleep:
                duration: 500
          # else:
          #     - verifyIdentifier:
          #         present:
          #           - identifier: ca.test.mappings.cart.shippingHeading
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.cart.shippingHeading
          then:
            - sleep:
                duration: 1000
            - verifyIdentifier:
                present:
                  # - identifier:  ca.test.mappings.cart.shippingHeading
                  - identifier: ca.test.mappings.cart.addressinCart
          else:
            - verifyIdentifier:
                present:
                  # - identifier:  ca.test.mappings.cart.shippingHeading
                  - identifier: ca.test.mappings.cart.addressinCart

# Relaunch app due to onboarding issue
  - name: ca.test.mappings.global.onboarding.relaunchApp
    platform: ios
    flow:
      - executeFunction:
          name: ca.test.functions.utils.terminateApp
      - executeFunction:
          name: ca.test.functions.utils.relaunchApp
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
          then:
            - click: 
                identifier: ca.test.mappings.global.onboarding.continue
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.notificationScreenText
            - identifier: ca.test.mappings.global.onboarding.getNotificationButton
      - click:
          identifier: ca.test.mappings.global.onboarding.mayBeLaterButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.locationScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeButton  
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
            - identifier: ca.test.mappings.global.onboarding.useCurrentLocationLink
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
      - enterText:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
          string: ca.test.data.onboarding.zipcode
      - hideKeyboard: true
      - click:
          wait: 5000
          identifier: ca.test.mappings.global.onboarding.searchButton  
      - sleep:
          duration: 5000    
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.personalisedExperienceText
          then:
            - click: 
                identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton     
            - click:
                identifier: ca.test.mappings.global.onboarding.personaliseExperienceAllow
      - executeFunction:
          name: ca.test.functions.utils.tryAgainWhenThereIsErrorIos    

# Relaunch app due to onboarding issue
  - name: ca.test.mappings.global.onboarding.relaunchApp1
    platform: ios
    flow:
      - executeFunction:
          name: ca.test.functions.utils.terminateApp
      - executeFunction:
          name: ca.test.functions.utils.relaunchApp
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
          then:
            - click: 
                identifier: ca.test.mappings.global.onboarding.continue
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.notificationScreenText
            - identifier: ca.test.mappings.global.onboarding.getNotificationButton
      - click:
          identifier: ca.test.mappings.global.onboarding.mayBeLaterButton
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.locationScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeButton  
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.shareZipCodeScreenText
            - identifier: ca.test.mappings.global.onboarding.useCurrentLocationLink
      - click:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
      - enterText:
          identifier: ca.test.mappings.global.onboarding.enterZipCodeField
          string: ca.test.data.remoteLocation
      - hideKeyboard: true
      - click:
          wait: 5000
          identifier: ca.test.mappings.global.onboarding.searchButton  
      - sleep:
          duration: 5000    
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.personalisedExperienceText
          then:
            - click: 
                identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton     
            - click:
                identifier: ca.test.mappings.global.onboarding.personaliseExperienceAllow
      - executeFunction:
          name: ca.test.functions.utils.tryAgainWhenThereIsErrorIos 


# Relaunch app due to onboarding issue
  - name: ca.test.mappings.global.onboarding.relaunchApp2
    platform: ios
    flow:
      - executeFunction:
          name: ca.test.functions.utils.terminateApp
      - executeFunction:
          name: ca.test.functions.utils.relaunchApp
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.mainScreenText
          then:
            - click: 
                identifier: ca.test.mappings.global.onboarding.continue
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.notificationScreenText
            - identifier: ca.test.mappings.global.onboarding.getNotificationButton
      - click:
          identifier: ca.test.mappings.global.onboarding.mayBeLaterButton
      - sleep:
         duration: 5000          
      - verifyIdentifier:
          present:
            - identifier: ca.test.mappings.global.onboarding.locationScreenText
      - click:
          identifier: ca.test.mappings.global.onboarding.sharePreciseLocation
      - sleep:
          duration: 3000    
      - verifyIdentifier:
          present:
            - identifier: ca.mappings.global.onboarding.allowOnceButton
      - click:
          identifier: ca.mappings.global.onboarding.allowOnceButton
      - sleep:
          duration: 5000    
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: ca.test.mappings.global.onboarding.personalisedExperienceText
          then:
            - click: 
                identifier: ca.test.mappings.global.onboarding.personaliseExperiencecontinueButton     
            - click:
                identifier: ca.test.mappings.global.onboarding.personaliseExperienceAllow
      - executeFunction:
          name: ca.test.functions.utils.tryAgainWhenThereIsErrorIos 

  - name: ca.test.functions.HP.validateStoreinHP
    platform: ios
    flow:
      - if:
          identifier:
             present:
              - identifier: ca.test.mappings.globalIntent.collapsedChevron
          then:
            - click:
                identifier: ca.test.mappings.globalIntent.collapsedChevron
            - sleep:
                duration: 1000
            - click:
               identifier: ca.test.mappings.homePage.globalIntentCenter.pickUp
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.store.storeName 
            - click:
               identifier: ca.test.mappings.homePage.globalIntentCenter.pickUpSelected     
            - click:
                identifier: ca.test.mappings.globalIntent.expandedChervon      
          else:
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.store.storeName 
            - click:
               identifier: ca.test.mappings.homePage.globalIntentCenter.pickUpSelected    
            - click:
                identifier: ca.test.mappings.globalIntent.expandedChervon

# validate the address in HP
  - name: ca.test.functions.HP.validateAddressinHP
    platform: ios
    flow:
      - if:
          identifier:
             present:
              - identifier: ca.test.mappings.globalIntent.collapsedChevron
          then:
            - click:
                identifier: ca.test.mappings.globalIntent.collapsedChevron
      - sleep:
          duration: 1000
      - click:
          identifier: ca.test.mappings.homePage.globalIntentCenter.deliveryIntent    
      - if:
          identifier:
            notPresent:
              - identifier: ca.test.mappings.HP.address
          then:
            - sleep:
                duration: 1000
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.HP.address
            - click:
                identifier: ca.test.mappings.homePage.globalIntentCenter.deliveryIntentSelected        
          else:
            - verifyIdentifier:
                present:
                  - identifier: ca.test.mappings.HP.address 
            - click:
                identifier: ca.test.mappings.homePage.globalIntentCenter.deliveryIntentSelected
      - executeFunction:
          name: ca.test.functions.utils.tryAgainWhenThereIsErrorIos                                 


  - name: ca.test.functions.onboarding.wrongZipCodeError
    flow:
      - verifyIdentifier:
          timeout: 5000
          present:
            - identifier: ca.test.mappings.onboarding.errorMessage
      - log:
          message: "Wrong zip code error message validation successful"
          color: GREEN_BOLD