functions:

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This flow Validate all the onboarding pages and navigates to the app using geo location
  # Param  No Param
  - name: ca.test.functions.onboarding.validate$NavigateToHomeUsingGeoLocation
    flow: 
      - executeFunction:
          name: ca.functions.onboarding.isOnboardingDisplayed
      - if:
          condition: ${returnedIsDisplayed} == true
          then:
            - log:
                message: "Onboarding displayed, flow will navigate through."
                color: CYAN
            - executeFunction:
                name: ca.functions.onboarding.tapContinueBtn
          else:
#----------------------------------------------xx----------------------------------------------------
            - startActivity:
                packageName: ca.walmart.ecommerceapp.qa
                activityName: com.walmart.glass.integration.splash.SplashActivity
            - sleep:
                duration: 5000
            - log:
                message: "Onboarding displayed, flow will navigate through."
                color: CYAN
            - executeFunction:
                name: ca.functions.onboarding.tapContinueBtn
#----------------------------------------------xx----------------------------------------------------
            # - failTest:
            #     message: "Onboarding not displayed."
      - executeFunction:
          name: ca.test.functions.onboarding.isNotificationDisplayed
      - if:
          condition: ${returnedIsDisplayed} == true
          then:
            - log:
                message: "Notification displayed"
                color: CYAN
            - executeFunction:
                name: ca.test.functions.onboarding.validateNotificationPage
            - executeFunction:
                name: ca.test.functions.onboarding.allowNotification
          else:
            - log:
                message: "Notification not displayed"
                color: CYAN
      - executeFunction:
          name: ca.functions.onboarding.validateShareLocation$LearnMoreLink
      - executeFunction:
          name: ca.test.functions.onboarding.shareLocation.tapEnterPostalCodeLink
      - executeFunction:
          name: ca.test.functions.onboarding.validateShareYourPostalCodePage
      - executeFunction:
          name: ca.test.functions.onboarding.sharePostalCode.tapUseCurrentLocation
      - executeFunction:
          name: ca.test.functions.onboarding.shareLocation.sharePreciseLocation
      - executeFunction:
          name: ca.test.functions.onboarding.validatePersonalisedExperienceScreen
      - executeFunction:
          name: ca.test.functions.onboarding.personalisedExperience.tapAllow
      - executeFunction:
          name: ca.test.functions.globalIntent.refreshCCM
      - sleep:
          duration: 5000
      - log:
          message: "End flow: onboarding.validate$NavigateToHomeUsingGeoLocation"
          color: GREEN_BOLD_BRIGHT

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This flow Validate all the onboarding pages and navigates to the app using geo location
  # Param  ${PostalCode}  [Mandatory] User postal code to enter the App
  - name: ca.test.functions.onboardingToHomePage.usingPostalCode
    flow: 
      - executeFunction:
          name: ca.functions.onboarding.isOnboardingDisplayed
      - if:
          condition: ${returnedIsDisplayed} == true
          then:
            - log:
                message: "Onboarding displayed, flow will navigate through."
                color: CYAN
            - executeFunction:
                name: ca.functions.onboarding.tapContinueBtn
          else:
#----------------------------------------------xx----------------------------------------------------
            - startActivity:
                packageName: ca.walmart.ecommerceapp.qa
                activityName: com.walmart.glass.integration.splash.SplashActivity
            - sleep:
                duration: 5000
            - log:
                message: "Onboarding displayed, flow will navigate through."
                color: CYAN
            - executeFunction:
                name: ca.functions.onboarding.tapContinueBtn
#----------------------------------------------xx------------------------------------------------------
            # - failTest:
            #     message: "Onboarding not displayed."
      - executeFunction:
          name: ca.test.functions.onboarding.isNotificationDisplayed
      - if:
          condition: ${returnedIsDisplayed} == true
          then:
            - log:
                message: "Notification displayed"
                color: CYAN
            - executeFunction:
                name: ca.test.functions.onboarding.dismissNotification
          else:
            - log:
                message: "Notification not displayed"
                color: CYAN
      - executeFunction:
          name: ca.test.functions.onboarding.shareLocation.tapEnterPostalCodeLink
      - executeFunction:
          name: ca.test.functions.onboarding.enterPostalCode    # <-- ${PostalCode}
      - executeFunction:
          name: ca.test.functions.onboarding.sharePostalCode.tapSearchButton
      - if:
          condition: ${invalidPostalCode} == true
          then:
            - executeFunction:
                name: ca.test.functions.onboarding.sharePostalCode.validateErrorMsg
          else:
            - executeFunction:
                name: ca.test.functions.onboarding.personalisedExperience.tapAllow
            - executeFunction:
                name: ca.test.functions.globalIntent.refreshCCM
            - sleep:
                duration: 5000
      - log:
          message: "End flow: onboardingToHomePage.usingPostalCode (no validation)"
          color: GREEN_BOLD_BRIGHT
