functions:

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This functions verify promotional badge label
  # param: ${promotionalBadge}    [Mandatory]  Badge name to enter 
  - name: ca.test.functions.searchPage.verifyPromotionalBadgeLabelText
    platform: ios
    flow:  
      - verifyIdentifier:
          label:
            - identifier: ca.test.mappings.pdp.promotionalBadges 
              contains: ${promotionalBadge}   
      - log:
          message: "End functions: search.verifyPromotionalBadgeLabelText"
          color: BLUE   

  #--------------------------------------------------------------------------------------------------------------------
  
  # Description: This functions get the first product name in seach result page
  # No params
  - name: ca.test.functions.search.getProductName
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: ca.test.mapping.searchPage.productDetails
      - getString:
          identifier: ca.test.mapping.searchPage.productDetails
          attribute: label
          storeIn: productName
      - executeNode:
          file: ca/test/helpers/sanitizeProductName.js
          args:
            - value: ${productName}
          getResponse:
            storeIn: productTitle
      - log:
          message: "Product name: ${productTitle}!"
          color: BLUE
      - log:
          message: "End function: search.getProductName"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This functions gets the product price after adding to cart
  # param:       ${quantity}    [Mandatory]  Quantity to add to cart
  - name: ca.test.functions.searchPage.getProductCost
    platform: ios
    flow:
      - getString:
          identifier: ca.test.mapping.searchPage.productCost
          attribute: value
          storeIn: productValue
      - executeNode:
          file: ca/test/helpers/global/extractingProductCost.js
          args:
            - value: ${productValue}
          getResponse:
            storeIn: productCost
      - log:
          message: "Removing string from the product value... ${productCost}"
          color: GREEN_BOLD
      - log:
          message: Product added to cart
          color: GREEN_BOLD
      - executeNode:
          file: ca/test/helpers/sanitizePrice.js
          args:
            - value: ${productCost}
          getResponse:
            storeIn: productPrice
      - log: 
          message: ${productPrice}
          color: GREEN_BOLD       
      - if:
          condition: ${totalPrice} != "null"
          then:
            - arithmetic:
                expression: ${totalPrice} + (${productPrice} * ${quantity})
                storeIn: totalPrice
          else:
            - arithmetic:
                expression: ${productPrice} * ${quantity}
                storeIn: totalPrice
      - log: 
          message: "Total product price...${totalPrice}"
          color: GREEN_BOLD
      - log:
          message: "End function: searchPage.getProductCost"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------
