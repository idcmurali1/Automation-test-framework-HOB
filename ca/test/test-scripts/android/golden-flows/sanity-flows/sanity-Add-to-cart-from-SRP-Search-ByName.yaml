general:
  platform: android
  tags: sanitya2cByName, Android-Development-Build-Sanity
  inherit:
    filesRunAll:
      - ca-errors-helpers.yaml

scenarios:
  - name: Before
    before: false
    endTestOnFailure: true
    flow:
      - log: Execute before scenarios

# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      - log: 'R2_SUBFLOW_PRE_TRANSACTION'
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  
  - name: Login as a registered user and search for a product using name and a2c from SRP. Validate the product added to cart and place order
    flow:
      - log:
          message: Login as a registered user and search for a product using name and a2c from SRP. Validate the product added to cart and place order
          color: GREEN_BOLD

      - log:
          message: Onboarding to app using postal code.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.global.onboarding.navigateOnboardingToHome.paramZip
          params:
            - name: ZIP_CODE
              string: ca.test.data.orleansZipCode

      - log:
          message: Navigating to Sign In to account from home page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.home.signIn

      - log:
          message: Putting user credentials.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.global.authentication.signInAccount
          params:
            - name: email
              string: sanityProdDevByName@test.com
            - name: password
              string: ca.test.android.data.flow001.password

      - log:
          message: Selecting store at home page.
          color: GREEN_BOLD

      # Selecting store at home
      - executeFunction:
          name: ca.test.functions.home.GICPhase2.selectStore
          params:
            - name: Zip_Code
              string: ca.test.data.flow001.zipCode
            - name: storeName
              string: ca.test.data.flow001.storeName

      #Checking for item and removing it
      - executeFunction:
          name: ca.test.functions.productSearch.checkItemsInCartAndRemovingThem

      - log:
          message: Searching for a product with sku.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.searchAProduct
          params:
            - name: product
              string: Dyna-Glo DGN576DNC-D X-Large Heavy-Duty Charcoal Grill

      # Add to cart
      - executeFunction:
          name: ca.test.functions.productSearch.addToCart
          params:
            - name: productName
              string: Dyna-Glo DGN576DNC-D X-Large Heavy-Duty Charcoal Grill
            - name: quantity
              string: 1

      - log:
          message: Asserting cart quantity.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.cart.assertCartQuantity
          params:
            - name: cartQuantity
              string: 1

# # * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      - log: 'R2_SUBFLOW_TRANSACTION'
# # * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

      - log:
          message: Navigating to cart.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.global.navigation.goToCart

      # Cart product details validation
      - executeFunction:
          name: ca.test.functions.cart.verifyProductTitle
          params:
            - name: productName
              string: Dyna-Glo DGN576DNC-D X-Large Heavy-Duty Charcoal Grill
            - name: quantity
              string: 1

      # Proceed to Checkout
      - executeFunction:
          name: ca.test.functions.cart.proceedToCheckOut

      # Adding CVV
      - sleep:
          duration: 90000
      - executeFunction:
          name: ca.test.functions.checkOut.payment.addCVV
          params:
            - name: cvv
              string: ca.test.android.data.flow001.cvvNumber

      # Entering Mobile number
      - executeFunction:
          name: ca.test.functions.checkOut.mobileContact.enterMobileNumber
          params:
            - name: phoneNumber
              string: 9876543210

      # Placing Order
      - executeFunction:
          name: ca.test.functions.checkOut.PlacingOrder

  #After Scenarios
  - name: After
    after: true
    flow:
      - executeFunction:
          name: ca.test.functions.utils.afterSteps 