general:
  platform: android
  tags: srp-001, ca-function-run
  testCaseId: srp-001
  inherit:
    filesRunAll:
      - ca-errors-helpers.yaml

scenarios:
  - name: Before
    before: true
    endTestOnFailure: false
    flow:
      - executeFunction:
          name: ca.test.functions.onboardingToHomePage.usingPostalCode
          params:
            - name: PostalCode
              string: ca.test.data.orleansZipCode

      - executeFunction:
          name: ca.test.functions.home.signIn

      - executeFunction:
          name: ca.test.functions.loginPage.userLogin
          params:
            - name: email
              string: ca.test.data.srp001.email
            - name: password
              string: ca.test.data.srp001.password

      - executeFunction:
          name: ca.test.functions.home.selectStore
          params:
            - name: Zip_Code
              string: ca.test.data.orleansZipCode
            - name: storeName
              string: ca.test.data.orleansStoreName

      # Clear cart
      - executeFunction:
          name: ca.test.functions.productSearch.checkItemsInCartAndRemovingThem

  - name: Verify if Search functionality is enabled in home and browse tab(SRP)
    flow:
      - try:
          flow:
            - executeFunction:
                name: ca.test.function.home.searchFunctionalityValidation
          catch:
            flow:
              - failTest: true
      
  - name: Search with L1 Categories items and validate the product
    flow:
      - try:
          flow:
            - executeFunction:
                name: ca.test.functions.productSearch.searchAProduct
                params:
                  - name: product
                    string: ca.test.data.l1Category

            - executeFunction:
                name: ca.test.functions.productSearch.validatingSRPPage

          catch:
            flow:
              - failTest: true

  - name: Search with product name and Check for Type Ahead functionality
    flow:
      - try:
          flow:
            - executeFunction:
                name: ca.test.functions.productSearch.validatingTypeAheadFunctionality
                params:
                  - name: product
                    string: ca.test.data.GMl1Category
          catch:
            flow:
              - failTest: true

  - name: Search for Single Variant item and Validate add to cart from SRP
    flow:
      - try:
          flow:
            - executeFunction:
                name: ca.test.functions.productSearch.searchAProduct
                params: 
                  - name: product
                    string: ca.test.data.singleVariantItem

            - log: 
                message: Extracting first product name from SRP.
                color: GREEN_BOLD
            
            - executeFunction:
                name: ca.test.functions.productSearch.extractingFirstProductName

            - log: 
                message: Storing product name to a variable.
                color: GREEN_BOLD

            - storeIn:
                key: go_item
                value: ${productName}

            - log: 
                message: Adding product to cart and extracting product price.
                color: GREEN_BOLD

            - executeFunction:
                name: ca.test.functions.productSearch.addToCartCostExtractionSRP
                params:
                  - name: quantity
                    string: ca.test.data.product_1_qty

            - log: 
                message: Storing product cost to a variable
                color: GREEN_BOLD

          catch:
            flow:
              - failTest:
                  message: Add to cart failed.

  #After Scenarios
  - name: After
    after: true
    flow:
      - executeFunction:
          name: ca.test.functions.utils.afterSteps 