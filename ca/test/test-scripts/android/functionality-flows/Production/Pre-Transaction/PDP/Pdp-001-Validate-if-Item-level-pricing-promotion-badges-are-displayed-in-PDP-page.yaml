general:
  platform: android
  tags: ca-function-run, pdp-001
  testCaseId: pdp-001
  inherit:
    filesRunAll:
      - ca-errors-helpers.yaml

scenarios:
  - name: Before
    before: false
    endTestOnFailure: false
    flow:
      - log: Execute before scenarios.

# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      - log: 'R2_SUBFLOW_PRE_TRANSACTION'
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  
  - name: Validating badges in PDP page.
    flow:
      - log:
          message: Validating badges in PDP page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.onboardingToHomePage.usingPostalCode
          params:
            - name: PostalCode
              string: ca.test.data.orleansZipCode

      - log: 
          message: Navigating to Sign In Page
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.home.signIn

      - log: 
          message: Registered user Sign In.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.loginPage.userLogin
          params:
            - name: email
              string: ca.test.data.pdp001.emailId
            - name: password
              string: ca.test.data.functional.password

      # Remove Item from cart
      - executeFunction:
          name: ca.test.functions.productSearch.checkItemsInCartAndRemovingThem

      - log: 
          message: Searching for a GM product
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.function.home.walmartFavourites
          params:
            - name: walmartFavourites
              string: Clearance
            - name: productCategory
              string: Appliances
      
      - log: 
          message: Scrolling to product with clearance badge
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.basedOnPromotionalBadge
          params:
            - name: promotionalBadge
              string: ca.test.data.badges.clearance
      
      - log: 
          message: Extracting product name with clearance badge
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.nameExtractionBasedOnPromotionalBadge
          params:
            - name: promotionalBadge
              string: ca.test.data.badges.clearance
      
      - log: 
          message: Storing the product name in variable
          color: GREEN_BOLD

      - storeIn:
          key: ClearanceProduct
          value: ${itemName}

      - log: 
          message: Navigating to PDP page of the product.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.prod.srpToPdpPage
          params:
            - name: productName
              string: ${ClearanceProduct}

      - log: 
          message: Validating promotional badge in PDP page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.pdp.validatingPromotionalDetails
          params:
            - name: productName
              string: ${ClearanceProduct}
            - name: promotionalBadge
              string: ca.test.data.badges.clearance

      - log: 
          message: Closing PDP page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.PDPpage.closePDPpage

      - executeFunction:
          name: ca.functions.searchPage.searchItemArray
          params:
            - name: items
              string: ca.test.data.pdp001.gmRollbackBadgeArray
            - name: quantity
              string: ca.test.data.pdp001.gmRollbackBadgeQty
            - name: promotionalBadge
              string: ca.test.data.badges.rollback
            - name: checkPromotionBadges
              string: true  

      # - executeFunction:
      #     name: ca.test.functions.productSearch.searchAProduct
      #     params:
      #       - name: product
      #         string: ca.test.data.productName.bedSheet

      # - log: 
      #     message: Scrolling to product with rollback badge
      #     color: GREEN_BOLD

      # - executeFunction:
      #     name: ca.test.functions.productSearch.basedOnPromotionalBadge
      #     params:
      #       - name: promotionalBadge
      #         string: ca.test.data.badges.rollback

      # - log: 
      #     message: Extracting product name with Rollback badge
      #     color: GREEN_BOLD

      # - executeFunction:
      #     name: ca.test.functions.productSearch.nameExtractionBasedOnPromotionalBadge
      #     params:
      #       - name: promotionalBadge
      #         string: ca.test.data.badges.rollback

      # - log: 
      #     message: Storing the product name in variable
      #     color: GREEN_BOLD

      # - storeIn:
      #     key: rollbackProduct
      #     value: ${itemName}

      # - scroll:
      #     direction: down

      - log: 
          message: Navigating to PDP page of the product.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.prod.srpToPdpPage
          params:
            - name: productName
              string: ${productName}

      - log: 
          message: Validating promotional badge in PDP page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.pdp.validatingPromotionalDetails
          params:
            - name: productName
              string: ${productName}
            - name: promotionalBadge
              string: ca.test.data.badges.rollback

      - log: 
          message: Closing PDP page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.PDPpage.closePDPpage

      - executeFunction:
          name: ca.functions.searchPage.searchItemArray
          params:
            - name: items
              string: ca.test.data.pdp001.gmReducedPriceBadgeArray
            - name: quantity
              string: ca.test.data.pdp001.gmReducedPriceBadgeQty
            - name: promotionalBadge
              string: ca.test.data.badges.reducedPrice
            - name: checkPromotionBadges
              string: true   

      # - executeFunction:
      #     name: ca.test.functions.productSearch.searchAProduct
      #     params:
      #       - name: product
      #         string: ca.test.data.GM.productName

      # - log: 
      #     message: Scrolling to product with Reduced Price badge
      #     color: GREEN_BOLD

      # - executeFunction:
      #     name: ca.test.functions.productSearch.basedOnPromotionalBadge
      #     params:
      #       - name: promotionalBadge
      #         string: ca.test.data.badges.reducedPrice

      # - log: 
      #     message: Extracting product name with Reduced Price badge
      #     color: GREEN_BOLD

      # - executeFunction:
      #     name: ca.test.functions.productSearch.nameExtractionBasedOnPromotionalBadge
      #     params:
      #       - name: promotionalBadge
      #         string: ca.test.data.badges.reducedPrice
      
      # - log: 
      #     message: Storing the product name in variable
      #     color: GREEN_BOLD

      # - storeIn:
      #     key: reducedPriceProduct
      #     value: ${itemName}

      - log: 
          message: Navigating to PDP page of the product.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.prod.srpToPdpPage
          params:
            - name: productName
              string: ${productName}

      - log: 
          message: Validating promotional badge in PDP page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.pdp.validatingPromotionalDetails
          params:
            - name: productName
              string: ${productName}
            - name: promotionalBadge
              string: ca.test.data.badges.reducedPrice

      - log: 
          message: Closing PDP page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.PDPpage.closePDPpage

      - log: 
          message: Searching for a GO product
          color: GREEN_BOLD

      - executeFunction:
          name: ca.functions.searchPage.searchItemArray
          params:
            - name: items
              string: ca.test.data.pdp001.goRollbackBadgeArray
            - name: quantity
              string: ca.test.data.pdp001.goRollbackBadgeQty
            - name: promotionalBadge
              string: ca.test.data.badges.rollback
            - name: checkPromotionBadges
              string: true  

      # - executeFunction:
      #     name: ca.test.functions.productSearch.searchAProduct
      #     params:
      #       - name: product
      #         string: ca.test.data.product.shampoo

      # - log: 
      #     message: Scrolling to product with Rollback badge
      #     color: GREEN_BOLD

      # - executeFunction:
      #     name: ca.test.functions.productSearch.basedOnPromotionalBadge
      #     params:
      #       - name: promotionalBadge
      #         string: ca.test.data.badges.rollback
      
      # - log: 
      #     message: Extracting product name with rollback badge
      #     color: GREEN_BOLD

      # - executeFunction:
      #     name: ca.test.functions.productSearch.nameExtractionBasedOnPromotionalBadge
      #     params:
      #       - name: promotionalBadge
      #         string: ca.test.data.badges.rollback

      # - log: 
      #     message: Storing the product name in variable
      #     color: GREEN_BOLD

      # - storeIn:
      #     key: ClearanceProduct
      #     value: ${itemName}

      - log: 
          message: Navigating to PDP page of the product.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.prod.srpToPdpPage
          params:
            - name: productName
              string: ${productName}

      - log: 
          message: Validating promotional badge in PDP page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.pdp.validatingPromotionalDetails
          params:
            - name: productName
              string: ${productName}
            - name: promotionalBadge
              string: ca.test.data.badges.rollback

      - log: 
          message: Closing PDP page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.PDPpage.closePDPpage

      - log: 
          message: Searching for a GO product
          color: GREEN_BOLD

      - executeFunction:
          name: ca.functions.searchPage.searchItemArray
          params:
            - name: items
              string: ca.test.data.pdp001.goMultisaveBadgeArray
            - name: quantity
              string: ca.test.data.pdp001.goMultisaveBadgeQty
            - name: promotionalBadge
              string: ca.test.data.badges.multiSave
            - name: checkPromotionBadges
              string: true   

      # - executeFunction:
      #     name: ca.test.functions.productSearch.searchAProduct
      #     params:
      #       - name: product
      #         string: ca.test.data.product.meat

      # - log: 
      #     message: Scrolling to product with Rollback badge
      #     color: GREEN_BOLD

      # - executeFunction:
      #     name: ca.test.functions.productSearch.basedOnSaveBadge
      
      # - log: 
      #     message: Extracting product name with rollback badge
      #     color: GREEN_BOLD

      # - executeFunction:
      #     name: ca.test.functions.productSearch.nameExtractionBasedOnMultiSavePromotionalBadge

      # - log: 
      #     message: Storing the product name in variable
      #     color: GREEN_BOLD

      # - storeIn:
      #     key: MultiSaveProduct
      #     value: ${itemName}

      # - sleep:
      #     duration: 10000

      - log: 
          message: Navigating to PDP page of the product.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.prod.srpToPdpPage
          params:
            - name: productName
              string: ${productName}

      - log: 
          message: Validating promotional badge in PDP page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.pdp.validatingMultiSaveBadge
          params:
            - name: badgeText
              string: ca.test.data.badges.multiSave

      - log: 
          message: Closing PDP page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.PDPpage.closePDPpage

  #After Scenarios
  - name: After
    after: true
    flow:
      - executeFunction:
          name: ca.test.functions.utils.afterSteps