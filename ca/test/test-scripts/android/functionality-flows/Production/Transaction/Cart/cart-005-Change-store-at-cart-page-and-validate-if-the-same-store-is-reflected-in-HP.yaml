

general:
  platform: android
  tags: ca-function-run, cart-005
  testCaseId: cart-005
  inherit:
    filesRunAll:
      - ca-errors-helpers.yaml

scenarios:
  - name: Before
    before: false
    endTestOnFailure: true
    flow:
      - log:
          message: Before scenarios.
          color: GREEN_BOLD


# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      - log: 'R2_SUBFLOW_PRE_TRANSACTION'
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

  - name: Validate store shown in cart is same as HP. Then change the store in cart page and validate same is updated in HP.
    flow:
      - log:
          message: Validate store shown in cart is same as HP. Then change the store in cart page and validate same is updated in HP.
          color: GREEN_BOLD

      - log:
          message: Onboarding to app using T6N0A9.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.onboardingToHomePage.usingPostalCode
          params:
            - name: PostalCode
              string: ca.test.data.cart010.onboarding.zipCodeT6N0A9

      - log:
          message: Navigating to Sign In to account from home page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.home.signIn

      - log:
          message: Putting user credentials.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.loginPage.userLogin
          params:
            - name: email
              string: ca.test.data.cart005.emailID
            - name: password
              string: ca.test.data.functional.password

      # Remove Item from cart
      - executeFunction:
          name: ca.test.functions.productSearch.checkItemsInCartAndRemovingThem

      - log:
          message: Selecting store at home page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.home.selectStore
          params:
            - name: Zip_Code
              string: ca.test.data.orleansZipCode
            - name: storeName
              string: ca.test.data.orleansStoreName

      - log:
          message: Searching a product with product name.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.functions.searchPage.searchItemArray
          params:
            - name: items
              string: ca.test.data.cart005.gmItemArray
            - name: quantity
              string: ca.test.data.product_1_qty
            - name: checkNonPromotionBadges
              string: true  

      # - executeFunction:
      #     name: ca.test.functions.productSearch.searchAProduct
      #     params:
      #       - name: product
      #         string: ca.test.data.cart005.GMProductName 

      # - log:
      #     message: Extracting product name from SRP.
      #     color: GREEN_BOLD

      # - executeFunction:
      #     name: ca.test.functions.productSearch.extractingFirstProductName

      # - storeIn:
      #     key: gm_item
      #     value: ${productName}
      
      # - log:
      #     message: ${gm_item}
      #     color: GREEN_BOLD

      # - log:
      #     message: Adding product to cart.
      #     color: GREEN_BOLD

      # - executeFunction:
      #     name: ca.test.functions.productSearch.addToCartCostExtractionSRP
      #     params:
      #       - name: quantity
      #         string: ca.test.data.product_1_qty

# # * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      - log: 'R2_SUBFLOW_TRANSACTION'
# # * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

      - log:
          message: Navigating to cart.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.global.navigation.goToCart
      
      - log:
          message: Validating pickup fulfillment tile in cart.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.cart.selectPickupOptions

      - log:
          message: Validating pickup store in cart.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.cart.pickupStoreAssertion
          params:
            - name: storeName
              string: ca.test.data.store.orleans

      - log:
          message: Changing pickup store in cart page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.cart.changePickupStore
          params:
            - name: Zip_Code
              string: ca.test.data.edmontonZipCode
            - name: storeName
              string: ca.test.data.storeName

      - log:
          message: Validating pickup store in cart.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.cart.pickupStoreAssertion
          params:
            - name: storeName
              string: ca.test.data.edmontonSuperCentre

      - log:
          message: Validating pickup store in home page selected in cart page.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.cart.assertingStoreSelectedInCartAtHP
          params:
            - name: storeName
              string: ca.test.data.edmontonStoreNameAssertion

  #After Scenarios
  - name: After
    after: true
    flow:
      - executeFunction:
          name: ca.test.functions.utils.afterSteps