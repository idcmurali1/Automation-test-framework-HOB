general:
  platform: ios
  tags: srp-004, ca-function-run
  inherit:
    filesRunAll:
      - ca-errors-helpers.yaml

scenarios:
  - name: Before
    before: true
    endTestOnFailure: false
    flow:
      - log: Execute before steps     
              
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      - log: 'R2_SUBFLOW_PRE_TRANSACTION'
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *      

    # Navigate onboarding to home
      - executeFunction:
          name: ca.test.functions.global.onboarding.navigateiosOnboardingToHome
     
    # SignIn
      - executeFunction:
          name: ca.test.functions.home.navigateHomeToSignInIos
    
      # Login as registered user
      - executeFunction:
          name: ca.test.functions.global.authentication.signInAccountIos
          params:
            - name: email
              string: ca.test.data.srp004_fn.emailios
            - name: password
              string: ca.test.data.srp004_fn.passwordios
      
      - executeFunction:
          name: ca.test.functions.home.verifyUserNameInTopleft
      
      - executeFunction:
          name: ca.test.functions.global.authentication.storeSelect
          params:
            - name: Zip_Code
              string: ca.test.data.onboarding.zipcode
            - name: storeName
              string: ca.test.data.orleansStoreName
      
      # Remove items from cart
      - executeFunction:
          name: ca.test.functions.cart.verifyItemInCart          
              
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      - log: 'R2_SUBFLOW_PRE_TRANSACTION'
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      - log: 
          message: Search badges product and Validate Price Badges on SRP
          color: GREEN_BOLD

      - executeFunction:
          name: ca.test.functions.productSearch.searchAProductIos
          params:
            - name: product
              string: ca.test.data.clearanceItem

      - executeFunction:
          name: ca.test.functions.productSearch.validatingPriceBadges

      - executeFunction:
          name: ca.test.functions.productSearch.clearSearch   

      - log: 
          message: Search for Promotional items and Validate Promotional badges on SRP
          color: GREEN_BOLD         

      - executeFunction:
          name: ca.test.functions.productSearch.searchAProductIos
          params:
            - name: product
              string: ca.test.data.multiSaveItem

      - executeFunction:
          name: ca.test.functions.productSearch.Pdp.validatingPromotionalBadge

      - executeFunction:
          name: ca.test.functions.productSearch.clearSearch   

      - log: 
          message: Search an item which qualifies for item level Price promotion and make sure that badges are displayed correctly(AR,MD etc)
          color: GREEN_BOLD        

      - executeFunction:
          name: ca.test.functions.productSearch.searchAProductIos
          params:
            - name: product
              string: ca.test.data.rollBackItem

      - executeFunction:
          name: ca.test.functions.productSearch.validatingPromotionalBadgeAR$MD
          
      - executeFunction:
          name: ca.test.functions.productSearch.clearSearch     
          
      - storeIn:
          key: testStatus
          value: passed
  
  #After Scenarios
  - name: After
    after: true
    flow:
      - log:
          message: srp-004-ios
          color: GREEN_BOLD
      - executeFunction:
          name: ca.test.functions.utils.afterSteps  