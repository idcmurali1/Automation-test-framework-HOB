general:
  platform: ios
  tags: pdp-004, ca-function-run
  inherit:
    filesRunAll:
      - ca-errors-helpers.yaml

scenarios:
  - name: Before
    before: false
    endTestOnFailure: false
    flow:
      - log: Execute before steps 

# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      - log: 'R2_SUBFLOW_PRE_TRANSACTION'
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  
  - name: Verify information shown related to seller and return for 1P and 3P for GM and 1P for GO in PDP page.
    flow:
      - log:
          message: Verify information shown related to seller and return for 1P and 3P for GM and 1P for GO in PDP page.
          color: GREEN_BOLD

     # Navigate onboarding to home 
      - log:
          message: Onboarding to app and Sign In as registered user
          color: CYAN_BOLD_BRIGHT
      - executeFunction:
          name: ca.test.functions.global.onboarding.navigateiosOnboardingToHome
    
      # Navigate to sign in page
      - executeFunction:
          name: ca.test.functions.home.navigateHomeToSignInIos
       
      # Login us registered user
      - executeFunction:
          name: ca.test.functions.global.authentication.signInAccountIos
          params:
            - name: email
              string: ca.test.data.pdp004Ios.emailId 
            - name: password
              string: ca.test.data.functional.password
      - executeFunction:
          name: ca.test.functions.home.verifyUserNameInTopleft

      # Clear Cart
      - executeFunction:
          name:  ca.test.functions.cart.removeCartItems      
  
      # Search a product
      - log: 
          message: Searching for a GM 1P product.
          color: GREEN_BOLD

      - executeFunction:
          name: ca.functions.searchPage.searchItemArray
          params:
            - name: items
              string: ca.test.data.pdp004.gmItemArray
            - name: quantity
              string: ca.test.data.pdp004.gmItemQty
            - name: checkNonPromotionBadges
              string: true  

      # Navigating to PDP
      - log: 
          message: Navigating to PDP page of the product.
          color: GREEN_BOLD
      - executeFunction:
          name: ca.test.functions.productSearch.prod.srpToPdpPage
          params:
            - name: productName
              string: ${productTitle}        

      # validate the label in PDP page
      - log: 
          message: Validating seller information
          color: GREEN_BOLD             
      - executeFunction:
          name: ca.test.functions.pdp.SellerReturnValidation
          params:
            - name: seller_name
              string: ca.test.data.flow007_fn.seller_1P   

      #close PDP page
      - log: 
          message: Closing PDP page.
          color: GREEN_BOLD     
      - executeFunction:
          name: ca.test.functions.PDPpage.closePDPpage
      - log: 
          message: Searching for a GM 3P product.
          color: GREEN_BOLD    

      - executeFunction:
          name: ca.functions.searchPage.searchItemArray
          params:
            - name: items
              string: ca.test.data.pdp004.3pGmItemArray
            - name: quantity
              string: ca.test.data.pdp004.3pGmItemQty
            - name: checkNonPromotionBadges
              string: true      

      # Navigating to PDP
      - log: 
          message: Navigating to PDP page of the product.
          color: GREEN_BOLD
      - executeFunction:
          name: ca.test.functions.productSearch.prod.srpToPdpPage 
          params:
            - name: productName
              string: ${productTitle}  

      # validate the label in PDP page
      - log: 
          message: Validating seller information
          color: GREEN_BOLD                   
      - executeFunction:
          name: ca.test.functions.pdp.SellerReturnValidation
          params:
            - name: seller_name
              string: ca.test.data.3PSeller.tasharinaCorp

      #close PDP page
      - log: 
         message: Closing PDP page.
         color: GREEN_BOLD
      - executeFunction:
          name: ca.test.functions.PDPpage.closePDPpage

      - executeFunction:
          name: ca.functions.searchPage.searchItemArray
          params:
            - name: items
              string: ca.test.data.pdp004.1pGoItemArray
            - name: quantity
              string: ca.test.data.pdp004.1pGoItemQty
            - name: checkNonPromotionBadges
              string: true        

      # Navigating to PDP page
      - log: 
          message: Navigating to PDP page of the product.
          color: GREEN_BOLD
      - executeFunction:
          name: ca.test.functions.productSearch.prod.srpToPdpPage 
          params:
            - name: productName
              string: ${productTitle}
          
     # Pdp product header validation
      - executeFunction:
          name: ca.test.functions.pdp.productHeaderContainer   
          
      # pdp validation for ingredients
      - executeFunction:
          name: ca.test.functions.pdp.productDetailsValidationIos
          params:
            - name: productType
              string: ca.test.data.productType.GO
      
      # validation for return information
      - log:
            message: Verify information shown related to return
            color: GREEN_BOLD_BRIGHT  
      - executeFunction:
          name: ca.test.functions.pdp.Returnpolicy

      # validation for more setails
      - log:
            message: Verify information shown related to more details
            color: GREEN_BOLD_BRIGHT       
      - executeFunction:
          name: ca.test.functions.pdp.MoreDetails

      - log:
            message: Verify information shown related to ingredients for 1P in PDP page for GO
            color: GREEN_BOLD_BRIGHT     
                
      # pdp validation for ingredients in more details
      - executeFunction:
          name: ca.test.functions.pdp.MoreDetailsIos.Ingredient

      # Search a product
      - executeFunction:
          name: ca.test.functions.global.navigation.goToDeepLink
          params:
            - name: deepLinkUrl
              string: ca.test.data.pdp004.deepLink
      
      # Validation of EDD
      - executeFunction:
          name: ca.test.functions.pdp.shippingandEDD1     

# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

      - storeIn:
          key: testStatus
          value: passed
  
  #After Scenarios
  - name: After
    after: true
    flow:
      - log:
          message: pdp-004-ios
          color: GREEN_BOLD
      - executeFunction:
          name: ca.test.functions.utils.afterSteps    

