functions:
  #--------------------------------------------------------------------------------------------------------------------

  # Description: This function taps on sign in button on account page
  # No params
  - name: functions.accountPage.tapSignInBtn
    flow:
      - if:
          condition: ${platform} == 'Android' 
          then:
            - executeFunction:
                name: functions.homePage.personalizedShoppingExperiencePopup.dismissIfDisplayed      
      - click:
          identifier: accountPage.signInBtn
      - log:
          message: "End functions: accountPage.tapSignInBtn"
          color: BLUE
          
  #--------------------------------------------------------------------------------------------------------------------

  # Description: Asserts whether the user has successfully logged in.
  # No params
  # Works for:   [ MX [âœ“]   MX-Bodega [needs_testing]   US [__] ]
  - name: functions.accountPage.assertUserLoggedInSuccessfully
    flow:
      - sleep:
          duration: 3000
      - if:
          identifier:
            present:
              - identifier: accountPage.headerName
          then:
            - log:
                message: "Header is displayed"
                color: GREEN
          else:
            - failTest:
                message: 'X User not logged in successfully: Header Name element not found. Assertion cannot be performed.'
      - log:
          message: "End function: functions.accountPage.assertUserLoggedInSuccessfully"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This function closes the phone number pop up
  # No params
  - name: functions.icashMobile.handlePhoneNumberPopUp
    flow:
      - if:
          condition: ${market} == 'MX' || ${market} == 'MX-Bodega' 
          then:
            - if:
                identifier:
                  present:
                    - identifier: cashiMobile.mobileNumberPopUpTitle
                then:
                  - click:
                      identifier: cashiMobile.mobileNumberPopUp.closeBtn
      - log:
          message: "End functions: icashMobile.handlePhoneNumberPopUp"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This function closes the cashi pop up
  # No params
  - name: functions.cashi.closeCashiPopUp
    flow:
      - if:
          condition: ${market} == 'MX' || ${market} == 'MX-Bodega' 
          then:
            - sleep:
                duration: 10000
            - if:
                identifier:
                  present:
                    - identifier: cashi.installPopup
                then:
                  - click:
                      identifier: cashi.installPopup.closeBtn
      - log:
          message: "End function: functions.cashi.closeCashiPopUp"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This function takes the user to the address  list page
  # No params required
  - name: functions.accountPage.tapOnAddressRow
    flow:
      - scroll:
          direction: down
          untilIdentifier: accountPage.addressRow
          scrollLimit: 5
      - click:
          identifier: accountPage.addressRow
      - log:
          message: "End Function: functions.accountPage.tapOnAddressRow"
          color: GREEN_BOLD

 #--------------------------------------------------------------------------------------------------------------------

  # Description: This function takes the user to the order history page
  # No params required
  - name:  functions.accountPage.tapOnOrderHistory
    flow:
      - click:
          identifier: accountPage.orderHistory
      - sleep:
          duration: 5000
      - log:
          message: "End Function: functions.accountPage.tapOnOrderHistory"
          color: GREEN_BOLD

         
  #--------------------------------------------------------------------------------------------------------------------
  # Description: This function tap on accept merge cart request alert
  # No params required 
  - name: functions.accountPage.acceptMergeCartAlertIfDisplayed
    flow: 
      - sleep:
          duration: 10000
      - if: 
          identifier:
            present:
              - identifier: accountPage.mergeCartRequestAlert
          then:
            - click:
                identifier: accountPage.acceptMergeCartBtn
      - log: 
          message: "End Function: functions.accountPage.acceptMergeCartAlertIfDisplayed"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------
  # Description: This function tap on accept merge cart request alert
  # No params required 
  - name: functions.accountPage.tapPurchaseHistory
    flow:
      - click:
          identifier: accountPage.purchaseHistoryRightArrow
      - log: 
          message: "End Function: accountPage.tapPurchaseHistory"
          color: BLUE


  - name: functions.accountPage.closePhoneNumberPopUp
    flow:
      - if:
          identifier:
            present:
              - identifier: accountPage.phoneNumberPopupTitle
          then:
            - click: 
                identifier: searchPage.results.filter.closeButton
      - log: 
          message: "End Function: accountPage.closePhoneNumberPopUp"
          color: BLUE
  #--------------------------------------------------------------------------------------------------------------------

  # Description: This function opens the Wallet.
  # No Params
  - name: functions.accountPage.openWallet
    flow:
      - sleep:
          duration: 5000
      - try:
          flow:
            - scroll:
                direction: down
                untilIdentifier: accountPage.walletCard
                scrollLimit: 2
            - sleep:  
                duration: 3000  
            - click:
                identifier: accountPage.walletCard
          catch:
            flow:
              - scroll:
                  direction: up
                  untilIdentifier: accountPage.walletCard
                  scrollLimit: 2
              - click:
                  identifier: accountPage.walletCard
              - sleep:  
                  duration: 3000    

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This function takes the user to the Purchase history screen from Home screen
  # No Params
  - name: functions.accountPage.navigateToPurchaseHistoryFromHomeScreen
    flow:
      - executeFunction:
          name: functions.global.tapAccountBtn
      - executeFunction:
          name: functions.accountPage.tapOnOrderHistory
      - log:
          message: "End function: accountPage.navigateToPurchaseHistory"
          color: BLUE
  #------------------------------------------------------------------------------------------------------------------
  # Description: This function opens invoice tab from account page
  # No Params
  - name: functions.accountPage.tapOnInvoice
    flow:
      - click:
          identifier: accountPage.invoiceBtn
      - log:
          message: "End function: accountPage.tapOnInvoice"
          color: BLUE
  #---------------------------------------------------------------------------------------------------------------
  # Description: This function taps on delete invoice button from account page
  # No Params
  - name: functions.accountPage.deleteInvoiceBtn
    flow:
      - click:
          identifier: accountPage.deleteInvoiceBtn
      - log:
          message: "End function: accountPage.deleteInvoice"
          color: BLUE
  #---------------------------------------------------------------------------------------------------------------
  # Description: This function taps on Confirm delete invoice Btn.
  # No params
  - name: functions.accountPage.tapConfirmDeleteInvoiceBtn
    flow:
      - click:
          identifier: accountPage.ConfirmDeleteInvoiceBtn
      - log: 
          message: "End function: addressPage.tapConfirmDeleteAddressBtn"
          color: BLUE
  #-----------------------------------------------------------------------------------------------------------------
  # Description: This function taps on delete invoice button from account page
  # No Params
  - name: functions.accountPage.verifyNoInvoicePresent
    flow:
     - verifyIdentifier:
         notPresent:
              - identifier: accountPage.deleteInvoiceBtn
     - log: 
          message: "End function: accountPage.verifyNoInvoicePresent"
          color: BLUE

  #---------------------------------------------------------------------------------------------------------------
  # Description: This function handles phone numvber popup on account page.
  # No Params
  - name: functions.accountPage.handleVerifyPhoneNumberPopups
    flow:
      - if:
          identifier:
            present:
              - identifier: accountPage.phoneNumberPopup.popupTitle
          then:
            - click:
                identifier: accountPage.phoneNumberPopup.popupDismissLink
      - log: 
            message: "End function: accountPage.handleVerifyPhoneNumberPopups"
            color: BLUE
  
  #---------------------------------------------------------------------------------------------------------------
  # Description: This function checks the invoice is there or not which contains the given name
  # No Params
  - name: functions.accountPage.verifyInvoicePresent
    flow:
     - verifyIdentifier:
         present:
              - identifier: accountPage.Invoice.name
     - log: 
          message: "End function: accountPage.verifyInvoicePresent"
          color: BLUE

  #---------------------------------------------------------------------------------------------------------------

  - name: accountPage.deleteInvoice
    flow:
      - if:
         identifier:
           present:
             - identifier: accountPage.deleteInvoiceBtn
         then:
           - executeFunction:
               name: functions.accountPage.deleteInvoiceBtn
           - executeFunction:
              name: functions.accountPage.tapConfirmDeleteInvoiceBtn

