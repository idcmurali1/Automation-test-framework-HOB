functions:

  # ------------------------------------------------------------------------------------------------------
  # Description: Returns the name and full address selected stores it in the variable
  #              ${selectedAddressName} ${selectedFullAddress}
  - name: functions.reserveATime.getSelectedAddress
    platform: ios
    flow:
      - getString:
          identifier: cartPage.reserveTimePage.storeName
          attribute: label
          storeIn: selectedAddressName
      - getString:
          identifier: cartPage.reserveTimePage.storeAddress
          attribute: label
          storeIn: selectedFullAddress
      - storeIn:
          key: returnedSelectedAddressName
          value: ${selectedAddressName}
      - storeIn:
          key: returnedFullAddress
          value: ${selectedFullAddress}
      - log:
          message: "End function: functions.reserveATime.getSelectedAddress"
          color: BLUE

  # ------------------------------------------------------------------------------------------------------
  # Description: This function chooses a particular address from the select address page and retrieves both the address name and the complete address.
  # return:          ${expectedAddressName}     Name on address
  #                  ${expectedFullAddress}     Full address
  - name: functions.reserveATime.selectDeliveryAddress_getAddressDetails
    platform: ios
    flow:
      - click:
          identifier: cartPage.reserveTime.addressSelection.addressRadioBtn
      - getString:
          identifier: cartPage.reserveTime.addressSelection.addressName
          storeIn: expectedAddressName
          attribute: label
      - getString:
          identifier: cartPage.reserveTime.addressSelection.addressFullAddress
          storeIn: expectedFullAddress
          attribute: label
      - log:
          message: "Address selected in select address page\n${expectedAddressName} - ${expectedFullAddress}"
          color: GREEN
      - log:
          message: "End function: reserveATime.selectDeliveryAddress_getAddressDetails"
          color: BLUE

  #----------------------------------------------------------------------------------------------------------------

  # Description: The function validate the strike out price for W+ User. As ther are not specific locator for 
  #               Strike out price. This function check if the text have two $.
  # No Param
  - name: functions.reserveTime.deliveryStrikeOutPrice
    platform: ios
    flow:
      - getString:
          identifier: cartPage.reserveATime.slotPriceText
          storeIn: slotPrice
          attribute: label
      - log:
          message: "First slot price ${slotPrice}"
          color: GREEN
      - executeNode:
          file: wcp/test/helpers/Utils/slotStrikeOutPrice.js
          args:
            - value: ${slotPrice}
          getResponse:
            storeIn: isSlotPriceStrikedOut
      - if:
          condition: ${isSlotPriceStrikedOut}
          then:
            - log:
                message: "✔ Slot price are striked out for a W+ User."
                color: GREEN
          else:
            - failTest:
                message: "✘ Strike out price not present for a W+ User."
      - log:
          message: "End functions: reserveTime.deliveryStrikeOutPrice"
          color: BLUE

# -------------------------------------------------------------------------------------------------------------------- 

  # Description: This function verifies that an expected delivery address exists. 
  # Params: 
  #       ${expectedDeliveryAddress}  Expected delivery full address.
  - name: functions.reserveATime.validateDeliveryAddress
    platform: ios
    flow:
      - if:
          identifier:
            present:
                - identifier: cartPage.deliveryAddress
          then: 
            - log:
                message: "[✔] Delivery address assertion successful"
                color: GREEN
          else:
            - failTest:
                message: '[X] Expected delivery address name "${expectedDeliveryAddress}" was not found'
      - log:
          message: "End function: reserveATime.validateDeliveryAddress"
          color: BLUE
  #--------------------------------------------------------------------------------------------------------------------
  # Description: This function taps on back to cart button in reserve a time
  # No params
  - name: functions.reserveATime.tapBackToCartButton
    platform: ios
    flow:
      - click:
          identifier: reserveATime.unavailableItem.backtoCartButton
      - log:
          message: "End function: functions.reserveATime.tapBackToCartButton"
          color: BLUE