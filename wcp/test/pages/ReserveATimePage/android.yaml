functions:

  # ------------------------------------------------------------------------------------------------------
  # Description: Returns the name and full address selected stores it in the variable
  #              ${selectedAddressName} ${selectedFullAddress}
  - name: functions.reserveATime.getSelectedAddress
    platform: android
    flow:
      - getString:
          identifier: cartPage.reserveTimePage.storeName
          attribute: text
          storeIn: selectedAddressName
      - getString:
          identifier: cartPage.reserveTimePage.storeAddress
          attribute: text
          storeIn: selectedFullAddress
      - storeIn:
          key: returnedSelectedAddressName
          value: ${selectedAddressName}
      - storeIn:
          key: returnedFullAddress
          value: ${selectedFullAddress}
      - log:
          message: "End function: functions.reserveATime.getSelectedAddress"
          color: BLUE

  # ------------------------------------------------------------------------------------------------------
  # Description: This function chooses a particular address from the select address page and retrieves both the address name and the complete address.
  # return:          ${expectedAddressName}     Name on address
  #                  ${expectedFullAddress}     Full address
  - name: functions.reserveATime.selectDeliveryAddress_getAddressDetails
    platform: android
    flow:
      - click:
          identifier: cartPage.reserveTime.addressSelection.addressRadioBtn
      - getString:
          identifier: cartPage.reserveTime.addressSelection.addressName
          storeIn: expectedAddressName
          attribute: text
      - getString:
          identifier: cartPage.reserveTime.addressSelection.addressFullAddress
          storeIn: expectedFullAddress
          attribute: text
      - log:
          message: "Address selected in select address page\n${expectedAddressName} - ${expectedFullAddress}"
          color: GREEN
      - log:
          message: "End function: reserveATime.selectDeliveryAddress_getAddressDetails"
          color: BLUE

  #----------------------------------------------------------------------------------------------------------------

  # Description: The function validate the strike out price for W+ User. As ther are not specific locator for 
  #               Strike out price. This function check if the text have two $.
  # No Param
  - name: functions.reserveTime.deliveryStrikeOutPrice
    platform: ios
    flow:
      - getString:
          identifier: cartPage.reserveATime.slotPriceText
          storeIn: slotPrice
          attribute: label
      - log:
          message: "First slot price ${slotPrice}"
          color: GREEN
      - executeNode:
          file: wcp/test/helpers/Utils/slotStrikeOutPrice.js
          args:
            - value: ${slotPrice}
          getResponse:
            storeIn: isSlotPriceStrikedOut
      - if:
          condition: ${isSlotPriceStrikedOut}
          then:
            - log:
                message: "✔ Slot price are striked out for a W+ User."
                color: GREEN
          else:
            - failTest:
                message: "✘ Strike out price not present for a W+ User."
      - log:
          message: "End functions: reserveTime.deliveryStrikeOutPrice"
          color: BLUE

# -------------------------------------------------------------------------------------------------------------------- 

  # Description: This function assert the delivery name and address.
  # Params:   ${expectedAddressName}  Expected delivery address name. 
  #           ${expectedFullAddress}  Expected delivery full address.
  - name: functions.reserveATime.validateDeliveryAddress
    platform: android
    flow:
      - executeFunction:
          name: functions.reserveATime.getSelectedAddress  # --> ${returnedSelectedAddressName}, ${returnedFullAddress}
      - executeNode:
          file: wcp/test/helpers/Utils/trimLeadingTrailingSpace.js
          args:
            - value: ${selectedFullAddress}
          getResponse:
            storeIn: selectedFullAddress
      - executeNode:
          file: wcp/test/helpers/Utils/trimLeadingTrailingSpace.js
          args:
            - value: ${expectedFullAddress}
          getResponse:
            storeIn: expectedFullAddress
      - if:
          condition: ${expectedAddressName} == ${returnedSelectedAddressName}
          then: 
            - log:
                message: "Delivery address name assertion successfully."
                color: GREEN
          else:
            - failTest:
                message: '[X] Expected delivery address name "${expectedAddressName}" does not match with "${returnedSelectedAddressName}"'
      - if:
          condition: ${expectedFullAddress} == ${returnedFullAddress}
          then: 
            - log:
                message: "Delivery address assertion successfully."
                color: GREEN
          else:
            - failTest:
                message: '[X] Expected delivery address name "${expectedFullAddress}" does not match with "${returnedFullAddress}"'
      - log:
          message: "End function: reserveATime.validateDeliveryAddress"
          color: BLUE
