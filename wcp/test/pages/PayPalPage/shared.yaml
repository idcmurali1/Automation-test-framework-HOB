functions:

 #--------------------------------------------------------------------------------------------------------------------
  # Description: This function check if the paypal email page loaded sucessfully.
  # No Params
  - name: functions.payPalPage.isPayPalEmailPageDisplayed
    flow:
      - storeIn:
          key: returnedIsDisplayed
          value: false
      - sleep:
          duration: 10000
      - if:
          identifier:
            present:
              - identifier: payPalPage.logo
              - identifier: payPalPage.title
          then:
            - storeIn:
                key: returnedIsDisplayed
                value: true
            - log:
                message: "End function: payPalPage.isPayPalEmailPageDisplayed (Displayed)"
                color: BLUE
          else: 
            - log:
                message: "End function: payPalPage.isPayPalEmailPageDisplayed (Not displayed)"
                color: BLUE

 #--------------------------------------------------------------------------------------------------------------------
  # Description: This function validate the paypal enter email page.
  # No Params
  - name: functions.payPalPage.emailPage.validatePayPalEmailPage
    flow:
      - sleep:
          duration: 2000
      - verifyIdentifier:
          present:
            - identifier: payPalPage.emailPage.enterEmailText
            - identifier: payPalPage.emailPage.emailField
            - identifier: payPalPage.emailPage.emailFieldMessage
            - identifier: payPalPage.emailPage.forgotEmail
            - identifier: payPalPage.emailPage.nextBtn
      - if:
          condition: ${market} != 'CA'
          then:
            - verifyIdentifier:
                present:
                  - identifier: payPalPage.emailPage.createAccountLink
      - log:
          message: "End function: payPalPage.emailPage.validatePayPalEmailPage"
          color: BLUE

 #--------------------------------------------------------------------------------------------------------------------
  # Description: This function enter email the paypal page.
  # Params:      ${payPalEmailId}  [Mandatory]  PayPal Email id.
  - name: functions.payPalPage.emailPage.enterEmail
    flow:
      - enterText:
          identifier: payPalPage.emailPage.emailField
          string: ${payPalEmailId}
          clearField: true
      - log:
          message: "End function: payPalPage.emailPage.enterEmail"
          color: BLUE

 #--------------------------------------------------------------------------------------------------------------------
  # Description: This function clicks on next button on enter email page.
  # No Params
  - name: functions.payPalPage.emailPage.tapNextBtn
    flow:
      - try:
          flow:
            - click:
                identifier: payPalPage.emailPage.nextBtn
                numberOfClicks: 1
          catch:
            flow:
              - log:
                  message: "Implementing a catch as its failing even after the click action is performed."
                  color: CYAN
      - log:
          message: "End function: payPalPage.emailPage.tapNextBtn"
          color: BLUE

 #--------------------------------------------------------------------------------------------------------------------
  # Description: This function check if the paypal password page loaded sucessfully.
  # No Params
  - name: functions.payPalPage.isPayPalPasswordPageDisplayed
    flow:
      - storeIn:
          key: returnedIsDisplayed
          value: false
      - if:
          identifier:
            present:
              - identifier: payPalPage.passwordPage.loginBtn
            timeout: 10000
          then:
            - storeIn:
                key: returnedIsDisplayed
                value: true
            - log:
                message: "End function: payPalPage.isPayPalPasswordPageDisplayed (Displayed)"
                color: BLUE
          else: 
            - log:
                message: "End function: payPalPage.isPayPalPasswordPageDisplayed (Not displayed)"
                color: BLUE

 #--------------------------------------------------------------------------------------------------------------------
  # Description: This function validate the paypal enter password page.
  # Params:      ${payPalEmailId}   [Mandatory]   For email id validation
  - name: functions.payPalPage.passwordPage.validatePayPalPasswordPage
    flow:
      - verifyIdentifier:
          present:
              - identifier: payPalPage.logo
              - identifier: payPalPage.title
              - identifier: payPalPage.passwordPage.passwordTitle
              - identifier: payPalPage.passwordPage.userEmail  #params <-- ${payPalEmailId}
              - identifier: payPalPage.passwordPage.cancelBtn
              - identifier: payPalPage.passwordPage.passwordField
              - identifier: payPalPage.passwordPage.forgotPassword
              - identifier: payPalPage.passwordPage.loginBtn
      - log: 
          message: "End function: payPalPage.passwordPage.validatePayPalPasswordPage"
          color: BLUE

 #--------------------------------------------------------------------------------------------------------------------
  # Description: This function enter password in paypal page.
  # Params:      ${payPalPassword}   [Mandatory]   PayPal account password.
  - name: functions.payPalPage.passwordPage.enterPassword
    flow:
      - enterText:
          identifier: payPalPage.passwordPage.passwordField
          clearField: true
          string: ${payPalPassword}
      - log:
          message: "End function: payPalPage.passwordPage.enterPassword"
          color: BLUE

 #--------------------------------------------------------------------------------------------------------------------
  # Description: This function clicks on login button.
  # No Params
  - name: functions.payPalPage.passwordPage.tapLoginbutton
    flow:
      - click:
          identifier: payPalPage.passwordPage.loginBtn
      - log:
          message: "End function: payPalPage.passwordPage.tapLoginbutton"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------
  # Description: This function clicks first available credit card.
  # Params:      ${lastFourDigits}   [Mandatory]     Credit card last digit to select
  - name: functions.payPalPage.selectCreditCartByLast4Digits
    flow:
      - click:
          identifier: payPalPage.creditCard.byLast4Digits    #<--- ${lastFourDigits}
      - log:
          message: "End function: payPalPage.selectCreditCartByLast4Digits"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------
  # Description: This function clicks expand button to show all avilable credit card list.
  # Params:      ${lastFourDigits}   [Mandatory]     Credit card last digit to select
  - name: functions.payPalPage.tapExpandCreditCardList
    flow:
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: payPalPage.creditCard.expandCreditCardList
          then:
            - click:
                identifier: payPalPage.creditCard.expandCreditCardList
      - log:
          message: "End function: payPalPage.tapExpandCreditCardList"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------
  # Description: This function check the paypal UI there are two different UI we can see for paypal payment:
  #               1. When the users logs in for paypal for first time -> then we can see two page authentication
  #                  first page ask for email and the second for password.
  #               2. When the users is revisiting the paypal experience -> then we can see a single page authentication
  #                  with last paypal email entered by default.
  #               Below function check for the password field based on which it decide which page experience is showing.
  # No Params
  - name: functions.payPalPage.getCurrentUIView
    flow:
      - if:
          identifier:
            present:
              - identifier: payPalPage.emailPage.nextBtn
          then:
            - storeIn:
                key: currentView
                value: newUser
          else:
            - storeIn:
                key: currentView
                value: returningUser
      - log:
          message: ${currentView} payPal experience....
          color: CYAN_BOLD
      - log:
          message: "End function: payPalPage.getCurrentUIView"
          color: BLUE

#--------------------------------------------------------------------------------------------------------------------
  # Description: This function check the paypal UI there are two different UI we can see for paypal payment:
  # No Params
  - name: functions.payPalPage.validatePayPalPage
    flow:
      - verifyIdentifier:
          present:
            - identifier: payPalPage.pageTitle
            - identifier: payPalPage.logo
            - identifier: payPalPage.title
            - identifier: payPalPage.passwordPage.passwordTitle
            - identifier: payPalPage.emailPage.emailField
            - identifier: payPalPage.passwordPage.passwordField
            - identifier: payPalPage.passwordPage.forgotPassword
            - identifier: payPalPage.passwordPage.loginBtn
            - identifier: payPalPage.createAccountBtn
            - identifier: payPalPage.cancel$ReturnLink
      - log:
          message: "End function: payPalPage.validatePayPalPage"
          color: BLUE
#--------------------------------------------------------------------------------------------------------------------

  # Description: This function clicks on contiune button to select credit card.
  # No Params
  - name: functions.payPalPage.paymentPage.tapAgree$Continuebutton
    flow:
      - click:
          identifier: payPalPage.paymentPage.agree$Continue
      - sleep:
          duration: 10000
      - log:
          message: "End function: payPalPage.paymentPage.tapAgree$Continuebutton"
          color: BLUE

 #--------------------------------------------------------------------------------------------------------------------

  # Description: This function handles paypal cookies pop up
  # No Params
  - name: functions.payPalPage.paymentPage.handleCookiesPopup
    flow:
      - if:
          identifier:
            present:
              - identifier: payPalPage.cookiesPopUp
            timeout: 10000
          then:
            - click:
                identifier: payPalPage.acceptCookies
            - log:
                message: "Accept paypal cookies"
                color: CYAN
      - log:
          message: "End function: payPalPage.paymentPage.handleCookiesPopup"
          color: BLUE

 #--------------------------------------------------------------------------------------------------------------------

  # Description: This function handles save password popup
  # No Params
  - name: functions.payPalPage.handleSavePasswordPopUp
    flow:
      - if:
          condition: ${platform} == 'iOS'
          then:
            - sleep:
                duration: 10000
            - if:
                identifier:
                  present:
                    - identifier: payPalPage.savePasswordPopUp
                then:
                  - click:
                      identifier: payPalPage.dismissSavePasswordPopUp
      - log:
          message: "End function: payPalPage.handleSavePassword"
          color: BLUE

 #--------------------------------------------------------------------------------------------------------------------