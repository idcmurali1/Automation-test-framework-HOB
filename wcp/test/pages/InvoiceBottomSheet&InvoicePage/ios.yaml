functions:

#--------------------------------------------------------------------------------------------------------------------
  # Description: This function verify existing invoice from bottom sheet
  # No param 
  - name: functions.checkoutPage.verifyExistingInvoice
    platform: ios
    flow: 
      - verifyIdentifier:
          present:
            - identifier: checkoutPage.invoiceBottomSheet.editLink
            - identifier: checkoutPage.invoiceBottomSheet.saveButton
      - log:
          message: "End functions: checkoutPage.verifyExistingInvoice"
          color: BLUE

#--------------------------------------------------------------------------------------------------------------------
  # Description: This function select invoice from bottom sheet
  # No param 
  - name: functions.checkoutPage.selectExistingInvoice
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: checkoutPage.invoiceBottomSheet.firstInvoiceRadioBtn
            timeout: 3000
          then:
            - click:
                identifier: checkoutPage.invoiceBottomSheet.firstInvoiceRadioBtn
      - if:
          condition: ${environment} == 'Production' && ${platform} == 'iOS'
          then:
            - click:
                coordinates: 54, 554
      - log:
          message: "End functions: checkoutPage.selectExistingInvoice"
          color: BLUE
  
#-------------------------------------------------------------------------------------------------------------------- 
  # Description: This function enter taxRegimeDropDown
  # Param [Mandatory] tax regime
  - name: functions.invoicePage.taxDropdown
    platform: ios
    flow: 
      - click:  
          identifier: invoicePage.taxRegimeDropDown
      - enterText:
          identifier: invoicePage.taxRegimeDropDownPickerWheel
          string:  ${taxRegime}
      - log:
          message: "End functions: invoicePage.taxDropdown"
          color: BLUE 
  
  #-------------------------------------------------------------------------------------------------------------------- 
  # Description: This function CFDIDropDown
  # Param [Mandatory] CFDI
  - name: functions.invoicePage.CFDIDropDown
    platform: ios
    flow: 
      - enterText:
          identifier: invoicePage.CFDIDropDown
          string:  ${CFDI}
      - log:
          message: "End functions:invoicePage.CFDIDropDown"
          color: BLUE

  #-------------------------------------------------------------------------------------------------------------------- 
  # Description: This function will view the selected invoice information and store the full name of the taxpayer into a variable
  # No param 
  - name: functions.invoiceBottomSheet.getTaxPayerName
    platform: ios
    flow: 
      - click:
          identifier: checkoutPage.invoiceBottomSheet.editLink
      - sleep:
          duration: 3000
      - if:
          identifier:
            present:
              - identifier: invoicePage.firstNameTextField
          then:
            - log: "First name is visible"
          else:
            - click:
               identifier: invoicePage.physicalPersonRadioBtn
      - getString:
          identifier: invoicePage.firstNameTextField
          attribute: value
          storeIn: selectedInvoiceTaxPayerName

      - getString:
          identifier: invoicePage.lastNameTextField
          attribute: value
          storeIn: selectedInvoiceTaxPayerFirstName

      - getString:
          identifier: invoicePage.middleNameTextField
          attribute: value
          storeIn: selectedInvoiceTaxPayerSecondLastName

      - storeIn:
          key: selectedInvoiceTaxPayerFullName
          value: ${selectedInvoiceTaxPayerName} ${selectedInvoiceTaxPayerFirstName} ${selectedInvoiceTaxPayerSecondLastName}

      - log:
          message: "The full name for the tax payer for the selected Invoice is: '${selectedInvoiceTaxPayerFullName}' "
          color: CYAN

      - click:
          identifier: invoicePage.closeBtn

      - log:
          message: "End functions: functions.invoiceBottomSheet.getTaxPayerName"
          color: BLUE

  #-----------------------------------------------------------------------------------------------------------------
  # Description: This function select CFDI from drop down
  # Params:      ${invoiceCFDI}  [Mandatory] Invoice page CFDI text.
  # Works for:   [ MX [✓]   MX-Bodega [✓]   US [__] ]
  - name: functions.invoicePage.selectCfdi
    platform: ios
    flow: 
      - log:
          message: Select CFDI
          color: CYAN
      - if:
          identifier:
            notPresent:
              - identifier: invoicePage.CFDIDropDown
          then:
            - scroll:
                direction: down
                untilIdentifier: invoicePage.CFDIDropDown
      - click:
          identifier: invoicePage.CFDIDropDown
      - executeFunction:
          name: functions.utils.selectValueFromDropDown
          params:
            - name: valueToSelect
              string: ${invoiceCFDI}       
      - log:
          message: "End functions:invoicePage.CFDIDropDown"
          color: BLUE

  #-----------------------------------------------------------------------------------------------------------------

  # Description: This function enters phone country code in invoice page
  # Params:      ${invoicePhoneCountryCode}  [Mandatory] Invoice page enter country code.
  # Works for:   [ MX [✓]   MX-Bodega [✓]   US [__] ]
  - name: functions.invoicePage.enterInvoicePhoneCountryCode
    platform: ios
    flow:
      - log:
          message: Entering country code in invoice page - ${invoicePhoneCountryCode}
          color: CYAN
      - if:
          identifier:
            notPresent:
              - identifier: invoicePage.invoicePhoneCountryCode
          then:
            - scroll:
                direction: down
                untilIdentifier: invoicePage.invoicePhoneCountryCode
                position: center
                scrollLimit: 3
      - click:
          identifier: invoicePage.invoicePhoneCountryCode
      - executeFunction:
          name: functions.utils.selectValueFromDropDown
          params:
            - name: valueToSelect
              string: ${invoicePhoneCountryCode}
      - log:
          message: "End functions: invoicePage.enterInvoicePhoneCountryCode"
          color: BLUE

  #-----------------------------------------------------------------------------------------------------------------

  # Description: This function select colony details in invoice page
  # Params:      ${invoiceColoniaName}  [Mandatory] Invoice page enter phone number.
  # Works for:   [ MX [✓]   MX-Bodega [✓]   US [__] ]
  - name: functions.invoicePage.selectColonia
    platform: ios
    flow:
      - log:
          message: Select tax regime - ${invoiceColoniaName}
          color: CYAN
      - if:
          identifier:
            notPresent:
              - identifier: invoicePage.invoiceColonyDropDown
          then:
            - scroll:
                direction: down
                untilIdentifier: invoicePage.invoiceColonyDropDown
      - click:
          identifier: invoicePage.invoiceColonyDropDown
      - executeFunction:
          name: functions.utils.selectValueFromDropDown
          params:
            - name: valueToSelect
              string: ${invoiceColoniaName}
      - log:
          message: "End functions: invoicePage.colonyDropDown"
          color: BLUE