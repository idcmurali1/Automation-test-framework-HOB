general:
  tags:  validatescreens
  testCaseId: 


scenarios:
  - name: Before
    before: true
    endTestOnFailure: true
    flow:

      #Get Environment Values
      - executeFunction:
          name: functions.utils.setMarketInfo


# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      - log: 'R2_SUBFLOW_PRE_TRANSACTION'
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

  - name: Main
    flow:
      - log: Start Main

      # Navigate onboarding to home
      - executeFunction:
          name: functions.onboardingToHomePage.usingPostalCode
          params:
            - name: PostalCode
              string: data.onboarding.userPostalCode
            - name: ShoppingExperience
              string: data.onboarding.onlineExclusiveStore

      # Capture HP Screenshot

      - executeFunction:
          name: function.utils.captureScreenshots
          params:
            - name: titleName
              string: Pickup or delivery
            - name: fileName
              string: Home Page

      - executeFunction:
          name: functions.global.tapAccountBtn

      - executeFunction:
          name: functions.accountPage.tapSignInBtn
      - if:
          condition: ${platform} == 'Android'
          then:
            - storeIn:
                key: userEmail
                value: data.wcp031.user.email.android
          else:
            - storeIn:
                key: userEmail
                value: data.wcp031.user.email.android

      - executeFunction:
          name: functions.loginPage.userAuthentication
          params:
            - name: userEmail
              string: ${userEmail}
            - name: userPassword
              string: data.wcp031.userPassword

      - executeFunction:
          name: functions.accountPage.assertUserLoggedInSuccessfully 
  
    
      - executeFunction:
          name: functions.global.tapServicesBtn

      # Capture Services Page Screenshot

      - executeFunction:
          name: function.utils.captureScreenshots
          params:
            - name: titleName
              string: Popular Services
            - name: fileName
              string: Services Page

      - executeFunction:
          name: functions.global.tapShopBtn

      - executeFunction:
          name: functions.global.allDepartmentsBtn

     # Capture All Departments Page Screenshot
      - executeFunction:
          name: function.utils.captureScreenshots
          params:
            - name: titleName
              string: All Departments
            - name: fileName
              string: All Departments Page


      - executeFunction:
          name: functions.global.tapShopBtn

      - executeFunction:
          name: functions.onboarding.navigation.goToDeepLink
          params:
            - name: deepLinkUrl
              string: walmart://cp/clothing/5438
            - name: deeplinkMarketPrefix
              string: walmart:// 
    
      # Capture Fashion Page Screenshot

      - executeFunction:
          name: function.utils.captureScreenshots
          params:
            - name: titleName
              string : fashion
            - name: fileName
              string: Fashion Page

      - executeFunction:
          name: functions.global.tapShopBtn


     # Capture Electronics Page Screenshot
      - executeFunction:
          name: functions.onboarding.navigation.goToDeepLink
          params:
            - name: deepLinkUrl
              string: walmart://cp/electronics/3944
            - name: deeplinkMarketPrefix
              string: walmart:// 
    

      - executeFunction:
          name: function.utils.captureScreenshots
          params:
            - name: titleName
              string : TVs & home theater
            - name: fileName
              string: Electronics Page
       # Clear cart
      - executeFunction:
          name: functions.global.tapShopBtn

     # Capture Registry Page Screenshot

      - executeFunction:
          name: functions.onboarding.navigation.goToDeepLink
          params:
            - name: deepLinkUrl
              string: walmart://cp/gifts-registry/1094765
            - name: deeplinkMarketPrefix
              string: walmart://    

      # - verifyIdentifier:
      #     present:
      #       - identifier: registry.landingPageTitle

      - executeFunction:
          name: function.utils.captureScreenshots
          params:
            - name: titleName
              string : Gifts
            - name: fileName
              string: Registry Page
  
      - executeFunction:
          name: functions.global.tapShopBtn

      - executeFunction:
          name: functions.onboarding.navigation.goToDeepLink
          params:
            - name: deepLinkUrl
              string: walmart://cp/pharmacy/5431
            - name: deeplinkMarketPrefix
              string: walmart://   
 
         # Capture Pharmacy Page Screenshot


      - executeFunction:
          name: function.utils.captureScreenshots
          params:
            - name: titleName
              string : Pharmacy
            - name: fileName
              string: Pharmacy Page
  
      - executeFunction:
          name: functions.global.tapShopBtn

     # Capture Deals Page Screenshot

      - executeFunction:
          name: functions.onboarding.navigation.goToDeepLink
          params:
            - name: deepLinkUrl
              string:  walmart://shop/deals
            - name: deeplinkMarketPrefix
              string: walmart://  

      - executeFunction:
          name: function.utils.captureScreenshots
          params:
            - name: titleName
              string : Deals
            - name: fileName
              string: Deals Page

       # Clear cart
      - executeFunction:
          name: functions.global.tapShopBtn  


     # Capture Search Page Screenshot

      - executeFunction:
          name: functions.searchField.enterText
          params:
            - name: searchText
              string: iPad


      - executeFunction:
          name: function.utils.captureScreenshots
          params:
            - name: titleName
              string : Filter
            - name: fileName
              string: Search Page

      - executeFunction:
          name: functions.global.tapShopBtn  

      - executeFunction:
          name: functions.cartPage.clearCart

      - executeFunction:
          name: functions.productPage.navigatetoPDPwithDeeplink
          params:
            - name: productArray
              string: data.searchPage.shoes
  
       # Capture Product Page Screenshot

      - executeFunction:
          name: function.utils.captureScreenshots
          params:
            - name: titleName
              string : Add to cart
            - name: fileName
              string: Product Page


      - executeFunction:
          name: functions.productDetailsPage.tapAddToCart

      - executeFunction:
          name: functions.productDetailsPage.tapClose

      - executeFunction:
          name: functions.global.tapCartIcon

     # Capture Cart Page Screenshot

      - executeFunction:
          name: function.utils.captureScreenshots
          params:
            - name: titleName
              string : Cart
            - name: fileName
              string: Cart Page

      - executeFunction:
          name: functions.cartPage.tapReserveATimeBtn
 

      # Capture Book Slot Page Screenshot

      - executeFunction:
          name: function.utils.captureScreenshots
          params:
            - name: titleName
              string : Reserve a time
            - name: fileName
              string: Book PickupSlot Page

      - executeFunction:
          name: functions.reserveATime.bookSlot
          params:
            - name: fufillment
              string: Pickup
            - name: slotType
              string: Standard
            - name: slotDay
              string: tomorrow 

     
      - executeFunction:
          name: functions.cartPage.tapContinueToCheckoutBtn
      
      - executeFunction:
          name: functions.checkoutPage.assertPageLoaded 

     # Capture Checkout Page Screenshot

      - executeFunction:
          name: function.utils.captureScreenshots
          params:
            - name: titleName
              string : Checkout
            - name: fileName
              string: Checkout Page    
                 
      - storeIn:
          key: testStatus
          value: passed

  - name: After
    after: true
    flow:
      - executeFunction:
          name: functions.utils.after