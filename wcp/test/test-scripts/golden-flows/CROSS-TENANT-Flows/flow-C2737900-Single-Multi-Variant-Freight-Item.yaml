general:
  testCaseId: C2737900
  tags: C2737900 # , p1-us-prod, p1-ca-en-prod
scenarios:
  - name: Before
    before: true
    flow:
      - executeFunction:
          name: functions.utils.setMarketInfo

  - name: Main
    flow:

      - executeFunction:
          name: functions.onboardingToHomePage.usingPostalCode
          params:
            - name: PostalCode
              string: data.onboarding.userPostalCode

      - executeFunction:
          name: functions.global.tapAccountBtn

      - executeFunction:
          name: functions.accountPage.tapSignInBtn

      - if:
          condition: ${platform} == 'Android'
          then:
            - storeIn:
                key: userEmail
                value: data.wcp.multivariant.android.email
          else:
            - storeIn:
                key: userEmail
                value: data.wcp.multivariant.ios.email

      - executeFunction:
          name: functions.loginPage.userAuthentication
          params:
            - name: userEmail
              string: ${userEmail}
            - name: userPassword
              string: data.global.password.Password

      - executeFunction:
          name: functions.global.tapShopBtn

      - executeFunction:
          name: functions.cartPage.clearCart

      - executeFunction:
          name: functions.searchPage.getTheFirstAvailableItemAndNavigateToPDP
          params:
            - name: productArray
              string: data.global.freightItems

      - executeFunction:
          name: functions.productDetailsPage.validateFreightFeeIsDisplayed

      - executeFunction:
          name: functions.productDetailsPage.tapAddToCart

      - executeFunction:
          name: functions.productDetailsPage.tapClose

      - executeFunction:
          name: functions.searchPage.getFirstVariantItemAndNavigateToPDP
          params:
            - name: productArray
              string: data.global.singleVariantItems

      - executeFunction:
          name: functions.productDetailsPage.validateVariantsInformationIsDisplayed
          params:
            - name: typeOfVariant
              string: 'SingleVariant'

      - executeFunction:
          name: functions.productDetailsPage.tapAddToCart

      - executeFunction:
          name: functions.productDetailsPage.tapClose

      - executeFunction:
          name: functions.searchPage.getFirstVariantItemAndNavigateToPDP
          params:
            - name: productArray
              string: data.global.multiVariantItems

      - executeFunction:
          name: functions.productDetailsPage.validateVariantsInformationIsDisplayed
          params:
            - name: typeOfVariant
              string: 'MultiVariant'

      - executeFunction:
          name: functions.productDetailsPage.changeMultiVariantOption

      - executeFunction:
          name: functions.productDetailsPage.tapAddToCart

      - executeFunction:
          name: functions.productDetailsPage.tapClose

      - executeFunction:
          name: functions.global.tapCartIcon

      - executeFunction:
          name: functions.cartPage.validateVariantOptionsLabelIsDisplayed

      - executeFunction:
          name: functions.cartPage.scrollDownToPOS

      - executeFunction:
          name: functions.global.moneyBox.validateFreightCharge

      - executeFunction:
          name: functions.cartPage.tapContinueToCheckoutBtn

      - executeFunction:
          name: functions.checkoutPage.scrollToPOS

      - executeFunction:
          name: functions.global.moneyBox.validateFreightCharge

      - storeIn:
          key: testStatus
          value: passed

  - name: After
    after: true
    flow:
      - executeFunction:
          name: functions.utils.after