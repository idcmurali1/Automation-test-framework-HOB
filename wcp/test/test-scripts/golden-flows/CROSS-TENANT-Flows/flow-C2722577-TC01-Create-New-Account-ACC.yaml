# ================================================================================================================================
# TC: 001
# Flow: TC-001: Create new account + ACC
# ================================================================================================================================

general:
  testCaseId: C2722577
  tags: C2722577, p1-mx-ea-teflon, p1-bodega-ea-teflon, p1-ca-en-teflon, p1-ca-fr-teflon, p1-mx-mh-e2e-teflon
  combineScenarios: true

scenarios:
  - name: Before
    before: true
    endTestOnFailure: true
    flow:
      - executeFunction:
          name: functions.utils.setMarketInfo

  - name: Main 
    flow:

      - executeFunction:
          name: functions.onboardingToHomePage.usingPostalCode
          params:
            - name: PostalCode
              string: data.onboarding.userPostalCode
            - name: ShoppingExperience
              string: data.onboarding.onlineExclusiveStore

      - executeFunction:
          name: functions.global.tapAccountBtn

      - executeFunction:
          name: functions.accountPage.tapSignInBtn

      - executeFunction:
          name: functions.login.createUserAccount

      - executeFunction:
          name: functions.accountPage.openWallet

      - executeFunction:
          name: functions.walletPage.addPaymentMethod.creditDebitCardButton

      - executeFunction:
          name: functions.addCreditDebitCardPage.fillCreditDebitCardInformationForm
          params:
            - name: cardNumber
              string: data.global.creditCard.visa.4242.fullNumber
            - name: cardLast4Digits
              string: data.global.creditCard.visa.4242.last4DigitsOnly
            - name: cardHolderFirstName
              string: data.global.name.ACCEPT
            - name: cardHolderLastName
              string: data.global.name.ACCEPT
            - name: expirationMonth
              string: data.global.addNewCardInfo.expiration.month.number
            - name: expirationYear
              string: data.wcp08.expirationYear
            - name: expirationDate
              string: data.wcp08.expirationDate
            - name: cvv
              string: data.global.card.cvv.123
            - name: phoneNumber
              string: data.defaultAddress.phoneNumber
            - name: sameBillingAddress
              string: false
            - name: defaultCard
              string: true
            - name: addressField
              string: data.defaultAddress.streetAddress
            - name: exteriorNumber
              string: data.defaultAddress.exteriorNumber
            - name: zipcode
              string: data.defaultAddress.zipCode
            - name: colonia
              string: data.defaultAddress.coloniaName
            - name: state 
              string: data.defaultAddress.state
            - name: city
              string: data.defaultAddress.city
            - name: fromAccount
              string: true

      - storeIn:
          key: testStatus
          value: passed

  - name: After
    flow:
      - executeFunction:
          name: functions.utils.after
