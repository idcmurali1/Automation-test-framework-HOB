functions:

  ###########################################################################################
  # Description : Function to navigate to tabs from the bottom navigation bar               #
  # ---------------------------------------- Params --------------------------------------- #
  # [mandatory]  ${tab}  - Name of the tab as 'Home'/ 'Inbox'/ 'Orders'/ 'Catalog'          #
  ###########################################################################################
  - name: sc.functions.navigation.toTab
    flow:
      - if:
          condition: ${tab} == 'Home' || ${tab} == 'Inbox' || ${tab} == 'Orders' || ${tab} == 'Catalog'
          then:
            - executeFunction:
                name: sc.functions.navigation.toFooterTab
                params:
                  - name: footerTab
                    string: ${tab}
          else:
            - if:
                condition: ${tab} == 'Notifications'
                then:
                  - executeFunction:
                      name: sc.functions.navigation.toNotificationsTab
                else:
                  - executeFunction:
                      name: sc.functions.navigation.toMenuOption

  - name: sc.functions.navigation.toMenuOption
    flow:
      - storeIn:
          key: skipLoad
          value: false
      - if:
          identifier:
            present:
              - identifier: sc.mappings.navigation.menu
          then:
            - click:
                identifier: sc.mappings.navigation.menu          
            # second click is added just incase if the page is in sub menu view
            - click:
                identifier: sc.mappings.navigation.menu
      - sleep:
          duration: 3000
      - if:
          condition: ${APP_PLATFORM} == 'ios'
          then:
            - if:
                identifier:
                  present:
                    - identifier: sc.mappings.navigation.currentTabTitle
                then:
                  - storeIn:
                      key: skipLoad
                      value: true
      - if:
          condition: ${skipLoad} == false
          then:
            - verifyIdentifier:
                present:
                  - identifier: sc.mappings.navigation.toTab
                  - identifier: sc.mappings.navigation.menuOptions
            - click:
                identifier: sc.mappings.navigation.toTab
            - sleep:
                duration: 3000
            - executeFunction:
                name: sc.functions.reloadPage
            - if:
                condition: ${tab} == 'Home'
                then:
                  - verifyIdentifier:
                      timeout: 30000
                      present:
                        - identifier: sc.mappings.home.userDetails
                else:
                  - executeFunction:
                      name: sc.functions.navigation.validateTabLoad
            - sleep:
                duration: 1000
          else:
            - log: Tab ${tab} already loaded

  - name: sc.functions.navigation.toNotificationsTab
    flow:
      - if:
          condition: ${APP_PLATFORM} == 'android'
          then:
            - click:
                identifier: sc.mappings.navigation.notificationsTab
          else:
            - storeIn:
                key: footerTab
                value: Notifications
            - click:
                identifier: sc.mappings.navigation.toFooterTab
      - sleep:
          duration: 3000
      - executeFunction:
          name: sc.functions.navigation.validateTabLoad

  - name: sc.functions.navigation.validateTabLoad
    flow:
      - if:
          condition: ${APP_PLATFORM} == 'android'
          then:
            - verifyIdentifier:
                text:
                  - identifier: sc.mappings.navigation.currentTabTitle
                    contains: ${tab}
          else:
            - if:
                condition: ${tab} == 'Catalog'
                then:
                  - verifyIdentifier:
                      timeout: 25000
                      present:
                        - identifier: Catalog             
                else:
                  - verifyIdentifier:
                      present:
                        - identifier: sc.mappings.navigation.currentTabTitle

  - name: sc.functions.navigation.toFooterTab
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: sc.mappings.navigation.toFooterTab
          then:
            - scroll:
                direction: up
      - click:
          identifier: sc.mappings.navigation.toFooterTab
      - sleep:
          duration: 3000
      - if:
          condition: ${APP_PLATFORM} == 'android'
          then:
            ## Add android verification
            - log: Android validation
          else:
            - verifyIdentifier:
                value:
                  - identifier: sc.mappings.navigation.toFooterTab
                    equals: 1


  - name: sc.functions.navigation.toInboxTab
    flow:
      - if:
          condition: ${APP_PLATFORM} == 'android'
          then:
            - executeFunction:
                name: sc.functions.navigation.toTab
                params:
                  - name: tab
                    string: sc.tab.inbox.name
          else:
            - executeFunction:
                name: us.functions.global.navigation.goToDeepLink
                params:
                  - name: deepLinkUrl
                    string: ${deepLinkUrl}
            - executeFunction:
                name: sc.functions.navigation.closePushNotifications

  ###########################################################################################
  # Description : Function to navigate to list page from any of the details/search page     #
  ###########################################################################################
  - name: sc.functions.navigation.navigateBackToListPage
    flow:
      - loop:
          begin: 0
          end: 3
          storeIndex: navigateIndex
          flow:
            - if:
                identifier:
                  present:
                    - identifier: sc.mappings.global.searchButton
                then:
                  - break: true
            - if:
                identifier:
                  present:
                    - identifier: sc.mappings.navigation.backButton
                then:
                  - click:
                      identifier: sc.mappings.navigation.backButton
                  - sleep:
                      duration: 3000
      - log: Back to list page

  - name: sc.functions.navigation.navigateToNotificationsSettings
    flow:
      - verifyIdentifier:
          present:
            - identifier: sc.mappings.accounts.notifications.settingsLink
      - click:
          identifier: sc.mappings.accounts.notifications.settingsLink
      - verifyIdentifier:
          present:
            - identifier: sc.mappings.accounts.notifications.settingsPage.title
      - sleep:
          duration: 3000

  - name: sc.functions.navigation.backToMainScreenFromSearch
    platform: android
    flow:
      - goBack: true
      - sleep:
          duration: 1000
      - goBack: true
      - sleep:
          duration: 1000

  # - name: sc.functions.navivation.toReturnsTab
  #   flow:
  #     - verifyIdentifier:
  #         present:
  #           - identifier: sc.mappings.home.shortcuts.returns
  #     - click:
  #         identifier: sc.mappings.home.shortcuts.returns
  #     - verifyIdentifier:
  #         present:
  #           - identifier: sc.mappings.returns.title
  #     - sleep:
  #         duration: 5000
  #     - try:
  #         flow:
  #           - verifyIdentifier:
  #               value:
  #                 - identifier: sc.mappings.navigation.toTab
  #                   equals: 1
  #         catch:
  #           flow:
  #             - verifyIdentifier:
  #                 selected:
  #                   - identifier: sc.mappings.navigation.toTab
  #                     value: true
  #     - sleep:
  #         duration: 1000
  
  # close popUp Push Notifications 
  - name: sc.functions.navigation.closePushNotifications
    flow:
      - log: Close Push Notifications page
      - try:
          flow:
            - verifyIdentifier:
                timeout: 15000
                present:
                  - identifier: sc.mappings.navigation.pushNotifications
            - click:
                identifier: sc.mappings.navigation.allowNotifications
            - sleep:
                duration: 4000
            - if:
                identifier:
                  present:
                    - identifier: sc.mappings.navigation.allowButton
                then:
                  - click:
                      identifier: sc.mappings.navigation.allowButton
                  - sleep:
                      duration: 4000
            - log: Notifications allowed
          catch:
            flow:
              - log:
                  message: Does not dispaly Notifications

  
  # navigation to Unshipped Orders
  - name: sc.functions.navigation.toUnshippedOrders
    flow:
      - log: Navigate to Unshipped Orders 
      - sleep:
          duration: 4000
      - verifyIdentifier:
          present:
            - identifier: sc.mappings.navigation.toUnshippedOrders
      - click:
          identifier: sc.mappings.navigation.toUnshippedOrders
      - sleep:
          duration: 3000
  
  # Back Navigate to the Orders list screen
  - name: sc.functions.navigation.backToOrderList
    flow:
      - sleep:
          duration: 4000
      - click:
          identifier: sc.mappings.navigation.backToOrderList
  
  # Navigate back home, by tapping Home button in the bottom nav footer bar.
  - name: sc.functions.navigation.backToHome
    flow:
      - sleep:
          duration: 3000
      - verifyIdentifier:
          present:
            - identifier: sc.mappings.navigation.clickHamburger
      - click:
          identifier: sc.mappings.navigation.clickHamburger
          wait: 4000
      - verifyIdentifier:
          present:
            - identifier: sc.mappings.navigation.backToHome
      - click:
          identifier: sc.mappings.navigation.backToHome


  - name: sc.functions.navigate.back
    flow:
      - click:
          identifier: sc.mappings.navigation.backButton

  #Open deep link for android
  - name: sc.functions.global.navigation.goToDeepLink
    flow:
      - verifyValue:
          identifier: $deepLinkUrl
          contains: 'sellercenter://'
      - openLink: ${deepLinkUrl}