general:
  tags: sc-e2e, sc-staging-feature-build, C2720439

scenarios:
  - name: Before
    before: true
    endTestOnFailure: true
    flow:

      - if:
          condition: ${APP_PLATFORM} == 'android'
          then:
            - storeIn:
                key: identifierTextAttribute
                value: text
          else:
            - storeIn:
                key: identifierTextAttribute
                value: label

  - name: Main
    flow:
      - log: Start Main

      # Login
      - executeFunction:
          name: sc.functions.accounts.login
          params:
            - name: email
              string: sc.partner1.email
            - name: password
              string: sc.partner1.password

      - storeIn:
          key: poNumber
          value: 109012948043970

      # navigation to catalog view from the home menu
      - executeFunction:
          name: sc.functions.navigation.toInboxTab
          params:
            - name: deepLinkUrl
              string: sellercenter://seller/inbox?status=failed

      - executeFunction:
          name: sc.functions.inbox.verifyMessageListDisplay

      - executeFunction:
          name: sc.functions.inbox.composeMessageWithInvalidPO

      - executeFunction:
          name: sc.functions.inbox.selectComposeMessage

      - executeFunction:
          name: sc.functions.inbox.composeMessage
          params:
            - name: poNumber
              string: ${poNumber}
            - name: messageBody
              string: 'Message for testing'
            - name: templateName
              string: 'AllFields'
            - name: tagName
              string: 'Item name'
            - name: sendMessage
              string: true

      - executeFunction:
          name: sc.functions.inbox.validateNewMessageCreated
          params:
            - name: poNumber
              string: ${poNumber}
            - name: messageBody
              string: 'Message for testing'

      - storeIn:
          key: testStatus
          value: passed

  - name: After
    after: true
    flow:
      - executeFunction:
          name: sc.functions.utils.afterSteps