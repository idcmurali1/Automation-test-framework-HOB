general:
  tags: C2715339, sc-e2e, sc-staging-feature-build

scenarios:
  - name: Before
    before: true
    endTestOnFailure: true
    flow:

  - name: Main
    flow:
      - log: Start Main
      
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      - log: 'R2_SUBFLOW_PRE_TRANSACTION'
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

      #Create successful order from a list of items saved based on recent successful orders
      - executeFunction:
          name: sc.functions.utils.astro.createOrder

      # Login
      - executeFunction:
          name: sc.functions.accounts.login
          params:
            - name: email
              string: sc.teflon.testaquafina.email
            - name: password
              string: sc.teflon.testaquafina.password

      #Go to orders Page and search for OrderNo in Android
      - if:
          condition: ${APP_PLATFORM} == 'android'
          then:
            - executeFunction:
                name: sc.functions.navigation.toTab
                params:
                  - name: tab
                    string: Orders

            - executeFunction:
                name: sc.functions.global.search
                params:
                  - name: searchValue
                    string: ${orderNo}

            - executeFunction:
                name: sc.functions.orders.selectFirstOrder
                
      # Get PONumber for order and go to order details deeplink in iOS
          else:            
            - executeFunction:
                name: sc.functions.orders.getOrderPONumber

            - executeFunction:
                name: sc.functions.global.navigation.goToDeepLink
                params:
                  - name: deepLinkUrl
                    string: sc.data.orders.orderDetails.deepLinkUrl
      
      # Tap the Acknowledge order button. Acknowledged if can be acknowledged, otherwise, verify print packing slip and then back
      - executeFunction:
          name: sc.functions.orders.acknowledgeOrder
      
      # verify order and order details
      - executeFunction:
          name: sc.functions.orders.verifyOrder

      - executeFunction:
          name: sc.functions.orders.markOrderAsShipped
          params:
            - name: carrierOption
              string: 'Asendia'
            - name: trackingNo
              string: '9876543210'

      - storeIn:
          key: testStatus
          value: passed
  
  - name: After
    after: true
    flow:
      - executeFunction:
          name: sc.functions.utils.afterSteps