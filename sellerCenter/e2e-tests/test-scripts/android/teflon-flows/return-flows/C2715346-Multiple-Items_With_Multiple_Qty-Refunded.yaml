general:
  platform: android
  tags: sc-e2e, sc-staging-feature-build, C2715346

scenarios:
  - name: Before
    before: true
    endTestOnFailure: true
    flow:
      - storeIn:
          key: identifierTextAttribute
          value: text

  - name: Main
    flow:
      - log: Start Main

      - executeFunction:
          name: sc.functions.createOrder
          params:
            - name: email
              string: testwalmarte2e+15@gmail.com
            - name: quantity
              string: 2

      # Login
      - executeFunction:
          name: sc.functions.accounts.login
          params:
            - name: email
              string: sc.partner1.email
            - name: password
              string: sc.partner1.password

      # navigation to catalog view from the home menu
      - executeFunction:
          name: sc.functions.navigation.toTab
          params:
            - name: tab
              string: sc.tab.returns.name


      # validate the catalog list page opens and validate the page contents
      - executeFunction:
          name: sc.functions.catalog.validateItemListPageDisplays
          params:
            - name: tabName
              string: Returns


      - executeFunction:
          name: sc.functions.items.searchItem
          params:
            - name: searchValue
              string: '100000505285368'

      - loop:
          begin: 1
          end: 2
          storeIndex: index
          mode: increment
          flow:
            # select the first item from the list
            - executeFunction:
                name: sc.functions.returns.saveItemDetailsAndSelect

            # Validating all the content present in the item details page
            - executeFunction:
                name: sc.functions.returns.item.validateItemDetails
                params:
                  - name: itemStatusValue
                    string: Initiated
                  - name: refundStatusValue
                    string: Not Invoiced

            # Issue full refund for the return
            - executeFunction:
                name: sc.functions.returns.item.issueRefund
                params:
                  - name: refundType
                    string: partial

            - executeFunction:
                name: sc.functions.navigate.back

            # ------------- Search for item and see the refunded status -------------
            - sleep:
                duration: 120000

            - executeFunction:
                name: sc.functions.items.searchItem
                params:
                  - name: searchValue
                    string: '100000279611084'

            # select the first item from the list
            - executeFunction:
                name: sc.functions.returns.saveItemDetailsAndSelect

            # Validating all the content present in the item details page
            - executeFunction:
                name: sc.functions.returns.item.validateItemDetails
                params:
                  - name: itemStatusValue
                    string: Keep It
                  - name: refundStatusValue
                    string: Refunded

            - executeFunction:
                name: sc.functions.return.item.validateRefundOption.isNotPresent

            # - sleep:
            #     duration: 10000

            # - executeFunction:
            #     name: sc.functions.navigate.back

      - storeIn:
          key: testStatus
          value: passed
