#======================================================================================================================
#  AUTHOR: Rodrigo Pacheco C. (vn53p0i)
#  CREATED: Feb/20/2024
#  REVISION: ---
#
#  Copyright © 2024 Walmart. All rights reserved.
#======================================================================================================================

functions:

  # DESCRIPTION:  Asserts the Cart Button Quantity Counter Badge equals the given expected quantity.
  # PARAM:        ${expectedQuantity} [Mandatory] Expected quantity of the Quantity Counter Badge.
  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.top-menu.assertCartQuantity
    platform: ios
    flow:
      - log:
          message: "Expected Quantity: '${expectedQuantity}'"
          color: CYAN
      - if:
          identifier:
            label:
              - identifier: mx.mappings.ea.top-menu.cartBadgeCounter
                equals: ${expectedQuantity}
          then:
            - log:
                message: "Success: Correct Cart icon quantity."
                color: CYAN
          else:
            - failTest:
                message: "Expected quantity: '${expectedQuantity}', did not match displayed quantity."
      - log:
          message: "End function: top-menu.assertCartQuantity"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.top-menu.tapCartIcon
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.ea.top-menu.cartIcon
      - log:
          message: "End function: top-menu.tapCartIcon"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.top-menu.tapSearchField
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.ea.top-menu.searchField
      - log:
          message: "End function: top-menu.tapSearchField"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function enters text in the search field.
  # PARAM:        ${searchTerm}  [Mandatory]  Partial product name to find.
  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.top-menu.enterSearchTerm
    platform: ios
    flow:
      - log:
          message: "Search Term: '${searchTerm}'"
          color: CYAN
      - enterText:
          identifier: mx.mappings.ea.top-menu.searchField
          string: ${searchTerm}
          clickFirst: true
          clearField: true
      - log:
          message: "End function: top-menu.enterSearchTerm"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  Taps the Search button in the keyboard to complete the search. If the keyboard is not visible, it will press Enter to complete the search.
  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.top-menu.tapSearchInKeyboard
    platform: ios
    flow:
      - getString:
          identifier: mx.mappings.ea.top-menu.searchKey
          attribute: visible
          storeIn: isVisible
      - if:
          condition: ${isVisible} == false
          then:
            - enterText:
                identifier: mx.mappings.ea.top-menu.searchKey
                string: ''
                pressEnter: true
          else:
            - click:
                identifier: mx.mappings.ea.top-menu.searchKey
      - log:
          message: "End function: top-menu.tapSearchInKeyboard"
          color: BLUE
