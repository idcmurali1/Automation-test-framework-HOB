#======================================================================================================================
#  AUTHOR: Rodrigo Pacheco C. (vn53p0i)
#  CREATED: Nov/06/2023
#  REVISION: ---
#
#  Copyright © 2023 Walmart. All rights reserved.
#======================================================================================================================

functions:

  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.sort-and-filter-popup.assertPopupDisplayed
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.ea.sort-and-filter-popup.title
              - identifier: mx.mappings.ea.sort-and-filter-popup.filtersContainer
              - identifier: mx.mappings.ea.sort-and-filter-popup.seeResultsButton
              - identifier: mx.mappings.ea.sort-and-filter-popup.closeButton
          then:
            - log:
                message: "Assertion Succeeded: Sort and Filter Popup is displayed."
                color: CYAN
          else:
            - failTest:
                message: "Failed: Sort and Filter Popup did not display."
      - log:
          message: "End function: sort-and-filter-popup.assertPopupDisplayed"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function expands the 'Sold by' (Vendido por) section if not expanded already.
  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.sort-and-filter-popup.expandSoldByFilterIfNotExpanded
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: mx.mappings.ea.sort-and-filter-popup.soldByFilterExpanded
          then:
            - click:
                identifier: mx.mappings.ea.sort-and-filter-popup.soldByFilterCollapsed
            - verifyIdentifier:
                present:
                  - identifier: mx.mappings.ea.sort-and-filter-popup.soldByFilterExpanded
      - log:
          message: "End function: sort-and-filter-popup.expandSoldByFilterIfNotExpanded"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function selects an option from the 'Sold by' (Vendido por) section defined by param.
  # PARAM:        ${soldByOption}   [Mandatory]   'Sold By' option to select, options: [ ByWalmart | ByOthersAndWalmart | ByOthers ].
  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.sort-and-filter-popup.selectSoldByOption
    platform: android
    flow:
      # Verifying provided Filter Option...
      - if:
          condition: ${soldByOption} != 'ByWalmart' && ${soldByOption} != 'ByOthersAndWalmart' && ${soldByOption} != 'ByOthers'
          then:
            - failTest:
                message: "Invalid 'Sold By' Filter Option provided: '${soldByOption}'"
      - log:
          message: "'Sold by' Filter Option: '${soldByOption}'"
          color: CYAN

      # Sold and shipped by Walmart...
      - if:
          condition: ${soldByOption} == 'ByWalmart'
          then:
            - click:
                identifier: mx.mappings.ea.sort-and-filter-popup.soldByWalmartCheckbox
            - verifyIdentifier:
                checked:
                  - identifier: mx.mappings.ea.sort-and-filter-popup.soldByWalmartCheckbox
                    value: true
            - log:
                message: "'Sold and shipped by Walmart' has been selected."
                color: CYAN

      # Sold by Other Sellers and shipped by Walmart...
      - if:
          condition: ${soldByOption} == 'ByOthersAndWalmart'
          then:
            - click:
                identifier: mx.mappings.ea.sort-and-filter-popup.soldByOthersAndWalmartCheckbox
            - verifyIdentifier:
                checked:
                  - identifier: mx.mappings.ea.sort-and-filter-popup.soldByOthersAndWalmartCheckbox
                    value: true
            - log:
                message: "'Sold by Other Sellers and shipped by Walmart' has been selected."
                color: CYAN

      # Sold and shipped by Other Sellers...
      - if:
          condition: ${soldByOption} == 'ByOthers'
          then:
            - click:
                identifier: mx.mappings.ea.sort-and-filter-popup.soldByOthersCheckbox
            - verifyIdentifier:
                checked:
                  - identifier: mx.mappings.ea.sort-and-filter-popup.soldByOthersCheckbox
                    value: true
            - log:
                message: "'Sold and shipped by Other Sellers' has been selected."
                color: CYAN
      - log:
          message: "End function: sort-and-filter-popup.selectSoldByOption"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function expands the 'Customer Rating' (Opiniones) section if not expanded already.
  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.sort-and-filter-popup.expandCustomerRatingFilterIfNotExpanded
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: mx.mappings.ea.sort-and-filter-popup.customerRatingFilterExpanded
          then:
            - click:
                identifier: mx.mappings.ea.sort-and-filter-popup.customerRatingFilterCollapsed
            - verifyIdentifier:
                present:
                  - identifier: mx.mappings.ea.sort-and-filter-popup.customerRatingFilterExpanded
      - log:
          message: "End function: sort-and-filter-popup.expandCustomerRatingFilterIfNotExpanded"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function selects an option from the 'Customer Rating' (Opiniones) section defined by param.
  # PARAM:        ${customerRating}   [Mandatory]   Expected integer number of stars to select, example options: [ 1 | 2 | 5 ].
  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.sort-and-filter-popup.selectCustomerRatingOption
    platform: android
    flow:
      # Verifying provided Rating value...
      - if:
          condition: ${customerRating} > 5 || ${customerRating} < 1
          then:
            - failTest:
                message: "Invalid! 'Customer Rating' value can only be an integer between 1 and 5. Input Provided: '${customerRating}'"
      - log:
          message: "'Customer Rating' Filter Option: '${customerRating}' Stars."
          color: CYAN
      - click:
          identifier: mx.mappings.ea.sort-and-filter-popup.customerRatingOptionByNumber # <--PARAM--${customerRating}
      - log:
          message: "End function: sort-and-filter-popup.selectCustomerRatingOption"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.sort-and-filter-popup.tapSeeResults
    platform: android
    flow:
      - click:
          identifier: mx.mappings.ea.sort-and-filter-popup.seeResultsButton
      - log:
          message: "End function: sort-and-filter-popup.tapSeeResults"
          color: BLUE
