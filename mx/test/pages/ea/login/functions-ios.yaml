#=====================================================================================================================
#   AUTHOR: Rodrigo Pacheco C. (vn53p0i)
#   CREATED: Feb/15/2024
#   REVISION: ---
#
#  Copyright © 2024 Walmart. All rights reserved.
#======================================================================================================================

functions:

  # DESCRIPTION:  This method asserts Login Page is displayed.
  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.functions.ea.login.assertPageDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.ea.login.popupTitle
              - identifier: mx.mappings.ea.login.forgotPasswordButton
              - identifier: mx.mappings.ea.login.createAccountButton
              - identifier: mx.mappings.ea.login.loginButton
          then:
            - log:
                message: "Assertion succeeded: Login Popup is displayed."
                color: GREEN_BOLD
          else:
            - failTest:
                message: "Failed: Popup did not display."
      - log:
          message: "End function: login.assertPageDisplayed"
          color: BLUE

  # ----------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This method enters user's email.
  # PARAM:        ${userEmail} [Mandatory] E-mail from registered user.
  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.functions.ea.login.enterEmail
    platform: ios
    flow:
      - log:
          message: "Email: ${userEmail}"
          color: CYAN
      - enterText:
          identifier: mx.mappings.login.emailField
          string: "${userEmail}"
          clickFirst: true
          clearField: true
      - log:
          message: "End function: login.enterEmail"
          color: BLUE

  # ----------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This method enters user's password.
  # PARAM:        ${userPassword} [Mandatory] Password for registered user.
  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.functions.ea.login.enterPassword
    platform: ios
    flow:
      - log:
          message: "Password: '${userPassword}'"
          color: CYAN
      - enterText:
          identifier: mx.mappings.ea.login.passwordField
          string: "${userPassword}"
          clickFirst: true
          clearField: true
      - log:
          message: "End function: login.enterPassword"
          color: BLUE

  # ----------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This method taps on Login button.
  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.functions.ea.login.tapLogin
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.ea.login.loginButton
      - log:
          message: "End function: login.tapLogin"
          color: BLUE

  # ----------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This method asserts Incorrect Credentials Text is not Displayed.
  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.functions.ea.login.assertIncorrectCredentialsErrorNotDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: mx.mappings.ea.login.incorrectCredentialsText
          then:
           - log: 
                message: "Credentials are ok!"
                color: GREEN_BOLD
          else:
            - failTest:
                message: "Incorrect Credentials Message is displayed."
      - log:
          message: "End function: login.assertIncorrectCredentialsErrorNotDisplayed"
          color: BLUE

  # ----------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This method asserts Incorrect Credentials Text IS Displayed.
  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.login.assertIncorrectCredentialsErrorDisplayed
    platform: ios
    flow:
      - verifyIdentifier:
          label:
            - identifier: mx.mappings.ea.login.incorrectCredentialsText
              contains: 'correo electrónico y/o la contraseña son incorrectos'
      - log: 
         message: "Success: Credentials error message is displayed."
         color: GREEN_BOLD
      - log:
          message: "End function: ea.login.assertIncorrectCredentialsErrorDisplayed"
          color: BLUE

  # ----------------------------------------------------------------------------------------------------------------

  # Description: This method taps on Don't Allow buttton if displayed.
  - name: mx.functions.ea.login.save-password.tapDontAllowIfDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.ea.login.save-password.dontAllowButton 
          then:
            - click:
                identifier: mx.mappings.ea.login.save-password.dontAllowButton
      - log:
          message: "End function: login.save-password.tapDontAllow"
          color: BLUE

# ----------------------------------------------------------------------------------------------------------------

  # AUTOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.login.tapCreateAccount
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.ea.login.createAccountButton
      - log:
          message: "End function: ea.login.tapCreateAccount"
          color: BLUE

# ------------------------------------------------- CREATE-ACCOUNT -------------------------------------------------

  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.login.create-account.assertPageDisplayed
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.ea.login.create-account.createAccountNavBar
            - identifier: mx.mappings.ea.login.create-account.privacyNoticeLynk
            - identifier: mx.mappings.ea.login.create-account.createAccountButton
          timeout: 10000
            
      - log:
          message: "End function: ea.login.create-account.assertPageDisplayed"
          color: BLUE

# -------------------------------------------------------------------------------------------------------------------

  # PARAM: ${userFirstName} [Mandatory] User's first name.
  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.login.create-account.enterName
    platform: ios
    flow:
      - log:
          message: "[ PARAM: User Name -> '${userFirstName}' ]"
          color: CYAN
      - enterText:
          identifier: mx.mappings.ea.login.create-account.userFirstNameField
          string: ${userFirstName}
          clickFirst: true
      - log:
          message: "End function: ea.login.create-account.enterName"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # PARAM: ${userLastName} [Mandatory] User's Last Name.
  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.login.create-account.enterLastName
    platform: ios
    flow:
      - log:
          message: "[ PARAM: User Last Name -> '${userLastName}' ]"
          color: CYAN
      - enterText:
          identifier: mx.mappings.ea.login.create-account.userLastNameField
          string: ${userLastName}
          clickFirst: true
      - log:
          message: "End function: ea.login.create-account.enterLastName"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # PARAM: ${userEmail} [Mandatory] User's E-mail.
  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.login.create-account.enterEmail
    platform: ios
    flow:
      - log:
          message: "[ PARAM: User Email -> '${userEmail}' ]"
          color: CYAN
      - enterText:
          identifier: mx.mappings.ea.login.create-account.userEmailField
          string: ${userEmail}
          clickFirst: true
      - log:
          message: "End function: ea.login.create-account.enterEmail"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # PARAM: ${userPassword} [Mandatory] User's Password.
  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.login.create-account.enterPassword
    platform: ios
    flow:
      - log:
          message: "[ PARAM: User password -> '${userPassword}' ]"
          color: CYAN
      - enterText:
          identifier: mx.mappings.ea.login.create-account.userPasswordField
          string: "${userPassword}"
          clickFirst: true
          clearField: true
      - log:
          message: "End function: ea.login.create-account.enterPassword"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION: This method asserts no error messages are displayed, also it verifies that all the requirements
  #                or rules for the password are fulfilled.
  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.login.create-account.assertErrorsNotDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.ea.login.create-account.errorIconView
              - identifier: mx.mappings.ea.login.create-account.errorMessageTextLabel
          then:
            - failTest:
                message: "Failed: One or more input field requirements/rules were not met in form."
      - if:
          identifier:
            present:
              - identifier: mx.mappings.ea.login.create-account.passwordValidationTextView
          then:
            - failTest:
                message: "Failed: One or more password requirements/rules were not met."
      - log:
          message: "End function: ea.login.create-account.assertErrorsNotDisplayed"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.login.create-account.tapCreateAccount
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.ea.login.create-account.createAccountButton
      - log:
          message: "End function: ea.login.create-account.tapCreateAccount"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.functions.ea.login.closePopupIfDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.ea.login.popupTitle
          then:
            - log:
                message: "Login Popup displayed, closing Popup..."
                color: GREEN_BOLD
            - click:
                identifier: mx.mappings.ea.login.closeButton
          else:
            - log:
                message: "Login Popup did not displayed, Test execution will continue..."
                color: GREEN_BOLD
      - log:
          message: "End function: login.closePopupIfDisplayed"
          color: BLUE
