#======================================================================================================================
#    AUTHOR: Rodrigo Pacheco C. (vn53p0i)
#   CREATED: Oct/31/2023
#  REVISION: ---
#
#  Copyright Â© 2023 Walmart. All rights reserved.
#======================================================================================================================

functions:

  # AUTHOR: Rodrigo Pacheco C. (vn53p0i)
  - name: mx.functions.ea.addresses.assertPageDisplayed
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.ea.addresses.pageTitle
            - identifier: mx.mappings.ea.addresses.addAddressButton
            - identifier: mx.mappings.ea.addresses.addressesListContainer
            - identifier: mx.mappings.ea.addresses.backButton
      - log:
          message: "Assertion Succeeded: Addresses Page is Displayed."
          color: CYAN
      - log:
          message: "End function: addresses.assertPageDisplayed"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function clicks the Back button.
  # AUTHOR: Rodrigo Pacheco C. (vn53p0i)
  - name: mx.functions.ea.addresses.tapBack
    platform: android
    flow:
      - click:
          identifier: mx.mappings.ea.addresses.backButton
      - log:
          message: "End function: addresses.tapBack"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function clicks the Add Address button at the top left.
  # AUTHOR: Rodrigo Pacheco C. (vn53p0i)
  - name: mx.functions.ea.addresses.tapAddAddressButton
    platform: android
    flow:
      - click:
          identifier: mx.mappings.ea.addresses.addAddressButton
      - log:
          message: "End function: addresses.tapAddAddressButton"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function clicks the Edit Address button by the name of the Address (NOT by the actual address).
  # PARAM:        ${addressName} [Mandatory] Name of the address (label on top of the actual address on the list).
  # AUTHOR: Rodrigo Pacheco C. (vn53p0i)
  - name: mx.functions.ea.addresses.tapEditAddress
    platform: android
    flow:
      - click:
          identifier: mx.mappings.ea.addresses.editAddressButtonByAddressName # <--PARAM--${addressName}
      - log:
          message: "End function: addresses.tapEditAddress"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function clicks the Delete Address button by the name of the Address (NOT by the actual address).
  # PARAM:        ${addressName} [Mandatory] Name of the address (label on top of the actual address on the list).
  # AUTHOR: Rodrigo Pacheco C. (vn53p0i)
  - name: mx.functions.ea.addresses.tapDeleteAddress
    platform: android
    flow:
      - click:
          identifier: mx.mappings.ea.addresses.deleteAddressButtonByAddressName # <--PARAM--${addressName}
      - log:
          message: "End function: addresses.tapDeleteAddress"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function asserts a specific address is marked as favorite by the address name.
  # PARAM:        ${addressName} [Mandatory] Name of the address (label on top of the actual address on the list).
  # AUTHOR: Rodrigo Pacheco C. (vn53p0i)
  - name: mx.functions.ea.addresses.assertAddressIsMarkedAsFavorite
    platform: android
    flow:
      - log:
          message: "Address Name: '${addressName}'"
          color: CYAN
      - if:
          identifier:
            present:
              - identifier: mx.mappings.ea.addresses.addressFavoriteLabelByAddressName # <--PARAM--${addressName}
          then:
            - log: 
                message: "Assertion Succeeded: Expected address is marked as favorite."
                color: CYAN
          else:
            - failTest:
                message: "Assertion Failed: Expected address is not marked as favorite."
      - log:
          message: "End function: addresses.assertAddressIsMarkedAsFavorite"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function asserts a specific address is not marked as favorite by the address name.
  # PARAM:        ${addressName} [Mandatory] Name of the address (label on top of the actual address on the list).
  # AUTHOR: Rodrigo Pacheco C. (vn53p0i)
  - name: mx.functions.ea.addresses.assertAddressIsNotMarkedAsFavorite
    platform: android
    flow:
      - log:
          message: "Address Name: '${addressName}'"
          color: CYAN
      - if:
          identifier:
            notPresent:
              - identifier: mx.mappings.ea.addresses.addressFavoriteLabelByAddressName # <--PARAM--${addressName}
          then:
            - log: 
                message: "Assertion Succeeded: Expected address is not marked as favorite."
                color: CYAN
          else:
            - failTest:
                message: "Assertion Failed: Expected address is marked as favorite."
      - log:
          message: "End function: addresses.assertAddressIsNotMarkedAsFavorite"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function asserts a specific address is displayed by its name.
  # PARAM:        ${addressName} [Mandatory] Name of the address (label on top of the actual address on the list).
  # AUTHOR: Rodrigo Pacheco C. (vn53p0i)
  - name: mx.functions.ea.addresses.assertAddressListedByName
    platform: android
    flow:
      - log:
          message: "Address Name: '${addressName}'"
          color: CYAN
      - if:
          identifier:
            present:
              - identifier: mx.mappings.ea.addresses.addressByName # <--PARAM--${addressName}
          then:
            - log: 
                message: "Assertion Succeeded: Expected address name is listed."
                color: CYAN
          else:
            - failTest:
                message: "Assertion Failed: Expected address name is not listed."
      - log:
          message: "End function: addresses.assertAddressListedByName"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function asserts a specific address is NOT displayed by its name.
  # PARAM:        ${addressName} [Mandatory] Name of the address (label on top of the actual address on the list).
  # AUTHOR: Rodrigo Pacheco C. (vn53p0i)
  - name: mx.functions.ea.addresses.assertAddressNotListedByName
    platform: android
    flow:
      - log:
          message: "Address Name: '${addressName}'"
          color: CYAN
      - if:
          identifier:
            notPresent:
              - identifier: mx.mappings.ea.addresses.addressByName # <--PARAM--${addressName}
          then:
            - log: 
                message: "Assertion Succeeded: Expected address name is not listed."
                color: CYAN
          else:
            - failTest:
                message: "Assertion Failed: Expected address name is listed."
      - log:
          message: "End function: addresses.assertAddressNotListedByName"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This method verifies an address is listed by full string.
  # PARAMS:       ${addressName}        [Mandatory] Name of the address (label on top of the actual address on the list).
  #               ${addressFullString}  [Mandatory]  Full string containing the address to be validated.
  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.functions.ea.addresses.assertAddressByFullString
    platform: android
    flow:
      - log:
          message: "Expected Address Full String: '${addressFullString}'"
          color: CYAN

      # Retrieving displayed Address...
      - getString:
          identifier: mx.mappings.ea.addresses.addressStringByAddressName # <--PARAM--${addressName}
          storeIn: displayedAddress
      - log:
          message: "Displayed Address: '${displayedAddress}'"
          color: CYAN

      # Assertion by Full String...
      - if:
          identifier:
            text:
              - identifier: mx.mappings.ea.addresses.addressStringByAddressName # <--PARAM--${addressName}
                contains: ${addressFullString}
          then:
            - log:
                message: "Assertion Succeeded: Address by Full String is correct."
                color: CYAN
          else:
            - failTest:
                message: "Failed: Address by Full String is not correct."
      - log:
          message: "End function: addresses.assertAddressByFullString"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This method verifies an address is displayed by its individual values.
  # PARAMS:
  #               ${addressName}      [Mandatory]   Name of the address (label on top of the actual address on the list).
  #               ${streetName}       [Mandatory]   Name of the street to be validated.
  #               ${exteriorNumber}   [Mandatory]   Exterior number to be validated.
  #               ${city}             [Mandatory]   City to be validated.
  #               ${state}            [Mandatory]   State to be validated.
  #               ${zipCode}          [Mandatory]   ZIP Code to be validated.
  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.functions.ea.addresses.assertAddressByIndividualValues
    platform: android
    flow:
      # Using '\e[36m' to print in CYAN and '\e[0m' to reset color, to simplify logs.
      - log: "\e[36mExpected StreetName: '${streetName}'\e[0m"
      - log: "\e[36mExpected ExteriorNumber: '${exteriorNumber}'\e[0m"
      - log: "\e[36mExpected City: '${city}'\e[0m"
      - log: "\e[36mExpected State: '${state}'\e[0m"
      - log: "\e[36mExpected ZipCode: '${zipCode}'\e[0m"

      # Retrieving displayed Address...
      - getString:
          identifier: mx.mappings.ea.addresses.addressStringByAddressName # <--PARAM--${addressName}
          storeIn: displayedAddress
      - log:
          message: "Displayed Address: '${displayedAddress}'"
          color: CYAN

      # Assertion by Individual Values...
      - executeNode:
          file: mx/test/helpers/utils/stringContainsAll.js
          args:
            - value: ${displayedAddress}
            - value: ${streetName}, ${exteriorNumber}, ${city}, ${state}, ${zipCode}
          getResponse:
            storeIn: isAddressCorrect
      - if:
          condition: ${isAddressCorrect} == true
          then:
            - log:
                message: "Home Address by individual values is correct."
                color: CYAN
          else:
            - failTest:
                message: "Home Address by individual values is not correct."
      - log:
          message: "End function: addresses.assertAddressByIndividualValues"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.functions.ea.addresses.delete-address-confirmation-popup.assertPopupDisplayed
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.ea.addresses.delete-address-confirmation-popup.popupTitle
            - identifier: mx.mappings.ea.addresses.delete-address-confirmation-popup.popupMessage
            - identifier: mx.mappings.ea.addresses.delete-address-confirmation-popup.cancelButton
            - identifier: mx.mappings.ea.addresses.delete-address-confirmation-popup.deleteButton
      - log:
          message: "Assertion Succeeded: Delete Address Popup is Displayed."
          color: CYAN
      - log:
          message: "End function: addresses.delete-address-confirmation-popup.assertPopupDisplayed"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.functions.ea.addresses.delete-address-confirmation-popup.tapDelete
    platform: android
    flow:
      - click:
          identifier: mx.mappings.ea.addresses.delete-address-confirmation-popup.deleteButton
      - log:
          message: "End function: addresses.delete-address-confirmation-popup.tapDelete"
          color: BLUE
