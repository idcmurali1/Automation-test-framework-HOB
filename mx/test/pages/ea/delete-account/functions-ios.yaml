#======================================================================================================================
#    AUTHOR: Osmar Juárez (vn56dce)
#   CREATED: Mar/07/2024
#  REVISION: ---
#
#  Copyright © 2024 Walmart. All rights reserved.
#======================================================================================================================

functions:

  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.delete-account.assertPageDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.ea.delete-account.titleNavBar
              - identifier: mx.mappings.ea.delete-account.deleateMyAccountTextView
          then:
            - log:
                message: "Assertion Succeeded: Delete Account screen is displayed."
                color: GREEN_BOLD
          else:
            - failTest:
                message: "Failed: Delete Account screen is not displayed."
      - log:
          message: "End function: ea.delete-account.assertPageDisplayed"
          color: BLUE

#--------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.delete-account.tapContinueButton
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: mx.mappings.ea.delete-account.continueButton
          scrollLimit: 3
      - click:
          identifier: mx.mappings.ea.delete-account.continueButton
      - log:
          message: "End function: ea.delete-account.tapContinueButton"
          color: BLUE

#--------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.delete-account.tapCancelButton
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: mx.mappings.ea.delete-account.cancelButton
          scrollLimit: 3
      - click:
          identifier: mx.mappings.ea.delete-account.cancelButton
      - log:
          message: "End function: ea.delete-account.tapCancelButton"
          color: BLUE

#--------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.delete-account.tapPrivacyNoticeLink
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: mx.mappings.ea.delete-account.privacyNoticeLinkButton
          position: center
          scrollLimit: 3
      - click:
          identifier: mx.mappings.ea.delete-account.privacyNoticeLinkButton
      - log:
          message: "End function: ea.delete-account.tapPrivacyNoticeLink"
          color: BLUE
  
  #-------------------------------------------- PRIVACY-NOTICE-WEB-VIEW --------------------------------------------

  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.delete-account.privacy-notice-web-view.assertPageDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.ea.delete-account.privacy-notice-web-view.browserNavBar
              - identifier: mx.mappings.ea.delete-account.privacy-notice-web-view.doneButton
              - identifier: mx.mappings.ea.delete-account.privacy-notice-web-view.webViewContainer
              - identifier: mx.mappings.ea.delete-account.privacy-notice-web-view.privacyNoticeTitleTextView
            timeout: 35000
          then:
            - log:
                message: "Assertion Succeeded: Web Browser displayed with Privacy Notice."
                color: GREEN_BOLD
          else:
            - failTest:
                message: "Failed: Web Browser is not present or Web Browser with Privacy Notice is not displayed."
      - log:
          message: "End function: ea.delete-account.privacy-notice-web-view.assertPageDisplayed"
          color: BLUE
  
  #--------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.delete-account.privacy-notice-web-view.tapDoneWebView
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.ea.delete-account.privacy-notice-web-view.doneButton
      - log:
          message: "End function: ea.delete-account.privacy-notice-web-view.tapDoneWebView"
          color: BLUE

  #-------------------------------------------- QUICK-SECURITY-CHECK-POPUP --------------------------------------------

  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.delete-account.quick-security-check-popup.assertPageDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.ea.delete-account.quick-security-check-popup.titleNavBar
              - identifier: mx.mappings.ea.delete-account.quick-security-check-popup.closeButon
              - identifier: mx.mappings.ea.delete-account.quick-security-check-popup.enterPasswordField
              - identifier: mx.mappings.ea.delete-account.quick-security-check-popup.continueButton
          then:
            - log:
                message: "Assertion Succeeded: Quick Security Check Poup is displayed."
                color: GREEN_BOLD
          else:
            - failTest:
                message: "Failed: Quick Security Check Poup is not displayed."
      - log:
          message: "End function: ea.delete-account.quick-security-check-popup.assertPageDisplayed"
          color: BLUE
  
  #--------------------------------------------------------------------------------------------------------------------

  # PARAM: ${expectedEmailAddress}  Expected user email displayed in popup to verify user 
  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.delete-account.quick-security-check-popup.assertEmailDisplayed
    platform: ios
    flow:
      - log:
          message: "[ PARAM: Expected email address -> '${expectedEmailAddress}' ]"
          color: CYAN
      - if:
          identifier:
            label:
              - identifier: mx.mappings.ea.delete-account.quick-security-check-popup.emailAddressTextLabel
                equals: ${expectedEmailAddress}
          then:
            - log:
                message: "Assertion Succeeded: expected email is displayed."
                color: GREEN_BOLD
          else:
            - getString:
                identifier: mx.mappings.ea.delete-account.quick-security-check-popup.emailAddressTextLabel
                attribute: label
                storeIn: displayedEmail
            - failTest:
                message: "Failed: expected email: '${expectedEmailAddress}' != displayed email: '${displayedEmail}' "
      - log:
          message: "End function: ea.delete-account.quick-security-check-popup.assertEmailDisplayed"
          color: BLUE


  #--------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.delete-account.quick-security-check-popup.tapContinue
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.ea.delete-account.quick-security-check-popup.continueButton
      - log:
          message: "End function: ea.delete-account.quick-security-check-popup.tapContinue"
          color: BLUE
  
  #--------------------------------------------------------------------------------------------------------------------

  # PARAM: ${userPassword}  User's password as a string
  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.delete-account.quick-security-check-popup.enterPassword
    platform: ios
    flow:
      - log:
          message: "[ PARAM: User password to enter -> '${userPassword}' ]"
          color: CYAN
      - enterText:
          identifier: mx.mappings.ea.delete-account.quick-security-check-popup.enterPasswordField
          string: ${userPassword}
          clickFirst: true
          clearField: true
      - log:
          message: "End function: ea.delete-account.quick-security-check-popup.enterPassword"
          color: BLUE