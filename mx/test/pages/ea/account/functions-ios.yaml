#======================================================================================================================
#    AUTHOR: Rodrigo Pacheco C. (vn53p0i)
#   CREATED: Feb/15/2024
#  REVISION: ---
#
#  Copyright © 2024 Walmart. All rights reserved.
#======================================================================================================================

functions:

  # DESCRIPTION:  This method clicks on the login button from the account page when user is not logged in.
  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.account.tapLogin
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.ea.account.loginButton
      - log:
          message: "End function: account.tapLogin"
          color: BLUE

# -------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.account.tapCreateAccount
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.ea.account.createAccountButton
      - log:
          message: "End function: ea.account.tapCreateAccount"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This method asserts if Account page is displayed correctly.
  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.account.assertPageDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.ea.account.genericHeaderLabel
              - identifier: mx.mappings.ea.account.genericOptionsContainer
          then:
            - log:
                message: "Assertion Succeeded: Account Page is Displayed."
                color: GREEN_BOLD
          else:
            - failTest:
                message: "Failed: Account Page did not Display."
      - log:
          message: "End function: account.assertPageDisplayed"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function asserts that the user is logged on account page.
  # PARAM:        ${userName} [Mandatory] user name to assert in account page.
  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.ea.account.assertUserLogged
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.ea.account.loggedUserHeader
            - identifier: mx.mappings.ea.account.loggedInOptionsContainer
      - log:
          message: "Success: User '${userName}' logged"
          color: GREEN_BOLD
      - log:
          message: "End function: account.assertUserLogged"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Rodrigo Pacheco C. (vn53p0i)
  - name: mx.functions.ea.account.openOrdersHistory
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.ea.account.ordersHistoryButton
      - log:
          message: "End function: account.openOrdersHistory"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.account.customer-service.tapAccountDeletionRequest
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: mx.mappings.ea.account.customer-service.accountDeletionRequestButton
          scrollLimit: 5
      - click:
          identifier: mx.mappings.ea.account.customer-service.accountDeletionRequestButton
      - log:
          message: "End function: account.openOrdersHistory"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION:  This function asserts that any user are not logged on account page.
  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.account.assertNoUserLogged
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.ea.account.loginButton
      - verifyIdentifier:
          label:
            - identifier: mx.mappings.ea.account.genericHeaderLabel
              equals: 'Cuenta'
      - log:
          message: "Success: No user is logged"
          color: GREEN_BOLD
      - log:
          message: "End function: account.assertNoUserLogged"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Rodrigo Pacheco C. (vn53p0i)
  - name: mx.functions.ea.account.openAddresses
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.ea.account.addressesButton
      - log:
          message: "End function: account.openAddresses"
          color: BLUE

  # -------------------------------------- CONFIRM-DELETION-ACCOUNT-PROCESS-POPUP --------------------------------------

  # DESCRIPTION: Function to assert popup displayed after an account is deleted. 
  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.account.confirm-deletion-account-process-popup.assertPageDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.ea.account.confirm-deletion-account-process-popup.titleNavBar
              - identifier: mx.mappings.ea.account.confirm-deletion-account-process-popup.deletionProcessTitleTextView
              - identifier: mx.mappings.ea.account.confirm-deletion-account-process-popup.deletionProcessInfoTextView
              - identifier: mx.mappings.ea.account.confirm-deletion-account-process-popup.understoodButton
            timeout: 30000
          then:
            - log:
                message: "Assertion Succeeded: Deletion Account Process Popup is Displayed."
                color: GREEN_BOLD
          else:
            - failTest:
                message: "Failed: Account Deletion Account Process Popup did not Display."
      - log:
          message: "End function: ea.account.confirm-deletion-account-process-popup.assertPageDisplayed"
          color: BLUE
  
  # -------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.ea.account.confirm-deletion-account-process-popup.tapUnderstoodButton
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.ea.account.confirm-deletion-account-process-popup.understoodButton
      - log:
          message: "End function: ea.account.confirm-deletion-account-process-popup.tapUnderstoodButton"
          color: BLUE
