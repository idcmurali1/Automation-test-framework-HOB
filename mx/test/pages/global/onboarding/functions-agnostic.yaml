#======================================================================================================================
#  AUTHOR: Francisco Javier Ramírez Hernández (vn53vq4)
#  CREATED: Oct/17/2022
#  REVISION: ---
#
#  Copyright © 2022 Walmart. All rights reserved.
#======================================================================================================================

functions:

  # Description: This method checks if onboarding process is active
  - name: mx.functions.onboarding.isOnboardingDisplayed
    flow:
      - storeIn:
          key: returnedIsDisplayed
          value: false
      - if:
          identifier:
            present:
              - identifier: mx.mappings.onboarding.welcomePage
          then:
            - storeIn:
                key: returnedIsDisplayed
                value: true
            - log:
                message: "End function: onboarding.isOnboardingDisplayed (Displayed)"
                color: BLUE
          else: 
            - log:
                message: "End function: onboarding.isOnboardingDisplayed (Not displayed)"
                color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This method taps on Allow Notifications button
  - name: mx.functions.onboarding.tapContinue
    flow: 
      - click: 
          identifier: mx.mappings.onboarding.continueButton
          coordinates: 75%, 75%
      - log:
          message: "End function: onboarding.tapContinue"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This method taps on Allows Once Button 
  - name: mx.functions.onboarding.location-popup.tapAllowOnce
    flow: 
      - click: 
          identifier: mx.mappings.onboarding.location-popup.allowOnceButton

  #--------------------------------------------------------------------------------------------------------------------
  
  # Description: This method taps on Continue as Guest button
  - name: mx.functions.onboarding.tapContinueAsGuest
    flow: 
      - click: 
          identifier: mx.mappings.onboarding.continueAsGuestButton
      - log:
          message: "End function: onboarding.tapContinueAsGuest"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  - name: mx.functions.onboarding.tapEnableWithZipCode
    flow: 
      - click: 
          identifier: mx.mappings.onboarding.enterZipCodeButton
      - log:
          message: "End function: onboarding.tapEnableWithZipCode"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  - name: mx.functions.onboarding.location.assertEnterZipCodePageDisplayed
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.onboarding.location-popup.zipCodePage
            - identifier: mx.mappings.onboarding.location.zipCodeField
            - identifier: mx.mappings.onboarding.location.searchButton
            - identifier: mx.mappings.onboarding.location.useCurrentLocationButton
      - log:
          message: "End function: onboarding.location.assertEnterZipCodePageDisplayed (Displayed)"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This method taps on Login button
  - name: mx.functions.onboarding.tapLogin
    flow: 
      - click: 
          identifier: mx.mappings.onboarding.loginButton
      - log:
          message: "End function: onboarding.tapLogin"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This method asserts Allow Location Popup is displayed
  - name: mx.functions.onboarding.location-popup.assertAllowLocationPopUpDisplayed
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.onboarding.location-popup.allowLocationPopup
            - identifier: mx.mappings.onboarding.location-popup.allowWhileUsingButton
            - identifier: mx.mappings.onboarding.location-popup.allowOnceButton
            - identifier: mx.mappings.onboarding.location-popup.notAllowButton
      - log:
          message: "End function: onboarding.location-popup.assertAllowLocationPopUpDisplayed"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------
  
  - name: mx.functions.onboarding.location-popup.isPopupDisplayed
    flow:
      - storeIn:
          key: returnedIsDisplayed
          value: false
      - if:
          identifier:
            present:
              - identifier: mx.mappings.onboarding.location-popup.allowLocationPopup
            timeout: 5000
          then:
            - storeIn:
                key: returnedIsDisplayed
                value: true
  