#======================================================================================================================
#  AUTHOR: Francisco Javier Ramírez Hernández (vn53vq4)
#  CREATED: Oct/26/2022
#  REVISION: ---
#
#  Copyright © 2022 Walmart. All rights reserved.
#======================================================================================================================

functions:

  # Description: This method enters user's email
  # Param ${userEmail} [Mandatory] E-mail from registered user
  - name: mx.functions.login.enterEmail
    platform: ios
    flow:
      - enterText:
          identifier: mx.mappings.login.emailField
          string: ${userEmail}
          clickFirst: true
          clearField: true
      - log:
          message: "End function: login.enterEmail"
          color: BLUE
  
  # ----------------------------------------------------------------------------------------------------------------
  
  # Description: This method enters user's password
  # Param ${userPassword} [Mandatory] User's password from registered user
  - name: mx.functions.login.enterPassword
    platform: ios
    flow:
      - enterText:
          identifier: mx.mappings.login.passwordField
          string: ${userPassword}
          clickFirst: true
          clearField: true
      - log:
          message: "End function: login.enterPassword"
          color: BLUE

  # ----------------------------------------------------------------------------------------------------------------
  
  # Description: This method taps on show Password
  - name: mx.functions.login.tapShowPassword
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.showPasswordButton

  # ----------------------------------------------------------------------------------------------------------------
  
  # Description: This method taps on Hide Password Button
  # [Condition]: Text must be already displayed
  # Note: Mapping is the same as the Show Button due the location of the element
  - name: mx.functions.login.tapHidePassword
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.hidePasswordButton

  # ----------------------------------------------------------------------------------------------------------------
  
  # Description: This method taps on Forgot Password
  - name: mx.functions.login.tapForgotPassword
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.forgotPasswordButton

  # ----------------------------------------------------------------------------------------------------------------
  
  # Description: This method taps on Login Button
  - name: mx.functions.login.tapLogin
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.loginButton
          coordinates: 75%, 75%
      - log:
          message: "End function: login.tapLogin"
          color: BLUE

  # ----------------------------------------------------------------------------------------------------------------
  
  # Description: This method taps on Close Login View
  - name: mx.functions.login.tapClose
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.closeButton

  # ----------------------------------------------------------------------------------------------------------------
  
  # Description: This method asserts Incorrect Credentials Text Displayed
  - name: mx.functions.login.assertIncorrectCredentialsErrorDisplayed
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.login.incorrectCredentialsText
  
  # ----------------------------------------------------------------------------------------------------------------
  
  # AUTHOR: Francisco Ramirez (vn53vq4)
  - name: mx.functions.login.assertInvalidEmailTextDisplayed
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.login.invalidEmailMessage
      - log:
          message: "End function: login.assertInvalidEmailTextDisplayed"
          color: BLUE
  
  # ----------------------------------------------------------------------------------------------------------------
  
  # AUTHOR: ?????
  # EDITOR: Sergio Fernandez (vn0t1qt)
  - name: mx.functions.login.assertIncorrectCredentialsErrorNotDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.login.incorrectCredentialsText
          then:
            - failTest:
                message: "Failed Assertion: Incorrect Credentials Error is displayed."
          else:
            - log:
                message: "Successful Assertion: Incorrect Credentials Error not displayed"
                color: CYAN
      - log:
          message: "End function: login.assertIncorrectCredentialsErrorNotDisplayed"
          color: BLUE

  # ----------------------------------------------------------------------------------------------------------------

  # Description: This method enters user's email from forgotten account
  # Param ${userEmail} [Mandatory] E-mail from forgotten account
  - name: mx.functions.login.forgot-password.enterEmail
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.emailField
      - enterText:
          identifier: mx.mappings.login.emailField
          string: ${userEmail}

  # ----------------------------------------------------------------------------------------------------------------

  # Description: This method taps on Continue button
  - name: mx.functions.login.forgot-password.tapContinue
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.forgot-password.continueButton

  # ----------------------------------------------------------------------------------------------------------------

  # Description: This method taps on Back button
  - name: mx.functions.login.forgot-password.tapBack
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.forgot-password.backButton

  # ----------------------------------------------------------------------------------------------------------------

  # Description: This method taps on Close button
  - name: mx.functions.login.forgot-password.tapClose
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.forgot-password.closeButton

  # ----------------------------------------------------------------------------------------------------------------

  # Description: Assert Forgot Password Page  is displayed
  - name: mx.functions.login.forgot-password.assertPageDisplayed
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.login.forgot-password.pageTitle
            - identifier: mx.mappings.login.forgot-password.enterYourForgottenEmailText
            - identifier: mx.mappings.login.forgot-password.continueButton
            - identifier: mx.mappings.login.forgot-password.backButton
            - identifier: mx.mappings.login.forgot-password.closeButton
  

  # ----------------------------------------------------------------------------------------------------------------
  
  # Description: This method taps on Back to Login Button
  - name: mx.functions.login.forgot-password-confirmation.tapBackToLogin
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.forgot-password-confirmation.backToLoginButton

  # ----------------------------------------------------------------------------------------------------------------
  
  # Description: This method taps on Close Button
  - name: mx.functions.login.forgot-password-confirmation.tapClose
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.forgot-password-confirmation.closeButton
  
  # ----------------------------------------------------------------------------------------------------------------
  
  # Description: This method asserts forgot password confirmation page is displayed
  - name: mx.functions.login.forgot-password-confirmation.assertPageDisplayed
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.login.forgot-password-confirmation.checkYourEmailTitle
            - identifier: mx.mappings.login.forgot-password-confirmation.emailInstructionsText
            - identifier: mx.mappings.login.forgot-password-confirmation.backToLoginButton
            - identifier: mx.mappings.login.forgot-password-confirmation.closeButton

  # ----------------------------------------------------------------------------------------------------------------
  
  # Description: This method asserts correct user's email is displayed
  # Param ${userEmail} [Mandatory] User's Emails from forgotten account
  - name: mx.functions.login.forgot-password-confirmation.assertCorrectEmailDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.login.forgot-password-confirmation.correctUserEmailDisplayedText
          then:
           - log: "Correct email address!"
          else:
            - failTest:
                message: "Incorrect Email Address!"

  # ----------------------------------------------------------------------------------------------------------------

  # Description: This method taps on Show Password button
  - name: mx.functions.login.create-account.tapShowPassword
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.create-account.showPasswordButton

  # ----------------------------------------------------------------------------------------------------------------

  # Description: This method taps on Hide Password button
  - name: mx.functions.login.create-account.tapHidePassword
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.create-account.hidePasswordButton

  # ----------------------------------------------------------------------------------------------------------------

  # Description: This method checks on propaganda button
  - name: mx.functions.login.create-account.tapPropagandaCheckbox
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.create-account.propagandaCheckBox

  # ----------------------------------------------------------------------------------------------------------------

  # Description: This method taps on close button
  - name: mx.functions.login.create-account.tapClose
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.forgot-password.closeButton

  # ----------------------------------------------------------------------------------------------------------------

  # Description: This method Asserts Propaganda checkbox is marked
  - name: mx.functions.login.create-account.assertPropagandaCheckboxMarked
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.login.create-account.propagandaCheckboxIsMarked
          then:
           - log: "Propaganda Checkbox is already marked!"
          else:
            - failTest:
                message: "Propaganda checkbox is not marked!"

  # ----------------------------------------------------------------------------------------------------------------

  # Description: This method Asserts Propaganda checkbox is unmarked
  - name: mx.functions.login.create-account.assertPropagandaCheckboxUnmarked
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: mx.mappings.login.create-account.propagandaCheckboxIsMarked
          then:
           - log: "Propaganda Checkbox is Unmarked!"
          else:
            - failTest:
                message: "Propaganda checkbox is still marked!"

  # -------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.functions.login.closePopupIfDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.login.popupTitle
          then:
            - log:
                message: "Login Popup displayed, closing Popup..."
                color: GREEN_BOLD
            - click:
                identifier: mx.mappings.login.closeButton
          else:
            - log:
                message: "Login Popup did not displayed, Test execution will continue..."
                color: GREEN_BOLD
      - log:
          message: "End function: login.closePopupIfDisplayed"
          color: BLUE

  # ----------------------------------------------------------------------------------------------------------------

 # Description: This method Asserts Save Password pop-up is displayed.
  - name: mx.functions.login.save-password.assertPopupDisplayed
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.login.save-password.savePasswordPopup
      - log:
          message: "End function: login.save-password.assertPopupDisplayed"
          color: BLUE

  # ----------------------------------------------------------------------------------------------------------------

  # Description: This method taps on Don't Allow buttton.
  - name: mx.functions.login.save-password.tapDontAllow
    platform: ios
    flow:
      - click:
          identifier: mx.mappings.login.save-password.dontAllowButton
      - log:
          message: "End function: login.save-password.tapDontAllow"
          color: BLUE

  # ----------------------------------------------------------------------------------------------------------------

  # Description: This method taps on Don't Allow buttton if displayed.
  - name: mx.functions.login.save-password.tapDontAllowIfDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.login.save-password.dontAllowButton 
          then:
            - click:
                identifier: mx.mappings.login.save-password.dontAllowButton
      - log:
          message: "End function: login.save-password.tapDontAllow"
          color: BLUE

  # ----------------------------------------------------------------------------------------------------------------

  # AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
  - name: mx.functions.login.save-password.bottom-popup.closePopupIfDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.login.save-password.bottom-popup.popupContainer
          then:
            - click:
                identifier: mx.mappings.login.save-password.bottom-popup.notNowButton
      - log:
          message: "End function: login.save-password.bottom-popup.closePopupIfDisplayed"
          color: BLUE
  # ----------------------------------------------------------------------------------------------------------------

  # DESCRIPTION: function to click on button 'continue' if poup 'Una cuenta exclusiva para ti' is displayed
  # AUTHOR: Francisco Ramirez (vn53vq4)
  - name: mx.functions.login.dissmissOneExlcusiveAccountIfDisplayed
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.login.one-exclusive-account-popup.titleTextView
          then:
            - log:
                message: "'Una cuenta exclusiva para ti' poup is displayed. Proceed to dismiss by tapping on 'Continuar'"
                color: CYAN
            - click:
                identifier: mx.mappings.login.one-exclusive-account-popup.continueButton
      - log:
          message: "End function: mx.functions.login.dissmissOneExlcusiveAccountIfDisplayed"
          color: BLUE
  
  # ----------------------------------------------------------------------------------------------------------------
  
  # AUTHOR: Francisco Ramirez (vn53vq4)
  - name: mx.functions.login.complete-your-information.assertPageDisplayed
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.login.complete-your-information.pageTitle
      - log:
          message: "End function: login.complete-your-information.assertPageDisplayed"
          color: BLUE
  
  # ----------------------------------------------------------------------------------------------------------------
  
  # AUTHOR: Francisco Ramirez (vn53vq4)
  - name: mx.functions.login.welcome-page.assertPageDisplayed
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.login.password.welcomeTitle
      - log:
          message: "End function: login.welcome-page.assertPageDisplayed"
          color: BLUE