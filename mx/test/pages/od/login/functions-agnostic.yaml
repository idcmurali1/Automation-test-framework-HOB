#======================================================================================================================
#  AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
#  CREATED: Mar/23/2023
#  REVISION: ---
#
#  Copyright © 2023 Walmart. All rights reserved.
#======================================================================================================================

functions:

  # Description: This method asserts Login Page is displayed
  # Author: ??
  # Editor: Osmar Juárez (vn56dce)
  - name: mx.functions.login.assertPageDisplayed
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.login.popupTitle
            - identifier: mx.mappings.login.loginButton
      - log:
          message: "End function: login.assertPageDisplayed"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.functions.login.closePopupIfDisplayed
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.login.popupTitle
          then:
            - log:
                message: "Login Popup displayed, closing Popup..."
                color: CYAN
            - click:
                identifier: mx.mappings.login.closeButton
          else:
            - log:
                message: "Login Popup did not displayed, Test execution will continue..."
                color: CYAN
      - log:
          message: "End function: login.closePopupIfDisplayed"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  - name: mx.functions.login.tapCreateAccount
    flow:
      - click:
          identifier: mx.mappings.login.createAccountButton
      - log:
          message: "End function: login.tapCreateAccount"
          color: BLUE

  # CREATE-ACCOUNT ####################################################################################################

  - name: mx.functions.login.create-account.assertPageDisplayed
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.login.create-account.createAccountText
            - identifier: mx.mappings.login.create-account.createAccountButton
            - identifier: mx.mappings.login.create-account.termsAndConditionsText
      - log:
          message: "End function: login.create-account.assertPageDisplayed"
          color: BLUE
  
  # -------------------------------------------------------------------------------------------------------------------

  # Description: This method enters user's name.
  # Param ${userFirstName} [Mandatory] User's first name.
  - name: mx.functions.login.create-account.enterName
    flow:
      - enterText:
          identifier: mx.mappings.login.create-account.userFirstNameField
          string: ${userFirstName}
          clickFirst: true
      - log:
          message: "End function: login.create-account.enterName"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # Description: This method enters user's last name.
  # Param ${userLastName} [Mandatory] User's Last Name.
  - name: mx.functions.login.create-account.enterLastName
    flow:
      - enterText:
          identifier: mx.mappings.login.create-account.userLastNameField
          string: ${userLastName}
          clickFirst: true
      - log:
          message: "End function: login.create-account.enterLastName"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # Description: This method enters user's email.
  # Param ${userEmail} [Mandatory] User's E-mail.
  - name: mx.functions.login.create-account.enterEmail
    flow:
      - enterText:
          identifier: mx.mappings.login.create-account.userEmailField
          string: ${userEmail}
          clickFirst: true
      - log:
          message: "End function: login.create-account.enterEmail"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # Description: This method enters user's password.
  # Param ${userPassword} [Mandatory] User's Password.
  - name: mx.functions.login.create-account.enterPassword
    flow:
      - enterText:
          identifier: mx.mappings.login.create-account.userPasswordField
          string: ${userPassword}
          clickFirst: true
      - log:
          message: "End function: login.create-account.enterPassword"
          color: BLUE
  
  # -------------------------------------------------------------------------------------------------------------------

  # Description: This method asserts no error messages are displayed, also it verifies that all the requirements
  #                or rules for the password are fulfilled.
  - name: mx.functions.login.create-account.assertErrorsNotDisplayed
    flow:
      - verifyIdentifier:
          notPresent:
            - identifier: mx.mappings.login.create-account.firstNameErrorMessage
            - identifier: mx.mappings.login.create-account.lastNameErrorMessage
            - identifier: mx.mappings.login.create-account.emailErrorMessage
      - if:
          identifier:
            present:
              - identifier: mx.mappings.login.create-account.passwordErrorMessage
          then:
            - failTest:
                message: "Failed: One or more password requirements/rules were not met."
      - log:
          message: "End function: login.create-account.assertNoErrorsDisplayed"
          color: BLUE
  
  # -------------------------------------------------------------------------------------------------------------------

  - name: mx.functions.login.create-account.tapCreateAccount
    flow:
      - click:
          identifier: mx.mappings.login.create-account.createAccountButton
      - log:
          message: "End function: login.create-account.tapCreateAccount"
          color: BLUE
  
  # -------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION: This function taps back button.
  # AUTHOR: Francisco Ramirez (vn53vq4)
  - name: mx.functions.login.create-account.tapBack
    flow:
      - click:
          identifier: mx.mappings.login.forgot-password.backButton
      - log:
          message: "End function: login.create-account.tapBack"
          color: BLUE

  # SAVE-PASSWORD #####################################################################################################

  # Note: This function only works on iOS because the save-password popup only displays there, but during the android
  #         test execution this function does not interfere.
  - name: mx.functions.login.save-password.closePopupIfDisplayed
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.login.save-password.savePasswordPopup
          then:
            - executeFunction:
                name: mx.functions.login.save-password.tapDontAllow
      - log:
          message: "End function: login.save-password.tapDontAllow"
          color: BLUE
