#======================================================================================================================
#  AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
#  CREATED: Mar/13/2023
#  REVISION: ---
#
#  Copyright © 2023 Walmart. All rights reserved.
#======================================================================================================================

functions:

  - name: mx.functions.store-selector-popup.assertPageDisplayed
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.store-selector-popup.pageTitle
            - identifier: mx.mappings.store-selector-popup.zipcodeField
            - identifier: mx.mappings.store-selector-popup.closeButton
      - log:
          message: "End function: store-selector-popup.assertPageDisplayed"
          color: BLUE


  #--------------------------------------------------------------------------------------------------------------------

  # Description: This method asserts the current location zip code (genetared after tapping/Clicking that button) vs the expected zipcode.
  # Param ${expectedZipcode} [Mandatory] Expected zip code
  - name: mx.functions.store-selector-popup.assertCurrentLocation
    flow:
      - log:
          message: "Expected zip code ${expectedZipcode}"
          color: CYAN
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.store-selector-popup.zipcodeFieldForAssertion
      - log:
          message: "Correct zip code"
          color: CYAN
      - log:
          message: "End function: store-selector-popup.assertCurrentLocation"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: Scrolls down until store with name is displayed
  # Param ${storeName} [Mandatory] Store name
  - name: mx.functions.store-selector-popup.scrollDownToAddress
    flow:
      - log:
          message: "Store name: ${storeName}"
          color: CYAN
      - if:
          condition: ${APP_PLATFORM} == 'android'
          then:
            - if:
                identifier:
                  notPresent:
                    - identifier: mx.mappings.store-selector-popup.storeByName
                then:
                  - scroll:
                      direction: down
                      untilIdentifier: mx.mappings.store-selector-popup.storeByName
                      withinIdentifier: mx.mappings.store-selector-popup.storeListContainer
                      scrollLimit: 18
                      position: center
                      wait: 1000
                  - verifyIdentifier:
                      present:
                        - identifier: mx.mappings.store-selector-popup.storeByName
          else:
            - if:
                identifier:
                  visible:
                    - identifier: mx.mappings.store-selector-popup.storeByName
                      value: 'false'
                then:
                  - scroll:
                      direction: down
                      untilIdentifier: mx.mappings.store-selector-popup.storeByName
                      withinIdentifier: mx.mappings.store-selector-popup.storeListContainer
                      scrollLimit: 18
                      position: center
                      wait: 1000
                  - verifyIdentifier:
                      visible:
                        - identifier: mx.mappings.store-selector-popup.storeByName
                          value: 'true'
      - log:
          message: "End function: store-selector-popup.scrollDownToAddress"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: Selects the store by the name provided in parameter.
  # Param ${storeName} [Mandatory] Store name
  - name: mx.functions.store-selector-popup.selectStore
    flow:
      - log:
          message: "Store name: ${storeName}"
          color: CYAN
      - sleep:
          duration: 2000
      - click:
          identifier: mx.mappings.store-selector-popup.storeByName
      - log:
          message: "End function: store-selector-popup.selectStore"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This method enters zip code
  # Param ${zipCode} [Mandatory] Store zip code 
  - name: mx.functions.store-selector-popup.enterZipCode
    flow:
      - enterText:
          identifier: mx.mappings.store-selector-popup.zipcodeField
          string: "${zipCode}"
          clearField: true
          pressEnter: true
      - log:
          message: "End function: store-selector-popup.enterZipCode"
          color: BLUE
  
  #--------------------------------------------------------------------------------------------------------------------

  # DESCRIPTION: This method select a type of store to filter in store selector. This filters only apears in Bodega App
  # PARAM: ${storeTypeName} [Mandatory] Store Type Name tot select in filter 
  # AUTHOR: Osmar Juárez (vn56dce)
  - name: mx.functions.store-selector-popup.selectFilterByStoreType
    flow:
      - scroll:
          direction: left
          untilIdentifier: mx.mappings.store-selector-popup.storeTypeFilterScrollView
          withinIdentifier: mx.mappings.store-selector-popup.storeTypeFilterByName # PARAM: --${storeTypeName}--
          scrollLimit: 5
      - click:
          identifier: mx.mappings.store-selector-popup.storeTypeFilterByName # PARAM: --${storeTypeName}--
      - log:
          message: "mx.functions.store-selector-popup.selectFilterByStoreType"
          color: BLUE
