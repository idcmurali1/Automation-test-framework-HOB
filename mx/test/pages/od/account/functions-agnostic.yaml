#======================================================================================================================
#  AUTHOR: Francisco Javier Ramirez Hernandez (vn53vq4)
#  CREATED: Mar/13/2023
#  REVISION: ---
#
#  Copyright Â© 2023 Walmart. All rights reserved.
#======================================================================================================================

functions:

  # Description: This method clicks on the login button from the account page when user is not logged in
  - name: mx.functions.account.tapLogin
    flow: 
      - click: 
          identifier: mx.mappings.account.loginButton
          coordinates: 75%, 75%
      - log:
          message: "End function: account.tapLogin"
          color: BLUE
  # ------------------------------------------------------------------------------------------------------------

  # Description: This method asserts if Account page is displayed correctly
  - name: mx.functions.account.assertPageDisplayed
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.account.genericHeaderLabel
            - identifier: mx.mappings.account.genericOptionsContainer
      - log:
          message: "End function: account.assertPageDisplayed (Displayed)"
          color: BLUE

  # ------------------------------------------------------------------------------------------------------------
  
  # Description: This function asserts that the user is logged on account page
  # Param: ${userName} [Mandatory] user name to assert in account page.
  - name: mx.functions.account.assertUserLogged
    flow:
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.account.loggedUserHeader
            - identifier: mx.mappings.account.loggedInOptionsContainer
      - log:
          message: "User '${userName}' logged"
          color: CYAN
      - log:
          message: "End function: account.assertUserLogged"
          color: BLUE

  # ------------------------------------------------------------------------------------------------------------

  # Description: This method opens the wallet
  - name: mx.functions.account.openWallet
    flow: 
      - click: 
          identifier: mx.mappings.account.walletButton
      - log:
          message: "End function: account.openWallet"
          color: BLUE

  # ------------------------------------------------------------------------------------------------------------

  - name: mx.functions.account.assertUserNotLogged
    flow: 
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.account.loginButton
            - identifier: mx.mappings.account.notLoggedUserHeader
            - identifier: mx.mappings.account.loggedOutOptionsContainer
      - log:
          message: "End function: account.assertUserNotLogged"
          color: BLUE

  # ------------------------------------------------------------------------------------------------------------

  - name: mx.functions.account.openPersonalInformation
    flow: 
      - click: 
          identifier: mx.mappings.account.personalInformationButton
      - log:
          message: "End function: account.openPersonalInformation"
          color: BLUE

  # ------------------------------------------------------------------------------------------------------------

  # NOTE: On Android the button is visible from the top of the page and on iOS the click works even if button is 
  #         not visible, that is why a scroll wasn't needed.
  - name: mx.functions.account.openAddresses
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: mx.mappings.account.addressesButton
          then:
            - scroll:
                direction: down
                untilIdentifier: mx.mappings.account.addressesButton
      - click: 
          identifier: mx.mappings.account.addressesButton
      - log:
          message: "End function: account.openAddresses"
          color: BLUE
  
  # ------------------------------------------------------------------------------------------------------------
  # Description: This function close the new "Cell phone collection" popup if displayed.
  - name: mx.functions.account.cellphone-collection-popup.closePopupIfDisplayed
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.account.phone-collection-popup.titleLabel
          then:
            - click:
                identifier: mx.mappings.account.phone-collection-popup.notNowButton
      - log:
          message: "End function: account.cellphone-collection-popup.closePopupIfDisplayed"
          color: BLUE

  # ------------------------------------------------------------------------------------------------------------
  # Description: This function closes the cashi popup if displayed. 
  - name: mx.functions.account.cashi-popup.closePopupIfDisplayed
    platform:
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.account.cashi-popup.titleLabel
          then:
            - click:
                identifier: mx.mappings.account.cashi-popup.closeButton
      - log:
          message: "End function: mx.functions.account.cashi-popup.closePopupIfDisplayed"
          color: BLUE
        