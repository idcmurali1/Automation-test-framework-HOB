#======================================================================================================================
#  AUTHOR: Francisco Javier Ramirez Hernandez
#  CREATED: Mar/28/2023
#  REVISION: ---
#
#  Copyright Â© 2023 Walmart. All rights reserved.
#======================================================================================================================

functions:

  #--------------------------------------------------------------------------------------------------------------------
   
  # Description: This method asserts a card was added successfully. (recently added)
  # Param: ${last4Digits} [Mandatory] User's card termination.
  - name: mx.functions.wallet.assertCardAdded
    platform: ios
    flow: 
        - verifyIdentifier:
            present:
                - identifier: mx.mappings.wallet.add-card.cardLast4Digits
        - log:
            message: "End function: wallet.assertCardAdded"
            color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This method asserts Credit/ Debit card was added. (Listed in card container)
  # Param ${last4Digits} [Mandatory] Last 4 digits of the CC/DC.
  - name: mx.functions.wallet.assertCardAddedByLast4Digits
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: mx.mappings.wallet.add-card.cardLast4Digits
          then:
            - log: 
                message: Card ${last4Digits} added.
                color: CYAN
          else:
            - scroll:
                direction: right
                scrollLimit: 2
                untilIdentifier: mx.mappings.wallet.add-card.cardLast4Digits
                withinIdentifier: mx.mappings.wallet.add-card.cardsContainer
            - if:
                identifier:
                  present:
                    - identifier: mx.mappings.wallet.add-card.cardLast4Digits
                then:     
                 - log: 
                    message: Card ${last4Digits} added.  
                    color: CYAN
                else:
                    - scroll:
                        direction: left
                        scrollLimit: 2
                        untilIdentifier: mx.mappings.wallet.add-card.cardLast4Digits
                        withinIdentifier: mx.mappings.wallet.add-card.cardsContainer
                    - if:
                        identifier:
                          present:
                             - identifier: mx.mappings.wallet.add-card.cardLast4Digits
                        then:
                            - log: 
                                message: Card ${last4Digits} added.  
                                color: CYAN
      - log: 
          message: "End function: wallet.assertCardAddedByLast4Digits"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This method scroll to card with last 4 digits.
  # Param: ${last4Digits} [Mandatory] User's card last 4 digits
  - name: mx.functions.wallet.scrollToCardWithLast4Digits
    platform: ios
    flow: 
      - if:
          identifier:
            present:
              - identifier: mx.mappings.wallet.add-card.cardWithLast4Digits
          then:
            - log:
                message: "End function: wallet.scrollToCardWithLast4Digits"
                color: BLUE
          else:
            - scroll:
                direction: right
                scrollLimit: 3
                withinIdentifier: mx.mappings.wallet.add-card.cardsContainer
                untilIdentifier: mx.mappings.wallet.add-card.cardWithLast4Digits
            - if:
                identifier:
                  present:
                    - identifier: mx.mappings.wallet.add-card.cardWithLast4Digits
                then:
                  - log:
                      message: "End function: wallet.scrollToCardWithLast4Digits"
                      color: BLUE
                else:
                  - scroll:
                      direction: left
                      scrollLimit: 5
                      untilIdentifier: mx.mappings.wallet.add-card.cardWithLast4Digits
                      withinIdentifier: mx.mappings.wallet.add-card.cardsContainer
                  - if:
                      identifier:
                        present:
                          - identifier: mx.mappings.wallet.add-card.cardWithLast4Digits
                      then:
                        - log:
                           message: "End function: wallet.scrollToCardWithLast4Digits"
                           color: BLUE
                      else:
                        - failTest:
                            message: "Error, card with last 4 digits: ${last4Digits}, not found!"

  #--------------------------------------------------------------------------------------------------------------------
   
  # Description: This method opens "edit card" by last 4 digits termination.
  # Param: ${last4Digits} [Mandatory] User's card last 4 digits
  - name: mx.functions.wallet.tapEditCard
    platform: ios
    flow: 
        - click:
            identifier: mx.mappings.wallet.add-card.editCardWithLast4Digits
        - log:
            message: "End function: wallet.tapEditCard"
            color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This asserts no cards are displayed in wallet
  - name: mx.functions.wallet.assertNoCardsAreDisplayed
    platform: ios
    flow:
        - if:
            identifier:
              notPresent:
                - identifier: mx.mappings.wallet.add-card.cardView
            then:
              - log:
                  message: "No cards displayed"
            else:
              - failTest:
                  message: "Found cards displayed"
        - log:
            message: "End function: wallet.assertNoCardsAreDisplayed"
            color: BLUE

  
 #--------------------------------------------------------------------------------------------------------------------
   
    # Description: This method scroll to card with last 4 digits.
    # Param: ${last4Digits} [Mandatory] User's card last 4 digits
  - name: mx.functions.wallet.scrollToCardWithLast4Digits
    platform: ios
    flow: 
        - scroll:
            direction: right
            scrollLimit: 5
            untilIdentifier: mx.mappings.wallet.add-card.cardLast4Digits
            withinIdentifier: mx.mappings.wallet.add-card.cardsContainer
        - if:
            identifier:
              present:
                - identifier: mx.mappings.wallet.add-card.cardLast4Digits
            then:
              - log:
                 message: "Card with termination: ${last4Digits} displayed."
                 color: CYAN
            else:
                 - scroll:
                    direction: left
                    untilIdentifier: mx.mappings.wallet.add-card.cardLast4Digits
                    withinIdentifier: mx.mappings.wallet.add-card.cardsContainer
                    scrollLimit: 5
                 - verifyIdentifier:
                    present:
                      - identifier: mx.mappings.wallet.add-card.cardLast4Digits
        - log:
            message: "End function: wallet.scrollToCardWithLast4Digits"
            color: BLUE

  #--------------------------------------------------------------------------------------------------------------------
   
  # Description: This method taps on add payment method button
  - name: mx.functions.wallet.tapContinue
    platform: ios
    flow: 
        - click:
            identifier: mx.mappings.wallet.continueButton
        - log:
            message: "End function: wallet.tapContinue"
            color: BLUE