#======================================================================================================================
#  AUTHOR: Gustavo Antonio Lopez Cambambia (vn53g21)
#  CREATED: Dec/14/2022
#  REVISION: ---
#
#  Copyright © 2022 Walmart. All rights reserved.
#======================================================================================================================

functions:

  # Description: This method asserts if lists is displayed
  - name: mx.functions.lists.assertPageDisplayed
    flow: 
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.lists.locationBar
            - identifier: mx.mappings.lists.createListButton
            - identifier: mx.mappings.lists.favoritesListButton
      - log:
          message: "End function: lists.assertPageDisplayed (Displayed)"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------
  
  # Description: This function asserts the list displayed on page
  # Param: ${listName}  [Mandatory]  Name of the list to assert.
  - name: mx.functions.lists.assertListDisplayed
    flow: 
      - log:
          message: "List name: ${listName}"
          color: CYAN
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.lists.listByName
      - log:
          message: "End function: lists.assertListDisplayed (Displayed)"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------
  
  - name: mx.functions.lists.openFavoritesList
    flow: 
      - click: 
          identifier: mx.mappings.lists.favoritesListButton
      - log:
          message: "End function: lists.openFavoritesList"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------
  
  # Description: This function asserts if list is not present
  # Param: ${listName}  [Mandatory]  Name of the list to assert.
  - name: mx.functions.lists.assertListNotDisplayed
    flow: 
      - log:
          message: "List name: ${listName}"
          color: CYAN
      - verifyIdentifier:
          notPresent:
            - identifier: mx.mappings.lists.listByName
      - log:
          message: "End function: lists.assertListNotDisplayed (Not displayed)"
          color: BLUE
  
  #--------------------------------------------------------------------------------------------------------------------
  
  # Description: This function delete all products from the a list.
  # Param: ${waitBeforeStart}  [Optional]  Wait time (sleep time) before to start the process of delete products. Default value is 3s
  # Author: Osmar Juárez (vn56dce)
  - name: mx.functions.lists.deleteAllProductsFromList
    flow:
       - sleep:
          duration: ${waitBeforeStart:3000}
       - if:
          identifier:
            notPresent:
              - identifier: //*[@name="Eliminar" or @name="Remove"] | //*[@text="Eliminar"]
          then:
            - log:
                message: "List is empty, checking if Cart is empty..."
                color: CYAN
          else:
            - log:
                message: "Emptying list..."
                color: CYAN
            - loop:
                begin: 1
                end: 50
                flow:
                  - if:
                      identifier:
                        present:
                          - identifier: //*[@name="Eliminar" or @name="Remove"] | //*[@text="Eliminar"]
                      then:
                        - click:
                            identifier: //*[@name="Eliminar" or @name="Remove"] | //*[@text="Eliminar"]
                        - click:
                            identifier: mx.mappings.list.delete-product-popup.deleteButton
                        - sleep:
                            duration: 3000
                      else:
                        - log:
                            message: "List is now empty."
                            color: CYAN
                        - break: true