#======================================================================================================================
#    AUTHOR: Octavio Cabrales Zárate (vn53g23)
#   CREATED: Jan/04/2023
#  REVISION: ---
#
#  Copyright © 2023 Walmart. All rights reserved.
#======================================================================================================================

functions:

 # Description: This method select a certain brand
 # Params:   {brand}  [Mandatory] Brand
 - name: mx.functions.brand-filter-pop-up.unselectBrand
   platform: ios
   flow: 
     - log:
         message: Unselecting brand ${brand} filter 
         color: CYAN
     - storeIn:    
         key: boxChecked
         value: 0
     - getString: 
         identifier: mx.mappings.brand-filter-pop-up.brandOption
         attribute: value
         storeIn: boxChecked
     - if:
         condition: ${boxChecked} == 0
         then:
           - log:
               message: Brand is unselected already
               color: CYAN
         else:
           - click:
               identifier: mx.mappings.brand-filter-pop-up.brandOption
           - log:
               message: Brand unselected
               color: CYAN

 # -------------------------------------------------------------------------------------------------------------------
 
 # Description: This method gets the amount of products within brand filter
 # Params:   {brand}  [Mandatory] Brand
 # Return:   {brandProductsCount} number of products for the given brand
 # Editor: Osmar Juárez (vn56dce)
 - name: mx.functions.brand-filter-pop-up.getBrandProductsCount
   platform: ios
   flow: 
     - log:
         message: Extracting products count for brand ${brand}
         color: CYAN
     - getString:
         identifier: mx.mappings.brand-filter-pop-up.brandOption
         attribute: name
         storeIn: returnedBrandProductsCount
     - executeNode:
         file: mx/test/helpers/brand-filter-popup/sanitizeBrandCheckboxiOS.js
         args:
            - value: ${returnedBrandProductsCount}  # PARAM: --${str}-- string label with brand name
            - value: 2                              # PARAM: --${option}-- option group of match for regular expression to return
         getResponse:
           storeIn: brandProductsCount
     - log:
         message: Extracted count - ${brandProductsCount}
         color: CYAN
         
 # -------------------------------------------------------------------------------------------------------------------
 
 # Description: This method clears the search selection
 - name: mx.functions.brand-filter-pop-up.deleteSearch
   platform: ios
   flow: 
     - log:
         message: Displaying all brands
         color: CYAN
     - enterText:
         identifier: mx.mappings.brand-filter-pop-up.textField
         string: ""
         clearField: true
     - log:
         message: Brand list displayed
         color: CYAN

 # -------------------------------------------------------------------------------------------------------------------
 
 # RETURN:   ${firstBrandName}   String with the first Brand name displayed in filter 
 # AUTHOR: Osmar Juárez (vn56dce)
 - name: mx.functions.brand-filter-pop-up.getFirstBrandName
   platform: ios
   flow:
     - getString:
          identifier: mx.mappings.brand-filter-pop-up.firstBrandNameTextView
          attribute: name
          storeIn: firstBrandName
     - executeNode:
          file: mx/test/helpers/brand-filter-popup/sanitizeBrandCheckboxiOS.js
          args:
            - value: ${firstBrandName}  # PARAM: --${str}-- string label with brand name
            - value: 1                  # PARAM: --${option}-- option group of match for regular expression to return
          getResponse:
            storeIn: firstBrandName
     - log:
         message: "First Brand Name displayed: '${firstBrandName}'"
         color: GREEN_BOLD
     - log:
          message: "End function: brand-filter-pop-up.getFirstBrandName"
          color: BLUE

# -------------------------------------------------------------------------------------------------------------------
 
 # DESSCRIPTION: This method search for a brand usign the search brand inside of the filter pupup
 # PARAMS:   ${brand}      [Mandatory] Brand name
 # AUTHOR: Osmar Juárez (vn56dce)
 - name: mx.functions.brand-filter-pop-up.searchBrand
   platform: ios
   flow: 
     - log:
         message: "Looking for brand: '${brand}'"
         color: CYAN
     - enterText:
         identifier: mx.mappings.brand-filter-pop-up.textField
         string: ${brand}
         clickFirst: true
         clearField: true
         pressEnter: true
     - log:
          message: "End function: brand-filter-pop-up.searchBrand"
          color: BLUE    