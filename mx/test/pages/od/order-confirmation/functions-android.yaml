#======================================================================================================================
#  AUTHOR: Octavio Cabrales Zárate (vn53g23)
#  CREATED: Dic/05/2022
#  REVISION: ---
#
#  Copyright © 2022 Walmart. All rights reserved.
#======================================================================================================================

functions:

  # -------------------------------------------------------------------------------------------------------------------

  # PARAMS: {expectedStoreAddress} [Mandatory] Store address
  # AUTHOR: Isis Tolentino (vn53dge)
  # EDITORS: Sergio Fernandez (vn0t1qt)
  - name: mx.functions.order-confirmation.assertStoreAddress
    platform: android
    flow:
      - log:
          message: "Expected Store Address: '${expectedStoreAddress}'"
          color: CYAN
      - verifyIdentifier:
          present:
            - identifier: mx.mappings.order-confirmation.storeAddress
      - log:
          message: "End function: order-confirmation.assertStoreAddress"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # Description: This method asserts the delivery store address name
  # Params: {expectedStoreAddressName} [Mandatory] Store address name
  - name: mx.functions.order-confirmation.assertStoreAddressName
    platform: android
    flow:
      - log:
          message: Checking if store address name ${expectedStoreAddressName}
          color: CYAN
      - if:
          identifier:
            text:
              - identifier: mx.mappings.order-confirmation.storeAddressName
                equals: ${expectedStoreAddressName}
          then:
            - log:
                message: Address name is correct
                color: CYAN
          else:
            - failTest:
                message: Name is not correct
      - log:
          message: "End function: order-confirmation.assertStoreAddressName"
          color: BLUE

  #--------------------------------------------------------------------------------------------------------------------

  # Description: This function compares the expected store address and the address displayed in Order confirmation page.
  # Params: ${expectedStoreAddress} [Mandatory] Store address
  # # AUTHOR: Gustavo Antonio López Cambambia (vn53g21)
  - name: mx.functions.order-confirmation.compareAddresses
    platform: android
    flow:
      # Retrieving and cleaning expected value...
      - log:
          message: "Expected Store Address to be displayed: ${expectedStoreAddress}"
          color: CYAN
      - executeNode:
          file: mx/test/helpers/utils/stringToLowerCase
          args:
            - value: ${expectedStoreAddress}
          getResponse:
            storeIn: expectedStoreAddress
      - log:
          message: "Parsed Store Address to be displayed: ${expectedStoreAddress}"
          color: CYAN
      # Retrieving and cleaning displayed value...
      - getString:
          identifier: mx.mappings.order-confirmation.homeAddress
          attribute: text
          storeIn: displayedAddress
      - executeNode:
          file: mx/test/helpers/utils/stringToLowerCase
          args:
            - value: ${displayedAddress}
          getResponse:
            storeIn: displayedAddress
      - log:
          message: "Parsed displayed Store Address: ${displayedAddress}"
          color: CYAN
      # Final comparison...
      - if:
          condition: ${displayedAddress} == ${expectedStoreAddress}
          then:
            - log: 
                message: "Addresses are correct"
                color: CYAN
          else:
            - failTest:
                message: "Addresses are not correct"
      - log: 
          message: "End Function: order-confirmation.compareAddresses (Addresses are correct)"
          color: BLUE

  # -------------------------------------------------------------------------------------------------------------------

  # Description: This method clicks the find more products button
  - name: mx.functions.order-confirmation.tapFindMoreProducts
    platform: android
    flow:
      - click:
          identifier: mx.mappings.order-confirmation.findMoreProductsButton
      - log:
          message: "End function: order-confirmation.tapFindMoreProducts"
          color: BLUE