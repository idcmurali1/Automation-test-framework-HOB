#======================================================================================================================
#    AUTHOR: Rodrigo Pacheco Cámara (vn53p0i)
#   CREATED: Mar/23/2023
#  REVISION: ---
#
#  Copyright © 2023 Walmart. All rights reserved.
#======================================================================================================================

functions:

#----------------------------------------------------------------------------------------------------------------------

  # Description:      This flow changes the store to the one specified on parameter from the popup, it selects the
  #                       desired store and clicks save.
  # NOTE/SUGGESTION:  For better performance on iOS, use a zip code that makes the desired store appear first on the list.
  # Params: ${zipCode}    [Mandatory]  Desired zip code to enter when opening the store selector popup.
  #         ${storeName}  [Mandatory]  Name of the store you want to switch to.
  # RETURNS:
  #   ${returnedBanner}
  #   ${returnedStoreName}
  #   ${returnedStoreAddress}
  #
  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.flows.od.store-selector-popup.changeStoreFromPopup
    flow:
      - log:
          message: "ZipCode: ${zipCode}"
          color: CYAN
      - log:
          message: "Store Name: ${storeName}"
          color: CYAN
      - executeFunction:
          name: mx.functions.store-selector-popup.enterZipCode
      - sleep:
          duration: 3000
      - executeFunction:
          name: mx.functions.store-selector-popup.scrollDownToAddress
      - click:
          identifier: mx.mappings.store-selector-popup.storeByName
      - fetchPageSource: false
      - executeFunction:
          name: mx.functions.store-selector-popup.getSelectedStoreBanner
      - executeFunction:
          name: mx.functions.store-selector-popup.getSelectedStoreName
      - executeFunction:
          name: mx.functions.store-selector-popup.getSelectedStoreAddress
      - executeFunction:
          name: mx.functions.store-selector-popup.tapSave
      - fetchPageSource: true
      - log:
          message: "End flow: store-selector.changeStoreFromPopup"
          color: BLUE

#----------------------------------------------------------------------------------------------------------------------

  # Description:          This flow changes the store to the one specified on parameter from the popup, it selects the
  #                           desired store and clicks save.
  # REQUIREMENT:          Use a zip code that makes the desired store appear first on the list.
  # Params: ${zipCode}    [Mandatory]  Desired zip code to enter when opening the store selector popup.
  #         ${storeName}  [Mandatory]  Name of the store you want to switch to.
  #
  # AUTHOR: Rodrigo Pacheco (vn53p0i)
  - name: mx.flows.od.store-selector-popup.quickChangeStoreFromPopup
    flow:
      - log:
          message: "ZipCode: ${zipCode}"
          color: CYAN
      - log:
          message: "Store Name: ${storeName}"
          color: CYAN
      - executeFunction:
          name: mx.functions.store-selector-popup.enterZipCode # <--VARIABLE--${zipCode}
      - sleep:
          duration: 3000
      - click:
          identifier: mx.mappings.store-selector-popup.storeByName # <--VARIABLE--${storeName}
      - executeFunction:
          name: mx.functions.store-selector-popup.tapSave
      - log:
          message: "End flow: store-selector.quickChangeStoreFromPopup"
          color: BLUE
