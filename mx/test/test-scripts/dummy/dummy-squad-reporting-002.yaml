#======================================================================================================================
#    AUTHOR: Sergio Fernandez (vn0t1qt)
#   CREATED: Oct/23/2023
#  REVISION: ---
#
#  Copyright Â© 2023 Walmart. All rights reserved.
#======================================================================================================================

general:
  tags: dummy-squad-reporting-staging-android, dummy-squad-reporting-staging-android-002, dummy-squad-reporting-staging-ios, dummy-squad-reporting-staging-ios-002, dummy-squad-reporting-production-android, dummy-squad-reporting-production-android-002, dummy-squad-reporting-production-ios, dummy-squad-reporting-production-ios-002
  testCaseId: MXMOB-2137

scenarios:

  #####################################################################################################################
  #
  # TEST CASE DESCRIPTION:
  #
  #   NOTES: This Dummy Test Case is meant to test the configuration for the Squad Reporting Utility.
  #
  #####################################################################################################################

  - name: Before
    before: true
    flow:
      - log: "BEFORE SCENARIO START: DUMMY TEST SUITE - SQUAD REPORTING - DUMMY-002..."

      - storeIn:
          key: varTC_SUCCESSFUL_EXECUTION
          value: false

      - executeFunction:
          name: mx.squad-reporting.setTestCaseName
          params:
            - name: testCaseName
              string: Dummy Squad Reporting 002

      - log: "BEFORE SCENARIO END"

  #####################################################################################################################

  - name: Main
    flow:
      - log: "TEST START: DUMMY TEST SUITE - SQUAD REPORTING - DUMMY-002"

      #----------------------------------------------------------------------------------------------------------------
      # STEP 1: Do something that CUSTOMER Squad owns...
      - executeFunction:
          name: mx.squad-reporting.setTestCaseStep
          params:
            - name: step
              string: 'STEP 1: Do something that CUSTOMER Squad owns...'
            - name: squadNames
              string: CUSTOMER | QAA

      #----------------------------------------------------------------------------------------------------------------
      # STEP 2: Do something that PRE-PURCHASE Squad owns...
      - executeFunction:
          name: mx.squad-reporting.setTestCaseStep
          params:
            - name: step
              string: 'STEP 2: Do something that PRE-PURCHASE Squad owns...'
            - name: squadNames
              string: PRE-PURCHASE | QAA
      - failTest:
          message: Forced Failure

      #----------------------------------------------------------------------------------------------------------------
      # STEP 3: Do something that PURCHASE Squad owns...
      - executeFunction:
          name: mx.squad-reporting.setTestCaseStep
          params:
            - name: step
              string: 'STEP 3: Do something that PURCHASE Squad owns...'
            - name: squadNames
              string: PURCHASE

      #----------------------------------------------------------------------------------------------------------------
      # STEP 4: Do something that POST-PURCHASE Squad owns...
      - executeFunction:
          name: mx.squad-reporting.setTestCaseStep
          params:
            - name: step
              string: 'STEP 4: Do something that POST-PURCHASE Squad owns...'
            - name: squadNames
              string: POST-PURCHASE

      #----------------------------------------------------------------------------------------------------------------
      # STEP 5: Do something that CORE Squad owns...
      - executeFunction:
          name: mx.squad-reporting.setTestCaseStep
          params:
            - name: step
              string: 'STEP 5: Do something that CORE Squad owns...'
            - name: squadNames
              string: CORE

      #----------------------------------------------------------------------------------------------------------------
      # STEP 6: Do something that QAA Squad owns...
      - executeFunction:
          name: mx.squad-reporting.setTestCaseStep
          params:
            - name: step
              string: 'STEP 6: Do something that QAA Squad owns...'
            - name: squadNames
              string: QAA

      #----------------------------------------------------------------------------------------------------------------
      
      - storeIn:
          key: varTC_SUCCESSFUL_EXECUTION
          value: true

      - log: "TEST END: DUMMY TEST SUITE - SQUAD REPORTING - DUMMY-002"

  #####################################################################################################################

  - name: After
    after: true
    flow:
      - log: "AFTER SCENARIO START: DUMMY TEST SUITE - SQUAD REPORTING - DUMMY-002..."

      - executeFunction:
          name: mx.squad-reporting.logTestCaseFailure
          params:
            - name: testCaseExecutionStatus
              string: ${varTC_SUCCESSFUL_EXECUTION}

      - if:
          condition: ${varTC_SUCCESSFUL_EXECUTION} != true
          then:
            - failTest:
                message: "Main Scenario Failed: propagating failure to After Scenario to ensure correct status in SauceLabs."
          else:
            - log:
                message: "Main Scenario Passed: no data reset needed."
                color: CYAN

      - log: "AFTER SCENARIO END"
