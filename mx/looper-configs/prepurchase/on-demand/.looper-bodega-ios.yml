inherit: 'job:///glass-mobile-app-automation/mx/qaa/base-job/global-base:mx/looper-configs/qaa/base/.looper-base.yml'

gitShallowDepth: 10

branches:
  - spec: development
    triggers:
      - push: disabled
      - pr: disabled
      - manual:
          name: '[[ Run Pre-Purchase Bodega iOS Test Suite ]]'
          call: build

  - spec: mx/MMS*
    triggers:
      - push: disabled
      - pr: disabled
      - manual:
          name: '[!] [[ Run Pre-Purchase Bodega iOS Test Suite ]]'
          call: build
  
  - spec: mx/prepurchase/release*
    triggers:
      - push: disabled
      - pr: disabled
      - manual:
          name: '[!] [[ Run Pre-Purchase Bodega iOS Test Suite ]]'
          call: build

envs:
  global:
    variables:
      JIRA_PROJECT_ID: MMS
      APP_PLATFORM: ios
      TURN_OFF_INDIVIDUAL_TEST_EXECUTION_SQUADS_REPORT: true
      SLACK_TEST_RESULTS_CHANNEL_ID: C063M11HW6S

rules:
  before:
    group (name 'Set Global Vars'):
      - var(JIRA_SUMMARY_PREFIX):
          shell (name JIRA_SUMMARY_PREFIX): 
            echo 'bodega-'

parameters:
  - SAUCELABS_IOS_FILENAME: {type: string, defaultValue: "", label: "<p style=\"padding-left: 50px; color: blue;\">
  <b>(mandatory)</b><br><br>
  Name of the .APP or .ZIP file that was uploaded into <b>SauceLabs</b>.<br><br>
  i.e. walmart-23.5-30-20230213.230543-1.zip<br><br>
  For more information, follow this guide üëáüèº<br>
  <a href=\"https://confluence.walmart.com/display/MXGECMEX/GlassMX+-+Automation+101\" target=\"_blank\">Automation 101</a> > 
  <a href=\"https://confluence.walmart.com/pages/viewpage.action?pageId=1631071320\" target=\"_blank\">Execute Test Suites/Test Cases</a> > 
  <a href=\"https://confluence.walmart.com/pages/viewpage.action?pageId=1631071320#GlassMXAUT10102ExecuteTestSuites/TestCases-Step2:UploadApptoSauceLabs\" target=\"_blank\">Step 2: Upload App to SauceLabs</a><br><br>
  <b>* For now, upoad only .ZIP (with the .IPA inside) to target execution for Real Devices.</b>
</p>"}
  - BUNDLE_ID: {type: string, defaultValue: "com.walmart.bodegaGM.qa", label: "<p style=\"padding-left: 50px; color: blue;\">
  <b>(mandatory)</b> Name of the Bundle ID or App Identifier.<br><br>
  Option 1: com.walmartmexico.WalmartMG<br>
  Option 2: com.walmartmexico.WalmartMG.qa<br>
  Option 3: com.walmart.bodegaGM<br>
  Option 4: com.walmart.bodegaGM.qa<br>
</p>"}
  - PREFIX_MAPPING_LABELS: {type: string, defaultValue: "bo_ea_ios", label: "<p style=\"padding-left: 50px; color: red;\">
  [ ! ] This variable it will only apply if IS_WCP_TEST_EXECUTION is true or checkbox is selected.<br>
</p>"}
  - TC_IDS: {type: string, defaultValue: "", label: "<p style=\"padding-left: 50px; color: blue;\">
  <b>(conditioned)</b>&nbsp&nbsp&nbsp(required only when <b>OVERWRITE_TC_SELECTION=true</b>)<br><br>
  List of Test Cases to be executed from the selected Test Suite.<br>
  Provide the list of Test Case IDs separated by comma ( , ).<br><br>
  i.e. 001, 002, 007, 021<br>
</p>"}
  - EXECUTION_NAME: {type: string, defaultValue: "<Pre-Purchase looper execution>", label: "<p style=\"padding-left: 50px; color: blue;\">
  <b>(optional)</b><br><br>
  Name you want to give to the execution to easily identify it in Slack's Results Post.<br>
  This name does not affect the execution.<br><br>
  i.e. E2E Regression 22.05.2<br>
</p>"}
  - DEVICE_NAME_IOS: {type: string, defaultValue: "iPhone Instant Simulator", label: "<p style=\"padding-left: 50px; color: blue;\">
  <b>(optional)</b><br><br>
  Device name to use when SauceLabs perform the Test Execution.<br>
  If not provided, the R2's dependencies file will use the device configured as default.<br><br>
  i.e. iPhone 11 Simulator<br><br>
  * You can also use wildcards for real device testing.<br><br>
  * 'Instant' is a wildcard for iOS Simulators.<br><br>
</p>"}
  - PLATFORM_VERSION_IOS: {type: string, defaultValue: "latest", label: "<p style=\"padding-left: 50px; color: blue;\">
  <b>(optional)</b><br><br>
  Platform version of the device SauceLabs will use to perform the Test Execution.<br>
  If not provided, the R2's dependencies file will use the platform version configured as default.<br><br>
  i.e. 14.5<br><br>
  * You can also use wildcards for real device testing.<br><br>
  * 'latest' is a wildcards for instant simulators. It will take latest OS version avilable for iOS instant simulators.<br><br>
</p>"}
  - IS_WCP_TEST_EXECUTION: {type: boolean, defaultValue: "false", label: "<p style=\"padding-left: 50px; color: red;\">
  [ ! ] Mark this variable if execution it is related to EA/WCP test scripts.<br>
</p>"}
  - PARALLEL_EXECUTION: {type: boolean, defaultValue: "true", label: "<p style=\"padding-left: 50px; color: blue;\">
  Flag to control whether or not to execute the Test Cases in parallel.<br>
</p>"}
  - OVERWRITE_TC_SELECTION: {type: boolean, defaultValue: "false", label: "<p style=\"padding-left: 50px; color: blue;\">
  Flag to control whether or not to execute all the Test Cases included in the selected Test Suite.<br>
  &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<b>true</b> - Only the selected Test Cases will be executed.<br>
  &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<b>false</b> - All the Test Cases will be executed.<br><br>
  If the value has been set to <b>true</b> be sure to provide the list of Test Cases you want to execute in the var <b>TC_IDS</b> üëáüèº below.<br>
</p>"}
  - EXECUTION_FLAGS: {type: file, label: "<p style=\"padding-left: 50px; color: blue;\">
  <b>(optional)</b><br><br>
  Provide a TXT file containing the Execution Flags to be used in case you need to customize the behavior of the execution.<br><br>
  If not provided, the execution will use the default file <a href=\"https://gecgithub01.walmart.com/MobileQE/glass-automation/blob/development/mx/scripts/execution-flags/execution_flags.txt\" target=\"_blank\">./mx/scripts/execution-flags/execution_flags.txt</a>.<br>
</p>"}
  - GLASS_ENV: {type: choice, choices: "production", label: "<p style=\"padding-left: 50px; color: blue;\">
  Environment against which the execution will be triggered.<br>
</p>"}
  - TEST_SUITE: {type: choice, choices: "prepurchase-od-smoke,prepurchase-bodega-ea-smoke,prepurchase-dev-phase", label: "<p style=\"padding-left: 50px; color: blue;\">
  Test Suite to be executed.<br>
</p>"}

