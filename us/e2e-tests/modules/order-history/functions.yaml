

functions:
#This functionality of searching by order id is not implemented in the app
  - name: us.functions.orderHistory.searchByOrderId
    platform: ios
    flow:
      - enterText:
          identifier: us.mappings.orderHistory.searchField
          string: ${orderNo}
          pressEnter: true

  - name: us.functions.orderHistory.serachBar.SearchYourPurchasesTextbox
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderHistory.searchBar

  - name: us.functions.orderHistory.searchOrder
    platform: ios
    flow:
      - storeIn:
          key: executionStage
          value: Transactions
      - click:
          identifier: us.mappings.orderHistory.searchBar
          wait: 3000    
      - enterText:
          identifier: us.mappings.orderHistory.searchBar
          string: ${orderNo}
          clickFirst: true
          pressEnter: true

  - name: us.functions.orderHistory.clickOnViewDetails
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - scroll:
          direction: down
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderHistory.viewDetailsButton
      - click:
          identifier: us.mappings.orderHistory.viewDetailsButton
      - sleep:
          duration: 3000

  - name: us.functions.orderHistory.VerifyNoOrders    
    platform: ios
    flow:
      - verifyIdentifier:
          notPresent:
            - identifier: us.mappings.orderHistory.viewDetailsButton  
              # wait: 3000

  - name: us.functions.orderHistory.backNavigationFromOrderDetails 
    platform: ios
    flow:
      - click:
          identifier: us.mappings.orderHistory.backNavigationFromOrderDetails  
  
  - name: us.functions.orderHistory.ost.fcDelivery.verifyOrderStatus
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderHistory.trackOrderButton
            - identifier: us.mappings.orderHistory.orderCardType
      - verifyIdentifier:
          value:
            - identifier: us.mappings.orderHistory.progressBar
              equals: ${orderStatus}

# this functions needs param ${fulfillmentType} and values can be "Curbside pickup", " Scheduled Delivery", "Store Order", "Delivery"
  - name: us.functions.orderHistory.orderType.goToOrderDetails
    platform: ios
    flow:
      - click:
          identifier: us.mappings.orderHistory.orderCardType

  - name: us.functions.orderHistory.goToHomeScreen
    platform: ios
    flow:
      - executeFunction: 
          name: us.functions.global.navigation.backNavigation
      - if:
          identifier:
            present:
              - identifier: us.mappings.reviewOrder.leaveAnywayButton
          then:
            - click:
                identifier: us.mappings.reviewOrder.leaveAnywayButton  
                wait: 8000
      - click: 
          identifier: us.mappings.global.navigation.backNavigationFromCart
          wait: 2000
      - click: 
          identifier: us.mappings.orderHistory.backNavigationFromOrderDetails
          wait: 2000
      - click: 
          identifier: us.mappings.account.communications.orderupdates.navigateBackButton
          wait: 2000   

  - name: us.functions.orderHistory.searchOrder.byName
    platform: ios
    flow:
      - click:
          identifier: us.mappings.orderHistory.searchBar
          wait: 3000    
      - enterText:
          identifier: us.mappings.orderHistory.searchBar
          string: ${name}
          clickFirst: true
          pressEnter: true

############################################# Android ################################################

# parameter "orderStatus" and "fulfillmentType" should be passed to this functions
  - name: us.functions.orderHistory.ost.pickup.verifyOrderStatus
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderHistory.orderCardType
      - verifyIdentifier:
          value:
            - identifier: us.mappings.orderHistory.progressBar

  - name: us.functions.orderHistory.serachBar.SearchYourPurchasesTextbox
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderHistory.serachBar.SearchYourPurchasesTextbox

  - name: us.functions.orderHistory.searchOrder
    platform: android
    flow:
      - storeIn:
          key: executionStage
          value: Post-transactions
      - enterText:
          identifier: us.mappings.orderHistory.searchBar
          string: ${orderNumber}
          clickFirst: true
          pressEnter: true
      - sleep:
          duration: 5000
      - hideKeyboard: true 

  - name: us.functions.orderHistory.searchOrder.byName
    platform: android 
    flow:
      - click:
          identifier: us.mappings.orderHistory.searchBar
          wait: 3000    
      - enterText:
          identifier: us.mappings.orderHistory.searchBar
          string: ${name}
          clickFirst: true
          pressEnter: true           
      - hideKeyboard: true 
         
  - name: us.functions.orderHistory.clickOnViewDetails
    platform: android
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.orderHistory.viewDetailsButton
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderHistory.viewDetailsButton
      - click:
          identifier: us.mappings.orderHistory.viewDetailsButton
          wait: 10000

  - name: us.functions.orderHistory.VerifyNoOrders
    platform: android
    flow:
      - verifyIdentifier:
          notPresent:
            - identifier: us.mappings.orderHistory.viewDetailsButton
                     
  - name: us.functions.orderHistory.backNavigationFromOrderDetails
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderHistory.backNavigationFromOrderDetail
      - click:
          identifier: us.mappings.orderHistory.backNavigationFromOrderDetail
          wait: 5000
      # - click:
      #     identifier: us.mappings.orderHistory.backNavigationFromOrderDetail
      #     wait: 5000

# parameter "orderStatus" and "fulfillmentType" should be passed to this functions
  - name: us.functions.orderHistory.ost.scheduledDelivery.verifyOrderStatus
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderHistory.trackOrderButton
            - identifier: us.mappings.orderHistory.orderCardType
            - identifier: us.mappings.orderHistory.progressBar

# parameter "orderStatus" and "fulfillmentType" should be passed to this functions
  - name: us.functions.orderHistory.ost.fcDelivery.verifyOrderStatus
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderHistory.trackOrderButton
            - identifier: us.mappings.orderHistory.orderCardType
            - identifier: us.mappings.orderHistory.progressBar

# parameter "fulfillmentType" should be passed to this functions
  - name: us.functions.orderHistory.orderType.goToOrderDetails
    platform: android
    flow:
      - click:
          identifier: us.mappings.orderHistory.orderCardType

  - name: us.functions.orderHistory.goToFirstOrder
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderHistory.viewOrderDetailsForFirstOrder
      - click:
          identifier: us.mappings.orderHistory.viewOrderDetailsForFirstOrder

  - name: us.functions.orderHistory.canceledOrder.goToOrderDetails
    platform: android
    flow:             
      - scroll:
          direction: down         
          untilIdentifier: us.mappings.orderHistory.scTitle                            
      - if:
          identifier:
            present:
              - identifier: us.mappings.orderHistory.scTitle
          then:
            - executeFunction:
                name: us.functions.orderHistory.clickOnViewDetails 

  - name: us.functions.orderHistory.verifyStoreNameandAddress
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderHistory.storeAddressText
      - verifyIdentifier:
          text:
            - identifier: us.mappings.orderHistory.storeName
              contains: ${storeName}
      - log: Store verified        

  - name: us.functions.orderHistory.verifyStoreNameandAddress
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderHistory.storeAddressText
            - identifier: us.mappings.orderHistory.storeName
            - identifier: us.mappings.orderHistory.storeNameText
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.orderHistory.storeName
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.orderHistory.storeNameText
      - log: Store verified
      
  - name: us.functions.orderHistory.startAReturn
    platform: android
    flow:             
      - scroll:
          direction: down         
          untilIdentifier: us.mappings.orderHistory.startAReturn                           
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderHistory.startAReturn
      - click:
          identifier: us.mappings.orderHistory.startAReturn
          wait: 5000

  - name: us.functions.orderHistory.carousel.addProductReview
    platform: ios
    flow:
      - if: 
          identifier : 
            present: 
              - identifier: us.mappings.orderHistory.carousel.verifyReviewHeader
          then: 
            - click:
                identifier:  us.mappings.orderHistory.carousel.clickFirstItem
          else: 
              - log: Product review carousel is not appearing on purchase history
      - sleep:
          duration: 5000  
      - if: 
          identifier: 
            label: 
              - identifier: us.mappings.orderHistory.carousel.firstProduct.verifyOverallRating
                contains: What did you think of it overall?
          then: 
            - click: 
                identifier: us.mappings.orderHistory.carousel.rateProduct
            - click: 
                identifier: us.mappings.orderHistory.carousel.clickContinue
            - verifyIdentifier:
                label:
                  - identifier: us.mappings.orderHistory.carousel.clickReviewCTA
                    contains: Skip
            - click: 
                identifier: us.mappings.orderHistory.carousel.clickReviewCTA
            - verifyIdentifier:
                label:
                  - identifier: us.mappings.orderHistory.carousel.clickReviewCTA
                    contains: Submit item review
            - click: 
                identifier: us.mappings.orderHistory.carousel.clickReviewCTA
    
          else:
              - verifyIdentifier:
                  present:
                    - identifier: us.mappings.orderHistory.carousel.fiveStarRating
              - click : 
                  identifier: us.mappings.orderHistory.carousel.fiveStarRating
            
  - name: us.functions.orderHistory.carousel.submitProductReview
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.orderHistory.carousel.clickSubmitReview
            - name: direction
              string: down
      - click: 
          identifier: us.mappings.orderHistory.carousel.clickSubmitReview    
      - log: 5 stars selected and validated submit review
      - verifyIdentifier: 
          present: 
            - identifier: us.mappings.orderHistory.carousel.verifyThankyouMsg
      - click: 
          identifier:  us.mappings.orderHistory.carousel.clickGotIt
      - log: Thank you message validated after submitting the product review

  - name: us.functions.orderHistory.carousel.addProductReview
    platform: android
    flow:
      - if: 
          identifier : 
            present: 
              - identifier: us.mappings.orderHistory.carousel.verifyReviewHeader
          then: 
            - click:
                identifier:  us.mappings.orderHistory.carousel.clickFirstItem
          else: 
              - log: Product review carousel is not appearing on purchase history
      - sleep:
          duration: 5000  
      - if: 
          identifier: 
            present: 
              - identifier: us.mappings.orderHistory.carousel.firstProduct.verifyOverallRating
          then: 
            - click: 
                identifier: us.mappings.orderHistory.carousel.rateProduct
            - log: Star rating selected!
            - click: 
                identifier: us.mappings.orderHistory.carousel.clickContinue
            - log: Validating product recommentation 
            - if:
                identifier:
                  present: 
                    - identifier: us.mappings.orderHistory.carousel.productRecomendation
                then: 
                  - click: 
                      identifier: us.mappings.orderHistory.carousel.clickProdRecommendation
                  - click: 
                      identifier: us.mappings.orderHistory.carousel.clickContinue
            - log: Writing a product review
            - verifyIdentifier: 
                present:
                  - identifier: us.mappings.orderHistory.writeProductReview
            - log: Verifying Image container - Option to add product image
            - executeFunction:
                  name: us.functions.utils.scrollIfNotVisible
                  params:
                    - name: identifier
                      string: us.mappings.orderHistory.carousel.verifyImageContainer
                    - name: direction
                      string: down
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.orderHistory.carousel.verifyImageContainer
            - if:
                identifier:
                  present:  
                    - identifier: us.mappings.orderHistory.carousel.clickContinue
                then: 
                    - click: 
                        identifier: us.mappings.orderHistory.carousel.clickContinue
            # - verifyIdentifier:
            #     text:
            #       - identifier: us.mappings.orderHistory.carousel.clickSubmitReviewCTA
            #         contains: Submit item review
            # - click: 
            #     identifier: us.mappings.orderHistory.carousel.clickSubmitReviewCTA
            # - log: Product review submitted
            - executeFunction:
                  name: us.functions.orderHistory.carousel.submitProductReview
    
          else:
              - verifyIdentifier:
                  present:
                    - identifier: us.mappings.orderHistory.carousel.fiveStarRating
              - click : 
                  identifier: us.mappings.orderHistory.carousel.fiveStarRating
              - log: Star rating selected!
            
              - executeFunction:
                  name: us.functions.orderHistory.carousel.submitProductReview

  - name: us.functions.orderHistory.carousel.submitProductReview
    platform: android
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.orderHistory.carousel.clickSubmitReviewCTA
            - name: direction
              string: down
      - click: 
          identifier: us.mappings.orderHistory.carousel.clickSubmitReviewCTA
      - log: Product review submitted
      - verifyIdentifier: 
          present: 
            - identifier: us.mappings.orderHistory.carousel.verifyThankyouMsg
      - click: 
          identifier:  us.mappings.orderHistory.carousel.clickGotIt
      - log: Thank you message validated after submitting the product review

  - name: us.functions.orderHistory.verifySODBanner
    platform: android
    flow:
      - storeIn:
          key: executionStage
          value: Post-transactions
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderDetails.rxpd.sodBanner
            - identifier: us.mappings.orderDetails.rxpd.sodBanner.title
            - identifier: us.mappings.orderDetails.rxpd.sodBanner.subText

  - name: us.functions.orderHistory.verifySODBanner
    platform: ios
    flow:
      - storeIn:
          key: executionStage
          value: Post-transactions
      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderDetails.sodBanner
            - identifier: us.mappings.orderDetails.sodBanner.title
            - identifier: us.mappings.orderDetails.sodBanner.subText            
