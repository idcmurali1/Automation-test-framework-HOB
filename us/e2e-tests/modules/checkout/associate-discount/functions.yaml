
functions:

  - name: us.functions.associateDiscount.verifyAssociateDiscountPage
    platform: ios
    flow:
      - verifyIdentifier:
          label:
            - identifier: us.mappings.associateDiscount.pageTitle
              contains: us.data.associateDiscount.title
      - verifyIdentifier:
          label:
            - identifier: us.mappings.associateDiscount.applyAssociateDiscount
              contains: us.data.associateDiscount.applyAssociateDiscount
      - verifyIdentifier:
          label:
            - identifier: us.mappings.associateDiscount.applyAssociateDiscountRadioButton
              contains: isSelected             
      - verifyIdentifier:
          label:
            - identifier: us.mappings.associateDiscount.doNotAppyAssociateDiscount
              contains: us.data.associateDiscount.doNotApplyAssociateDiscount
      - verifyIdentifier:
          label:
            - identifier: us.mappings.associateDiscount.doNotApplyAssociateDiscountRadioButton
              contains: isNotSelected
      - verifyIdentifier:
          label:
            - identifier: us.mappings.associateDiscount.VerifyDiscountpolicyTitle
              contains: us.mappings.associateDiscount.VerifyDiscountpolicyTitle
      - click:
          identifier: us.mappings.associateDiscount.VerifyDiscountpolicyArrow       
      - verifyIdentifier:
          label:
            - identifier: us.mappings.associateDiscount.VerifyDiscountpolicyMessage
              contains: us.data.associateDiscount.policyMessage          
      - verifyIdentifier:
          label:
            - identifier: us.mappings.associateDiscount.continueButton
              contains: Continue

  - name: us.functions.associateDiscount.selectAssociateDiscount
    platform: ios
    flow:
      - click:
          identifier: us.mappings.associateDiscount.applyAssociateDiscountRadioButton
          
  - name: us.functions.associateDiscount.doNotSelectAssociateDiscount
    platform: ios
    flow:
      - click:
          identifier: us.mappings.associateDiscount.doNotApplyAssociateDiscountRadioButton
                  
  - name: us.functions.associateDiscount.clickContinue
    platform: ios
    flow:
      - click:
          identifier: us.mappings.associateDiscount.continueButton                

  - name: us.functions.associateDiscount.applyAssociateDicount
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.associateDiscount.pageTitle
          then:
            - storeIn:
                key: associateDiscountApplied
                value: true
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.associateDiscount.pageTitle
                  - identifier: us.mappings.associateDiscount.applyAssociateDiscount
                  - identifier: us.mappings.associateDiscount.doNotAppyAssociateDiscount
                  - identifier: us.mappings.associateDiscount.VerifyDiscountpolicyArrow
            - click:
                identifier: us.mappings.associateDiscount.continueButton
                wait: 10000
          else:
            - storeIn:
                key: associateDiscountApplied
                value: false

  - name: us.functions.associateDiscount.doNotApplyAssociateDicount
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.associateDiscount.pageTitle
            - identifier: us.mappings.associateDiscount.applyAssociateDiscount
            - identifier: us.mappings.associateDiscount.doNotAppyAssociateDiscount
            - identifier: us.mappings.associateDiscount.VerifyDiscountpolicyArrow
      - click:
          identifier: us.mappings.associateDiscount.doNotAppyAssociateDiscount
      - click:
          identifier: us.mappings.associateDiscount.continueButton
          wait: 10000

  - name: us.functions.reviewOrder.verifyItemLevelAssociateDicount
    platform: ios
    flow:
      - click:
          identifier: us.mappings.reviewOrder.editItemButton
          wait: 10000
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.associateDiscount.checkoutItemLevelAssociateDiscountLable
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.associateDiscount.checkoutItemLevelAssociateDiscountLable
          then:
            - failTest:
                message: "ENV_FAILURE - ${env} - Associate Discount not displayed"
      - click:
          identifier: us.mappings.reviewOrder.substitution.doneButton
          wait: 10000

  - name: us.functions.checkout.reviewOrder.verifyAssociateDiscountPOSOnReviewOrder
    platform: ios
    flow:
      - if:
          condition: ${associateDiscountApplied}
          then:
            - if:
                identifier:
                  notPresent:
                    - identifier: us.mappings.associateDiscount.checkout.posAssociateDiscountLabel
                then:
                  - failTest:
                      message: "ENV_FAILURE - ${env} - Associate discount label not displayed in the Review Order page"

  - name: us.functions.checkout.reviewOrder.verifyAssociateDiscountPOSOnReviewOrderNotPresent
    platform: ios
    flow:
      - verifyIdentifier:
          notPresent:
            - identifier: us.mappings.associateDiscount.checkout.posAssociateDiscountLabel

##########################################Android######################################################################

  - name: us.functions.associateDiscount.applyAssociateDicount
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.associateDiscount.pageTitle
          then:
            - storeIn:
                key: associateDiscountApplied
                value: true
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.associateDiscount.pageTitle
                  - identifier: us.mappings.associateDiscount.applyAssociateDiscount
                  - identifier: us.mappings.associateDiscount.doNotAppyAssociateDiscount
                  - identifier: us.mappings.associateDiscount.VerifyDiscountpolicyArrow
            - click:
                identifier: us.mappings.associateDiscount.continueButton
                wait: 10000
          else:
            - storeIn:
                key: associateDiscountApplied
                value: false          

  - name: us.functions.associateDiscount.doNotApplyAssociateDicount
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.associateDiscount.pageTitle
            - identifier: us.mappings.associateDiscount.applyAssociateDiscount
            - identifier: us.mappings.associateDiscount.doNotAppyAssociateDiscount
            - identifier: us.mappings.associateDiscount.VerifyDiscountpolicyArrow
      - click:
          identifier: us.mappings.associateDiscount.doNotAppyAssociateDiscount
      - click:
          identifier: us.mappings.associateDiscount.continueButton
          wait: 10000

  - name: us.functions.reviewOrder.verifyItemLevelAssociateDicount
    platform: android
    flow:
      - click:
          identifier: us.mappings.reviewOrder.editItemButton
          wait: 10000
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.associateDiscount.checkoutItemLevelAssociateDiscountLable
      #       - identifier: us.mappings.associateDiscount.checkoutItemLevelAssociateDiscountPrice
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.associateDiscount.checkoutItemLevelAssociateDiscountLable
          then:
            - failTest:
                message: "ENV_FAILURE - ${env} - Associate Discount not displayed"
      - click:
          identifier: us.mappings.reviewOrder.substitution.doneButton
          wait: 10000

  - name: us.functions.checkout.reviewOrder.verifyAssociateDiscountPOSOnReviewOrder
    platform: android
    flow:
      - if:
          condition: ${associateDiscountApplied}
          then:
            - scroll:
                direction: down
                untilIdentifier: us.mappings.associateDiscount.checkout.posAssociateDiscountLabel
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.associateDiscount.checkout.posAssociateDiscountLabel
                then:
                  - log: "Associate discount displayed as expected"
                else:
                  - failTest:
                      message: "ENV_FAILURE - ${env} - Associate discount not displayed as expected"
            # - verifyIdentifier:
            #     present:
            #       - identifier: us.mappings.associateDiscount.checkout.posAssociateDiscountLabel
            #       - identifier: us.mappings.associateDiscount.checkout.posAssociateDiscountValueLabel

  - name: us.functions.checkout.reviewOrder.verifyAssociateDiscountPOSOnReviewOrderNotPresent
    platform: android
    flow:
      - verifyIdentifier:
          notPresent:
            - identifier: us.mappings.associateDiscount.checkout.posAssociateDiscountLabel
            - identifier: us.mappings.associateDiscount.checkout.posAssociateDiscountValueLabel    
