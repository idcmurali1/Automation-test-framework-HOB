functions:

  - name: us.functions.paypal.changePaymentsButton
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.global.navigation.goToDeepLink
          params:
            - name: deepLinkUrl
              string: walmart://wallet
      - scroll:
          direction: down
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.wallet.paypalButton        
          then:
            - log: "Paypal Card already added Removing card to continue with scenario"
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.account.walletPaypalCardView
                  - name: direction
                    string: down
                  - name: scrollPosition
                    string: center
            - click: 
                identifier: us.mappings.account.walletPaypalCardRemoveButton 
            - sleep:
                duration: 1000             
            - click: 
                identifier: us.mappings.account.walletPaypalCardRemoveConfirmButton
            - verifyIdentifier:
                notPresent:
                    - identifier: us.mappings.account.walletPaypalCardView
      - scroll:
          direction: down
          position: center
          untilIdentifier: us.mappings.wallet.paypalButton
      - if:
          identifier:
            present:
              - identifier: us.mappings.paypalWebView.accountDetails
            enabled:
              - identifier: us.mappings.paypalWebView.accountDetails
                value: true         
          then:
            - log: 'Remember my PayPal account Selected'
            - click:
                identifier: us.mappings.paypalWebView.accountDetails
          else: 
            - log: 'Remember my PayPal account Not Selected'
      - click:
          identifier: us.mappings.wallet.paypalButton
      - sleep:
          duration: 5000          
      - click:
          identifier: us.mappings.wallet.paypalConfirmButton
      - sleep:
          duration: 8000

  - name: us.functions.paypal.changePaymentsButton
    platform: android
    flow:
      # - executeFunction:
      #      name: us.functions.global.navigation.goToWalletPage 
      - executeFunction:
          name: us.functions.global.navigation.goToDeepLink
          params:
            - name: deepLinkUrl
              string: walmart://wallet
      - sleep:
          duration: 6000
      - scroll:
          direction: up
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.wallet.paypalButton        
          then:
            - log: "Paypal Card already added Removing card to continue with scenario"
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.account.walletPaypalCardView
                  - name: direction
                    string: down
                  - name: scrollPosition
                    string: center
            - click: 
                identifier: us.mappings.account.walletPaypalCardRemoveButton 
            - sleep:
                duration: 1000             
            - click: 
                identifier: us.mappings.account.walletPaypalCardRemoveConfirmButton
            - verifyIdentifier:
                notPresent:
                    - identifier: us.mappings.account.walletPaypalCardView
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.wallet.paypalButton
            - name: direction
              string: up
            - name: scrollPosition
              string: center
      - click:
          identifier: us.mappings.wallet.paypalButton
      - if:
          identifier:
            present:
              - identifier: us.mappings.paypalWebView.agreeandcontinueButton
          then:
            - click:
                identifier: us.mappings.paypalWebView.agreeandcontinueButton     
      - if:
          identifier:
            present:
              - identifier: us.mappings.paypalWebView.saveandcontinueButton
          then:
            - click:
                identifier: us.mappings.paypalWebView.saveandcontinueButton                      
          else:
            - executeFunction:
                name: us.functions.paypal.logInPage       
      - sleep:
          duration: 10000

  - name: us.functions.paypal.logInPage
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.wallet.paypalWebView.confirmationPopupTitle
          then:
            - click:
                identifier: us.mappings.paypal.popupContinueButton 
      - if:
          identifier:
            present:
              - identifier: us.mappings.paypalWebView.acceptCookies
          then:
            - click:
                identifier: us.mappings.paypalWebView.acceptCookies
      - if:
          identifier:
            present:
              - identifier: us.mappings.paypalWebView.emailTextField
          then:
            - click:
                identifier: us.mappings.paypalWebView.emailTextField
            - enterText:
                identifier: us.mappings.paypalWebView.emailTextField
                string: pgptest@walmart.com
                clearField: true
            # - click:
            #     identifier: Done
            - sleep:
                duration: 2000
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.paypalWebView.nextButton
                then:
                  - click:
                      identifier:   us.mappings.paypalWebView.nextButton
            - click:
                identifier: us.mappings.paypalWebView.passwordTextField
            - enterText:
                identifier: us.mappings.paypalWebView.passwordTextField
                string: testing4pgp$
            - click:
                identifier: us.mappings.paypalWebView.loginButton
            - sleep:
                duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.global.notNowButton
          then:
            - click:
                identifier: us.mappings.global.notNowButton
      - if:
          identifier:
            present:
              - identifier: us.mappings.paypalWebView.acceptCookies
          then:
            - click:
                identifier: us.mappings.paypalWebView.acceptCookies
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.paypalWebView.agreeandcontinueButton
                then:
                  - click:
                      identifier: us.mappings.paypalWebView.agreeandcontinueButton
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.paypalWebView.saveandcontinueButton
                then:
                  - click:
                      identifier: us.mappings.paypalWebView.saveandcontinueButton                      
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.orderdeatils.continueToAppButton
                then:
                  - click:
                      identifier: us.mappings.orderdeatils.continueToAppButton
            - sleep:
                duration: 5000
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.wallet.PaypalPaymentContinueButton
                then:
                  - click:
                      identifier:  us.mappings.wallet.PaypalPaymentContinueButton
            - sleep:
                duration: 3000
          else:
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.paypalWebView.agreeandcontinueButton
                then:
                  - click:
                      identifier: us.mappings.paypalWebView.agreeandcontinueButton
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.paypalWebView.saveandcontinueButton
                then:
                  - click:
                      identifier: us.mappings.paypalWebView.saveandcontinueButton                     
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.orderdeatils.continueToAppButton
                then:
                  - click:
                      identifier: us.mappings.orderdeatils.continueToAppButton
            - sleep:
                duration: 5000
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.wallet.PaypalPaymentContinueButton
                then:
                  - click:
                      identifier: us.mappings.wallet.PaypalPaymentContinueButton
            - sleep:
                duration: 3000
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.wallet.PaypalPaymentCardError
                then:
                  - failTest:
                      message: "ENV_FAILURE - ${env} - Unable to Add Paypal Card"

  - name: us.functions.paypal.logInPage
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.paypalWebView.acceptCookies
          then:
            - click:
                identifier: us.mappings.paypalWebView.acceptCookies
      - if:
          identifier:
            present:
              - identifier: us.mappings.paypalWebView.emailTextField
          then:
            - click:
                identifier: us.mappings.paypalWebView.emailTextField
            - enterText:
                identifier: us.mappings.paypalWebView.emailTextField
                string: pgptest@walmart.com
                clearField: true
            # - click:
            #     identifier: Done
            - click:
                identifier:   us.mappings.paypalWebView.nextButton
            - click:
                identifier: us.mappings.paypalWebView.passwordTextField
            - enterText:
                identifier: us.mappings.paypalWebView.passwordTextField
                string: testing4pgp$
            - click:
                identifier: us.mappings.paypalWebView.loginButton
            - sleep:
                duration: 5000
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.paypalWebView.agreeandcontinueButton
                then:
                  - click:
                      identifier: us.mappings.paypalWebView.agreeandcontinueButton
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.paypalWebView.saveandcontinueButton
                then:
                  - click:
                      identifier: us.mappings.paypalWebView.saveandcontinueButton                          
            - sleep:
                duration: 10000

  - name: us.functions.paypal.placeOrder
    platform: ios
    flow:
       - scroll:
            untilIdentifier: us.mappings.reviewOrder.verifyPayPalpalView
            direction: down
            position: center
       - if:
          identifier:
            present:
              - identifier: us.mappings.reviewOrder.selectPayPalpalPayment 
          then:
            - click:
                identifier: us.mappings.reviewOrder.selectPayPalpalPayment          
            - click:
                identifier: us.mappings.wallet.paypalConfirmButton 
       - executeFunction:
           name: us.functions.checkout.placeOrder

  - name: us.functions.paypal.placeOrder
    platform: android
    flow:
        - sleep:
            duration: 3000
        - if:
            identifier:
              notPresent:
                - identifier: us.mappings.reviewOrder.editPayment
            then:
              - scroll:
                  direction: down
                  untilIdentifier: us.mappings.reviewOrder.editPayment
        - click:
            identifier: us.mappings.reviewOrder.editPayment
            wait: 3000
        - click:
            identifier: us.mappings.paymentMethod.selectPaypal
            wait: 3000
        - click:
            identifier: us.mappings.capOne.paymentsOptionsContinueButton
            wait: 2000

#        - executeFunction:
#            name: us.functions.utils.scrollIfNotVisible
#            params:
#              - name: identifier
#                string: us.mappings.reviewOrder.selectPayPalpalPayment
#              - name: direction
#                string: up
#              - name: scrollPosition
#                string: center
#        - if:
#            identifier:
#              present:
#                - identifier: us.mappings.reviewOrder.selectPayPalpalPayment
#            then:
#              - click:
#                  identifier: us.mappings.reviewOrder.selectPayPalpalPayment
#            else:
#              - executeFunction:
#                  name: us.functions.utils.scrollIfNotVisible
#                  params:
#                    - name: identifier
#                      string: us.mappings.reviewOrder.selectPayPalpalPayment
#                    - name: direction
#                      string: up
#                    - name: scrollPosition
#                      string: center
#              - click:
#                  identifier: us.mappings.reviewOrder.selectPayPalpalPayment
        - sleep:
            duration: 5000
        - executeFunction:
            name: us.functions.checkout.placeOrder

  - name: us.functions.paypal.orderDetails.mixedOrder.verifyPaypalPaymentMethod
    platform: ios
    flow:
      - scroll:
          direction: down
      - verifyIdentifier:
                label:
                  - identifier: us.mappings.paypal.orderDetailsPage.paypalEmailId
                    contains: wal@pp.com

  - name: us.functions.paypal.removePayPalCard
    platform: android
    flow:
       - executeFunction:
           name: us.functions.global.navigation.goToDeepLink
           params:
             - name: deepLinkUrl
               string: walmart://home
       - executeFunction:
           name: us.functions.home.closeWPlusPromotionPopUpIfDisplayed
       - executeFunction:
          name: us.functions.global.navigation.toTab
          params:
            - name: tabName
              string: Account
       - executeFunction:
           name: us.functions.home.closeWPlusPromotionPopUpIfDisplayed
      #  - executeFunction:
      #      name: us.functions.global.navigation.goToWalletPage 
       - executeFunction:
           name: us.functions.global.navigation.goToDeepLink
           params:
             - name: deepLinkUrl
               string: walmart://wallet
       - sleep:
            duration: 1000 
       - executeFunction:
           name: us.functions.utils.scrollIfNotVisible
           params:
             - name: identifier
               string: us.mappings.account.walletPaypalCardView
             - name: direction
               string: down
             - name: scrollPosition
               string: center
       - click: 
          identifier: us.mappings.account.walletPaypalCardRemoveButton 
       - sleep:
           duration: 1000             
       - click: 
           identifier: us.mappings.account.walletPaypalCardRemoveConfirmButton
       - verifyIdentifier:
           notPresent:
              - identifier: us.mappings.account.walletPaypalCardView

  - name: us.functions.paypal.removePayPalCard
    platform: ios
    flow:
       - executeFunction:
           name: us.functions.global.navigation.goToDeepLink
           params:
             - name: deepLinkUrl
               string: walmart://home
       - executeFunction:
          name: us.functions.global.navigation.toTab
          params:
            - name: tabName
              string: Account
       - executeFunction:
           name: us.functions.global.navigation.goToDeepLink
           params:
             - name: deepLinkUrl
               string: walmart://wallet
       - sleep:
            duration: 1000 
       - executeFunction:
           name: us.functions.utils.scrollIfNotVisible
           params:
             - name: identifier
               string: us.mappings.account.walletPaypalCardView
             - name: direction
               string: down
             - name: scrollPosition
               string: center
       - click: 
          identifier: us.mappings.account.walletPaypalCardRemoveButton 
       - sleep:
           duration: 1000             
       - click: 
           identifier: us.mappings.account.walletPaypalCardRemoveConfirmButton
       - verifyIdentifier:
           notPresent:
              - identifier: us.mappings.account.walletPaypalCardView

  - name: us.functions.wplus.paypalPayment.nonMemberToTrialMonthly
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.wplus.signup.selectPlan.monthly
          then:
            - executeFunction:
                name: us.functions.paypalPaymentMethod
            - click:
                identifier: us.mappings.wplus.signup.selectPlan.monthly
            - click:
                identifier: us.mappings.wplus.signup.trywalmartplusforFreeButton
                wait: 3000

            - if:
                identifier:
                  present:
                    - identifier: us.mappings.wplus.aquisition.legalCheckBox
                then:
                  # - scroll:
                  #     direction: down
                  #     untilIdentifier: us.mappings.wplus.aquisition.legalCheckBox
                  #     position: center
                  
                  - click:
                      identifier: us.mappings.wplus.aquisition.legalCheckBox
                      wait: 3000
                  
                  - click:
                      identifier: us.mappings.wplus.signup.trywalmartplusforFreeButton
                      wait: 8000

            - executeFunction:
                name: us.functions.wplus.phoneVerificationPage
            - sleep:
                 duration: 5000 
            - click:
                identifier: us.mappings.wlus.membershipBottomsheetClose
            - log: "started trial from account with Paypal"    

  - name: us.functions.paypalPaymentMethod
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.payPalLabel
            - identifier: us.mappings.wplus.paypalPaymentDescription               