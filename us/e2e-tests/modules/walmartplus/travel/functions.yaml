functions:

  # Travel card on benefits tab and direct to W+ travel BDP
  - name: us.functions.wplus.benefitsTabSelected.travelbanner
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.wPlus.benifitsTabHeader
          then:
            - click:
                identifier: us.mappings.wPlus.benifitsTabHeader
                wait: 1000
            - scroll:
                direction: down
                untilIdentifier: us.mappings.wplus.travel.bookTripbtn
          else:
            - scroll:
                direction: down
                untilIdentifier: us.mappings.wplus.travel.wplusTravel
            - click:
                identifier: us.mappings.wplus.travel.wplusTravel
                wait: 1000
      - try:
          flow:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.wplus.travel.bookTripbtn
                  - identifier: us.mappings.wplus.travel.banner.learnMoreLink
          catch:
            flow:
              - failTest:
                  message: "ENV_FAILURE - ${env} - Book a trip or Learn more is missing on travel card of benefit tab"
      - click:  
          identifier: us.mappings.wplus.travel.banner.learnMoreLink
          wait: 3000

  # Validate the CTAs on W+ travel BDP
  - name: us.functions.wplus.benefitScreen.travelBDP
    platform: ios
    flow:
      - try:
          flow:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.wplus.travel.travelBDP.title
                  - identifier: us.mappings.wplus.travel.bookTripbtn
                  - identifier: us.mappings.wplus.travel.travelBDP.seeBookedTripsbtn
                  - identifier: us.mappings.wplus.travel.travelBDP.subtitleExpedia
          catch:
            flow:
              - failTest:
                  message: "ENV_FAILURE - ${env} - identifier is missing on travel BDP"
      # View All FAQ
      - scroll:
          direction: down
          untilIdentifier: us.mappings.wplus.travel.travelBDP.ViewallFAQ
      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.travel.travelBDP.ViewallFAQ
            - identifier: us.mappings.wplus.travel.bookTripbtn
      # Walmart Plus Cash
      - scroll:
          direction: up
          untilIdentifier: us.mappings.wplus.travel.travelBDP.viewWalmartCash
      - click:
           identifier: us.mappings.wplus.travel.travelBDP.viewWalmartCash
           wait: 5000
      - verifyIdentifier:
           present:
             - identifier: us.mappings.savings.wplus.WalmartRewardCenterTitle
      - click:
           identifier: us.mappings.wplus.backBtn
      - sleep:
          duration: 3000
      - click:
           identifier: us.mappings.wplus.backBtn

  # Travel card on benefits tab and direct to W+ travel BDP
  - name: us.functions.wplus.benefitsTabSelected.travelbanner
    platform: android
    flow:
      #Remove this once hub redesign is enabled 100%
      - if:
          identifier:
            present:
              - identifier: us.mappings.wPlus.benifitsTabHeader
          then:   
            - click:
                identifier: us.mappings.wPlus.benifitsTabHeader
                wait: 1000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.wplus.travel.bookTripCollapsedView 
            - name: direction
              string: down
            - name: scrollPosition
              string: center 
      # - if:
      #     identifier:
      #       present:
      #         - identifier: us.mappings.wPlus.benifitsTabHeader
      #     then:   
      #       - click:
      #           identifier: us.mappings.wPlus.benifitsTabHeader
      #           wait: 1000
      # - scroll:
      #     direction: down
      #     untilIdentifier: us.mappings.wplus.travel.bookTripCollapsedView 
      #     scrollLimit: 3              
      - if: 
          identifier:
            present:
              - identifier: us.mappings.wplus.travel.bookTripCollapsedView 
          then:
            - click:
                identifier: us.mappings.wplus.travel.bookTripCollapsedView 
      # - if:
      #     identifier:
      #       present:
      #         - identifier: us.mappings.wplus.travel.bookTripbtn
      #     then:   
      #       - verifyIdentifier:
      #           present:
      #             - identifier: us.mappings.wplus.travel.bookTripbtn             
      #     else:
      #       - log: "travel card not visible"
      #       - scroll:
      #           direction: down
      #           untilIdentifier: us.mappings.wplus.travel.bookTripbtn
      #           position: center
      - try:
          flow:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.wplus.travel.bookTripbtn
                  - identifier: us.mappings.wplus.travel.banner.learnMoreLink
          catch:
            flow:
              - failTest:
                  message: "ENV_FAILURE - ${env} - Book a trip or Learn more is missing on travel card of benefit tab"
      - click:  
          identifier: us.mappings.wplus.travel.banner.learnMoreLink
          wait: 3000

  # Validate the CTAs on W+ travel BDP
  - name: us.functions.wplus.benefitScreen.travelBDP
    platform: android
    flow:
      - try:
          flow:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.wplus.travel.travelBDP.title
                  - identifier: us.mappings.wplus.travel.bookTripbtn
                  - identifier: us.mappings.wplus.travel.travelBDP.seeBookedTripsbtn
                  - identifier: us.mappings.wplus.travel.travelBDP.subtitleExpedia
          catch:
            flow:
              - failTest:
                  message: "ENV_FAILURE - ${env} - identifier is missing on travel BDP"
      - scroll:
          direction: down
          untilIdentifier: us.mappings.wplus.travel.travelBDP.bookTripOnBottom
      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.travel.travelBDP.ViewallFAQ
            - identifier: us.mappings.wplus.travel.travelBDP.bookTripOnBottom
      - scroll:
          direction: up
          untilIdentifier: us.mappings.wplus.travel.travelBDP.viewWalmartCash
      - click:
          identifier: us.mappings.wplus.travel.travelBDP.viewWalmartCash
          wait: 5000
      - sleep:
          duration: 3000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.wplus.WalmartRewardCenterTitle
            - name: direction
              string: down
      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.WalmartRewardCenterTitle
      - click:
          identifier: us.mappings.global.navigateBackArrow

  - name: us.functions.wplus.accountPage.clickWalmartBenefitsButton
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.wplus.walmartBenefitsButton
          position: center
          
      - if:
          identifier:
            present:
              - identifier: us.mappings.wplus.walmartBenefitsButton
          then:   
            - click:
                identifier: us.mappings.wplus.walmartBenefitsButton
                wait: 1000
          
