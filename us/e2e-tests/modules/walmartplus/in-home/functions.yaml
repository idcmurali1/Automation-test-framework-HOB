functions: 
  
  # Sign up for in-home
  - name: us.functions.wplus.inHome.signup
    platform: android
    flow:
      - if:
          identifier:
            present: 
              - identifier: #benifit tab is selected
          then:
           - scroll:
                direction: down
                untilIdentifier: us.mappings.benefitHub.inHome.title
           - click:
                wait: 1000
                identifier: # plus-up indentifier
          else:
            - log: "Benifits tab is not selected"
            - click: 
                identifier: # benefits tab
            - scroll:
                direction: down
                untilIdentifier: us.mappings.benefitHub.inHome.title
            - click:
                wait: 1000
                identifier: us.mappings.benefitHub.inHome.title
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.startTrailButton
          then:
            - log: "Start Trial button is vailable as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Star trial button should be present but is not"
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inHome.reviewMembershipTitle
            - identifier: us.mappings.inHome.trailLabel
      - click: 
          identifier: us.mappings.inHome.startTrailButton
  
  # Sign up for in-home
  - name: us.functions.wplus.inHome.signup
    platform: ios
    flow:
      - if:
          identifier:
            present: 
              - identifier: #benifit tab is selected
          then:
           - scroll:
                direction: down
                untilIdentifier: us.mappings.benefitHub.inHome.title
           - click:
                wait: 1000
                identifier: # plus-up indentifier
          else:
            - log: "Benifits tab is not selected"
            - click: 
                identifier: # benefits tab
            - scroll:
                direction: down
                untilIdentifier: us.mappings.benefitHub.inHome.title
            - click:
                wait: 1000
                identifier: us.mappings.benefitHub.inHome.title
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.startTrailButton
          then:
            - log: "Start Trial button is vailable as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Star trial button should be present but is not"
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inHome.reviewMembershipTitle
            - identifier: us.mappings.inHome.trailLabel
      - click: 
          identifier: us.mappings.inHome.startTrailButton

  # Sign up for in-home through benefits hub

  - name: us.functions.wplus.inHome.benefitshubsignup
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - scroll:
          direction: up
          untilIdentifier: us.mappings.benefits.title
          position: center
      - verifyIdentifier:
          timeout: 2000
          present:
            - identifier: us.mappings.benefits.title
      # - if:
      #     identifier:
      #        present: 
      #          - identifier: us.mappings.wplus.benefitsTabSelected comments: Delete this once Hub redesign is enabled 100%
      #     then:
      #       - click:
      #           wait: 1000
      #           identifier: us.mappings.wplus.benefitsTabSelected comments:Delete this once Hub redesign is enabled 100%
      - scroll:
          direction: down
          untilIdentifier: us.mappings.benefits.inhome.tryInhomePlusupsForFree #us.mappings.benefitHub.inHome.tryInHomePlusUpsForFree comments: Delete this once Hub redesign is enabled 100%
      - click:
            wait: 1000
            identifier: us.mappings.benefits.inhome.tryInhomePlusupsForFree #us.mappings.benefitHub.inHome.tryInHomePlusUpsForFree comments: Delete this once Hub redesign is enabled 100%

  # Sign up for in-home through benefits hub

  - name: us.functions.wplus.inHome.checkForTryInHomePlusUpsNotPresentInBenefits
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.benefitHub.inHome.tryInHomePlusUpsForFree
          then:
            - log: "Try In Home plus up not present in Benefits hub as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - In Home plus up option should not be present but is showed"
      # - verifyIdentifier:
      #     notPresent:
      #       - identifier: us.mappings.benefitHub.inHome.tryInHomePlusUpsForFree


  # Sign up for in-home through benefits hub

  - name: us.functions.wplus.inHome.checkForTryInHomePlusUpsNotPresentInBenefits
    platform: android
    flow:
       - if:
          identifier:
            notPresent:
              - identifier: us.mappings.benefitHub.inHome.tryInHomePlusUpsForFree
          then:
            - log: "Try In Home plus up not present in Benefits hub as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - In Home plus up option should not be present but is showed"
      # - verifyIdentifier:
      #     notPresent:
      #       - identifier: us.mappings.benefitHub.inHome.tryInHomePlusUpsForFree
            
  # Confirm address for in-home

  - name: us.functions.wplus.inHome.confirmAddress
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - if:
          identifier:
            present: 
              - identifier: us.mappings.benefitHub.inHome.addressConfirmationPageTitle
          then:
            - verifyIdentifier:
               present:
                 - identifier: us.mappings.benefitHub.inHome.confirmButton
            - click:
               wait: 1000
               identifier: us.mappings.benefitHub.inHome.confirmButton

  # Validate start in home free trial page

  - name: us.functions.wplus.inHome.validateStartInHomeFreeTrialPage
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.benefitHub.inHome.startInHomeFreeTrialButton
          then:
            - log: "Start In Home trial option is present as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Start In Home free trial button should be present but is not"
      - verifyIdentifier:
          present:
            - identifier: us.mappings.benefitHub.inHome.paymentDetailsAndTerms.30DayFreeTrialLabel
            - identifier: us.mappings.benefitHub.inHome.paymentDetailsAndTerms.paymentStartDateLabel

  # Start in home free trial

  - name: us.functions.wplus.inHome.startInHomeFreeTrial
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.benefitHub.inHome.startInHomeFreeTrialButton
          then:
            - log: "Start In Home trial option is present as expected"
            - click:
                wait: 3000
                identifier: us.mappings.benefitHub.inHome.startInHomeFreeTrialButton
                wait: 3000
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Start In Home free trial button should be present but is not"
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.benefitHub.inHome.startInHomeFreeTrialButton
      # - click:
      #     wait: 3000
      #     identifier: us.mappings.benefitHub.inHome.startInHomeFreeTrialButton
      #     wait: 3000

 # Click on explorePlusUps 
  - name: us.functions.wplus.inHome.explorePlusUps
    platform: ios
    flow:
      - click: 
          identifier: us.mappings.inHome.explorePlusUpsutton

  # Click on ManagePlusUps 
  - name: us.functions.wplus.inHome.managePlusUps
    platform: ios
    flow:
      - click:
          identifier: us.mappings.manageMembership.inHome.managePlusUpsButton

  # Click on ManagePlusUps 
  - name: us.functions.wplus.inHome.managePlusUps
    platform: android
    flow:
      - scroll:
         direction: down
         untilIdentifier: us.mappings.manageMembership.inHome.managePlusUpsButton
      - if:
          identifier:
            present:
              - identifier: us.mappings.manageMembership.inHome.managePlusUpsButton
          then:
            - log: "Manage Plus Ups button is present as expected"
            - click:
                identifier: us.mappings.manageMembership.inHome.managePlusUpsButton
          else:
            - failTest:
                message: "Manage Plus Ups button should be present but is not"
      

  # Validate Manage PlusUps Inhome monthly signup details 
  - name: us.functions.wplus.inHome.monthly.verifyPlusUpsDetails
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inHome.unSelectCheckbox
      - executeFunction:
          name: us.functions.wplus.inhome.verifyPlanDetails
          params:
           - name: amount
             string: $7 per month
      - click:
          identifier: us.mappings.inHome.selectInhomeCheckbox
      
      - click:
          identifier: us.mappings.inHome.monthlyReviewchangesBtn

  # Validate Manage PlusUps Inhome monthly signup details 
  - name: us.functions.wplus.inHome.annual.verifyPlusUpsDetails
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inHome.unSelectCheckbox
      - executeFunction:
          name: us.functions.wplus.inhome.verifyPlanDetails
          params:
           - name: amount
             string: $40/year
      - click:
          identifier: us.mappings.inHome.selectInhomeCheckbox
      
      - click:
          identifier: us.mappings.inHome.monthlyReviewchangesBtn

   # Validate Manage PlusUps Inhome monthly details        
  - name: us.functions.wplus.inhome.verifyPlanDetails
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.priceLabel
          then:
            - log: "Plan details displayed as expected"
            - verifyIdentifier:
                present:
                  - identifier:  us.mappings.inHome.monthlyFreetrial
                  - identifier:  us.mappings.inHome.monthlyFreetrialMsg
            # - verifyIdentifier: 
            #       text:
            #         - identifier: us.mappings.wplus.manageMembership.inHome.plusUps.payment.description
            #           contains: $7 plus
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Plan details not displayed as expected"
      # - verifyIdentifier:
      #     present:
      #       - identifier:  us.mappings.inHome.monthlyFreetrial
      # - verifyIdentifier:
      #     present:
      #       - identifier:  us.mappings.inHome.monthlyFreetrialMsg
              
  
 # Validate Inhome Review membership details    
  - name: us.functions.wplus.inHome.verifyReviewmembershipDetails
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inHome.monthlyWplustrialDecsription
            - identifier: us.mappings.inHome.trialDecsription
      - if:
          condition: ${tenure} == 'annual'
          then:
            - log: Verifying Annual trial tenure Details
            - verifyIdentifier:
                present: 
                  - identifier: us.mappings.inHome.wplusAnnualReviewChangesRate
                  - identifier: us.mappings.inHome.annualReviewChangesPayment
          else:
            - log: Verifying Monthly trial tenure Details
            - verifyIdentifier:
                present:       
                  - identifier: us.mappings.inHome.wplusMonthlyReviewChangesRate
                  - identifier: us.mappings.inHome.monthlyReviewChangesPayment    
      - scroll:
          direction: down
      - sleep:
          duration: 2000 
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.agreeCheckbox
          then:
            - click:
                identifier: us.mappings.inHome.agreeCheckbox          
      - click:
          identifier: us.mappings.inHome.monthlyStartInhometrial
          wait: 3000
      - click:
          identifier: us.mappings.inHome.monthlyReviewchangeDoneButton

# Navigate  Manage Membership page to benefits page
  - name: us.functions.wplus.navigateToBenefitsFromMembershipPage
    platform: ios
    flow:
      - click:
          identifier: us.mappings.inHome.managePlusUpsbackButton

# select InHome Address in home page

  - name: us.funtions.wplus.inHome.selectAddress
    platform: ios
    flow:
      - click:
          identifier: us.mappings.home.gic.module.parent.addAddressButton
      - click:
          identifier: us.mappings.reserveSlot.addressselectionButton
      - click:
          wait: 2000
          identifier:  us.mappings.inHome.addressSelection.saveButton
     
# Signup Inhome via Bookslot
  - name: us.funtions.inHome.bookSlot.signUpTrialInHome
    platform: ios
    flow:
      - verifyIdentifier:
          label: 
            - identifier: us.mappings.inHome.bookSlot.verifyTipFreeDeliveriryLabel
              contains: Want tip-free delivery for a whole month?
      - verifyIdentifier:
          label: 
            - identifier: us.mappings.inHome.bookSlot.verifyInHomeTrialSignUpLink
              contains: Start InHome 30-day free trial
      - click:
          identifier: us.mappings.inHome.bookSlot.verifyInHomeTrialSignUpLink
      - scroll:
          direction: down
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.bookslot.checkBox
          then:
            - click:
                identifier: us.mappings.inHome.bookslot.checkBox
      - click:
          identifier: us.mappings.inHome.bookSlot.clickInHomeTrialSignUpButton
      
# Validate Signup Inhome bottomsheet details
  - name: us.funtions.inHome.bookSlot.verifyInhomeSignUpBottomSheet
    platform: ios
    flow:
        - sleep:
            duration: 3000
        - if:
            identifier:
                present:
                  - identifier : us.mappings.inHome.bookSlot.verifyInHomeSignupSuccessMsg
            then: 
                - verifyIdentifier:
                    label: 
                      - identifier: us.mappings.inHome.bookSlot.verifyInHomeSignupSuccessMsg
                        contains: Welcome! We’re ready to tackle your to-dos
                - verifyIdentifier:
                     label: 
                      - identifier: us.mappings.inHome.bookSlot.verifyInHomeBottomSheetLabel
                        contains: Enjoy your free 30-day membership of InHome
            else:
                - verifyIdentifier:
                    label: 
                      - identifier: us.mappings.inHome.bookSlot.verifyInHomeSignupBottomSheeMsg
                        contains: Save a trip to the store – enjoy free and easy grocery delivery
        - click:
           identifier: us.mappings.wplus.inHome.membership.closeAlert
      
# Validat Sign Up Inhome details in Bookslot
  - name: us.funtions.inHome.bookSlot.verifyInhomeSignUpDetails
    platform: ios
    flow:
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.inHome.bookSlot.verifyTipFreeDeliveryLabelAfterSignUp
      - click:
          identifier: us.mappings.inHome.bookSlot.clickInfoIcon
      - verifyIdentifier:
          label: 
            - identifier: us.mappings.inHome.bookSlot.verifyInHomeTitle
              contains: InHome delivery
      - click:
          identifier: us.mappings.inHome.bookSlot.clickCloseIcon
      - click:
          identifier: us.mappings.reserveSlot.dismissPageButton

      
# Validate Inhome membership details after the enrollment
  - name: us.functions.wplus.inHome.validateMyPlusUpsTrialMonthlyPlanDetails
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - if:
          identifier:
            present: 
              - identifier: us.mappings.inHome.managePlusUpscheckbox
          then:
            - log: "Manage Plus Ups checkbox present as expected"
            - executeFunction:
                name: us.functions.wplus.inhome.verifyPlanDetails
                params:
                  - name: amount
                    string: $7 per month
          else:
            - failTest: "ENV_FAILURE - ${env} - Manage Plus Ups checkbox should have been present but was not "
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.inHome.managePlusUpscheckbox

      # - executeFunction:
      #     name: us.functions.wplus.inhome.verifyPlanDetails
      #     params:
      #      - name: amount
      #        string: $7 per month
      

# Verify InHome card details in Benefits screen after the enrollment
  - name: us.functions.wplus.inHome.validatePlusUpsbenefitsDetails
    platform: ios
    flow:
      - scroll:
          direction: down #up  comments: Delete this once hub redesign is enabled is 100%
          untilIdentifier: us.mappings.inHome.benefitscardInHomeDelivery
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.benefitInHomeSettings
          then:
            - log: "Plus ups benefits details displayed properly"
            - verifyIdentifier:
                present:
                  - identifier:  us.mappings.inHome.benefitscardInHomeDelivery
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Plus ups benefits details not displayed properly"

# Manage PlusUps page validations for cancel member
  - name: us.functions.wplus.inHome.validateCancelMemberManagePlusUps
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - verifyIdentifier:
         present:
            - identifier: us.mappings.inHome.cancelMember.reviewchangesbtnDisabled
      - click:
          identifier: us.mappings.inHome.selectInhomeCheckbox
      - sleep:
          duration: 5000
      - verifyIdentifier:
          present:
            - identifier:  us.mappings.inHome.cancelWarningMsgmanagePlusUps
            - identifier:  us.mappings.inHome.cancelMember.reviewchangesbtnEnabled
            - identifier:  us.mappings.inHome.cancelPlusUps.freeTrialLabel
      - if:
          condition: ${membership} == 'Trial Monthly'
          then:
              - log: Verifying In-Home Monthly trial membership Details
              - verifyIdentifier:
                  label:
                    - identifier: us.mappings.inHome.cancelMember.verifyInhomePaymentDetails
                      contains: $7 per month
          else: 
              - log: Verifying In-Home Paid Annual membership details
              - verifyIdentifier:
                 label: 
                  - identifier: us.mappings.inHome.cancelMember.verifyInhomePaymentDetails
                    contains: $40 per year
      - click:
          identifier: us.mappings.inHome.cancelMember.reviewchangesbtnEnabled
      - sleep:
          duration: 5000

# Manage PlusUps page validations for cancel member
  - name: us.functions.wplus.inHome.validateCancelMemberManagePlusUpsAfterReactivation
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - verifyIdentifier:
         present:
            - identifier: us.mappings.inHome.cancelMember.reviewchangesbtnDisabled
      - click:
          identifier: us.mappings.inHome.selectInhomeCheckbox
      - sleep:
          duration: 5000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inHome.cancelMember.reviewchangesbtnEnabled
      - if:
          condition: ${membership} == 'Paid Monthly'
          then:
              - log: Verifying In-Home Monthly membership Details
              - verifyIdentifier:
                  label:
                    - identifier: us.mappings.inHome.cancelMember.verifyInhomePaymentDetails
                      contains: $7 per month
          else: 
              - log: Verifying In-Home Paid Annual membership details
              - verifyIdentifier:
                 label: 
                  - identifier: us.mappings.inHome.cancelMember.verifyInhomePaymentDetails
                    contains: $40 per year
      - click:
          identifier: us.mappings.inHome.cancelMember.reviewchangesbtnEnabled
      - sleep:
          duration: 5000
      - executeFunction:
          name: us.functions.wplus.inHome.cancelmember.verifyReviewmembershipDetails


# Manage PlusUps page validations for cancel member
  - name: us.functions.wplus.inHome.validateCancelMemberManagePlusUps
    platform: android
    flow:
      - verifyIdentifier:
         present:
            - identifier: us.mappings.inHome.cancelMember.reviewchangesbtnDisabled
      - click:
          identifier: us.mappings.inHome.selectInhomeCheckbox
      - verifyIdentifier:
          present:
            - identifier:  us.mappings.inHome.cancelWarningMsgmanagePlusUps
            - identifier:  us.mappings.inHome.cancelMember.reviewchangesbtnEnabled
      - click:
          identifier: us.mappings.inHome.cancelMember.reviewchangesbtnEnabled
               

# Validate Inhome Review membership details    
  - name: us.functions.wplus.inHome.cancelmember.verifyReviewmembershipDetails
    platform: ios
    flow:
      - verifyIdentifier:
          value:
            - identifier:  us.mappings.inHome.confirmPage.addonsReviewTitle
              contains:  ${firstName} , Before you cancel...
          present:
            - identifier: us.mappings.inHome.confirmPage.addonsReviewSubTitle
            - identifier: us.mappings.inHome.confirmPage.cancellationTerms
            - identifier: us.mappings.inHome.confirmPage.cancelInHomeBtn
            - identifier: us.mappings.inHome.confirmPage.keepInHomeBtn
   
      - click:
          identifier: us.mappings.inHome.confirmPage.cancelInHomeBtn
           
# Validate Inhome Review membership details    
  - name: us.functions.wplus.inHome.cancelmember.verifyReviewmembershipDetails
    platform: android
    flow:
      - verifyIdentifier:
          text:
            - identifier:  us.mappings.inHome.confirmPage.addonsReviewTitle
              contains:  ${firstName} , Before you cancel...
          present:
            - identifier: us.mappings.inHome.confirmPage.addonsReviewSubTitle
            - identifier: us.mappings.inHome.confirmPage.cancellationTerms
            - identifier: us.mappings.inHome.confirmPage.cancelInHomeBtn
            - identifier: us.mappings.inHome.confirmPage.keepInHomeBtn
   
      - click:
          identifier: us.mappings.inHome.confirmPage.cancelInHomeBtn

# Select Inhome membership cancel reason
  - name: us.functions.wplus.inHome.cancelmember.selectCancelReason
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inHome.reasonPage.cancelInHomeChooseReasonTitle
      - click:
          identifier: us.mappings.inHome.reasonPage.cancelInHomeReason
      - click:
          identifier: us.mappings.inHome.reasonPage.cancelInHomeBtn


# Select Inhome membership cancel reason
  - name: us.functions.wplus.inHome.cancelmember.selectCancelReason
    platform: ios
    flow:
      - click:
          identifier: us.mappings.inHome.reasonPage.cancelInHomeReason
      - click:
          identifier: us.mappings.wplus.clickCancelMembershipButton

  - name: us.functions.wplus.inHome.validateMonthlyProgressbar
    platform: ios
    flow:
       - verifyIdentifier:
           present:
             - identifier: us.mappings.manageMembership.monthlyProgressbar

  - name: us.functions.wplus.inHome.validatemonthlyMembershipChargeamt
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.manageMembership.monthlyMembershipChargeamt
          then:
            - log: "Monthly membership charge amount displayed correctly as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Monthly membership charge amount should have been displayed but is not"
       # - verifyIdentifier:
       #     present:
       #       - identifier: us.mappings.manageMembership.monthlyMembershipChargeamt
           
  # Manage Plus Ups Screen Validations
  - name: us.functions.wplus.inHomeManagePlusValidations
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inHome.explorePlusUpsCTA
      - click:
          identifier: us.mappings.inHome.explorePlusUpsCTA
          wait: 5000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inHome.managePlusUps.screenHeader
            - identifier: us.mappings.inHome.managePlusUps.howInHomeWorksLink
            - identifier: us.mappings.inHome.managePlusUps.reviewChangesCTA
            - identifier: us.mappings.inHome.managePlusUps.reviewChangesCTADisabled
            - identifier: us.mappings.inHome.managePlusUps.mayBeLaterLink
    

    # Verify Avaialable Plus Up on Benefits screen and validate the enrollment
  - name: us.functions.wplus.inHomeSignUpValidationThroughAvailablePlusUpsOnBenefits
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.inHome.benefitsAvailablePlusUps.tryInHomePlusUpsForFreeCTA
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inHome.benefitsAvailablePlusUps.availablePlusUpsTileHeader
            - identifier: us.mappings.inHome.benefitsAvailablePlusUps.availablePlusUpsInHomeText
      - click:
          identifier: us.mappings.inHome.benefitsAvailablePlusUps.tryInHomePlusUpsForFreeCTA
          wait: 5000
      - loop:
          begin: 0
          end: 2
          mode: increment
          flow:
            - click:
                identifier: us.mappings.inHome.selectAnAddress
                wait: 5000
            # - click:
            #     identifier: us.mappings.inHome.managePlusUps.reviewChangesCTA    
            # - verifyIdentifier:
            #     present:
            #       - identifier: us.mappings.inHome.startInHomeFreeTrialScreen
            - scroll:
                direction: down
            - executeFunction:
                name: us.functions.wplus.handle.viewFullScreen
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.inHome.startInHomeFreeTrialCTA
                then:    
                  - break: true     
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.global.onboarding.technicalError
                then: 
                  - log: Retrying due to technical error
                  - click:
                      identifier: us.mappings.global.onboarding.technicalErrorDismissButton    
            - sleep:
                duration: 2000               
      - verifyIdentifier:
          present:         
            - identifier: us.mappings.inHome.startInHomeFreeTrialCTA             
      
  # Explore Walmart+ benefits after signing up for free inhome trial

  - name: us.functions.wplus.inHome.exploreW+BenefitsAfterInHomeFreeTrial
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.benefitHub.inHome.exploreWalmartPlusBenefits
          then:
            - log: "Explore W+ Benefits button is present as expected"
            - click:
                wait: 1000
                identifier: us.mappings.benefitHub.inHome.exploreWalmartPlusBenefits
                wait: 3000
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Explore W+ Benefits button should be present but is not"
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.benefitHub.inHome.exploreWalmartPlusBenefits
      # - click:
      #     wait: 1000
      #     identifier: us.mappings.benefitHub.inHome.exploreWalmartPlusBenefits
      #     wait: 3000

  - name: us.functions.wplus.inHome.exploreW+BenefitsAfterInHomeFreeTrial
    platform: android
    flow:
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.benefitHub.inHome.exploreWalmartPlusBenefits
          then:
            - log: "Explore W+ Benefits button is present as expected"
            - click:
                wait: 1000
                identifier: us.mappings.benefitHub.inHome.exploreWalmartPlusBenefits
                wait: 3000
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Explore W+ Benefits button should be present but is not"
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.benefitHub.inHome.exploreWalmartPlusBenefits
      # - click:
      #     wait: 1000
      #     identifier: us.mappings.benefitHub.inHome.exploreWalmartPlusBenefits
      #     wait: 3000

# Sign up for in-home through benefits hub

  - name: us.functions.wplus.inHome.benefitshubsignup
    platform: android
    flow:
      - sleep:
          duration: 1000
      - verifyIdentifier:
          timeout: 2000
          present:
           - identifier: us.mappings.benefits.title
# Delete this once hub redesign is enabled 100%
      # - if:
      #     identifier:
      #        present: 
      #          - identifier: us.mappings.wplus.benefitsTabSelected
      #     then:
      #       - click:
      #           wait: 1000
      #           identifier: us.mappings.wplus.benefitsTabSelected
      #     else:
      #       - click:
      #           wait: 1000
      #           identifier: us.mappings.global.navigateBenifitTab
      
      - scroll:
            direction: down
            untilIdentifier: us.mappings.benefitHub.inHome.tryInHomePlusUpsForFree
      - click:
            wait: 1000
            identifier: us.mappings.benefitHub.inHome.tryInHomePlusUpsForFree

  - name: us.functions.wplus.inHome.returnFromHomeTileValidation
    platform: android
    flow:
      - sleep:
          duration: 3000
      - scroll:
          direction: up
          untilIdentifier: us.mappings.benefits.title
          position: center
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.benefitHub.inHome.returnFromHomeTile
            - name: direction
              string: down 
            - name: scrollPosition
              string: center 
      - verifyIdentifier:
          present:
            - identifier: us.mappings.benefitHub.inHome.returnFromHomeTile
      - click: 
          identifier: us.mappings.benefitHub.inHome.returnFromHomeTile
      - verifyIdentifier: 
            text:
              - identifier:  us.mappings.benefitHub.inHome.viewMyOrderButton
                contains: View my orders
              - identifier:  us.mappings.benefitHub.inHome.howItWorksButton
                contains: How it works
      - sleep:
          duration: 3000
      - click: 
          identifier: us.mappings.benefitHub.inHome.viewMyOrderButton
      - verifyIdentifier:
          timeout: 5000            
          present:
            - identifier: us.mappings.purchaseHistory.headerLabel
      - click: 
          identifier: us.mappings.navigation.backNavigationFrompurchasehistory
      - sleep:
          duration: 5000
      - if:
          identifier:
            present: 
              - identifier: us.mappings.benefitHub.inHome.returnHomeHowItWorksButton
          then:
            - click:
                wait: 1000
                identifier: us.mappings.benefitHub.inHome.returnHomeHowItWorksButton
          else:
            - sleep:
                duration: 2000
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.benefitHub.inHome.howItWorksButton
                  - name: direction
                    string: down
                  - name: scrollPosition
                    string: center
            - click: 
                identifier: us.mappings.benefitHub.inHome.returnHomeHowItWorksButton
            - verifyIdentifier:
                timeout: 5000            
                present:
                  - identifier: us.mappings.validateBDPSubtitle
            - click: 
                identifier: us.mappings.global.navigateBackArrow 


    # flow:
    #   - sleep:
    #       duration: 3000
    #   - if:
    #       identifier:
    #          present: 
    #            - identifier: us.mappings.wplus.benefitsTabSelected
    #       then:
    #         - click:
    #             wait: 1000
    #             identifier: us.mappings.wplus.benefitsTabSelected
    #         - executeFunction:
    #             name: us.functions.utils.scrollIfNotVisible
    #             params:
    #               - name: identifier
    #                 string: us.mappings.benefitHub.inHome.returnFromHomeTile
    #               - name: direction
    #                 string: down
    #               - name: scrollPosition
    #                 string: center                
    #         - verifyIdentifier:
    #             present:
    #               - identifier: us.mappings.benefitHub.inHome.returnFromHomeTile                    
    #         - verifyIdentifier: 
    #               text:
    #                 - identifier:  us.mappings.benefitHub.inHome.viewMyOrderButton
    #                   contains: View my orders
    #                 - identifier:  us.mappings.benefitHub.inHome.howItWorksButton
    #                   contains: How it works
    #         - sleep:
    #             duration: 3000                      
    #         - click: 
    #             identifier: us.mappings.benefitHub.inHome.viewMyOrderButton                                            
            # - verifyIdentifier:
            #     timeout: 5000            
            #     present:
            #       - identifier: us.mappings.purchaseHistory.headerLabel
            # - click: 
            #     identifier: us.mappings.navigation.backNavigationFrompurchasehistory  
            # - sleep:
            #     duration: 5000                     
            # - if:
            #     identifier:
            #       present: 
            #         - identifier: us.mappings.benefitHub.inHome.returnHomeHowItWorksButton
            #     then:
            #       - click:
            #           wait: 1000
            #           identifier: us.mappings.benefitHub.inHome.returnHomeHowItWorksButton
            #     else:
            #       - sleep:
            #           duration: 2000                
            #       - click:
            #           identifier: us.mappings.wplus.benefitsTab               
            #       - executeFunction:
            #           name: us.functions.utils.scrollIfNotVisible
            #           params:
            #             - name: identifier
            #               string: us.mappings.benefitHub.inHome.howItWorksButton
            #             - name: direction
            #               string: down
            #             - name: scrollPosition
            #               string: center                                                            
            #       - click: 
            #           identifier: us.mappings.benefitHub.inHome.returnHomeHowItWorksButton                                          
            #       - verifyIdentifier:
            #           timeout: 5000            
            #           present:
            #             - identifier: us.mappings.validateBDPSubtitle     
            #       - click: 
            #           identifier: us.mappings.global.navigateBackArrow                                

  - name: us.functions.wplus.inHome.returnFromHomeTileValidation
    platform: ios
    flow:
      - sleep:
          duration: 3000
          
    # # - if:
    #      identifier:
    #           present: 
    #            - identifier: us.mappings.wplus.benefitsTabSelected
    #        then:
    #          - click:
    #              wait: 1000
    #              identifier: us.mappings.wplus.benefitsTabSelected
      - scroll:
          direction: up
          untilIdentifier: us.mappings.benefits.title
          position: center

      - verifyIdentifier:
          timeout: 2000
          present:
            - identifier: us.mappings.benefits.title

      - executeFunction:
            name: us.functions.utils.scrollIfNotVisible
            params:
              - name: identifier
                string: us.mappings.benefitHub.inHome.returnFromHomeTile
              - name: direction
                string: down
              - name: scrollPosition
                string: center                
      - verifyIdentifier:
          present:
            - identifier: us.mappings.benefitHub.inHome.returnFromHomeTile  
      - click:
          identifier: us.mappings.benefitHub.inHome.returnFromHomeTile                    
      - verifyIdentifier: 
            label:
               - identifier:  us.mappings.benefitHub.inHome.viewMyOrderButton
                 contains: View my orders
               - identifier:  us.mappings.benefitHub.inHome.howItWorksButton
                 contains: How it works
      - sleep:
          duration: 3000                      
      - click: 
          identifier: us.mappings.benefitHub.inHome.viewMyOrderButton                                            
      - verifyIdentifier:
            timeout: 5000            
            present:
                - identifier: us.mappings.orderHistory.title
      - click: 
          identifier: us.mappings.global.navigateBackArrow  
      - click:
          identifier: us.mappings.benefitHub.inHome.returnFromHomeTile                
      - click: 
          identifier: us.mappings.benefitHub.inHome.howItWorksButton                                          
      - verifyIdentifier:
            timeout: 5000            
            present:
                - identifier: us.mappings.validateBDPSubtitle     
      - click: 
          identifier: us.mappings.global.navigateBackArrow

  # Confirm address for in-home

  - name: us.functions.wplus.inHome.confirmAddress
    platform: android
    flow:
      - sleep:
          duration: 2000
      - if:
          identifier:
               present:
                 - identifier: us.mappings.benefitHub.inHome.confirmButton
          then:
            - click:
               wait: 1000
               identifier: us.mappings.benefitHub.inHome.confirmButton
               wait: 1000

  # Validate start in home free trial page

  - name: us.functions.wplus.inHome.validateStartInHomeFreeTrialPage
    platform: android
    flow:
      - sleep:
          duration: 1000
      - if:
          identifier:
            present:
              - identifier: us.mappings.benefitHub.inHome.startInHomeFreeTrialButton
          then:
            - log: "Start In Home free trial button present as expected"
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.benefitHub.inHome.paymentDetailsAndTerms.30DayFreeTrialLabel
                  - identifier: us.mappings.benefitHub.inHome.paymentDetailsAndTerms.paymentStartDateLabel
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Start In Home trial page not displayed as expected"

  # Start in home free trial

  - name: us.functions.wplus.inHome.startInHomeFreeTrial
    platform: android
    flow:
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.benefitHub.inHome.startInHomeFreeTrialButton
          then:
            - log: "Start In Home free trial button present as expected"
            - scroll:
                direction: down
                untilIdentifier: us.mappings.inHome.bookSlot.activateInHomeIagree
            - click:
                identifier: us.mappings.inHome.bookSlot.activateInHomeIagree
            - click:
                wait: 3000
                identifier: us.mappings.benefitHub.inHome.startInHomeFreeTrialButton
                wait: 3000
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Start In Home pfree trial button should be present but is not"
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.benefitHub.inHome.startInHomeFreeTrialButton
      # - click:
      #     wait: 3000
      #     identifier: us.mappings.benefitHub.inHome.startInHomeFreeTrialButton
      #     wait: 3000

 # Click on Plus Ups Manage link 
  - name:  us.functions.wplus.inHome.manageMebership.managePlusUps
    platform: android
    flow:
      - click: 
          identifier: us.mappings.wplus.managemembership.manageplusups.cta

  # Validate Manage PlusUps Inhome signup details 
  - name: us.functions.wplus.inHome.reactivateInHomeAfterFreeTrialCancellation
    platform: ios
    flow:
      - sleep:
          duration: 1000
      - if:
          identifier:
              present:
              - identifier: us.mappings.inHome.unSelectCheckbox
          then:
              # inhome checkbox is checked
              - click:
                  identifier: us.mappings.inHome.unSelectCheckbox
              - executeFunction:
                  name: us.functions.utils.handleTechnicalErrorPopup
      - click:
          identifier: us.mappings.inHome.monthlyReviewchangesBtn
      - scroll:
          direction: down
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.agreeCheckbox
          then:
            - click:
                identifier: us.mappings.inHome.agreeCheckbox
      - sleep:
          duration: 2000
      - click:
          identifier: us.mappings.inHome.revieMembership.reactivateInhome
      - sleep:
          duration: 2000
      - click: 
          identifier: us.mappings.inHome.monthlyReviewchangeDoneButton
      - sleep:
          duration: 1000

  # Validate Manage PlusUps Inhome signup details 
  - name: us.functions.wplus.inHome.reactivateInHomeAfterFreeTrialCancellation
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.unSelectCheckbox
          then:
            - log : "Selecting In home checkbox"
            - click: 
                identifier: us.mappings.inHome.unSelectCheckbox
            - executeFunction:
                name: us.functions.utils.handleTechnicalErrorPopup
            - if:
                identifier:
                    present:
                    - identifier: us.mappings.inHome.managePlusUps.addAddressButton
                then:
                    - log: Add address process
                    - executeFunction:
                        name: us.functions.wplus.inHome.modifyAddressOnManagePlusUps
                        params:
                          - name: address
                            string: 3839 Yates St
                          - name: cityState
                            string: Denver, CO
                          - name: method
                            string: add
                    - break: true
            - if:
                identifier:
                    present:
                    - identifier: us.mappings.inHome.managePlusUps.changeAddressButton
                then:
                    - log: add address is not needed
                    - break: true
            - click:
                identifier: us.mappings.inHome.managePlusUps.ReviewchangesBtn
            - scroll:
                direction: down
                untilIdentifier: us.mappings.inHome.bookSlot.activateInHomeIagree
            - click:
                identifier: us.mappings.inHome.bookSlot.activateInHomeIagree
            - click:
                identifier: us.mappings.inHome.revieMembership.reactivateInhome
            - click: 
                identifier: us.mappings.inHome.revieMembership.doneButton


  # Validate Manage PlusUps Inhome signup details 
  - name: us.functions.wplus.inHome.verifyManagePlusUpsDetails
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inHome.unSelectCheckbox
            - identifier: us.mappings.inHome.managePlusUpsScreen.addOnTitle
            - identifier: us.mappings.inHome.managePlusUpsScreen.30DayFreeTrialLabel
      - if:
          condition: ${tenure} == 'monthly'
          then:
            - log: Verifying Monthly trial Tenure Details
            - verifyIdentifier: 
                  text:
                    - identifier: us.mappings.inHome.managePlusUpsScreen.addOnPrice
                      contains: $7/month
          else:
            - log: Verifying Annual trial tenure Details
            - verifyIdentifier: 
                  text:
                    - identifier:  us.mappings.inHome.managePlusUpsScreen.addOnPrice
                      contains: $40/year     
      - click:
          identifier:  us.mappings.inHome.managePlusUps.selectInhomeCheckbox
      - click:
          identifier: us.mappings.inHome.managePlusUps.ReviewchangesBtn

   # Validate Manage PlusUps Inhome monthly details        
  - name: us.functions.wplus.inhome.managePlusUpPlanDetails
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.monthlyFreetrialMsg
          then:
            - log : "Manage Plus Ups plan details displayed as expected"
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.inHome.monthlyPrice
                  - identifier: us.mappings.inHome.monthlyFreetrial
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Manage Plus Ups plan details not displayed as expected"
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.inHome.monthlyFreetrial
      # - verifyIdentifier:
      #     present:
      #       - identifier:  us.mappings.inHome.monthlyFreetrialMsg
              
  
 # Validate Inhome Review membership details    
  - name: us.functions.wplus.inHome.manageMemberShip.verifyReviewmembershipDetails
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inHome.walmartMember.membershipTile
            - identifier:  us.mappings.inHome.reviewMembership.membershipTile
            - identifier: us.mappings.inHome.reviewMembership.tenture
      - verifyIdentifier: 
          text:         
            - identifier: us.mappings.inHome.walmartMember.reviewMembership.price
              contains: ${walmartMembshipPrice}
            - identifier: us.mappings.inHome.reviewMembership.price
              contains: ${inhomeMembshipPrice}
            - identifier: us.mappings.inHome.reviewMembership.totalDueAmount
              contains: ${amount}
      - scroll:
          direction: down
          untilIdentifier: us.mappings.inHome.bookSlot.activateInHomeIagree
      - click:
          identifier: us.mappings.inHome.bookSlot.activateInHomeIagree
      - click:
          identifier: us.mappings.inHome.revieMembership.startInhometrial
      - click:
          identifier:  us.mappings.inHome.revieMembership.doneButton

  # Click the okay CTA on the error bottom sheet
  - name: us.functions.wplus.inHome.cancel.bottomSheet.error.cta
    platform: android
    flow:
     - if:
          identifier:
            present:
              - identifier: us.mappings.cancellation.errorMessageCTA
          then:
            - click:
                identifier: us.mappings.cancellation.errorMessageCTA
            - executeFunction:
                name: us.functions.wplus.inHome.confirmAddress
          else:
            - log: Error Bottom Sheet screen is NOT displayed

  # Validate Inhome Manage membership details  
  - name: us.functions.wplus.inHome.validateMyPlusUpsDetailsOnManageMembershipPage
    platform: android

    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.manageMembership.inHome.plusUps.title
            - identifier: us.mappings.manageMembership.inHome.plusUps.inHomeLabel
            - identifier: us.mappings.manageMembership.inHome.plusUps.30DayFreeTrialLabel
      - if:
          condition: ${tenure} == 'monthly'
          then:
            - log: Verifying Monthly trial Tenure Details
            - verifyIdentifier: 
                  text:
                    - identifier: us.mappings.manageMembership.inHome.plusUps.addOnPrice
                      contains: Cancel InHome
                          
           
            - if:
                condition: ${membership} == 'paid'
                then:
                   - try:
                         flow:
                           - verifyIdentifier:
                              text:
                               - identifier: us.mappings.wplus.manageMembership.inHome.plusUps.payment.description
                                 contains: $7
                               
                         catch:
                             flow:
                                - verifyIdentifier:
                                   text:
                                     - identifier: us.mappings.wplus.manageMembership.inHome.plusUps.payment.description
                                       contains: $0.23
                                    
                else:
                   - verifyIdentifier:
                       text:
                         - identifier: us.mappings.wplus.manageMembership.inHome.plusUps.payment.description
                           contains: $7
      - if:
          condition: ${tenure} == 'annual'
          then:
            - log: Verifying Annual trial tenure Details
            - verifyIdentifier: 
                  text:
                    - identifier: us.mappings.manageMembership.inHome.plusUps.addOnPrice
                      contains: Cancel InHome
            - if:
                condition: ${membership} == 'paid'
                then:
                  - try:
                      flow:
                        - verifyIdentifier: 
                            text:
                               - identifier: us.mappings.wplus.manageMembership.inHome.plusUps.payment.description
                                 contains: $36.82 plus
                               - log : "First payment prorated amount $36.82 is displayed"
                      catch:
                          flow:
                            - verifyIdentifier: 
                                 text:
                                   - identifier: us.mappings.wplus.manageMembership.inHome.plusUps.payment.description
                                     contains: $40 plus
                                   - log : "First payment prorated amount $40 is displayed"
                else:
                  - verifyIdentifier: 
                        text:
                        - identifier: us.mappings.wplus.manageMembership.inHome.plusUps.payment.description
                          contains: $36.71

      - executeFunction:
          name: us.functions.wplus.inHome.managePlusUps

   # Validate Inhome details on manage plusUps screen         
  - name: us.functions.wplus.inhome.managePlusUpsScreen.verifyPlusUpDetails
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier:  us.mappings.inHome.selectInhomeCheckbox
            - identifier: us.mappings.inHome.managePlusUpsScreen.addOnTitle
            - identifier: us.mappings.inHome.managePlusUpsScreen.30DayFreeTrialLabel
      - if:
          condition: ${tenure} == 'monthly'
          then:
            - log: Verifying Monthly trial Tenure Details
            - verifyIdentifier: 
                  text:
                    - identifier: us.mappings.inHome.managePlusUpsScreen.addOnPrice
                      contains: $7/month
            
            - verifyIdentifier: 
                  text:
                    - identifier: us.mappings.inHome.managePlusUpsScreen.30DayFreeTrialLabel
                      contains: 30-day free trial

          else:
            - log: Verifying Annual trial tenure Details
            - verifyIdentifier: 
                  text:
                    - identifier:  us.mappings.inHome.managePlusUpsScreen.addOnPrice
                      contains: $40/year

            - verifyIdentifier: 
                  text:
                    - identifier: us.mappings.inHome.managePlusUpsScreen.30DayFreeTrialLabel
                      contains: 30-day free trial


   # Validate Inhome details on manage plusUps screen         
  - name: us.functions.wplus.inhome.managePlusUpsScreen.verifyPlusUpDetails
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inHome.managePlusUpscheckbox
            - identifier: us.mappings.inHome.managePlusUps.30DayFreeTrialLabel
      - if:
          condition: ${tenure} == 'monthly'
          then:
            - log: Verifying Monthly trial Tenure Details
            - verifyIdentifier: 
                  label:
                    - identifier: us.mappings.inHome.managePlusUpsAddOnPrice
                      contains: $7 per month

            - verifyIdentifier: 
                  label:
                    - identifier: us.mappings.inHome.monthlyFreetrial
                      contains: 30-day free trial

          else:
            - log: Verifying Annual trial tenure Details
            - verifyIdentifier: 
                  label:
                    - identifier:  us.mappings.inHome.managePlusUpsAddOnPrice
                      contains: $40 per year  

            - verifyIdentifier: 
                  label:
                    - identifier: us.mappings.inHome.monthlyFreetrial
                      contains: 30-day free trial
      - click:
          identifier: us.mappings.inHome.managePlusUpsbackButton

# Validate Inhome membership details after the enrollment
  - name: us.functions.wplus.inHome.validateMyPlusUpsTrialMonthlyPlanDetails
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.managePlusUpschecked
          then:
            - log: "Monthly plus ups plan details displayed as expected"
            # - verifyIdentifier:
            #     present:
            #       - identifier: us.mappings.inHome.managePlusUpschecked
            - executeFunction:
                name: us.functions.wplus.inhome.verifyPlanDetails
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - My Pus Ups plan details not displayed as expected"
    
# Verify InHome card details in Benefits screen after the enrollment
  - name: us.functions.wplus.inHome.validatePlusUpsbenefitsDetails
    platform: android
    flow:
      # - verifyIdentifier:
      #     present: 
      #       - identifier: us.mappings.wplus.benefitsTab
      # - click: 
      #     wait: 3000
      #     identifier: us.mappings.wplus.benefitsTab
      - scroll:
          direction: down
          untilIdentifier: us.mappings.inHome.benefitscardInHomeDelivery
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.benefitscardInHomeDelivery
          then:
            - log: "Plus Ups benefits details displayed as expected"
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.inHome.benefitInHomeSettings
          else:
            - if:
                identifier:
                  notPresent:
                    - identifier: us.mappings.benefits.limitedTimeOffers.header
                then:
                  - failTest:
                      message: "ENV_FAILURE - ${env} - Plus Ups benefits details not displayed as expected"

      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.inHome.benefitscardInHomeDelivery
      #       - identifier: us.mappings.inHome.benefitInHomeSettings

  - name: us.functions.wplus.inHome.savings.validateCashbackModule
    platform: android
    flow:
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.inHome.benefitInHomeSettings.savings
      - click: 
          wait: 3000
          identifier: us.mappings.inHome.benefitInHomeSettings.savings
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.inHome.benefitInHomeSettings.cashbackModule
          then:    
              - log: relaunching the app 
              - terminateApp: true
              - openLink: walmart://home
              - sleep:
                  duration: 10000
              - executeFunction:
                  name: us.functions.global.navigation.goToDeepLink
                  params:
                    - name: deepLinkUrl
                      string: us.data.android.wplus.deeplinkurl     
              - sleep:
                  duration: 3000
              - click: 
                  wait: 3000
                  identifier: us.mappings.inHome.benefitInHomeSettings.savings            
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.benefitInHomeSettings.cashbackModule
          then:
            - verifyIdentifier:
                text:
                  - identifier: us.mappings.inHome.benefitInHomeSettings.cashbackModule
                    contains:  2% rewards
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.wplus.benefits.cashbackTile.howRewardsWorkCTA
            - click: 
                wait: 3000
                identifier: us.mappings.wplus.benefits.cashbackTile.howRewardsWorkCTA
            - sleep:
                duration: 3000
            - goBack: true
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Cashback text is not availalbe"
            # - log: "cashback text is not availalbe"

  - name: us.functions.wplus.inHome.benefits.validateCashbackModule
    platform: android
    flow:
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.inHome.benefitInHomeSettings.benefits
      - click: 
          wait: 3000
          identifier: us.mappings.inHome.benefitInHomeSettings.benefits
      - try:
          flow:
            - scroll:
                direction: down
                untilIdentifier: us.mappings.inHome.benefitInHomeSettings.benefitsHeading
                scrollLimit: 3
            - verifyIdentifier:
                text:
                  - identifier: us.mappings.inHome.benefitInHomeSettings.benefitsHeading
                    contains: 2% Walmart Rewards
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.wplus.benefits.cashbackTile.howRewardsWorkCTA
                  - name: direction
                    string: down
                  - name: scrollPosition
                    string: center 
            - click: 
                wait: 3000
                identifier: us.mappings.wplus.benefits.cashbackTile.howRewardsWorkCTA
            - sleep:
                duration: 3000
            - goBack: true
          catch:
            flow:
              - if:
                  identifier:
                    notPresent:
                      - identifier: us.mappings.inHome.benefitInHomeSettings.benefitsHeading
                  then:
                    - failTest:
                        message: "ENV_FAILURE - ${env} - Cashback text is not availalbe"
            # - log: "cashback text is not availalbe"          

  - name: us.functions.wplus.inHome.savings.validateCashbackModule
    platform: ios
    flow:
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.inHome.benefitInHomeSettings.savings
      - click: 
          wait: 3000
          identifier: us.mappings.inHome.benefitInHomeSettings.savings
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.benefitInHomeSettings.cashbackModule
          then:
            - verifyIdentifier:
                label:
                  - identifier: us.mappings.inHome.benefitInHomeSettings.cashbackModule
                    contains: 2% rewards
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.wplus.benefits.cashbackTile.howRewardsWorkCTA
            - click: 
                wait: 3000
                identifier: us.mappings.wplus.benefits.cashbackTile.howRewardsWorkCTA
            - sleep:
                duration: 5000
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.wplus.benefits.walmartRewards
                then:
                    - goBack: true
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Cashback text is not availalbe"
            # - log: "cashback text is not availalbe"

  - name: us.functions.wplus.inHome.benefits.validateCashbackModule
    platform: ios
    flow:
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.wplus.benefitsTabSelected
      - click: 
          wait: 3000
          identifier: us.mappings.wplus.benefitsTabSelected
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.benefitInHomeSettings.benefitsHeading
          then:
            - verifyIdentifier:
                label:
                  - identifier: us.mappings.inHome.benefitInHomeSettings.benefitsHeading
                    contains: 2% Walmart Rewards
            - click: 
                wait: 3000
                identifier: us.mappings.wplus.benefits.cashbackTile.howRewardsWorkCTA
            - sleep:
                duration: 3000
            - goBack: true
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Cashback text is not availalbe"
            # - log: "cashback text is not availalbe" 

#Plus ups Cancel membership validations
# navigate membership hub
  - name: us.functions.wplus.inhome.validateCancelMembership
    platform: android
    flow:
      - executeFunction:
          name: us.functions.wplus.account.navigateToWalmartPlus

      - executeFunction:
          name: us.functions.wplus.navigateToManageMembershipFromBenefitsPage
          
      # select manage plus up, unselect the in-home check box & click review changes
      - executeFunction:
          name: us.functions.wplus.inHome.managePlusUps
      
      - executeFunction:
          name: us.functions.wplus.inHome.validateCancelMemberManagePlusUps

      # cancel in-home annual plan
      - executeFunction:
          name: us.functions.wplus.inHome.cancelmember.verifyReviewmembershipDetails

      # - executeFunction:
      #     name: us.functions.wplus.inHome.cancelmember.selectCancelReason

      - executeFunction:
          name: us.functions.wplus.inHome.validatecancelmemberPlusUpsOnManageMembershipPage

  # This method Just monthly plan and we need to add the annual plan steps 
  - name: us.functions.wplwplus.inHome.via.manage.MembershipPlan
    platform: ios
    flow:
      - if:
          condition: ${membership} == 'Monthly plan'
          then:
          - executeFunction:
              name: us.functions.wplus.inHome.explorePlusUps
          - executeFunction:
              name: us.functions.wplus.inHome.monthly.verifyPlusUpsDetails
          - executeFunction:
              name: us.functions.wplus.inHome.verifyReviewmembershipDetails
          - executeFunction:
              name: us.functions.wplus.inHome.validateMyPlusUpsOnManageMembershipPageTrialPlan
          # - executeFunction:
          #     name: us.functions.wplus.inHome.validateMyPlusUpsTrialMonthlyPlanDetails
          else:
              - executeFunction:
                  name: us.functions.wplus.inHome.explorePlusUps
              - executeFunction:
                  name: us.functions.wplus.inHome.annual.verifyPlusUpsDetails
              - executeFunction:
                  name: us.functions.wplus.inHome.verifyReviewmembershipDetails
                  params:
                    - name: tenure
                      string: annual
              - executeFunction:
                  name: us.functions.wplus.inHome.validateMyPlusUpsOnManageMembershipPageTrialPlan
              # - executeFunction:
              #     name: us.functions.wplus.inHome.validateMyPlusUpsTrialAnnualPlanDetails 

 # Validate Inhome membership details after the enrollment
  - name: us.functions.wplus.inHome.validateMyPlusUpsTrialAnnualPlanDetails
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.managePlusUpscheckbox
          then:
            - log: "My Plus Ups Annual plan details displayed properly"
            - executeFunction:
                name: us.functions.wplus.inhome.verifyPlanDetails
                params:
                  - name: amount
                    string: $40 per annual
          else:
            - failTest:
                message: "My Plus Ups Annual plan details not displayed properly"
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.inHome.managePlusUpscheckbox

      # - executeFunction:
      #     name: us.functions.wplus.inhome.verifyPlanDetails
      #     params:
      #      - name: amount
      #        string: $40 per annual

 # Validate Inhome Manage membership details  
  - name: us.functions.wplus.inHome.validateMyPlusUpsOnManageMembershipPageTrialPlan
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.manageMembership.myPlusUps.title
            - identifier: us.mappings.manageMembership.inHome.inHomeLabel
            - identifier: us.mappings.manageMembership.inHome.30DayFreeTrialLabel
      - if:
          condition: ${tenure} == 'annual'
          then:
            - log: Verifying Annual trial tenure Details
            - verifyIdentifier:
                present: 
                  - identifier: us.mappings.inHome.annualReviewChangesPayment
          else:
            - log: Verifying Monthly trial tenure Details
            - verifyIdentifier:
                present: 
                  - identifier: us.mappings.inHome.monthlyReviewChangesPayment

                 
  - name: us.functions.wplus.inHome.trial.signUp.via.hub
    platform: ios
    flow:
          - executeFunction:
              name: us.functions.wplus.inHome.benefitshubsignup
          - executeFunction:
              name: us.functions.wplus.inHome.confirmAddress
          - executeFunction:
              name: us.functions.wplus.inHome.validateStartInHomeFreeTrialPage
          - executeFunction:
              name: us.functions.wplus.inHome.startInHomeFreeTrial
          - executeFunction:
              name: us.functions.wplus.inHome.exploreW+BenefitsAfterInHomeFreeTrial
          - executeFunction:
              name: us.functions.wplus.navigateToManageMembershipFromBenefitsPage 

  - name: us.functions.wplus.inHome.via.manage.cancelMembershipPlan
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.wplus.inHome.managePlusUps
      
      # Cancel in-home membership plan
      - executeFunction:
          name: us.functions.wplus.inHome.validateCancelMemberManagePlusUps

  # Add/Change address on Manage Plus Ups Screen(reusable)
  # {deliveryAddress}: [mandatory] delivery address. ex: 3839 Yates St, Denver, CO
  # {method}: [mandatory] add or change
  - name: us.functions.wplus.inHome.modifyAddressOnManagePlusUps
    platform: ios
    flow:
      - if:
          condition: ${method} == 'add'
          then:
            - click:
                identifier: us.mappings.inHome.managePlusUps.addAddressButton
          else:
            - if:
                condition: ${method} == 'change'
                then:
                  - click:
                      identifier: us.mappings.inHome.managePlusUps.changeAddressButton
                  - click:
                      wait: 2000
                      identifier: us.mappings.deliveryAddress.add.title
                else:
                  - log: method is invalid
      - enterText:
          identifier: us.mappings.inHome.deliveryAddress.deliveryAddressTextField
          string: ${deliveryAddress}
          pressEnter: true
      - click:
          wait: 5000
          identifier: us.mappings.inHome.deliveryAddress.addressSelectButton

# Upgrade to Annual and verify W+ and InHome bundle payment
  - name: us.functions.wplus.inHome.via.manage.clickChangeMembershipPlan
    platform: android
    flow:
      - click: 
          identifier: us.mappings.wplus.inHome.membership.upgradeToAnnualButton
      - if:
          identifier:
            present:
              - identifier: us.mappings.wplus.inHome.membership.annualTenurePlan
          then:
            - click: 
                identifier: us.mappings.wplus.inHome.membership.annualTenurePlan
      - verifyIdentifier:
          text:
            - identifier: us.mappings.wplus.inHome.membership.annualTenurePlanText
              contains: Annual
      - log: Verifing Walmart Plus and Inhome annual bundle amount
      - verifyIdentifier:
          text:
            - identifier: us.mappings.wplus.inHome.membership.annualTenurePlanPriceText
              contains: $138/yr
      - scroll:
          direction: down
          untilIdentifier: us.mappings.wplus.inHome.membership.agreeCheckBox
      - click:
          identifier: us.mappings.wplus.inHome.membership.agreeCheckBox
      - click: 
          identifier: us.mappings.wplus.inHome.membership.changePlanButton
      - click:
          identifier: us.mappings.wplus.inHome.membership.closeAlert

# Verifing the start date of W+ and InHome membership after Upgrade
  - name : us.functions.wplus.inHome.bundle.verifyPaymentStartDate
    platform: android
    flow:
      - log: Verifing the start date of W+ and InHome membership
      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.inHome.membership.paymentStartDateDisclaimer
      - getString:
          identifier: us.mappings.wplus.inHome.membership.paymentStartDateDisclaimer
          storeIn: paymentDate
      - log : $paymentDate
      - log : Typing Payment Date
      - executeNode:
          file: us/e2e-tests/helpers/splitPayment.js
          args:
            - value: ${paymentDate}
          getResponse:
            storeIn: returnedpaymentDate
      - log: "Payment Date: ${returnedpaymentDate}"
      - verifyIdentifier:
          text:
            - identifier: us.mappings.wplus.title
              contains: My Walmart+
            - identifier: us.mappings.wplus.inHome.walmartPlus.payment.description
              contains:  ${returnedpaymentDate} ($98 plus applicable taxes)
      - log: verifing plusups payments
      - verifyIdentifier:
          text:
            - identifier: us.mappings.wplus.inHome.plusup.title
              contains: My Plus Ups
            - identifier: us.mappings.wplus.inHome.plusUps.payment.description
              contains: ${returnedpaymentDate} $40 plus applicable taxes


  - name: us.functions.inHome.bookSlot.chooseDeliveryFromStore
    platform: android
    flow:
        - log: Navigte to BookSlot and switch to Delivery from store tab
        - if:
            identifier:
              present:
                - identifier : us.mappings.inHome.bookSlot.clickCenterCloseButton
            then:
              - click: 
                  identifier: us.mappings.inHome.bookSlot.clickCenterCloseButton
       # - click:
       #     identifier: us.mappings.inHome.bookSlot.clickBookslotCta
        - verifyIdentifier:
            text:
              - identifier: us.mappings.inHome.bookSlot.switchToDeliveryFromStoreTab
                contains: Delivery from store
        - click:
            identifier: us.mappings.inHome.bookSlot.switchToDeliveryFromStoreTab

  - name: us.functions.inHome.bookSlot.addInhomeEligibleAddress
    platform: android
    flow:
        - log: Verifying InHome Address and change to InHome eligible address
        - click:
            wait: 1000
            identifier: us.mappings.inHome.bookSlot.addAddress
        - click:
            wait: 1000
            identifier: us.mappings.inHome.bookSlot.clickAddressSaveButton

  - name: us.funtions.inHome.bookSlot.signUpTrialInHome
    platform: android
    flow:
        - log: Verify Tip free delivery label 
        - verifyIdentifier:
            text:
              - identifier: us.mappings.inHome.bookSlot.verifyDeliveriryLabel
                contains: Want tip-free delivery for a whole month?
        - verifyIdentifier:
            text:
              - identifier: us.mappings.inHome.bookSlot.verifyInHomeTrialSignUpLink
                contains: Start InHome 30-day free trial
        - log: Sign up to trial InHome membership
        - click:
              wait: 1000
              identifier: us.mappings.inHome.bookSlot.verifyInHomeTrialSignUpLink
        - click:
              wait: 1000
              identifier: us.mappings.inHome.bookSlot.activateInHomeIagree
        - click:
            wait: 1000
            identifier: us.mappings.inHome.bookSlot.clickInHomeTrialSignUpButton

  - name: us.funtions.inHome.bookSlot.verifyInhomeSignUpBottomSheet
    platform: android
    flow:
        - log: Verify InHome Signup success message
        - if: 
           identifier:
             present:
               - identifier: us.mappings.inHome.bookSlot.verifyInHomeOrderBottomSheetMsg
           then: 
             - verifyIdentifier:
                 present:
                   - identifier: us.mappings.inHome.bookSlot.verifyInHomeOrderBottomSheetMsg
           else:
              - verifyIdentifier:
                  text:
                   - identifier: us.mappings.inHome.bookSlot.verifyInHomeSignupSuccessMsg
                     contains: Welcome! We’re ready to tackle your to-dos
        
              - verifyIdentifier:
                    text:
                      - identifier: us.mappings.inHome.bookSlot.verifyInHomeBottomSheetLabel
                        contains: Enjoy your free 30-day membership of InHome
        - click:
            identifier: us.mappings.wplus.inHome.membership.closeAlert
        
        - verifyIdentifier:
            text:
            - identifier: us.mappings.inHome.bookSlot.verifyTipFreeDeliveryLabelAfterSignUp
              contains: InHome delivery
        - click: 
            identifier: us.mappings.inHome.bookSlot.clickInfoIcon
        - verifyIdentifier:
            text:
            - identifier: us.mappings.inHome.bookSlot.verifyInHomeTitle
              contains: InHome delivery
        - click:
            identifier: us.mappings.inHome.bookSlot.clickCloseIcon
        - click:
            identifier: us.mappings.inHome.bookSlot.clickCloseIcon

  #  Verify BDP screen and navigate to Reward center
  - name: us.functions.wplus.cashBack.validateBenefitsDetailPage
    platform: android
    flow:
        - log: Verify BDP screen and navigate to Reward center
        - verifyIdentifier:
            text:
            - identifier: us.mappings.wplus.cashback.rewardCenter.bdpTitle
              contains: 2% Walmart Rewards
        - if:
            identifier:
              present:
                - identifier: us.mappings.wplus.cashback.rewardCenter.viewRewardsCenterButton
            then:
              - log: "View rewards center button present as expected"
              - click:
                  identifier:  us.mappings.wplus.cashback.rewardCenter.viewRewardsCenterButton
            else:
              - failTest:
                  message: "ENV_FAILURE - ${env} - View Rewards Center button should be present but is not"
        # - verifyIdentifier:
        #     present:
        #     - identifier:  us.mappings.wplus.cashback.rewardCenter.viewRewardsCenterButton
        # - click:
        #     identifier:  us.mappings.wplus.cashback.rewardCenter.viewRewardsCenterButton

  # Validate rewards center screen
  - name: us.functions.wplus.cashBack.validateRewardsCenterScreen
    platform: android
    flow:
        - log: Validate Rewards Center Screen
        - verifyIdentifier:
            present:
              - identifier: us.mappings.wplus.cashback.rewardCenter.verifyRewardsCenterTitle
        - click:
            identifier: us.mappings.wplus.cashback.rewardCenter.clickRewardsHelp
        - verifyIdentifier:
            text:
            - identifier: us.mappings.wplus.cashback.rewardCenter.verifyRewardsBalanceTitle
              contains: Rewards balance
        - click:
            identifier: us.mappings.wplus.cashback.rewardCenter.closeRewardsFragment
        - verifyIdentifier:
            present:
              - identifier: us.mappings.wplus.cashback.rewardCenter.verifyRewardsMembershipTile
        - executeFunction:
            name: us.functions.utils.scrollIfNotVisible
            params:
              - name: identifier
                string: us.mappings.wplus.cashback.rewardCenter.verifyRewardCenterTool
              - name: direction
                string: down
              - name: scrollPosition
                string: center                      
        - verifyIdentifier:
            text:
            # - identifier: us.mappings.wplus.cashback.rewardCenter.verifySavedRewardsTile
            #   contains: Saved Rewards
            - identifier: us.mappings.wplus.cashback.rewardCenter.verifyRewardCenterTool
              contains: Rewards Center Tools

  #  Verify BDP screen and navigate to Reward center
  - name: us.functions.wplus.cashBack.validateBenefitsDetailPage
    platform: ios
    flow:
        - log: Verify BDP screen and navigate to Reward center
        - verifyIdentifier:
            label:
            - identifier: us.mappings.inHome.benefitInHomeSettings.benefitsHeading
              contains: 2% Walmart Rewards
        - verifyIdentifier:
            present:
            - identifier:  us.mappings.wplus.cashback.rewardCenter.viewRewardsCenterButton
        - click:
            identifier:  us.mappings.wplus.cashback.rewardCenter.viewRewardsCenterButton

  # Validate rewards center screen
  - name: us.functions.wplus.cashBack.validateRewardsCenterScreen
    platform: ios
    flow:
        - log: Validate Rewards Center Screen
        - verifyIdentifier:
            present:
              - identifier: us.mappings.wplus.cashback.rewardCenter.verifyRewardsCenterTitleLabel
        - click:
            identifier: us.mappings.wplus.cashback.rewardCenter.clickRewardsHelp
        - verifyIdentifier:
            label:
            - identifier: us.mappings.wplus.cashback.rewardCenter.verifyRewardsBalanceTitle
              contains: Rewards balance
        - click:
            identifier: us.mappings.inHome.bookSlot.clickCloseIcon
        - verifyIdentifier:
            label:
              - identifier: us.mappings.wplus.cashback.rewardCenter.verifyRewardsMembershipTileLabel
                contains: "You’re earning 2% more with Walmart+!"
        - verifyIdentifier:
            label:
            - identifier: us.mappings.wplus.cashback.rewardCenter.verifySavedRewardsTile
              contains: Saved Rewards
            - identifier: us.mappings.wplus.cashback.rewardCenter.verifyRewardCenterTool
              contains: Rewards Center Tools

  - name: us.functions.cart.inhome.bookSlotPickup
    platform: android
    flow:
      - executeFunction:
              name: us.functions.loadBookingSlotScreen      
              params:
                - name: page
                  string: cart
                - name: tab
                  string: delivery
                - name: addAddress
                  string: true
                - name: addExistingAddress
                  string: true
      # - click:
      #     identifier: us.mappings.reserveSlot.scheduledDelivery.tab
      # - sleep:
      #     duration: 3000
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.account.delivery.addAddressPopUp                    
      # - click:
      #     identifier: us.mappings.account.delivery.addAddressPopUp      
      # - click:
      #     identifier: us.mappings.reserveSlot.addressselectionButton
      # - sleep:
      #     duration: 3000
      # - click:
      #     identifier: us.mappings.item.SubsAddressEdit.continue
      # - sleep:
      #     duration: 5000
      - click:
          identifier: us.mappings.reserveSlot.curbsidePickup.tab            
      - sleep:
          duration: 3000
      - if:    
          identifier:
            present:
              - identifier: us.mappings.wplus.inhomeFreeTrial
          then: 
              - log: In Home present in Pickup
              - click:
                  identifier: us.mappings.wplus.inhomeFreeTrial
          else:
              - click:
                  identifier: us.mappings.global.closeButton
              - sleep:
                  duration: 3000
              - click:
                  identifier: us.mappings.cart.sc.noSlotBooked.reserveTime         
              - verifyIdentifier:
                  present:
                    - identifier: us.mappings.wplus.inhomeFreeTrial  
              - log: In Home present in Pickup             
      - click:
          identifier: us.mappings.wplus.inhomeFreeTrial   
      - sleep:
          duration: 3000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.inhomeBottomSheet
      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.inhomeBaseTenure
      - click:
          identifier: us.mappings.wplus.inhomeFreeTrial   
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inhome.cart.pickup.scheduleInhomeDelivery
      - click:
          identifier: us.mappings.inhome.cart.pickup.scheduleInhomeDelivery
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.inhome.cart.delivery.InhomeDeliverySlot
          then:
            - click:
                identifier: us.mappings.reserveSlot.scheduledDelivery.tab 
      - verifyIdentifier:
          timeout: 5000
          present:
            - identifier: us.mappings.inhome.cart.delivery.InhomeDeliverySlot
      - click:
          identifier: us.mappings.reserveSlot.continueButton     
    
  - name: us.functions.account.inhome.membershipValidation
    platform: android
    flow:
      - executeFunction:
          name: us.functions.global.navigation.goToAccountFromTabBar 
      - executeFunction:
          name: us.functions.wplus.account.navigateToWalmartPlus
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mapppings.wplus.benefitsTab
      # - click:
      #     identifier: us.mapppings.wplus.benefitsTab
      #     wait: 3000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.account.inhome.membershipButton
            - identifier: us.mappings.account.inhome.Settings
      - log: In Home added to Membership

  - name: us.functions.cart.inhome.bookSlotPickup
    platform: ios
    flow:
      - executeFunction:
              name: us.functions.loadBookingSlotScreenBasics      
              params:
                - name: page
                  string: cart
                - name: tab
                  string: delivery
                - name: addAddress
                  string: true
                - name: addExistingAddress
                  string: true 
      - click:
          identifier: us.mappings.reserveSlot.curbsidePickup.tab            
      - sleep:
          duration: 3000       
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inhome.cart.pickup.optInSection
            - identifier: us.mappings.inhome.cart.pickup.optInButton             
      - click:
          identifier: us.mappings.inhome.cart.pickup.optInButton        
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inhome.cart.pickup.inHomeBanner
      - verifyIdentifier:
          label:
            - identifier: us.mappings.inhome.cart.pickup.bannerTenure
              contains: 30 free days of tip-free delivery
      - verifyIdentifier:
          label:
            - identifier: us.mappings.inhome.cart.pickup.freeTrial
              contains: Start InHome 30-day free trial
      - click:
          identifier: us.mappings.inhome.cart.pickup.freeTrial
      - sleep:
          duration: 5000
      - verifyIdentifier:
          label:
            - identifier: us.mappings.inhome.cart.pickup.scheduleInhomeDelivery
              contains: Schedule InHome delivery
      - click:
          identifier: us.mappings.inhome.cart.pickup.scheduleInhomeDelivery
      - sleep:
          duration: 50000
      - if: 
          identifier:
            present:
              - identifier: us.mappings.editSlot.deliveryTab
          then:
            - click:
                identifier: us.mappings.editSlot.deliveryTab
          else:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.navBar.cartIcon
            - click:
                identifier: us.mappings.navBar.cartIcon    
            - sleep:
                duration: 5000
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.cart.sc.noSlotBooked.reserveTime
            - click:
                identifier: us.mappings.cart.sc.noSlotBooked.reserveTime
            - sleep:
                duration: 4000
            - click:
                identifier: us.mappings.editSlot.deliveryTab                  
      - sleep:
          duration: 5000
      - verifyIdentifier:
          label:
            - identifier: us.mappings.inhome.cart.pickup.scheduleInhomeDelivery
              contains: InHome delivery
      - click:
          identifier: us.mappings.reserveSlot.continueButton
      - sleep:
          duration: 5000

  - name: us.functions.account.inhome.membershipValidation
    platform: ios
    flow:
      - click:
          identifier: us.mappings.wplus.backToAccountButton
      - executeFunction:
          name: us.functions.wplus.account.navigateToWalmartPlus
    # Delete this once Hub redesign is enabled 100%      
    #  # - verifyIdentifier: 
    #       present:
    #         - identifier: us.mappings.wplus.benefitsTabSelected
    #   - click:
    #       identifier: us.mappings.wplus.benefitsTabSelected
    #       wait: 3000
      - scroll:
          direction: up
          untilIdentifier: us.mappings.benefits.title
          position: center
      - verifyIdentifier:
          timeout: 2000
          present:
            - identifier: us.mappings.benefits.title
      - scroll:
          direction: down
          untilIdentifier: us.mappings.account.ihome.membershipButton
          position: center
      - verifyIdentifier:
          label:
            - identifier: us.mappings.account.ihome.membershipButton
              contains: Schedule InHome delivery
            - identifier: us.mappings.account.ihome.Settings
              contains: InHome settings
      - log: In Home added to Membership

  #MLP InHome 30day free trail verification
  - name: us.functions.mlp.inhome.bundleSignUp.validation
    platform: android
    flow:
      - log: "Landed on the MLP inHome trail page"
      #- verifyInApplitools: true
      - verifyIdentifier:
          present:
            - identifier: us.mappings.mlp.inhome.trail.button
      - click:
          identifier: us.mappings.mlp.inhome.trail.button
          wait: 1500
      - log: "Clicked the Start InHome trail"
      #- verifyInApplitools: true
      - verifyIdentifier:
          present:
            - identifier: us.mappings.mlp.inhome.delivery.address.banner
            - identifier: us.mappings.mlp.inhome.delivery.address.banner.subtext
            - identifier: us.mappings.mlp.inhome.delivery.address.on.account
            - identifier: us.mappings.mlp.inhome.delivery.address.confirm.button
            - identifier: us.mappings.mlp.inhome.add.newaddress.link
      - log: "Verified all the assertions on the select address page"
      #- verifyInApplitools: true
      - click:
          identifier: us.mappings.mlp.inhome.delivery.address.confirm.button
          wait: 1500
      - log: "Clicked on the confirm address button"
      #- verifyInApplitools: true
      - verifyIdentifier:
          present:
            - identifier: us.mappings.mlp.inhome.chooseplan.banner
            - identifier: us.mappings.mlp.inhome.choose.annualplan
            - identifier: us.mappings.mlp.inhome.choose.monthlyplan
            - identifier: us.mappings.mlp.inhome.membership.signup.button
            - identifier: us.mappings.mlp.inhome.membership.bestvalue.tag
            - identifier: us.mappings.mlp.inhome.membership.page.close.button
      - log: "Verified all the differnet plans availabke for the InHome to choose"
      - click:
          identifier: us.mappings.mlp.inhome.membership.page.close.button
          wait: 1500

 #MLP InHome 30day free trail verification on PROD
  - name: us.functions.mlp.inhome.bundleSignUp.validation
    platform: ios
    flow:
      - log: "Landed on the MLP inHome trail page"
      #- verifyInApplitools: true
      - verifyIdentifier:
          present:
            - identifier: us.mappings.inhome.bundleSignup.freeTrialcta
      - click:
          identifier: us.mappings.inhome.bundleSignup.freeTrialcta
          wait: 1500
      - log: "Clicked the Start InHome trail"
      #- verifyInApplitools: true
      - verifyIdentifier:
          present:
            - identifier: us.mappings.benefitHub.inHome.addressConfirmationPageTitle
      - click:
          identifier: us.mappings.benefitHub.inHome.confirmButton    
          wait: 1500
      - log: "Clicked on the confirm address button"
      #- verifyInApplitools: true
      - if: 
          identifier:
            present:
              - identifier: us.mappings.page.retryAgainButton
          then:
            - click:
                identifier: us.mappings.page.retryAgainButton
                wait: 3000                                        
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.errorPopUp
          then:
            - failTest:
                message: "ENV_FAILURE - ${env} - something went wrong technical issue"
      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.inhome.MLP.chooseplan.bundletitleannualeprice
            - identifier: us.mappings.wplus.inhome.MLP.chooseplan.inhomeannualprice
            - identifier: us.mappings.wplus.inhome.MLP.startFreeTrialCTA
            - identifier: us.mappings.wplus.inhome.MLP.chooseplan.signupforwalmartplusonlylink 
            - identifier: us.mappings.wplus.inhome.MLP.chooseplan.annualprice                                                     
      - verifyIdentifier: 
          value:
            - identifier: us.mappings.wplus.inhome.MLP.chooseplan.annualprice
              contains: $98 per year
      - verifyIdentifier: 
          value:
            - identifier: us.mappings.wplus.inhome.MLP.chooseplan.monthlyprice
              contains: $12.95 per month
      - log: "Verified Monthly and Annual plans bundle singup prices"         

  #MLP InHome 30day free trail Monthly Bundle sign up
  - name: us.functions.mlp.inhome.bundleSignUp.monthly
    platform: ios
    flow:
      - log: "Landed on the MLP inHome trail page"
      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.inhome.MLP.chooseplan.monthlyprice           
      - click:
          identifier: us.mappings.wplus.inhome.MLP.chooseplan.monthlyprice
          wait: 1500
      - log: "Selected Monthly Tenure"
      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.inhome.MLP.chooseplan.bundletitlemonthlyprice
            - identifier: us.mappings.wplus.inhome.MLP.chooseplan.inhomemonthlyprice   
      - if:
          identifier:
            present:
              - identifier: us.mappings.reviewOrder.splash.walmartPlusAgreeTermsCheckBox
          then:
            - scroll:
                direction: down
                untilIdentifier: us.mappings.reviewOrder.splash.walmartPlusAgreeTermsCheckBox
            - click:
                identifier: us.mappings.reviewOrder.splash.walmartPlusAgreeTermsCheckBox

      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.inhome.MLP.startFreeTrialCTA
      - click:
          identifier: us.mappings.wplus.inhome.MLP.startFreeTrialCTA  
          wait: 1500
      - log: "Clicked on Start 30-day Free trial"
      - verifyIdentifier:
          label:
            - identifier: us.mappings.wplus.membershipBottomsheetTitle
              contains: Welcome! We’re ready to tackle your to-dos

      - log: "InHome Confirmation screen loaded"          
      - verifyIdentifier: 
          present:
            - identifier: us.mappings.wlus.membershipBottomsheetClose
      - click:
          identifier: us.mappings.wlus.membershipBottomsheetClose 
          wait: 1500   

  - name: us.funtions.inHome.splashscreen.freetrial.signup
    platform: ios
    flow:   
    - if:    
          identifier:
            present:
              - identifier: us.mappings.skinnyBanner.bottomSheet.container
          then: 
            - log: inHome Splash Screen is displayed on homepage.
            - scroll:
                direction: down
                untilIdentifier: us.mappings.inHome.bookslot.checkBox
                scrollLimit: 2
            - click:
                identifier: us.mappings.inHome.bookslot.checkBox
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.wplus.inhome.homepage.splashscreen.bottomSheet.cta
            - click:
                identifier: us.mappings.wplus.inhome.homepage.splashscreen.bottomSheet.cta
                wait: 4000
            - log: Start 30-day inhome free trial CTA is clicked.
            - verifyIdentifier: 
                  present:
                    - identifier: us.mappings.wplus.inhome.splashscreen.signupConfirmationScreen
            - log: "InHome Confirmation screen loaded"          
            - verifyIdentifier: 
               present:
                  - identifier: us.mappings.wplus.inhome.spashcreen.signupConfirmationScreen.closeXMark
            - click:
                identifier: us.mappings.wplus.inhome.spashcreen.signupConfirmationScreen.closeXMark
                wait: 1500 
          else: 
            - log: inHome Splash Screen is NOT displayed on homepage.

  - name: us.funtions.inHome.splashscreen.freetrial.signup
    platform: android
    flow:   
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.home.orderSavingsupdatesCancel
          then:
            - click:
                identifier: us.mappings.home.orderSavingsupdatesCancel
      - if:    
          identifier:
            present:
              - identifier: us.mappings.skinnyBanner.bottomSheet.container
          then: 
            - log: inHome Splash Screen is displayed on homepage.
            - scroll:
                direction: down
                untilIdentifier: us.mappings.inHome.bookSlot.activateInHomeIagree
                scrollLimit: 2
            - click:
                identifier: us.mappings.inHome.bookSlot.activateInHomeIagree
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.skinnyBanner.bottomSheet.startTrial.cta
            - click:
                identifier: us.mappings.skinnyBanner.bottomSheet.startTrial.cta
                wait: 4000
            - log: Start 30-day inhome free trial CTA is clicked.
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.inHome.bookSlot.clickInHomeTrialSignUpButton
            - log: "InHome Confirmation screen loaded"          
            - verifyIdentifier: 
                present:
                  - identifier: us.mappings.wplus.inHome.membership.closeAlert
            - click:
                identifier: us.mappings.wplus.inHome.membership.closeAlert
                wait: 1500 
          else: 
            - log: inHome Splash Screen is NOT displayed on homepage.

  # Add/Change address on Manage Plus Ups Screen(reusable)
  # {address}: [mandatory] address. ex: 3839 Yates St
  # {cityState}: [mandatory] city and state. ex: Denver, CO
  # {method}: [mandatory] add or change
  - name: us.functions.wplus.inHome.modifyAddressOnManagePlusUps
    platform: android
    flow:
      - storeIn:
          key: deliveryAddress
          value: ${address}, ${cityState}
      - if:
          condition: ${method} == 'add'
          then:
            - click:
                identifier: us.mappings.inHome.managePlusUps.addAddressButton
          else:
            - if:
                condition: ${method} == 'change'
                then:
                  - click:
                      identifier: us.mappings.inHome.managePlusUps.changeAddressButton
                else:
                  - log: method is invalid
      - enterText:
          identifier: us.mappings.inHome.deliveryAddress.deliveryAddressTextField
          string: ${deliveryAddress}
          pressEnter: true
      - click:
          wait: 5000
          identifier: us.mappings.inHome.deliveryAddress.addressSelectButton
      - executeFunction:
          name: us.functions.utils.handleTechnicalErrorPopup
  

  - name: us.functions.account.deliveryAddress.inhome.edit.addresses
    platform: android
    flow:
    - if:    
          identifier:
            present:
              - identifier: us.mappings.selectAddress.editbutton
          then: 
            - log: Edit button is displayed on addresses page.
    - click:
        identifier: us.mappings.selectAddress.editbutton   
    - click:
        identifier: us.mappings.global.closeButton

  - name: us.functions.addresses.validating.inhomeDeliveryNote
    platform: android
    flow:
    - scroll:
        direction: down
        untilIdentifier: us.mappings.inhome.deliverynotes.instructions
    - click:
        identifier: us.mappings.inhome.deliverynotes.instructions
    - enterText:
        identifier: us.mappings.inhome.deliverynotes.instructions
        clearField: true
        string: ${inhomedeliverynote}
    - click:
        identifier: us.mappings.amend.editItem.selectItemButton
    - scroll:
        direction: up

  - name: us.functions.addresses.validating.inhomeDeliveryNote.on.checkout
    platform: android
    flow:
      - verifyIdentifier:
          text:
            - identifier: us.mappings.inhome.deliverynotes.instructions.checkoutpage
              contains: ${inhomedeliverynote}
      - log:
          message: Inhome delivery notes validation completed
          color: GREEN_BOLD  

  - name: us.functions.account.deliveryAddress.inhome.edit.addresses
    platform: ios
    flow:
    - click:
        identifier: us.mappings.accounts.address.title
    - if:    
          identifier:
            present:
              - identifier: us.mappings.selectAddress.editbutton
          then: 
            - log: Edit button is displayed on addresses page.
    - click:
        identifier: us.mappings.selectAddress.editbutton 
    - click: 
        identifier: us.mappings.deliveryAddress.add.lastName
    - click: 
        identifier: us.mappings.default.keyboardDoneButton                                                          

  - name: us.functions.addresses.validating.inhomeDeliveryNote
    platform: ios
    flow:
    - scroll:
        direction: down
        untilIdentifier: us.mappings.inhome.deliverynotes.instructions
    - click:
        identifier: us.mappings.inhome.deliverynotes.instructions.edit
    - enterText:
        identifier: us.mappings.inhome.deliverynotes.instructions.edit.field
        clearField: true
        string: ${inhomedeliverynote}
    - click: 
        identifier: us.mappings.default.keyboardDoneButton 
    - click:
        identifier: us.mappings.amend.editItem.selectItemButton
    - click:
        identifier: us.mappings.amend.editItem.selectItemButton

  - name: us.functions.addresses.validating.inhomeDeliveryNote.on.checkout
    platform: ios
    flow:
      - log:
          message: "Here is the inhome notes: ${inhomedeliverynote}"   
      - verifyIdentifier: 
            present:
              - identifier: us.mappings.inhome.deliverynotes.instructions.checkoutpage
      - log:
          message: Inhome delivery notes validation completed
          color: GREEN_BOLD  
 
  - name: us.functions.wplus.inHomecancellation.validateOnManageMembershipScreen
    platform: android
    flow:
      - if:
          identifier:
            present: 
             - identifier: us.mappings.wplus.inHome.plusup.title
          then:
            - verifyIdentifier: 
                text:
                  - identifier: us.mappings.manageMembership.inHome.paymentDetails
                    contains: Cancelled
                present:
                  - identifier: us.mappings.inHome.manageMembershipScreen.reactivateLink

  - name: us.functions.wplus.inHomeReactivation.validateOnManageMembershipScreen
    platform: android
    flow:
      - verifyIdentifier:
          notPresent:
            - identifier: us.mappings.manageMembership.inHome.30DayFreeTrialLabel

  - name: us.functions.wplus.inHomeReactivation.validateOnManageMembershipScreen
    platform: ios
    flow:
      - verifyIdentifier:
            visible:
              - identifier: us.mappings.manageMembership.inHome.30DayFreeTrialLabel
                value: 'false'

  - name: us.functions.wplus.inHomePaidCancellation.validateOnManageMembershipScreen
    platform: android
    flow:
      - verifyIdentifier:
          notPresent:
            - identifier: us.mappings.manageMembership.inHome.30DayFreeTrialLabel
            - identifier: us.mappings.manageMembership.inHome.paymentDetails
      -  verifyIdentifier:
           present:
             - identifier: us.mappings.inHome.manageMembershipScreen.reactivateLink

  - name: us.functions.wplus.inHomePaidCancellation.validateOnManageMembershipScreen
    platform: ios
    flow:
      - sleep:
          duration: 3000
      - if:
          identifier:
            present: 
             - identifier: us.mappings.inhome.cancelInhome.reactiveLink
          then:
            - break: true
          else:
           -  verifyIdentifier:
                present:
                  - identifier: us.mappings.inhome.cancelInhome.cancelledLabel

 