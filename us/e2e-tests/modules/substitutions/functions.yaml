functions:

# Navigate to subs order detail page
  - name: us.functions.subs.pHOrderDetailsPage
    platform: ios
    flow:
      - click:
          identifier: us.mappings.tabBar.account
      - click:
           identifier: us.mappings.account.yourOrdersButton
    
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.odpSubsBanner     
      - click:
          identifier: us.mappings.purchaseHistory.viewDetailsButton
          wait: 5000

      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.odpSubsBanner 

# Navigate to subs order detail page
  - name: us.functions.subs.pHOrderDetailsPage
    platform: android
    flow:
      - click:
          identifier: us.mappings.tabBar.account
      - click:
           identifier: us.mappings.account.purchaseHistory
           wait: 5000
      - click:
           identifier: us.mappings.subs.orderDetailsViewDetails
           wait: 5000  

# Click on subs banner on homescreen
  - name: us.functions.subs.homeBanner   
    platform: ios
    flow:
      #  homepage subs banner
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.bannerHeaderCopy
            - identifier: us.mappings.subs.homepageBanner.itemsSubstitutedCopy
      - click:
           identifier: us.mappings.subs.bannerViewButton

# Click on subs banner on homescreen
  - name: us.functions.subs.homeBanner
    platform: android
    flow:
      #  homepage subs banner
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.bannerHeaderCopy
            - identifier: us.mappings.subs.homepageBanner.itemsSubstitutedCopy
      - click:
           identifier: us.mappings.subs.bannerViewButton

  # # Click on subs pickup banner on order details page
  # - name: us.functions.subs.orderDetailsPickupBanner
  #   platform: ios
  #   flow:
  #     # Deeplink into order details page
  #     - executeFunction:
  #         name: us.functions.global.navigation.goToDeepLink
  #         params:
  #           - name: deepLinkUrl
  #             string: walmart://orders/$orderNo
  #     #  order details pickup subs banner
  #     # - verifyIdentifier:
  #     #     present:
  #     #       - identifier: us.mappings.subs.bannerHeaderCopy
  #           # - identifier: us.mappings.subs.orderDetailsBanner.itemsSubstitutedPickupCopy
  #     - click:
  #          identifier: us.mappings.subs.bannerViewButton

  # # Click on subs pickup banner on order details page
  # - name: us.functions.subs.orderDetailsPickupBanner
  #   platform: android
  #   flow:
  #     # Deeplink into order details page
  #     - executeFunction:
  #         name: us.functions.global.navigation.goToDeepLink
  #         params:
  #           - name: deepLinkUrl
  #             string: walmart://orders/$orderNo
  #     #  order details pickup subs banner
  #     - if:
  #         identifier:
  #           present:
  #             - identifier: us.mappings.subs.bannerHeaderCopy
  #         then:
  #           - log: "Pick up banner displayed correctly"
  #         else:
  #           - failTest:
  #               message: "ENV_FAILURE - ${env} - Pick up banner not displayed correctly"
  #     - verifyIdentifier:
  #         present:
  #           - identifier: us.mappings.subs.orderDetailsBanner.itemsSubstitutedPickupCopy
  #     - click:
  #          identifier: us.mappings.subs.bannerViewButton

  # Click on subs delivery banner on order details page
  - name: us.functions.subs.orderDetailsDeliveryBanner
    platform: android
    flow:
      # Deeplink into order details page
      - executeFunction:
          name: us.functions.global.navigation.goToDeepLink
          params:
            - name: deepLinkUrl
              string: walmart://orders/$orderNo
      #  order details Delivery subs banner
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.bannerHeaderCopy
            - identifier: us.mappings.subs.homepageBanner.itemsSubstitutedCopy
      - click:
           identifier: us.mappings.subs.bannerViewButton

  # Click on subs delivery banner on order details page
  # - name: us.functions.subs.orderDetailsPickupBanner
  #   platform: ios
  #   flow:
  #     #  order details delivery subs banner
  #     - verifyIdentifier:
  #         present:
  #           - identifier: us.mappings.subs.bannerHeaderCopy
  #           - identifier: us.mappings.subs.orderDetailsBanner.itemsSubstitutedDeliveryCopy
  #     - click:
  #           identifier: us.mappings.subs.bannerViewButton

  # Cutsomer accepts all the subs flow
  - name: us.functions.subs.acceptYourSubs
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.reviewYourSubs.wantToEditText
          position: center
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.reviewYourSubsItemsCount2
            - identifier: us.mappings.subs.reviewYourSubs.wantToEditText
      - click:
            identifier: us.mappings.subs.orderDetailsConfirmationPage.subsViewButton
            wait: 6000
      #  Verify review you subs page
      - verifyIdentifier:
          timeout: 8000
          present:
            - identifier: us.mappings.subs.reviewYourSubsHeader
      - executeFunction:
          name: us.functions.subs.partialAccept
      - click:
           identifier: us.mappings.subs.reviewYourSubsConfirmButton
           wait: 8000
      #  Verify subs order details confirmation page
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.subs.unableToEditSubstitutions
          then:
            - log: "Retying to edit substitution after waiting for sometime"
            - sleep:
                duration: 10000
            - click:
                  identifier: us.mappings.subs.reviewYourSubsConfirmButton
            - sleep:
                duration: 5000
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.subs.unableToEditSubstitutions
                then:
                  - log: "Unable to edit substitutions"
                  - failTest:
                      message: "ENV_FAILURE - ${env} - Unable to edit substitutions"           
      - if:
          identifier:
            present:
              - identifier: us.mappings.subs.orderDetailsConfirmationPage.successBanner
          then:
            - log: "Success banner displayed as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Sccess banner should be displayed but is not"
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.subs.orderDetailsConfirmationPage.successBanner
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.orderDetailsConfirmationPage.substitutionBanner

  - name: us.functions.subs.partialAccept
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.qtyStepperSection
            - identifier: us.mappings.subs.eachItemAmount
          label:
            - identifier: us.mappings.subs.qtyStepperText
              contains: Max
      - click:
          identifier: us.mappings.subs.reviewYourSubsRejectRadioButton
      - verifyIdentifier:
          label:
            - identifier: us.mappings.subs.qtyStepperText
              contains: 0
      - verifyIdentifier:
          notPresent:
            - identifier: us.mappings.subs.eachItemAmount
          label:
            - identifier: us.mappings.subs.totalAmount
              contains: 0.0
      - click:
          identifier: us.mappings.subs.qtyStepperIncrement
      - verifyIdentifier:
          notPresent:
            - identifier: us.mappings.subs.eachItemAmount
          value:
            - identifier: us.mappings.subs.reviewYourSubsAccpetRadioButton
              contains: 1

  - name: us.functions.subs.acceptYourSubs
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.reviewYourSubs.wantToEditText
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.reviewYourSubs.wantToEditText
      - click:
            identifier: us.mappings.subs.orderDetailsConfirmationPage.subsViewButton
            wait: 6000
      #  Verify review you subs page
      - if:
          identifier:
            present:
              - identifier: us.mappings.subs.reviewYourSubsHeader
          then:
            - log: "Review subs page displayed correctly"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Review subs page not displayed correctly"
      - executeFunction:
          name: us.functions.subs.partialAccept
      - click:
           identifier: us.mappings.subs.reviewYourSubsConfirmButton
           wait: 8000
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.subs.unableToEditSubstitutions
          then:
            - log: "Retying to edit substitution after waiting for sometime"
            - sleep:
                duration: 10000
            - click:
                  identifier: us.mappings.subs.reviewYourSubsConfirmButton
            - sleep:
                duration: 5000
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.subs.unableToEditSubstitutions
                then:
                  - log: "Unable to edit substitutions"
                  - failTest:
                      message: "ENV_FAILURE - ${env} - Unable to edit substitutions" 
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.orderDetailsConfirmationPage.substitutionBanner

  - name: us.functions.subs.partialAccept
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.qtyStepperSection
            - identifier: us.mappings.subs.eachItemAmount
          text:
            - identifier: us.mappings.subs.qtyStepperText
              contains: Max
      - click:
          identifier: us.mappings.subs.reviewYourSubsRejectRadioButton
      - verifyIdentifier:
          text:
            - identifier: us.mappings.subs.qtyStepperText
              contains: 0
      - verifyIdentifier:
          notPresent:
            - identifier: us.mappings.subs.eachItemAmount
          text:
            - identifier: us.mappings.subs.totalAmount
              contains: 0.0
      - click:
          identifier: us.mappings.subs.qtyStepperIncrement
      - verifyIdentifier:
          notPresent:
            - identifier: us.mappings.subs.eachItemAmount
          checked:
            - identifier: us.mappings.subs.reviewYourSubsAccpetRadioButton
              value: true

  # Cutsomer reject all the subs flow
  - name: us.functions.subs.rejectYourSubs
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.reviewYourSubs.wantToEditText
      #  Verify review you subs page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.reviewYourSubsItemsCount1
            - identifier: us.mappings.subs.reviewYourSubs.wantToEditText
      - click:
            identifier: us.mappings.subs.orderDetailsConfirmationPage.subsViewButton
            wait: 6000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.reviewYourSubsHeader
      - click:
           identifier: us.mappings.subs.reviewYourSubsRejectRadioButton
      - click:
           identifier: us.mappings.subs.reviewYourSubsConfirmButton
           wait: 8000
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.subs.unableToEditSubstitutions
          then:
            - log: "Retying to edit substitution after waiting for sometime"
            - sleep:
                duration: 10000
            - click:
                  identifier: us.mappings.subs.reviewYourSubsConfirmButton
            - sleep:
                duration: 5000
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.subs.unableToEditSubstitutions
                then:
                  - log: "Unable to edit substitutions"
                  - failTest:
                      message: "ENV_FAILURE - ${env} - Unable to edit substitutions"               
      #  Verify subs order details confirmation page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.orderDetailsConfirmationPage.successBanner
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.orderCanceled

  # Cutsomer reject all the subs flow
  - name: us.functions.subs.rejectYourSubs
    platform: android
    flow:
      #  Verify review you subs page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.reviewYourSubsHeader
            - identifier: us.mappings.subs.reviewYourSubsUnavailableTable
            - identifier: us.mappings.subs.reviewYourSubsSubstitutionTable
      - click:
           identifier: us.mappings.subs.reviewYourSubsRejectRadioButton
      - click:
           identifier: us.mappings.subs.reviewYourSubsRejectRadioButton2
      - click:
           identifier: us.mappings.subs.reviewYourSubsConfirmButton
      #  Verify subs order details confirmation page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.orderDetailsConfirmationPage.successBanner
            - identifier: us.mappings.subs.orderDetailsConfirmationPage.substitutionExpandedTable
            - identifier: us.mappings.subs.orderDetailsConfirmationPage.unavailableExpandedTable
            - identifier: us.mappings.subs.orderDetailsConfirmationPage.shoppedCollapsedTable
            - identifier: us.mappings.subs.orderDetailsConfirmationPage.weightAdjustedCollapsedTable

  # Cutsomer accepts and reject few subs flow
  - name: us.functions.subs.acceptRejectYourSubs
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.reviewYourSubs.wantToEditText
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.reviewYourSubsItemsCount
            - identifier: us.mappings.subs.reviewYourSubs.wantToEditText
      - click:
            identifier: us.mappings.subs.orderDetailsConfirmationPage.subsViewButton
            wait: 6000
      #  Verify review you subs page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.reviewYourSubsHeader
      - click:
           identifier: us.mappings.subs.reviewYourSubsRejectRadioButton
      - click:
           identifier: us.mappings.subs.reviewYourSubsConfirmButton
      #  Verify subs order details confirmation page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.orderDetailsConfirmationPage.successBanner

  # Cutsomer accepts and reject few subs flow
  - name: us.functions.subs.acceptRejectYourSubs
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.reviewYourSubs.wantToEditText
      - if:
          identifier:
            present:
              -  identifier: us.mappings.subs.reviewYourSubs.wantToEditText
          then:
            - log: "Edit Text option displayed as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Edit text should be present but is not"
      - click:
            identifier: us.mappings.subs.orderDetailsConfirmationPage.subsViewButton
            wait: 6000
      #  Verify review you subs page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.reviewYourSubsHeader
      - click:
           identifier: us.mappings.subs.reviewYourSubsRejectRadioButton
      - click:
           identifier: us.mappings.subs.reviewYourSubsConfirmButton
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.subs.unableToEditSubstitutions
          then:
            - log: "Retying to edit substitution after waiting for sometime"
            - sleep:
                duration: 10000
            - click:
                  identifier: us.mappings.subs.reviewYourSubsConfirmButton
            - sleep:
                duration: 5000
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.subs.unableToEditSubstitutions
                then:
                  - log: "Unable to edit substitutions"
                  - failTest:
                      message: "ENV_FAILURE - ${env} - Unable to edit substitutions" 
      #  Verify subs order details confirmation page
      - if:
          identifier:
            present:
              - identifier: us.mappings.subs.orderDetailsConfirmationPage.successBanner
          then:
            - log: "Success banner displayed as expected"
          else:
            - failTest:
                message: "Success banner should have been displayed but is not"
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.subs.orderDetailsConfirmationPage.successBanner

  # Subs flow without accept reject
  - name: us.functions.subs.subsWithoutAcceptReject
    platform: ios
    flow:
      # verify subs banner
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.subsNilsBannerHeaderCopy
            - identifier: us.mappings.subs.homepageBanner.itemsSubstitutedCopy
      - click:
           identifier: us.mappings.subs.bannerViewButton
      #  Verify substituted item page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.detailsPage
            - identifier: us.mappings.subs.detailsPage.substitutedItemsBannerOrderDispensed
      
      - click:
           identifier: us.mappings.subs.detailsPage.closeButton

  # Subs flow without accept reject
  - name: us.functions.subs.subsWithoutAcceptReject
    platform: android
    flow:
      # verify subs banner
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.subsNilsBannerHeaderCopy
            - identifier: us.mappings.subs.homepageBanner.itemsSubstitutedCopy
      - click:
           identifier: us.mappings.subs.bannerViewButton
      #  Verify substituted item page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.detailsPage
            - identifier: us.mappings.subs.detailsPage.substitutedItemsBannerOrderDispensed    
      - click:
           identifier: us.mappings.subs.detailsPage.closeButton

  #  Verify subs order details page after order is picked or delivered
  - name: us.functions.subs.orderPickedUpSubsOrderDetailPage
    platform: ios
    flow:
      - scroll:
          direction: up
      - scroll:
          direction: up
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.accordions
      #Verify subs order details page after order is picked or delivered
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.orderDetailsConfirmationPage.wantToSeeText
      # Click on subs order detail confirmation page
      - if: 
          identifier: 
            present: 
              - identifier: us.mappings.subs.orderPickeus.mappings.subs.orderPickedUpSubsOrderDetailPage.viewButtondUpSubsOrderDetailPage.accordions
          then: 
            - click: 
                identifier: us.mappings.subs.orderPickeus.mappings.subs.orderPickedUpSubsOrderDetailPage.viewButtondUpSubsOrderDetailPage.accordions
          else: 
            - click:
                identifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.accordions
      - click: 
           identifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.viewButton

  - name: us.functions.subs.orderPickedUpSubsOrderDetailPage
    platform: android
    flow: 
      - sleep:
          duration: 3000
      - if:
          identifier:
            present:
              - identifier: us.mappings.orderDetails.itemsContainer.expandableButton
          then:
            - click:
                identifier: us.mappings.orderDetails.itemsContainer.expandableButton
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.subs.orderPickedUpSubsOrderDetailPage.viewButton
            - name: direction
              string: down
            - name: scrollPosition
              string: center   
      - click: 
           identifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.viewButton
           wait: 5000      

   #  Verify order details page without subs  after order is picked or delivered
  - name: us.functions.subs.orderPickedUpNonSubsOrderDetailPage
    platform: ios
    flow:
      - scroll:
          direction: up
      - scroll:
          direction: up
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.accordions
      # Click on subs order detail confirmation page
      - if:
          identifier:
            present:
              - identifier: us.mappings.subs.orderPickeus.mappings.subs.orderPickedUpSubsOrderDetailPage.viewButtondUpSubsOrderDetailPage.accordions
          then:
            - click:
                identifier: us.mappings.subs.orderPickeus.mappings.subs.orderPickedUpSubsOrderDetailPage.viewButtondUpSubsOrderDetailPage.accordions
          else:
            - click:
                identifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.accordions
      - verifyIdentifier:
          notPresent:
            - identifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.viewButton

  #  Verify order details page without subs  after order is picked or delivered
  - name: us.functions.subs.orderPickedUpNonSubsOrderDetailPage
    platform: android
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.viewButton
          then:
            - log: "Order details page without Subs displayed correctly"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Order details page without Subs not displayed correctly as expected"
      # - verifyIdentifier:
      #     notPresent:
      #       - identifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.viewButton


  # Verify substituted item page
  - name: us.functions.subs.substitutedItemsPage
    platform: ios
    flow:
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.subs.detailsPage
          then:
            - click:
                identifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.viewButton
      #  Verify substituted item page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.detailsPage
            # - identifier: us.mappings.subs.detailsPage.substitutedItemsWindowExpiredPickupBanner
      # - click:
      #      identifier: us.mappings.subs.detailsPage.closeButton

  # Verify substituted item page
  - name: us.functions.subs.substitutedItemsPage
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.subs.detailsPage
          then:
            - log: "Substituted item detail page displayed"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Substituted item detail page not displayed as expected"
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.subs.detailsPage
      - click:
           identifier: us.mappings.subs.detailsPage.closeButton

  # Navigate to subs order in PH
  - name: us.functions.subs.orderDetailsPage
    platform: ios
    flow:
      #  Click on account tab on homescreen
      - click:
           identifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.viewButton

      #  Verify substituted item page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.detailsPage
            - identifier: us.mappings.subs.detailsPage.substitutedItemsWindowExpiredPickupBanner

  - name: us.functions.subs.searchSubItems.and.updateOrder
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - scroll:
          direction: down
          scrollLimit: 2
      - click:
          identifier: us.mappings.subs.subsReplaceWith.bestMatch.button
          wait: 1500
      - log: "The Replace with best match button is now visible and clicked!!!"
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subsPreference.itemSubstitutionCarouselViewCollectionView
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.subsPreference.searchItemButton
            - name: direction
              string: left
            - name: identifierScope
              string: us.mappings.subsPreference.itemSubstitutionCarouselViewCollectionView
      - verifyIdentifier:
          present:
              - identifier: us.mappings.subsPreference.searchItemButton
      # - scroll:
      #     direction: down
      #     scrollLimit: 1
      #     wait: 2000
      - click:
          identifier: us.mappings.subs.searchItems.button
          wait: 2000
      - log: "The Substitution Search button is now visible and clicked!!!"
      - enterText:
          identifier: us.mappings.subs.searchBar
          string: ${subSearchTerm}
          pressEnter: true
      # - click:
      #     identifier: us.mappings.subs.searchItemsSearchFor
      #     wait: 1000
      #     coordinates: 50%, 25%
      - log: "Searched the subs items and selected the first item in the results"
      - if:
          identifier:
            present:
              - identifier: us.mappings.subs.searchItems.button
          then:
              - click:
                  identifier: us.mappings.subs.searchItems.button
      - click:
          identifier: us.mappings.subs.searchResultItem.1stIndex
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.subs.saveButton
      - click:
          identifier: us.mappings.subs.subs.saveButton
          wait: 10000
      - log: "Clicked on the Save Button to update the substitution item."
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.daysLeftToEditOrder.text
            - identifier: us.mappings.subs.replaceIfUnavailable.text.onUpdateOrderPage
            - identifier: us.mappings.subs.allowSubs.text.onUpdateOrderPage
            - identifier: us.mappings.subs.editButton.onUpdateOrder
            - identifier: us.mappings.subs.replaceItem.onUpdateOrderPage
            - identifier: us.mappings.subs.updateOrderButton
            - identifier: us.mappings.subs.allowSubs.toggleSwitch
      - log: "Verified all the asserts on Update Order Page."
      - click:
          identifier: us.mappings.subs.updateOrderButton
          wait: 10000
      - log: "Clicked Update Order button."
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.subs.totalText.onOrderDetailPage
          then:
            - log: "The Temporary Hold amount field is not visible, Scrolling down."
            - scroll:
                direction: down
                untilIdentifier: us.mappings.subs.totalText.onOrderDetailPage
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.subs.temporaryHold.fieldOnOrderDetailPage
      # - log: "The Temporary Hold mount field is Visible on the Order Detail Page!!!"

  - name: us.functions.subs.searchSubItems.and.updateOrder
    platform: android
    flow:
      - sleep:
          duration: 5000
      - scroll:
          direction: down
          scrollLimit: 2
      - click:
          identifier: us.mappings.subs.subsReplaceWith.bestMatch.button
      - sleep:
          duration: 4000
      - log: "The Replace with best match button is now visible and clicked!!!"
      - scroll:
          direction: down
          scrollLimit: 1
          wait: 2000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.subs.searchItems.button
            - name: direction
              string: left
            - name: identifierScope
              string: us.mappings.subsPreference.itemSubstitutionCarouselViewCollectionView 
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.lookingForSomethingElse.text
            - identifier: us.mappings.subs.searchItems.button
      - scroll:
          direction: down
          scrollLimit: 1
          wait: 2000
      - click:
          identifier: us.mappings.subs.searchItems.button
          wait: 2000
      - log: "The Substitution Search button is now visible and clicked!!!"
      - enterText:
          identifier: us.mappings.subs.searchBar
          string: ${subSearchTerm}
          pressEnter: true
      - click:
          identifier: us.mappings.subs.searchResultItem.1stIndex
          wait: 1000
      - log: "Searched the subs items and selected the first item in the results"
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.subs.saveButton
      - click:
          identifier: us.mappings.subs.subs.saveButton
      - sleep:
          duration: 4000
      - log: "Clicked on the Save Button to update the substitution item."
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.daysLeftToEditOrder.text
            - identifier: us.mappings.subs.replaceIfUnavailable.text.onUpdateOrderPage
            - identifier: us.mappings.subs.allowSubs.text.onUpdateOrderPage
            - identifier: us.mappings.subs.editButton.onUpdateOrder
            - identifier: us.mappings.subs.replaceItem.onUpdateOrderPage
            - identifier: us.mappings.subs.updateOrderButton
            - identifier: us.mappings.subs.allowSubs.toggleSwitch
      - log: "Verified all the asserts on Update Order Page."
      - click:
          identifier: us.mappings.subs.updateOrderButton
          wait: 2000
      - log: "Clicked Update Order button."
      - sleep:
          duration: 20000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.orderDetails.totalText
            - name: direction
              string: down
            - name: scrollPosition
              string: center   

      - verifyIdentifier:
          present:
            - identifier: us.mappings.orderDetails.totalText
      # - log: "The Temporary Hold mount field is Visible on the Order Detail Page!!!"
        
  - name: us.functions.subs.verifyItem
    platform: android
    flow:
      - scroll:
          direction: down
          wait: 5000
          untilIdentifier: us.mappings.subs.replacementItem
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.replacementItem
      - scroll:
          direction: down
          wait: 2000
          untilIdentifier: us.mappings.subs.adjustmentDebit
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.adjustmentDebit
            - identifier: us.mappings.subs.adjustmentDebitAmount
            - identifier: us.mappings.subs.adjustmentText

  - name: us.functions.subs.verifyItem
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.replacementItem    
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.replacementItem
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.adjustmentDebit   
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.adjustmentDebit
            - identifier: us.mappings.subs.adjustmentDebitAmount
            - identifier: us.mappings.subs.adjustmentText
      - log: Adjustment debit is present                

  # Cutsomer accepts subs flow
  - name: us.functions.subs.acceptYourSubs.with1item
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.reviewYourSubs.wantToEditText
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.reviewYourSubsItemsCount
            - identifier: us.mappings.subs.reviewYourSubs.wantToEditText
      - click:
            identifier: us.mappings.subs.orderDetailsConfirmationPage.subsViewButton
            wait: 6000
      #  Verify review you subs page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.reviewYourSubsHeader
      - click:
           identifier: us.mappings.subs.reviewYourSubsAcceptRadioButton
      - click:
           identifier: us.mappings.subs.reviewYourSubsConfirmButton
      #  Verify subs order details confirmation page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.orderDetailsConfirmationPage.successBanner

   #  Verify order details page without subs  after order is picked or delivered
  - name: us.functions.subs.orderPickedUpNonSubsAndSubsOrderDetailPage
    platform: ios
    flow:
      - storeIn:
          key: executionStage
          value: Post-transactions
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.SubsItem
      - click:
           identifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.SubsItem
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.SubsItemDetails         

  - name: us.functions.subs.acceptSubItems
    platform: ios
    flow:
      - storeIn:
          key: executionStage
          value: Post-transactions
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.reviewYourSubs.wantToEditText
          position: center
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.reviewYourSubs.wantToEditText
      - click:
            identifier: us.mappings.subs.orderDetailsConfirmationPage.subsViewButton
            wait: 6000
      #  Verify review you subs page
      - verifyIdentifier:
          timeout: 8000
          present:
            - identifier: us.mappings.subs.reviewYourSubsHeader
      - click:
           identifier: us.mappings.subs.reviewYourSubsAccpetRadioButton

      - click:
           identifier: us.mappings.subs.reviewYourSubsConfirmButton
        
      #  Verify subs order details confirmation page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.orderDetailsConfirmationPage.successBanner

  - name: us.functions.subs.acceptSubItems
    platform: android
    flow:
      - storeIn:
          key: executionStage
          value: Post-transactions
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.reviewYourSubs.wantToEditText
          position: center
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.reviewYourSubs.wantToEditText
      - click:
            identifier: us.mappings.subs.orderDetailsConfirmationPage.subsViewButton
            wait: 6000
      #  Verify review you subs page
      - verifyIdentifier:
          timeout: 8000
          present:
            - identifier: us.mappings.subs.reviewYourSubsHeader
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.reviewYourSubsAccpetRadioButton
      - click:
           identifier: us.mappings.subs.reviewYourSubsAccpetRadioButton
      - click:
           identifier: us.mappings.subs.reviewYourSubsConfirmButton
      - sleep:
          duration: 3000
      - scroll: 
          direction: up   
          wait: 6000
      #  Verify subs order details confirmation page
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.orderDetailsConfirmationPage.successBanner
     
   #  Verify order details page without subs  after order is picked or delivered
  - name: us.functions.subs.orderPickedUpNonSubsAndSubsOrderDetailPage
    platform: android 
    flow:
      - storeIn:
          key: executionStage
          value: Post-transactions
      - scroll:
          direction: down
          untilIdentifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.SubsItem
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.SubsItem   
      - click:
           identifier: us.mappings.subs.orderPickedUpSubsOrderDetailPage.SubsItem

  - name: us.functions.subs.verifyAfterReject
    platform: ios
    flow:
      - sleep:
          duration: 3000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.orderCanceled
      - click:
          identifier: us.mappings.cancellation.ItemDropDownButton
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.unavailable

  - name: us.functions.subs.verifyAfterReject
    platform: android
    flow:
      - sleep:
          duration: 3000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.subs.orderCanceled
            - identifier: us.mappings.subs.unavailable