functions:  

########################################################### iOS ##############################################

  # Verify petrx item prescription badge
  - name: us.functions.item.petrxItem.verifyPresent
    platform: ios
    flow:

      # Verify petrx item prescription badge
      - verifyIdentifier:
          timeout: 40000
          present:
            - identifier: us.mappings.item.productNameTileGeneric
            - identifier: us.mappings.item.petrxprescriptionBadge
            - identifier: us.mappings.item.productPrimaryPrice

      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.pickupNotAvailable
      # Verify Pickup availability
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.pickupNotAvailable
          then:
            - log: "Pickup not available for petrx items"


      # - scroll:
      #     direction: down
      #     untilIdentifier: us.mappings.item.petrxpickupna
      # - if:
      #     identifier:
      #       present:
      #         - identifier: us.mappings.item.petrxpickupna
      #     then:
      #       - log: "Pet Rx item present as expected"
      #     else:
      #       - failTest:
      #           message: "ENV_FAILURE - ${env} - Pet Rx item not present as expected"
      # - verifyIdentifier:
      #     timeout: 40000
      #     present:
      #     - identifier: us.mappings.item.petrxpickupna

#Petrx virtual pack 
  - name: us.functions.item.petrxItem.virtualPack
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.itemPage.petRXitemName
            - identifier: us.mappings.item.petrxprescriptionBadge
#Virtual Pack size
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.petrxVirtualpacksize
      - click:
          identifier: us.mappings.item.petrxVirtualpacksize
      #Petrx Virtual Pack tablet form
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.petrxVirtualpacktabletform
      - click:
          identifier: us.mappings.item.petrxVirtualpacktabletform
          #Petrx Virtual Pack tablet count
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.petrxVirtualpacktabletcount60
      - click:
          identifier: us.mappings.item.petrxVirtualpacktabletcount60
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.productPrimaryPrice
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.productPrimaryPrice
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.pickupNotAvailable
      # Verify Pickup availability
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.pickupNotAvailable
          then:
            - log: "Pickup not available for petrx items"


  # Verify vision item buy in store badge
  - name: us.functions.item.visionItem.verifyPresent
    platform: ios
    flow:
      - verifyIdentifier:
          timeout: 30000
          present:
            - identifier: us.mappings.item.productNameTileGeneric
            - identifier: us.mappings.item.visionBuyInStoreBadge
            - identifier: us.mappings.item.visionPrescriptionBadge
          notPresent:
            - identifier: us.mappings.buyNow.buyNowButton
            - identifier: us.mappings.item.addToCartButton
  
  - name: us.functions.item.visionItem.verifySizeChart
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.vision.sizeGuide
      - click:
          identifier: us.mappings.item.vision.sizeGuide
      - verifyIdentifier:
          timeout: 3000
          present: 
            - identifier: us.mappings.item.vision.sizeGuideBottomSheet 
      - click:
          identifier: us.mappings.item.vision.sizeGuide.backButton
  
  - name: us.functions.item.visionItem.verifyBuyInStoreCTA
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.visionBuyInStoreBadge
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.visionBuyInStoreBadge
      - click:
          identifier: us.mappings.item.visionBuyInStoreBadge
      - verifyIdentifier:
          timeout: 3000
          present:
            - identifier: us.mappings.item.vision.buyInStoreBottomSheet
            - identifier: us.mappings.item.vision.buyInStoreContinueButton
      - click:
            identifier: us.mappings.item.vision.buyInStoreContinueButton
      - sleep:
          duration: 3000
      - verifyIdentifier:      
          present:
            - identifier: us.mappings.item.vision.storeDetail
  
  - name: us.functions.item.visionItem.verifyChangeStoreCTA
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.vision.buyInStoreChangeButton
            - name: direction
              string: up
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.visionBuyInStoreLabel
            - identifier: us.mappings.item.vision.buyInStoreChangeButton
      - click:
          identifier: us.mappings.item.vision.buyInStoreChangeButton
      - sleep:
          duration: 3000
      
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.selectStoreTextFieldVisionItem
      - click: 
          identifier: us.mappings.reserveSlot.selectStore.saveButton
      - sleep:
          duration: 5000
      - verifyIdentifier:
         present:
           - identifier: us.mappings.item.visionBuyInStoreBadge

  - name: us.functions.item.rewards.clickJoinWplusCtaItemPage
    platform: ios
    flow:
      - log: Clicking Join Walmart + CTA on Item Page 
      - click: 
          identifier: us.mappings.search.rewards.joinWalmartPlusCtaItemPage
          wait: 1000

# function to verify bought before 
  - name: us.functions.item.boughtBefore.verifyPresent
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.broughtBefore.label
          then:
            - log: "Bought before item present"
          else:
            - failTest:
                message: "DATA_FAILURE - Bought before item not present"
      # - verifyIdentifier:
      #     present: 
      #       - identifier: us.mappings.item.broughtBefore.label
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.item.broughtBefore.date

  - name: us.functions.item.selectVariants
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.variant.colour
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.variant.colour
      - click:
          identifier: us.mappings.item.variant.colour
      - sleep:
          duration: 2000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.variant.colour
            - name: direction
              string: up
            - name: limit
              string: 8
      - getString:
          identifier: us.mappings.item.variant.colour
          attribute: label
          storeIn: itemColour
      - log: $itemColour
      - executeNode:
          file: us/e2e-tests/helpers/splitVariantString.js
          args:
            - value: ${itemColour}
            - value: ' '
          getResponse:
            storeIn: color
      - log: $Color
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.variant.size
      - click:
          identifier: us.mappings.item.variant.size
      - sleep:
          duration: 2000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.variant.size
            - name: direction
              string: up
            - name: limit
              string: 8
      - getString:
          identifier: us.mappings.item.variant.size
          attribute: label
          storeIn: itemSize
      - log: $itemSize                    
      - if: 
          condition: ${Variant} == 3
          then:      
              - verifyIdentifier:
                  present:
                    - identifier: us.mappings.item.variant.width
              - click:
                  identifier: us.mappings.item.variant.width
              - sleep:
                  duration: 2000
              - executeFunction:
                  name: us.functions.utils.scrollIfNotVisible
                  params:
                    - name: identifier
                      string: us.mappings.item.variant.width
                    - name: direction
                      string: up
                    - name: limit
                      string: 8
              - getString:
                  identifier: us.mappings.item.variant.width
                  attribute: label
                  storeIn: itemWidth
              - log: $itemWidth
              - executeNode:
                  file: us/e2e-tests/helpers/splitVariantString.js
                  args:
                    - value: ${itemWidth}
                    - value: '\n'
                  getResponse:
                    storeIn: wid
              - log: $wid

  - name: us.functions.item.selectVariants.verifySizeChart
    platform: ios
    flow:
      # - executeFunction:
      #     name: us.functions.utils.scrollIfNotVisible
      #     params:
      #       - name: identifier
      #         string: us.mappings.item.vision.sizeGuide
      #       - name: direction
      #         string: down
      #       - name: scrollPosition
      #         string: center
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.vision.sizeGuide
          position: center
          scrollLimit: 1
      - click:
          identifier: us.mappings.item.vision.sizeGuide
      - verifyIdentifier:
          timeout: 60000
          present: 
            - identifier: us.mappings.item.vision.sizeGuideBottomSheet
            - identifier: us.mappings.item.measuringGuideViewImage
      - click:
          identifier: us.mappings.item.vision.sizeGuide.backButton
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.variant.firstContainerVariant
            - name: direction
              string: up
            - name: scrollPosition
              string: center

            ####### market place ##################

  - name: us.function.item.marketplace.verify3PSeller
    platform: ios
    flow: 
      - sleep:
          duration: 10000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.productNameTileGeneric
      - click:
          identifier: us.mappings.item.productNameTileGeneric
      - scroll:
          direction: down
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.showShippingDeliveryAndPickupOptionsButton
          then:
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.item.showShippingDeliveryAndPickupOptionsButton
                  - name: direction
                    string: down
                  - name: scrollPosition
                    string: center
            - click:
                identifier: us.mappings.item.showShippingDeliveryAndPickupOptionsButton
      # - executeFunction:
      #     name: us.functions.utils.scrollIfNotVisible
      #     params:
      #       - name: identifier
      #         string: us.mappings.item.3PsellerInfo
      #       - name: direction
      #         string: down
      #       - name: scrollPosition
      #         string: center
      - sleep:
          duration: 10000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.3PsellerInfo

  - name: us.function.item.marketplace.verify3PProSeller
    platform: ios
    flow:
        - sleep:
            duration: 5000
        - scroll:
            direction: down
        - if:
            identifier:
              present:
                - identifier: us.mappings.item.showShippingDeliveryAndPickupOptionsButton
            then:
              - click:
                  identifier: us.mappings.item.showShippingDeliveryAndPickupOptionsButton   
        - if:
            identifier:
              notPresent:
                - identifier: us.mappings.item.3P_ProSeller
            then:
              - executeFunction:
                  name: us.functions.utils.scrollIfNotVisible
                  params:
                    - name: identifier
                      string: us.mappings.item.3P_ProSeller
                    - name: direction
                      string: down
        - if:
            identifier:
              present:
                - identifier: us.mappings.item.3P_ProSeller
            then:
              - log: "The item is a 3P Pro seller item"
            else:
              - failTest:
                  message: "DATA_FAILURE - Item is not a 3P Proseller item"
        # - verifyIdentifier:
        #     present:
        #       - identifier: us.mappings.item.3P_ProSeller

  - name: us.functions.item.marketplace.verifySellerType
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.showShippingDeliveryAndPickupOptionsButton
          then:
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.item.showShippingDeliveryAndPickupOptionsButton
                  - name: direction
                    string: down
                  - name: scrollPosition
                    string: center
            - click:
                identifier: us.mappings.item.showShippingDeliveryAndPickupOptionsButton
      - if: 
          condition: ${sellerType} == 'pro-seller'
          then:
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.item.3P_ProSeller
                  - name: direction
                    string: down
                  - name: scrollPosition
                    string: center
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.item.3P_ProSeller
                then:
                  - verifyIdentifier:
                      present: 
                        - identifier: us.mappings.item.3P_ProSeller
                  - log: MP Pro-Seller tag Validated
                else:
                    - failTest:
                        message: "DATA_FAILURE - ${env} - MP Pro-Seller tag not available for ${itemFetched} " 

          else:
              - if:
                  condition: ${sellerType} == '3p'
                  then:
                    - executeFunction:
                        name: us.functions.utils.scrollIfNotVisible
                        params:
                          - name: identifier
                            string: us.mappings.item.sellerInfo
                          - name: direction
                            string: down
                          - name: scrollPosition
                            string: center
                    - if:
                        identifier:
                          present:
                            - identifier: us.mappings.item.sellerInfo
                        then:
                          - verifyIdentifier:
                              present: 
                                - identifier: us.mappings.item.sellerInfo
                        else:
                          - failTest:
                              message: "DATA_FAILURE - ${env} - MP Seller tag not available for ${itemFetched} " 
                          

                  else:
                      - if:
                          condition: ${sellerType} == 'pro-seller-wfs'
                          then:
                            - if:
                                identifier:
                                  present:
                                    - identifier: us.mappings.item.3P_ProSeller_WFS
                                then:
                                  - verifyIdentifier:
                                      present: 
                                        - identifier: us.mappings.item.3P_ProSeller_WFS
                                else:
                                    - executeFunction:
                                        name: us.functions.utils.scrollIfNotVisible
                                        params:
                                          - name: identifier
                                            string: us.mappings.item.3P_ProSeller_WFS
                                          - name: direction
                                            string: down
                                          - name: scrollPosition
                                            string: center
                                    - verifyIdentifier:
                                        present: 
                                          - identifier: us.mappings.item.3P_ProSeller_WFS
                          else:
                              - if:
                                  condition: ${sellerType} == '3p-wfs'
                                  then:
                                    - scroll: 
                                        direction: down
                                    - if:
                                        identifier:
                                          present:
                                            - identifier: us.mappings.item.3P_WFS
                                        then:
                                          - verifyIdentifier:
                                              present: 
                                                - identifier: us.mappings.item.3P_WFS
                                        else:
                                            - executeFunction:
                                                name: us.functions.utils.scrollIfNotVisible
                                                params:
                                                  - name: identifier
                                                    string: us.mappings.item.3P_WFS
                                                  - name: direction
                                                    string: up
                                                  - name: scrollPosition
                                                    string: center
                                            - verifyIdentifier:
                                                present: 
                                                  - identifier: us.mappings.item.3P_WFS

  - name: us.function.marketplace.contactSellerFromOrderDetails
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.orderDetails.marketplace.button.contactSeller
          then:
            - click:
                identifier: us.mappings.orderDetails.marketplace.button.contactSeller
            - click:
                identifier: us.mappings.contactSellerOptionAskAQuestion
            - click:
                identifier: us.mappings.orderDetails.contactSeller.sendButton
            - enterText:
                identifier: us.mappings.contactSellerMessageField
                string: ${message}
            - click:
                identifier: Done
            - click:
                identifier: us.mappings.contactSellerSendButton
          else:
            - verifyIdentifier:
                present:      
                  - identifier: us.mappings.cart.marketplace.sellerInfo
            - click: 
                wait: 2000
                identifier: us.mappings.cart.marketplace.sellerInfo
            - click:
                identifier: us.mappings.orderDetails.marketplace.button.contactSeller
            - verifyIdentifier:
                present:      
                  - identifier: us.mappings.contactSellerTitle
                  - identifier: us.mappings.contactSellerSendMessageToText
                  - identifier: us.mappings.contactSellerReasonForContactText
            - click:
                wait: 5000
                coordinates: 27,374
            - enterText:
                identifier: us.mappings.contactSellerMessageField
                string: ${message}
            - click:
                identifier: Done
            - click:
                identifier: us.mappings.contactSellerSendButton
      - if:
          identifier:
            present:
              - identifier: us.mappings.popup.technicalError
          then:    
              - log: Trying again due to technical error
              - click:
                  identifier: us.mappings.amend.confirmation.okay
              - click:
                  identifier: us.mappings.contactSellerSendButton
              - sleep:
                  duration: 2000
      - if:
          identifier:
            present:
              - identifier: us.mappings.contactSellerConfirmationText
          then:
            - verifyIdentifier:
                present: 
                  - identifier: us.mappings.contactSellerConfirmationText
          else:
            - failTest:
                message: FAILURE - ${env} - contact Seller Confirmation Text not visible
      - click:
          identifier: us.mappings.orderDetails.contactSeller.doneButton
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.orderDetails.navBarTitle
  
  - name: us.function.marketplace.contactSellerFromReturns
    platform: ios
    flow:
      - click:
          identifier: us.mappings.orderDetails.ContactSellerButton
      - verifyIdentifier:
          present:      
            - identifier: us.mappings.contactSellerTitle
            - identifier: us.mappings.contactSellerSendMessageToText
            - identifier: us.mappings.contactSellerReasonForContactText
      #      - identifier: us.mappings.initiateReturnText
      - enterText:
          identifier: us.mappings.contactSellerMessageField
          string: ${message}
      - click:
          identifier: us.mappings.default.keyboardDoneButton
      - click:
          identifier: us.mappings.contactSellerSendButton
      - sleep:
          duration: 2000
      - if:
          identifier:
            present:
              - identifier: us.mappings.popup.technicalError
          then:    
              - log: Trying again due to technical error
              - click:
                  identifier: us.mappings.amend.confirmation.okay
              - click:
                  identifier: us.mappings.contactSellerSendButton
              - sleep:
                  duration: 2000
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.contactSellerConfirmationText
          then:
            - failTest:
                message: "ENV_FAILURE - ${env} - Contact Seller Confirmation Not available "
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.contactSellerConfirmationText
      - click:
          identifier: us.mappings.item.contactSellerDoneButton 
      - verifyIdentifier:
          present: 
            - identifier:  us.mappings.returns.startReturnScreenHeader
  

  - name: us.functions.addNonWinningOfferItem
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.marketplace.compareSellerButton  
      - sleep: 
           duration: 2000
      - click:
          identifier: us.mappings.marketplace.compareSellerButton
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.item.moreSellerOptions
      - click:
          identifier: us.mappings.marketplace.compareSellerAddToCartButton
      - click:
          identifier: us.mappings.marketplace.moreSellersCloseButton
      # - sleep: 
      #      duration: 2000
      # - if:
      #     identifier:
      #       notPresent:
      #         - identifier: us.mappings.cartContainsOneItem
      #     then:
      #       - click: 
      #           identifier: us.mappings.cart.itemDecrementButton

  - name: us.functions.addNonWinningOfferItem.cartItemsPresent  #Joel added
    platform: ios
    flow:
    #  Scrool to More seller options
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.moreSellerOptions
            - name: direction
              string: down   
            - name: scrollPosition
              string: center  
      - verifyIdentifier:
           present: 
            - identifier: us.mappings.item.moreSellerOptions        
      - log: More seller options reached....
      - sleep: 
           duration: 2000    

    # Verify and click "Compare all sellers"    
      - if:
          identifier:
            present:
              - identifier: us.mappings.marketplace.compareSellerButton        
          then:
              - verifyIdentifier:
                  present: 
                    - identifier: us.mappings.marketplace.compareSellerButton 
              - log: lets click the Compare all sellers link...                 
              - click:
                  identifier: us.mappings.marketplace.compareSellerButton 
              - log: Compare all sellers link clicked

      # Verify we are on More seller option screen
              - verifyIdentifier:
                  present: 
                    - identifier: us.mappings.marketplace.compareSellerAddToCartButton

      # Verify Return detailse screen
              - click:
                  identifier: us.mappings.item.compareSeller.detailsButton
              - verifyIdentifier:
                  present: 
                    - identifier: us.mappings.item.compareSeller.returnPolicyHeader
                    - identifier: us.mappings.item.compareSeller.returnWithin
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.item.compareSeller.returnPolicyBackButton
                  then:
                    - click:  
                        identifier: us.mappings.item.compareSeller.returnPolicyBackButton
                  else:
                    - click:
                        identifier: us.mappings.global.closeButton
              
      # Add item to the card
              - click:
                  identifier: us.mappings.marketplace.compareSellerAddToCartButton
              - if:
                  identifier:
                    present:
                      - identifier: us.mapping.item.addWalmartProtectionPlan
                  then:
                    - click:
                        identifier: us.mapping.item.addWalmartProtectionPlan.closeButton 
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.marketplace.moreSellersCloseButton
                  then:
                    - click:
                        identifier: us.mappings.marketplace.moreSellersCloseButton
                  else:
                    - click:
                        identifier: us.mappings.buyNow.navigateback
              - sleep: 
                  duration: 2000
              - if:
                  identifier:
                    notPresent:
                      - identifier: us.mappings.cartContainsItem
                  then:
                    - click: 
                        identifier: us.mappings.cart.itemDecrementButton
          else:
            - failTest:
                message: FAILURE - ${env} - Compare seller link  not visible

  - name: us.functions.reviewSellerInfo.thenAdd.marketplaceItem  #Joel added on 11.1.21
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.orderDetails.marketplace.text.3P
            - name: direction
              string: down
            - name: scrollPosition
              string: center       
      - log: finished scrolling....
      - sleep: 
           duration: 2000
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.item.productsellerAndShipper
            - identifier: us.mappings.orderDetails.marketplace.text.3P         
            - identifier: us.mappings.orderDetails.marketplace.text.3P.sellerReviews  
      # - verifyValue:
      #      identifier: us.mappings.orderDetails.marketplace.text.sellerString.id
      #      contains: Sold by eForCity #Sold and shipped by                         
      - verifyIdentifier:
          label:
            - identifier: us.mappings.orderDetails.marketplace.text.3P.sellerReviews.id
              contains: seller reviews    
      - click:
         identifier: us.mappings.item.sellerInfoView
      - verifyIdentifier:
          timeout: 10000
          present: 
            - identifier: us.mappings.orderDetails.marketplace.text.sellerString.id
            - identifier: us.mappings.orderDetails.marketplace.button.contactSeller
            - identifier: us.mappings.orderDetails.marketplace.button.contactSeller.phoneNumber
      - sleep: 
           duration: 2000                 
      - click:  
          identifier: us.mappings.global.navigation.backNav.resourceId
      - executeFunction:
          name: us.functions.item.addItemToCart

  - name: us.functions.item.clickSellerInfoLinkUsingCoOrdinates 
    platform: ios
    flow:
      - click:      
          identifier: us.mappings.item.SellerInfoBoxView
          coordinates: 25%,10%
          longClick: true
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.orderDetails.marketplace.button.contactSeller
          then:
            - log : "Seller info page not loaded trying next combination of Coordinates"
            - click:      
                identifier: us.mappings.item.SellerInfoBoxView
                coordinates: 25%,35%
                longClick: true
            - sleep: 
                duration: 2000
            - if:
                identifier:
                  notPresent:
                    - identifier: us.mappings.orderDetails.marketplace.button.contactSeller
                then:
                  - log : "Seller info page not loaded trying next combination of Coordinates"
                  - click:      
                      identifier: us.mappings.item.SellerInfoBoxView
                      coordinates: 25%,65%
                      longClick: true
                  - sleep: 
                      duration: 2000
                  - if:
                      identifier:
                        notPresent:
                          - identifier: us.mappings.orderDetails.marketplace.button.contactSeller
                      then:
                        - log : "Seller info page not loaded trying next combination of Coordinates"
                        - click:      
                            identifier: us.mappings.item.SellerInfoBoxView
                            coordinates: 25%,95%
                            longClick: true

  - name: us.functions.item.mp.wfs.proSeller.atc  #Joel added on 11.4.21
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.marketplace.text.3P_ProSeller
            - name: direction
              string: down
            - name: scrollPosition
              string: center           
      - log: finished scrolling....
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.orderDetails.marketplace.text.3P_ProSeller_WFS 
            - identifier: us.mappings.item.productReturnInfoText.id         
            - identifier: us.mappings.orderDetails.marketplace.text.3P.sellerReviews.id 
          label:
            - identifier: us.mappings.orderDetails.marketplace.text.3P_ProSeller_WFS
              contains: Fulfilled by Walmart                           
      - verifyIdentifier:
          label:
            - identifier: us.mappings.orderDetails.marketplace.text.3P.sellerReviews.id 
              contains: seller reviews            
      # - click:
      #     identifier: us.mappings.item.SellerInfoBoxView
      #     coordinates: 25%,85%
      #     longClick: true
      # - log: Coordinates were clicked
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.viewSellerInfo
            - name: direction
              string: down
            - name: scrollPosition
              string: center    
      - click:
          identifier: us.mappings.item.viewSellerInfo
          coordinates: 25%,50%
      - sleep:
          duration: 5000  
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.item.ContactSellerButton
          then:
            - executeFunction:
                name: us.functions.item.mp.clickSellerNameLinkUsingCoOrdinates        
      - verifyIdentifier: # Assert Pro Sellers module for Returns info page
          timeout: 20000
          present: 
            - identifier: us.mappings.orderDetails.marketplace.text.sellerString.id
            # - identifier: us.mappings.orderDetails.returnInfo.mp.wfs.proSeller.module
            # - identifier: us.mappings.orderDetails.returnInfo.mp.wfs.proSeller.qualityText         
            # - identifier: us.mappings.orderDetails.returnInfo.mp.wfs.proSeller.consistentText
            # - identifier: us.mappings.orderDetails.returnInfo.mp.wfs.proSeller.freeOnlineText
      - verifyIdentifier: # Assert Returns and Contact module for Returns info page
          timeout: 20000
          present:
            # - identifier: us.mappings.item.productReturnInfoText                       
            # - identifier: us.mappings.item.productReturnInfoDetailsLink
            - identifier: us.mappings.orderDetails.marketplace.button.contactSeller
            - identifier: us.mappings.orderDetails.marketplace.button.contactSeller.phoneNumber
     # Return Policy page: TBD due to Bug with Details button   
      # - click:
      #     identifier: us.mappings.item.productReturnInfoDetailsButton  #us.mappings.item.productReturnInfoDetailsLink
      #     wait: 3000
      # - log: the button was clicked!    
      # - printPageSource:
      #     printToLog: true          
      # - verifyIdentifier:
      #     present: 
      #       - identifier: us.mappings.item.compareSeller.returnPolicyHeader
      #       - identifier: us.mappings.item.compareSeller.returnWithin
      #       - identifier: us.mappings.item.compareSeller.returnableToStore
      #       - identifier: us.mappings.item.compareSeller.returnPolicyStandards
      # - click:  
      #     identifier: us.mappings.global.navigation.backNav.resourceId            
      - click:  
          identifier: us.mappings.global.navigation.backNav.resourceId
      - executeFunction:
          name: us.functions.item.addItemToCart
      

  - name: us.functions.item.verifyPriceOptionsAndCustomPriceField
    platform: ios
    flow:
      - verifyIdentifier:
          timeout: 60000
          present:
            - identifier: us.mappings.item.priceOption1
            - identifier: us.mappings.item.priceOption2            
            - identifier: us.mappings.item.giftCardDefaultAmount
            - identifier: us.mappings.item.giftCardCustomerPriceField

  - name: us.functions.item.validateMPProsellerItems
    platform: ios
    flow:
      - storeIn:
          key: atcbutton
          value: false    
      - loop:
          each: ${itemList}
          storeElement: items
          storeIndex: itemIndex
          flow:
              - executeFunction:
                  name: us.functions.global.navigation.goToDeepLink
                  params:
                    - name: deepLinkUrl
                      string: walmart://item/$items
              - sleep: 
                  duration: 5000
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.item.addToCartButton
                  then:
                    - log: 'Add to cart button is present'
                    - executeFunction:
                        name: us.functions.item.marketplace.verifySellerType
                    - executeFunction:
                        name: us.functions.item.addItemToCart
                    - storeIn:
                        key: atcbutton
                        value: true                            
                    - break: true
                  else:  
                    - executeFunction:
                        name: us.functions.item.closeItemPage

  - name: us.functions.item.verifyPriceFields
    platform: ios
    flow:
      - executeFunction:
            name: us.functions.utils.scrollIfNotVisible
            params:
              - name: identifier
                string: us.mappings.item.giftCardCustomerPriceField
              - name: direction
                string: down
      - executeFunction:
          name: us.functions.item.verifyPriceOptionsAndCustomPriceField
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.giftCardDefaultAmount
          label:
            - identifier: us.mappings.item.giftCardDefaultAmount
              equals: Amount, currently selected $50

  - name: us.functions.item.enterCustomAmount
    platform: ios
    flow:
      - if:
          identifier:
           notPresent:
            - identifier: us.mappings.item.giftCardCustomerPriceField
          then:
          - scroll:
              direction: down
              untilIdentifier: us.mappings.item.giftCardCustomerPriceField
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.giftCardDefaultAmount
          label:
            - identifier: us.mappings.item.giftCardDefaultAmount
              equals: Amount, currently selected $50
      - enterText:
          identifier: us.mappings.item.giftCardCustomerPriceField
          string: ${amount}
      - click: 
          wait: 2000
          identifier: us.mappings.default.keyboardDoneButton
      - verifyIdentifier:
          label:
            - identifier: us.mappings.item.productPrimaryPrice
              contains: $${amount}
      - getString:
          identifier: us.mappings.item.productPrimaryPrice
          attribute: label
          storeIn: giftCardPrice
      - log: $giftCardPrice

  - name: us.functions.item.deepLink.checkItemAvailable
    platform: ios
    flow:
      - storeIn:
          key: failedItems
          value: 'Items used : '
      - loop:
          each: ${itemArray}
          storeElement: items
          storeIndex: itemIndex
          flow:
              - executeFunction:
                  name: us.functions.global.navigation.goToDeepLink
                  params:
                    - name: deepLinkUrl
                      string: walmart://item/$items
              - sleep: 
                  duration: 5000  
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.item.addToCartButton
                  then:
                    - log: "$items Item available"
                    - break: true
                  else:
                    - log: $items Not Available.
                    - storeIn:
                        key: failedItems
                        value: ${failedItems} , $items
      - storeIn:
          key: itemDataDetails
          value: ${failedItems}

  - name: us.functions.item.ad.validateBuyboxAdview
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.ad.buyboxFulfillmentInfo
            - name: direction
              string: down
            - name: scrollPosition
              string: center    
      # - scroll:
      #     direction: down
      #     untilIdentifier: us.mappings.item.ad.buyboxFulfillmentInfo 
      #     position: center
      #     timeout: 600000                        
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.buyboxAd 
            - identifier: us.mappings.item.ad.buyboxRatings
            - identifier: us.mappings.item.ad.buyboxReviews
            - identifier: us.mappings.item.ad.buyboxFulfillmentInfo
            - identifier: us.mappings.item.ad.buyboxSponsoredLabel
          label:
            - identifier: us.mappings.item.ad.buyboxSponsoredLabel
              contains: us.data.sbaAd.prod.textSponsored
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.item.ad.buyboxad.ATCbutton
          then:
            - log: 'Button present'
            - click:
                identifier: us.mappings.item.ad.buyboxad.ATCbutton
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.item.ad.SpCarouselads.ATCQuantityListView
                then:
                  - click:
                      identifier: us.mappings.item.ad.SpCarouselads.ATCQuantityListViewSelectedQuatity

     # Verify Buybox ad Item stepper
      - executeFunction:
          name: us.functions.itemPage.verifyStepper

    #Clicking on Buybox ad Item
      - click: 
          identifier: us.mappings.item.ad.buyboxAd        
      - verifyIdentifier:
          timeout: 50000
          present:
            #- identifier: us.mappings.item.sponsored.item.brandName
            #- identifier: us.mappings.item.ad.SponsoredAd.item.title
            - identifier: us.mappings.item.sponsored.ratings
      # - click: 
      #     identifier: us.mappings.item.ad.SponsoredAd.item.close

  - name: us.functions.item.visionItem.verifyItemPage
    platform: ios
    flow:
      - storeIn:
          key: executionStage
          value: Transactions
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.verifySeeHow
            - name: direction
              string: down
            - name: scrollPosition
              string: center        
      - verifyIdentifier:
          timeout: 70000
          present:
            - identifier: us.mappings.item.SaveMoneyOnPrescription
            - identifier: us.mappings.item.verifySeeHow 
            - identifier: us.mappings.item.verifyMakeTheseFramesYourOwn
            # - identifier: us.mappings.item.verifyCustomizeFrameDetails             
      - click:
          identifier: us.mappings.item.verifySeeHow
      - verifyIdentifier:
          timeout: 70000
          present:
            - identifier: us.mappings.item.arrivesWithinBusinessDays
            - identifier: us.mappings.item.selectYourFrameAndLenses
            - identifier: us.mappings.item.framesSheetGotIt
      - click:
          identifier: us.mappings.item.framesSheetGotIt                    
      - verifyIdentifier:
          present:
            # - identifier: us.mappings.item.verifyFSAandHSA
            - identifier: us.mappings.item.free90daysReturns  
      
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.twentyPercentPromo 
          then:    
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.twentyPercentPromo
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.visionItem.PercentPromoT&CLink
                  - name: direction
                    string: down
                  - name: scrollPosition
                    string: center             
            - click:
                identifier: us.mappings.visionItem.PercentPromoT&CLink
                wait: 2000
            - log: Verifying percent promo bottom sheet                
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.visionItem.PercentPromoBottomsheetTitle
                  - identifier: us.mappings.visionItem.PercentPromoBottomsheetGotIt
                  # - identifier: us.mappings.visionItem.PercentPromoBottomsheetBackBtn
                  - identifier: us.mappings.visionItem.PercentPromoBottomsheetCloseBtn                  
            - click:
                identifier: us.mappings.visionItem.PercentPromoBottomsheetGotIt  
          else:
            - log: 20% Promo is not visible        

  - name: us.functions.item.visionItem.verifySelectLenses
    platform: ios
    flow:
      - storeIn:
          key: executionStage
          value: Transactions                                 
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.verifySelectLensesCTA
      - click: 
          identifier: us.mappings.item.verifySelectLensesCTA
      - if:
          condition: ${skipValidation} == true
          then:
            - log: Skipping validation for faster execution 
          else:
            - verifyIdentifier:
                timeout: 60000
                present:
                  - identifier: us.mappings.item.verifySelectYourLensesTitle      #single vision  
                  - identifier: us.mappings.item.verifySingleVisionLense
                  - identifier: us.mappings.item.verifyWhat'sYourPrescriptionType
                  - identifier: us.mappings.item.verifySubTotalText                 
                  - identifier: us.mappings.item.continueButton 
                  - identifier: us.mappings.item.closeItemDetailsPage             
      - click: 
          identifier: us.mappings.item.verifySingleVisionLense
      - click: 
          identifier: us.mappings.item.continueButton       
      - if:
          condition: ${itemType} == 'Eyeglasses'       
          then:
            - log: Selecting Lense
            - if:
                condition: ${skipValidation} == true
                then:
                  - log: Skipping validation for faster execution 
                else:
                  - verifyIdentifier:
                      timeout: 60000
                      present:
                        - identifier: us.mappings.item.verifyWhatTypesOfLesesYouNeed     
                        - identifier: us.mappings.item.verifyClearOption        
                        - identifier: us.mappings.item.verifySunGlassesOption 
                      # - identifier: us.mappings.item.verifyLightReactiveOption  #available for itemId 461870591
                        - identifier: us.mappings.item.verifySubTotalText                
                        - identifier: us.mappings.item.continueButton 
                        - identifier: us.mappings.item.closeItemDetailsPage             
            - if:
                condition: ${lensetype} == 'Lense A'
                then:
                  - log: Selecting 'Clear' option
                  - click: 
                     identifier: us.mappings.item.verifyClearOption
                else:
                  - if:
                      condition: ${lensetype} == 'Lense B'
                      then:
                        - log: Selecting 'Sunglasses' option
                        - click:
                            identifier: us.mappings.item.verifySunGlassesOption
                      else:
                        - if:
                            condition: ${lensetype} == 'Lense C'
                            then:
                              - log: Selecting 'Light Reactive' option
                              - click:
                                  identifier: us.mappings.item.verifyLightReactiveOption                       
            - click: 
               wait: 2000
               identifier: us.mappings.item.continueButton
          else:
            - if:
                condition: ${itemType} == 'Sunglasses'       
                then:
                  - log: Skipping lenseType selection for sunglasses
                  - if:
                      identifier:
                        present:
                          - identifier: us.mappings.item.verifySunGlassesOption
                      then:
                        - click:
                            identifier: us.mappings.item.verifySunGlassesOption
                        - click: 
                            wait: 2000
                            identifier: us.mappings.item.continueButton
      - if:
          condition: ${skipValidation} == true
          then:
            - log: Skipping validation for faster execution 
          else:
            - verifyIdentifier:
                present:
                  #- identifier: us.mappings.item.verifyWhatLenseMaterialWorkForYou        
                  # - identifier: us.mappings.item.verifyStandardOption        #Lens Material available for itemId 461870591
                  # identifier: us.mappings.item.verifySunPolyCarbonateOption
                  # - identifier: us.mappings.item.verifyHiIndexOption         #available for itemId 461870591
                  - identifier: us.mappings.item.verifySubTotalText                             
                  - identifier: us.mappings.item.continueButton
    # select LenseMaterial in params options (Polycarbonate , Hi-index, Standard)
      - if:
          condition: ${LenseMaterial} == 'Standard'
          then:
            - click:
                identifier: us.mappings.item.standard #us.mappings.item.selectedLenseMaterial        
            - click: 
                identifier: us.mappings.item.continueButton
          else:
            - click:
                identifier: us.mappings.item.verifySunPolyCarbonateOption       
            - click: 
                identifier: us.mappings.item.continueButton
            - if: 
                condition: ${option} == 'StandardPolycarbonate'
                then: 
                  - log: Selecting  "standard polycarbonate"
                  - click:          
                      identifier: us.mappings.item.standardPolycarbonate.title
                  - click:
                      identifier: us.mappings.item.continueButton
            - if: 
                condition: ${option} == 'PremiumPolycarbonate'
                then: 
                  - log: Selecting  "premium polycarbonate"
                  - click:          
                      identifier: us.mappings.item.premiumPolycarbonate.title
                  - click:
                      identifier: us.mappings.item.continueButton
            - if: 
                condition: ${option} == 'Standard hi-index'
                then: 
                  - log: Selecting  "Standard hi-index"
                  - click:          
                      identifier: us.mappings.item.standardHiIndex.title
                  - click:
                      identifier: us.mappings.item.continueButton

      - if:
          condition: ${LenseColor} == 'Copper'               
          then:
            - click:          
                identifier: us.mappings.item.color.copper
            - click: 
                identifier: us.mappings.item.continueButton
          else:
            - if:
                condition: ${LenseColor} == 'Grey'
                then:
                  - click:
                      identifier: us.mappings.item.color.grey   
                  - click: 
                      identifier: us.mappings.item.continueButton
      - if:
          condition: ${skipValidation} == true
          then:
            - log: Skipping validation for faster execution 
          else:                             
            - verifyIdentifier:
                timeout: 15000
                present:
                  - identifier: us.mappings.item.verifyAnythingWantToAdd       
                  - identifier: us.mappings.item.noAddOn # us.mappings.item.verifyNoAddOns        #Ad-ons
                  # - identifier: us.mappings.item.verifyAntiRefective
                  # - identifier: us.mappings.item.verifyAntiRefecticveWithBlueLight
                  - identifier: us.mappings.item.verifySubTotalText                           
                  - identifier: us.mappings.item.continueButton
      # select add-ons in params options (No add-ons , Anti-reflective, Anti-reflective with blue light)
      - click:
          identifier: us.mappings.item.selectedAddOns 
      - click: 
          identifier: us.mappings.item.continueButton
      - if:
          condition: ${skipValidation} == true
          then:
            - log: Skipping validation for faster execution 
          else:  
            - verifyIdentifier:
                timeout: 15000
                present:
                  - identifier: us.mappings.item.verifyReviewYourSelectionTitle     
                  - identifier: us.mappings.item.verifyEverythingLookRight
                  - identifier: us.mappings.item.verifyFramesText
                  - identifier: us.mappings.item.verifyLensesText
                  - identifier: us.mappings.item.verifySubTotalTitle
                  # - identifier: us.mappings.item.verifyAddPrescriptionCTA                         
                  # - identifier: us.mappings.item.verifyAddToCartCTA
                  
  - name: us.functions.item.visionItem.AddPrescription
    platform: ios
    flow:
      - storeIn:
          key: executionStage
          value: Transactions
      - try:
          flow:
            - verifyIdentifier:
                timeout: 0
                present:
                  - identifier: us.mappings.cart.smartNudgeViewClose
            - click:
                identifier: us.mappings.cart.smartNudgeViewClose
          catch:
            flow:
              - log: No smart Nudge View pop up
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.item.verifyAddPrescriptionCTA
          then: 
            - scroll:
                direction: down
                untilIdentifier: us.mappings.item.verifyAddPrescriptionCTA
                position: center
                scrollLimit: 3
      - click:
          identifier: us.mappings.item.verifyAddPrescriptionCTA
      - sleep:
          duration: 3000          
      - if:
          condition: ${name} == 'PatientA'
          then:
            - log: Selecting 'PatientA - Native Test'
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.visionItem.prescriptionName   
                then:
                  - click:          
                      identifier: us.mappings.visionItem.prescriptionName
                  - click:
                      identifier: us.mappings.item.privacyPolicyCheckBox
                  - click:
                      identifier: us.mappings.item.continueButton
                  - enterText:
                      identifier: us.mappings.visionItem.prescriptionDob
                      string: ${dob}
                  - if: 
                      identifier:
                        present: 
                          - identifier: us.mappings.item.addPrescription.done
                      then:
                        - click:
                            identifier: us.mappings.item.addPrescription.done
                  - click:
                      identifier: us.mappings.item.prescriptionFooter.continueButton
                else:
                  - enterText:
                      identifier: us.mappings.visionItem.addPatient.firstName
                      string: VisionA              
                  - enterText:
                      identifier: us.mappings.visionItem.addPatient.lastName
                      string: Test
                  - if: 
                      identifier:
                        present: 
                          - identifier: us.mappings.item.addPrescription.done
                      then:
                        - click:
                            identifier: us.mappings.item.addPrescription.done   
                  - enterText:
                      identifier: us.mappings.visionItem.addPatient.dob
                      string: ${dob}
                  - if: 
                      identifier:
                        present: 
                          - identifier: us.mappings.item.addPrescription.done
                      then:
                        - click:
                            identifier: us.mappings.item.addPrescription.done   
                  - click:
                      identifier: us.mappings.item.privacyPolicyCheckBox
                  - click:
                      identifier: us.mappings.item.continueButton
          else:
            - if:
                condition: ${name} == 'PatientB'
                then:
                  - log: Selecting 'PatientB - Vision Test'
                  - if:
                      identifier:
                        present:
                          - identifier: us.mappings.visionItem.addPrescription.addPatient
                      then:
                        - click:          
                            identifier: us.mappings.visionItem.addPrescription.addPatient
                  - enterText:
                      identifier: us.mappings.visionItem.addPatient.firstName
                      string: Vision              
                  - enterText:
                      identifier: us.mappings.visionItem.addPatient.lastName
                      string: Test
                  - if: 
                      identifier:
                        present: 
                          - identifier: us.mappings.item.addPrescription.done
                      then:
                        - click:
                            identifier: us.mappings.item.addPrescription.done   
                  - enterText:
                      identifier: us.mappings.visionItem.addPatient.dob
                      string: ${dob}   
                  - if: 
                      identifier:
                        present: 
                          - identifier: us.mappings.item.addPrescription.done
                      then:
                        - click:
                            identifier: us.mappings.item.addPrescription.done   
                  - click:
                      identifier: us.mappings.item.privacyPolicyCheckBox                 
                  - click:
                      identifier:  us.mappings.item.prescriptionFooter.continueButton 
      - executeFunction:
         name: us.functions.item.addVisionPDImage        
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.addAPrescription.replaceImage                 
      - click:
          identifier: us.mappings.item.prescriptionFooter.continueButton
      - sleep:
         duration: 5000
      - click:
          identifier: us.mappings.visionItem.termsAndConditionChechBox         
      - click:
          identifier: us.mappings.visionItem.manuallyEnterPDLink
      - click:
          identifier: us.mappings.visionItem.prescriptionPD
      - enterText:
          identifier: us.mappings.search.fitment.pickerWheel
          string: ${PD}
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.item.addPrescription.done
          then:
            - click:
                identifier: us.mappings.item.addPrescription.done             
      - click:
          identifier: us.mappings.item.prescriptionFooter.continueButton
      - sleep:
         duration: 3000
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.prescriptionFooter.continueButton
          then:
            - click:
                identifier: us.mappings.item.prescriptionFooter.continueButton
      - sleep:
         duration: 5000
#      - if:
#          condition: ${cartPage}
#          then:
#            - verifyIdentifier:
#                present:
#                  - identifier: us.mappings.cart.verifyPrescriptionAdded
#          else:      
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.verifyYouHaveAddedPrescriptionText

  - name: us.functions.item.visionItem.verifyRestrictedAddressText
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.switching.fulfillment.shippingText
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - click:
          identifier: us.mappings.item.switching.fulfillment.shippingText     
      - sleep:
         duration: 2000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.vision.restrictedAdressText     
      - getString:
          identifier: us.mappings.item.vision.restrictedAdressText
          attribute: label
          storeIn: restrictedAdressText
      - log: $restrictedAdressText text is displayed on item page          

####################################################### Android ################################################

  - name: us.functions.item.selectVariants
    platform: android
    flow:
      - sleep:
          duration: 5000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.variant.colour
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.variant.colour
      - click:
          identifier: us.mappings.item.variant.colour
      - sleep:
          duration: 3000
      - getString:
          identifier: us.mappings.item.variant.selectedVariantTitle
          attribute: text
          storeIn: itemColour
      - log: $itemColour
      - sleep:
          duration: 5000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.itemPage.secondVariantsContainer 
            - name: direction
              string: down
            - name: scrollPosition
              string: center          
      - scroll:
          direction: right
          untilIdentifier: us.mappings.item.variant.size
          withinIdentifier: us.mappings.itemPage.secondVariantsContainer        
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.variant.size
      - click:
          identifier: us.mappings.item.variant.size
      - sleep:
          duration: 7000
      - getString:
          identifier: us.mappings.item.variant.selectedVariantSizeTitle
          attribute: text
          storeIn: itemSize
      - log: $itemSize
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.variant.width
          then:      
              - verifyIdentifier:
                  present:
                    - identifier: us.mappings.item.variant.width
              - click:
                  identifier: us.mappings.item.variant.width
              - sleep:
                  duration: 5000
              - getString:
                  identifier: us.mappings.item.variant.width
                  attribute: text
                  storeIn: itemWidth
              - log: $itemWidth
              - sleep:
                  duration: 5000

  - name: us.functions.item.selectVariants.verifySizeChart
    platform: android
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.vision.sizeGuide
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - click:
          identifier: us.mappings.item.vision.sizeGuide
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.vision.sizeGuideBottomSheet
          then:
            - click:
                identifier: us.mappings.item.vision.sizeGuideBottomSheet
            - click:
                identifier: us.mappings.returns.returnReasonFirstOption
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.item.vision.sizeGuideTableView
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.measuringGuideViewImage
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.item.measuringGuideViewImage
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.vision.sizeGuide.backButton
          then:
            - click:
                identifier: us.mappings.item.vision.sizeGuide.backButton
          else:
            - click:
                identifier: us.mappings.global.closeButton

  # Verify petrx item prescription badge
  - name: us.functions.item.petrxItem.verifyPresent
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 40000
          present:
            - identifier: us.mappings.itemPage.petRXitemName
      - sleep:
          duration: 2000
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.productPrimaryPrice
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.petrxprescriptionBadge
          position: center
          scrollLimit: 1
      - verifyIdentifier:
          timeout: 40000
          present:
            - identifier: us.mappings.item.petrxprescriptionBadge
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.productPrimaryPrice
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.productPrimaryPrice          
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.pickupNotAvailable
      # Verify Pickup availability
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.pickupNotAvailable
          then:
            - log: "Pickup not available for petrx items"

      # - scroll:
      #     direction: down
      #     untilIdentifier: us.mappings.item.petrxpickupna
      # - if:
      #     identifier:
      #       present:
      #         - identifier: us.mappings.item.petrxpickupna
      #     then:
      #       - log: "Pet Rx item present as expected"
      #     else:
      #       - failTest:
      #           message: "ENV_FAILURE - ${env} - Pet Rx item not present as expected"


# Verify petrx item prescription badge
  - name: us.functions.item.petrxItem.virtualPack
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.itemPage.petRXitemName
            - identifier: us.mappings.item.petrxprescriptionBadge
#Virtual Pack size
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.petrxVirtualpacktabletcount15
      - click:
          identifier: us.mappings.item.petrxVirtualpacktabletcount15
      #Petrx Virtual Pack tablet form
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.item.petrxVirtualpacktabletform
      # - click:
      #     identifier: us.mappings.item.petrxVirtualpacktabletform
          #Petrx Virtual Pack tablet count ( Not available)
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.item.petrxVirtualpacktabletcount60
      # - click:
      #     identifier: us.mappings.item.petrxVirtualpacktabletcount60
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.productPrimaryPrice
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.productPrimaryPrice
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.pickupNotAvailable
      # Verify Pickup availability
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.pickupNotAvailable
          then:
            - log: "Pickup not available for petrx items"


  # Verify vision item buy in store badge
  - name: us.functions.item.visionItem.verifyPresent
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: us.mappings.item.productNameTileGeneric
            - identifier: us.mappings.item.prescriptionBadge
            - identifier: us.mappings.item.visionBuyInStoreBadge
          notPresent:
            - identifier: us.mappings.buyNow.buyNowButton
            - identifier: us.mappings.item.addToCartButton
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.productDetails
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.productDetails
      - scroll:
          direction: up
          untilIdentifier: us.mappings.item.productNameTileGeneric
  
  - name: us.functions.item.visionItem.verifySizeChart
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.vision.sizeGuide
      - click:
          identifier: us.mappings.item.vision.sizeGuide
      - verifyIdentifier:
          timeout: 3000
          present:
            - identifier: us.mappings.item.vision.sizeGuideBottomSheet
      - click:
          identifier: us.mappings.item.vision.sizeGuide.backButton
  
  - name: us.functions.item.visionItem.verifyBuyInStoreCTA
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.visionBuyInStoreBadge
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.visionBuyInStoreBadge
      - click:
          identifier: us.mappings.item.visionBuyInStoreBadge
      - verifyIdentifier:
          timeout: 3000
          present:
            - identifier: us.mappings.item.vision.buyInStoreBottomSheet
            - identifier: us.mappings.item.vision.buyInStoreContinueButton
      - click:
            identifier: us.mappings.item.vision.buyInStoreContinueButton
      - verifyIdentifier:
          timeout: 6000
          present:
            - identifier: us.mappings.item.vision.storeDetail
      - log: Continued to website 
  
  - name: us.functions.item.visionItem.verifyChangeStoreCTA
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.vision.buyInStoreChangeButton
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.visionBuyInStoreLabel
            - identifier: us.mappings.item.vision.buyInStoreChangeButton
      - click:
          identifier: us.mappings.item.vision.buyInStoreChangeButton
      - verifyIdentifier:
          timeout: 10000
          present:
            - identifier: us.mappings.home.selectStoreTextField
      - click: 
          identifier: us.mappings.reserveSlot.selectStore.saveButton
      - sleep:
          duration: 5000
      - verifyIdentifier:
         present:
           - identifier: us.mappings.item.visionBuyInStoreLabel

  - name: us.functions.item.validateFitmentDetails
    platform: android
    flow:
      - sleep:
          duration: 6000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.fitmentDetails
            - name: direction
              string: down
            - name: scrollPosition
              string: center  
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.fitmentIcon
            # - identifier: us.mappings.item.fitmentStatusMessage
            - identifier: us.mappings.item.fitmentDetails
            - identifier: us.mappings.item.fitmentDetailsChangeButton

  - name: us.functions.item.closeItemDetailsPage
    platform: android
    flow:
      - click:
          wait: 3000
          identifier: us.mappings.item.closeButton

  - name: us.functions.item.verifyPriceOptionsAndCustomPriceField
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.priceOption1
            - identifier: us.mappings.item.priceOption2            
            - identifier: us.mappings.item.giftCardDefaultAmount
            - identifier: us.mappings.item.giftCardCustomerPriceField

  - name: us.functions.item.verifyPriceFields
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.giftCardCustomerPriceField
      - executeFunction:
          name: us.functions.item.verifyPriceOptionsAndCustomPriceField
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.giftCardDefaultAmount
          text:
            - identifier: us.mappings.item.giftCardDefaultAmount
              equals: $50

  - name: us.functions.item.enterCustomAmount
    platform: android
    flow:
      - if:
          identifier:
           notPresent:
            - identifier: us.mappings.item.giftCardCustomerPriceField
          then:
          - scroll:
              direction: down
              untilIdentifier: us.mappings.item.giftCardCustomerPriceField
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.giftCardDefaultAmount
          text:
            - identifier: us.mappings.item.giftCardDefaultAmount
              equals: $50
      - enterText:
          identifier: us.mappings.item.giftCardCustomerPriceField
          string: ${amount}
      - if:
          identifier:
            present:
              - identifier: us.mappings.tipping.custom.numpad.doneButton
          then:
            - click:
                identifier: us.mappings.tipping.custom.numpad.doneButton
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.giftCardAddtoCartDefaultAmount
          then:
            - click:
                coordinates: 1696,2104
      - verifyIdentifier:
          text:
            - identifier: us.mappings.item.stickyATC.productPrimaryPrice
              contains: ${amount}
      - getString:
          identifier: us.mappings.item.stickyATC.productPrimaryPrice
          attribute: text
          storeIn: giftCardPrice
      - log: $giftCardPrice

  # function to verify bought before 
  - name: us.functions.item.boughtBefore.verifyPresent
    platform: android
    flow:
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.item.broughtBefore.label
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.item.broughtBefore.date  

     ####### market place ##################

  - name: us.functions.item.marketplace.verifySellerType
    platform: android
    flow:
      - sleep: 
           duration: 3000
      - scroll:
          direction: down
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.showShippingDeliveryAndPickupOptionsButton
          then:
            - click:
                identifier: us.mappings.item.showShippingDeliveryAndPickupOptionsButton  

      - if:
          identifier:
            present:
              - identifier: us.mappings.wplus.itempage.freeshippinglabel
          then:

            - click:
                identifier: us.mappings.wplus.itempage.freeshippinglabel
      - scroll:
          direction: down
          untilIdentifier:  us.mappings.itemPage.addToListOption
      # - executeFunction:
      #     name: us.functions.utils.scrollIfNotVisible
      #     params:
      #       - name: identifier
      #         string: us.mappings.itemPage.addToListOption
      #       - name: direction
      #         string: down
      #       - name: scrollPosition
      #         string: center    
      - if:
          identifier:
            present:
              - identifier: us.mappings.wplus.itempage.freeshippinglabel
          then:

            - click:
                identifier: us.mappings.wplus.itempage.freeshippinglabel
                
      - if: 
          condition: ${sellerType} == 'pro-seller'
          then:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.sellerInfo
            - log: "Verified pro-seller"
          else:
              - if:
                  condition: ${sellerType} == '3p'
                  then:
                    - verifyIdentifier:
                        present:
                          - identifier: us.mappings.item.sellerInfo
                    - log: "Verified 3p"
                  else:
                      - if:
                          condition: ${sellerType} == 'pro-seller-wfs'
                          then:
                             - scroll:
                                direction: down
                                untilIdentifier:  us.mappings.item.3P_ProSeller_WFS
                             - verifyIdentifier:
                                present:
                                  - identifier: us.mappings.item.3P_ProSeller_WFS
                             - log: "Verified pro-seller-wfs"
                          else:
                              - if:
                                  condition: ${sellerType} == '3p-wfs'
                                  then:
                                    - verifyIdentifier:
                                        present: 
                                          - identifier: us.mappings.item.3P_WFS
                                    - log: "Verified 3p-wfs"
      # - scroll:
      #     direction: up
      #     untilIdentifier: us.mappings.item.productNameTileGeneric
                                      
    
  - name: us.function.marketplace.contactSellerFromOrderDetails
    platform: android
    flow:
      - sleep: 
           duration: 3000
      - scroll:
         direction: down
         untilIdentifier: us.mappings.orderDetails.ContactSellerButton
      - click:
          identifier: us.mappings.orderDetails.ContactSellerButton
      - verifyIdentifier:
          present:      
            - identifier: us.mappings.contactSellerTitle
            - identifier: us.mappings.contactSellerSendMessageToText
            - identifier: us.mappings.contactSellerReasonForContactText
      - click:
          identifier: us.mappings.contactSellerOptionWhereIsMyOrder
      - click:
          identifier: us.mappings.contactSellerNextButton
      - enterText:
          identifier: us.mappings.contactSellerMessageField
          string: ${message}
          pressEnter: true
      - goBack: true
      - click:
          identifier: us.mappings.contactSellerSendButton
      - sleep:
          duration: 2000
      - if:
          identifier:
            present:
              - identifier: us.mappings.contactSellerMessageError
          then:    
              - log: Trying again due to technical error
              - click:
                  identifier: us.mappings.contactSellerSendButton
              - sleep:
                  duration: 2000
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.contactSellerConfirmationText
      - click:
          identifier: us.mappings.contactSellerDoneButton
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.orderDetails.navBarTitle

  - name: function.marketplace.verifySellerPageAndSendMesssage
    platform: android
    flow:
      - verifyIdentifier:
          present:      
            - identifier: us.mappings.contactSellerTitle
            - identifier: us.mappings.contactSellerSendMessageToText
            - identifier: us.mappings.contactSellerReasonText
            - identifier: us.mappings.contactSellerReasonForContactText
      - enterText:
          identifier: us.mappings.contactSellerMessageField
          string: ${message}
      - hideKeyboard: true
      - click:
          wait: 2000
          identifier: us.mappings.contactSellerSendButton 
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.contactSellerConfirmationText
          text:
            - identifier: us.mappings.contactSellerConfirmationText
              contains: Your message has been sent!
      - click:
          identifier: us.mappings.contactSellerDoneButton

  - name: us.functions.addNonWinningOfferItem
    platform: android
    flow:
      - sleep:
           duration: 10000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.marketplace.compareSellerButton
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - click:
          identifier: us.mappings.marketplace.compareSellerButton
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.moreSellerPageTitle
      - click:
          identifier: us.mappings.marketplace.compareSellerAddToCartButton
      - click:
          identifier: us.mappings.marketplace.moreSellersCloseButton

  - name: function.marketplace.contactSellerFromReturns
    platform: android
    flow:
      - click:
          identifier: us.mappings.returns.ContactSellerButton
      - verifyIdentifier:
          present:      
            - identifier: us.mappings.contactSellerTitle
            - identifier: us.mappings.contactSellerSendMessageToText
            - identifier: us.mappings.contactSellerReasonForContactText
            - identifier: us.mappings.returns.contactSellerInitiateReturnText
      - enterText:
          identifier: us.mappings.contactSellerMessageField
          string: ${message}
      - goBack: true
      - click:
          identifier: us.mappings.contactSellerSendButton
      - sleep:
          duration: 5000
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.contactSellerConfirmationText
      - click:
          identifier: us.mappings.contactSellerDoneButton
      - verifyIdentifier:
          present: 
            - identifier:  us.mappings.returns.startReturnScreenHeader


  - name: us.functions.item.validateMPProsellerItems
    platform: android
    flow:
      - storeIn:
          key: atcbutton
          value: false    
      - loop:
          each: ${itemList}
          storeElement: items
          storeIndex: itemIndex
          flow:
              - executeFunction:
                  name: us.functions.global.navigation.goToDeepLink
                  params:
                    - name: deepLinkUrl
                      string: walmart://item/$items
              - sleep: 
                  duration: 5000
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.item.addToCartButton
                  then:
                    - log: 'Add to cart button is present'
                    - executeFunction:
                        name: us.functions.item.marketplace.verifySellerType
                    - executeFunction:
                        name: us.functions.item.addItemToCart
                    - storeIn:
                        key: atcbutton
                        value: true                            
                    - break: true
                  else:  
                    - executeFunction:
                        name: us.functions.item.closeItemPage                                                  
      - if:
          condition: ${atcbutton} != true
          then:
            - failTest:
                message: "DATA_FAILURE - ${env} - No MP Proseller items are present"                          

  - name: us.functions.addNonWinningOfferItem.cartItemsPresent  #Joel added
    platform: android
    flow:
# Scroll to 
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.marketplace.compareSellerButton
            - name: direction
              string: down  
      - verifyIdentifier:
           present: 
            - identifier: us.mappings.marketplace.compareSellerButton        
      - log: More seller options reached....
      - sleep: 
           duration: 2000  

      # Verify and click "Compare all sellers"
      - log: lets click the Compare all sellers link...   
      - click:
          identifier: us.mappings.marketplace.compareSellerButton
      - log: Compare all sellers link clicked

      # Add item to cart
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.marketplace.compareSellerAddToCartButton      
      - click:
          identifier: us.mappings.marketplace.compareSellerAddToCartButton
      - sleep: 
           duration: 2000

      - if:
          identifier:
            present:
              - identifier: us.mappings.item.closeButton       
          then:               
              - click: 
                 identifier: us.mappings.item.closeButton

  - name: us.functions.reviewSellerInfo.thenAdd.marketplaceItem  #Joel added on 11.1.21
    platform: android
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.orderDetails.sellerReviewsStars.module
            - name: direction
              string: down
            - name: scrollPosition
              string: center 
      - log: finished scrolling....
      - sleep: 
           duration: 2000
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.fulfillment.showShippingDeliveryPickup.button
          then:
            - click: 
                identifier: us.mappings.item.fulfillment.showShippingDeliveryPickup.button
            - log: Fulfillment options field was suppressed.    
          else:
            - log: Fulfillment options field is not suppressed.  

      - scroll:
          direction: down
          untilIdentifier: us.mappings.orderDetails.sellerTitle  #mappings.orderDetails.sellerTitle
          position: center 

      - verifyIdentifier:
          present: 
            - identifier: us.mappings.orderDetails.sellerTitle 
            - identifier: us.mappings.orderDetails.sellerReviewsStars        
            - identifier: us.mappings.orderDetails.sellerReviewsStars.module 
          text:
            - identifier: us.mappings.orderDetails.sellerTitle 
              contains: Sold by                        
          text:
            - identifier: us.mappings.orderDetails.sellerReviewsStars.count 
              contains: seller review
      # The steps to review seller details is blocked as xpath and resourceID are not tappable atm.  Ticket: OAMD-889    
      # - click:
      #     identifier: us.mappings.marketplace.sellerTitle
      #     wait: 3000        
      # - verifyIdentifier:
      #     timeout: 10000
      #     present: 
      #       - identifier: us.mappings.marketplace.contactSellerName    
      #       - identifier: us.mappings.item.productReturnInfoText 
      #       - identifier: us.mappings.item.marketplace.contactSellerTitle 
      #       - identifier: us.mappings.item.marketplace.contactSellerPhoneNumber 
      #       - identifier: us.mappings.item.marketplace.contactSellerAddressLine1 
      #       - identifier: us.mappings.item.marketplace.contactSellerAddressLine2          
      # - click:  
      #     identifier: us.mappings.global.navigation.backNavigation.heroImageViewer


  - name: us.functions.item.mp.wfs.proSeller.atc  #Joel added on 11.5.21
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.orderDetails.marketplace.text.3P_ProSeller
          position: center
      - log: finished scrolling....
      - verifyIdentifier:  #Joel added 8/18
          present: 
            - identifier: us.mappings.orderDetails.marketplace.text.3P_ProSeller      
      - sleep: 
           duration: 2000
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.fulfillment.showShippingDeliveryPickup.button
          then:
            - click: 
                identifier: us.mappings.item.fulfillment.showShippingDeliveryPickup.button
            - log: Fulfillment options field was suppressed.    
          else:
            - log: Fulfillment options field is not suppressed.           
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.orderDetails.sellerReviewsStars.module 
            - identifier: us.mappings.orderDetails.marketplace.text.3P_ProSeller            
            - identifier: us.mappings.item.3P_ProSeller_WFS              
            - identifier: us.mappings.orderDetails.sellerReviewsStars
            - identifier: us.mappings.orderDetails.sellerReviewsStars.count 
      - verifyValue:
          identifier: us.mappings.item.3P_ProSeller_WFS
          contains: Fulfilled by Walmart                           
      - verifyValue:
          identifier: us.mappings.orderDetails.sellerReviewsStars.count
          contains: seller reviews  
      - click:
          identifier: us.mappings.marketplace.viewSellerInfoLink
          coordinates: 30%,50% 
      - log: Coordinates were clicked
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.marketplace.contactSellerName
          then:
            - log: View seller info page loaded
          else:
            - executeFunction:
                name: us.functions.item.mp.clickSellerNameLinkUsingCoOrdinates
      - verifyIdentifier: # Assert Pro Sellers module for Returns info page
          present: 
            - identifier: us.mappings.marketplace.contactSellerName 
            - identifier: us.mappings.orderDetails.marketplace.button.contactSeller
            - identifier: us.mappings.item.marketplace.contactSellerPhoneNumber
      - click:  
          identifier: us.mappings.storeMaps.backButton
      #Added Item Page close logic 1/28/22
      - executeFunction:
          name: us.functions.item.addItemToCart

            ## ACC Tires ##

  - name: us.functions.item.mp.clickSellerNameLinkUsingCoOrdinates
    platform: android
    flow:
      - try:
          flow:
            - verifyIdentifier:
                text:
                  - identifier: us.mappings.marketplace.sellerTitle.parent
                    contains: Sold
            - click:
                identifier: us.mappings.marketplace.sellerTitle.parent
                coordinates: 10%,50%
                wait: 2000
            - sleep:
                duration: 5000
            - if:
                identifier:
                  notPresent:
                    - identifier: us.mappings.marketplace.contactSellerName
                then:
                   - failTest:
                      message: "FAILURE - ${env} - Link not clicked"
          catch:
            flow:
               - click:
                   identifier: us.mappings.marketplace.sellerTitle.parent
                   coordinates: 40%,50%

  - name: us.functions.item.mp.clickSellerNameLinkUsingCoOrdinates
    platform: ios
    flow:
      - try:
          flow:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.SellerInfoBoxView
            - click:
                identifier: us.mappings.item.SellerInfoBoxView
                coordinates: 45%,90%
                longClick: true
                wait: 2000
            - sleep:
                duration: 5000
            - if:
                identifier:
                  notPresent:
                    - identifier: us.mappings.item.ContactSellerButton
                then:
                   - failTest:
                      message: "FAILURE - ${env} - View seller info Link not clicked"
          catch:
            flow:
               - click:
                   identifier: us.mappings.item.SellerInfoBoxView
                   coordinates: 20%,80%
                   longClick: true

  - name: function.item.acc.verifyACCLabels
    platform: android
    flow:
      - if: 
          condition: ${itemType} == 's2s-tires'
          then:
            - scroll: 
                direction: down
                untilIdentifier: us.mappings.acc.item.s2sLabel

            - verifyIdentifier:
                present:
                  - identifier: us.mappings.acc.item.s2sLabel
          else:
              - if:
                  condition: ${itemType} == 'put-tires'
                  then:
                    - scroll: 
                       direction: down
                       untilIdentifier: us.mappings.acc.item.putLabel

                    - verifyIdentifier:
                        present:
                          - identifier: us.mappings.acc.item.putLabel
      - scroll: 
          direction: up
          untilIdentifier: us.mappings.itemPage.itemTitle


  - name: us.functions.item.acc.brandHeaderValidation     #Added by Joel 9/30.21 updated by Joel 1/5/22
    platform: android
    flow:
      - sleep:
          duration: 5000   
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.itemPage.itemTitle
      - scroll:
          direction: up
          untilIdentifier: us.mappings.acc.tireBrandHeader
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.acc.tireBrandHeader

      - log: Tire Brand Name Verified!
      - sleep:
          duration: 5000   
      - click:
          identifier: us.mappings.item.heroImage
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.backButton
          then:
            - click:
                identifier:  us.mappings.item.backButton
          else:
            - click:
                identifier: us.mappings.item.closeButton

  - name: us.functions.item.acc.brandHeaderValidation     #Added by Joel 10/5/21, updated by Joel 12/14/21, updated by Joel 1/5/22
    platform: ios
    flow:
      - sleep:
          duration: 5000
      - verifyIdentifier:
          timeout: 100000
          present: 
            - identifier: us.mappings.item.brandNameTitle.text  #Joel Testing...
      - log: Tire Brand Name Verified!
      - sleep:
          duration: 5000
      - click:
          identifier: us.mappings.item.productTitleViewpProductTitle
      - click:
          identifier: us.mappings.item.heroImageView
      - sleep:
          duration: 5000
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.item.heroImageView.productLabel
          then:
            - click:
                identifier: us.mappings.item.heroImageView
            - sleep:
                duration: 5000
      - goBack: true
      # - executeFunction:
      #     name: us.functions.utils.scrollIfNotVisible
      #     params:
      #       - name: identifier
      #         string: us.mappings.acc.item.s2sLabel
      #       - name: direction
      #         string: down
      #       - name: scrollPosition
      #         string: center
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.acc.item.s2sLabel
      # - scroll: 
      #     direction: up
      #     untilIdentifier: us.mappings.item.productNameTileGeneric       


  - name: us.function.marketplace.contactSellerFromItemPage        # modified on 27th April 2021
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.productAddToListButtonView
            - name: direction
              string: down 
            - name: scrollPosition
              string: center
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.sellerInfoView
          then:
            - click:
                identifier: us.mappings.item.sellerInfoView
          else:
            - click: 
                identifier: us.mappings.item.SellerInfoBoxView
                coordinates: 35%,90%
                
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.item.sellerPage.detailsView.navigationBar
            - identifier: us.mappings.item.ContactSellerButton
      - click:
          identifier: us.mappings.item.ContactSellerButton
      - executeFunction:
          name: function.marketplace.verifySellerPageAndSendMesssage
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.item.sellerPage.detailsView.navigationBar
            - identifier: us.mappings.item.ContactSellerButton
      - click:
          identifier: us.mappings.global.navigateBackArrow

  - name: us.function.marketplace.contactSellerFromItemPage        # modified on 20th May 2022
    platform: android
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.marketplace.viewSellerInfoLink
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - if:
          identifier:
            present:
              - identifier: us.mappings.wplus.itempage.freeshippinglabel           
          then:
            - click:
                identifier: us.mappings.wplus.itempage.freeshippinglabel
      - sleep:
          duration: 5000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.marketplace.viewSellerInfoLink
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.marketplace.viewSellerInfoLink
      - click:
          identifier: us.mappings.marketplace.viewSellerInfoLink
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.marketplace.contactSellerName
          then:
            - log: seller details page loaded
          else:
            - executeFunction:
                name: us.functions.item.mp.clickSellerNameLinkUsingCoOrdinates
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.item.sellerPage.detailsView.sellerPagenavigationBar
            - identifier: us.mappings.item.marketplace.contactSellerTitle
      - click:
          wait: 2000
          identifier: us.mappings.item.marketplace.contactSellerTitle
      - executeFunction:
          name: function.marketplace.verifySellerPageAndSendMesssage
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.item.sellerPage.detailsView.sellerPagenavigationBar
            - identifier: us.mappings.item.marketplace.contactSellerTitle
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.backButton
          then:
            - click:
                wait: 2000
                identifier: us.mappings.item.backButton
          else:
            - click:
                identifier: us.mappings.global.navigateBackArrow

  - name: us.functions.item.verifyNotFitBannerMessage
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.verifyFitmentNotFitMessage
            - name: direction
              string: up
            - name: scrollPosition
              string: center
      - verifyIdentifier:
          label:
            - identifier: us.mappings.item.verifyFitmentNotFitMessage
              contains: Looks like this tire won’t fit your vehicle.

  - name: us.functions.item.verifyNotFitBannerMessage
    platform: android
    flow:
      - verifyIdentifier:
          text:
            - identifier: us.mappings.item.verifyFitmentNotFitMessage
              contains: Looks like this tire won’t fit your vehicle

  - name: us.functions.item.verifyFindTiresThatFit
    platform: ios
    flow:
      - verifyIdentifier:
          present:      
            - identifier: us.mappings.item.verifyFindTiresThatFitButton
      - click:
          identifier: us.mappings.item.verifyFindTiresThatFitButton
      - sleep:
          duration: 2000
      - if:
          identifier:
            present:
              - identifier: us.mappings.search.fitmentWidgetAddMoreInfoButton
          then:
            - click:
                identifier: us.mappings.search.fitmentWidgetAddMoreInfoButton
            - click:
                identifier:  us.mappings.search.fitment.selectSubmodeldropdown
            - enterText:
                identifier: us.mappings.search.fitment.pickerWheel 
                string: ${submodel} 
            - click:
                identifier: done
            - click:
                identifier:  us.mappings.search.fitment.selectTireSizedropdown
            - click:
                identifier: done
            - sleep:
                duration: 2000 
            - click:
                identifier: us.mappings.search.fitment.viewResultButton
      - sleep:
          duration: 5000
      - executeFunction:
          name: us.functions.search.clickOnFirstItem
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.verifyStatusFitmentGoodFitMessage
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - loop:
         begin: 0
         end: 3
         mode: increment
         storeIndex: i
         flow:
           - log: $i
           - if:
               identifier:
                 present:
                   - identifier: us.mappings.search.fitmentWidgetNeedMoreInfo
               then:
                 - if:
                     identifier:
                       present:
                         - identifier: us.mappings.search.fitmentWidgetAddMoreInfoButton
                     then:
                       - click:
                           identifier: us.mappings.search.fitmentWidgetAddMoreInfoButton
                 - click:
                     identifier:  us.mappings.search.fitment.selectSubmodeldropdown
                 - enterText:
                     identifier: us.mappings.search.fitment.pickerWheel 
                     string: ${submodel} 
                 - click:
                     identifier: done
                 - click:
                     identifier:  us.mappings.search.fitment.selectTireSizedropdown
                 - click:
                     identifier: done
                 - sleep:
                     duration: 2000 
                 - click:
                     identifier: us.mappings.search.fitment.viewResultButton
               else:
                 - break: true 
      - verifyIdentifier:
          label:
            - identifier: us.mappings.item.verifyStatusFitmentGoodFitMessage
              contains: This tire is a good fit    
      - executeFunction:
         name: us.functions.item.closeItemPage
      - sleep: 
          duration: 3000

  - name: us.functions.item.verifyFindTiresThatFit
    platform: android
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.verifyFindTiresThatFitButton
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - click:
          identifier: us.mappings.item.verifyFindTiresThatFitButton
      - executeFunction:
          name: us.functions.search.clickOnFirstItem  
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.search.fitmentDetailsChangeButton
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - verifyIdentifier:
          notPresent:
            - identifier: us.mappings.item.verifyFitmentNotFitMessage

      # commenting As part of the new widget theme changes by @glass-android-fitment-us, you cant able to see fitmentStatusMessage in android https://walmart.slack.com/archives/C011X7AGVA7/p1714382058017159?thread_ts=1714377994.569629&cid=C011X7AGVA7
      # - click:
      #     identifier: us.mappings.search.pdp.productPrice
      # - executeFunction:
      #     name: us.functions.utils.scrollIfNotVisible
      #     params:
      #       - name: identifier
      #         string: us.mappings.item.verifyStatusFitmentGoodFitMessage
      #       - name: direction
      #         string: down
      #       - name: scrollPosition
      #         string: center
      # - verifyIdentifier:
      #     text:
      #       - identifier: us.mappings.item.verifyStatusFitmentGoodFitMessage
      #         contains: This tire is a good fit       
      - executeFunction:
          name: us.functions.item.closeItemPage
      - sleep: 
          duration: 3000
                   
  - name: function.marketplace.verifySellerPageAndSendMesssage      # modified on 26th May 2021
    platform: ios
    flow:
      - verifyIdentifier:
          present:      
            - identifier: us.mappings.contactSellerTitle
            - identifier: us.mappings.contactSellerSendMessageToText
            #- identifier: us.mappings.contactSellerReasonText
            - identifier: us.mappings.contactSellerReasonForContactText
            # - identifier: us.mappings.contactSellerMessageField
      - enterText:
          identifier: us.mappings.item.contactSellerPage.enterMessageText
          string: ${message}
      - click: 
          wait: 2000
          identifier: us.mappings.default.keyboardDoneButton
      - click:
          wait: 2000
          identifier: us.mappings.contactSellerSendButton 
      - if:
          identifier:
            present:
              - identifier: us.mappings.popup.technicalError
          then:    
              - log: Trying again due to technical error
              - click:
                  identifier: us.mappings.amend.confirmation.okay
              - click:
                  identifier: us.mappings.contactSellerSendButton
              - sleep:
                  duration: 2000
      - verifyIdentifier:
          present: 
            - identifier: us.mappings.contactSellerConfirmationText
          label:
            - identifier: us.mappings.contactSellerConfirmationText
              equals: Your message has been sent
      - click:
          identifier: us.mappings.item.contactSellerDoneButton

######################### ACC Tires ###################################

  - name: function.item.acc.verifyACCLabels
    platform: ios
    flow:
      - sleep: 
          duration: 5000
      - if: 
          condition: ${itemType} == 's2s-tires'
          then:
            - scroll: #not required , suprinder
                direction: down
                untilIdentifier: us.mappings.acc.item.s2sLabel

            - verifyIdentifier:
                present:
                  - identifier: us.mappings.acc.item.s2sLabel
          else:
              - if:
                  condition: ${itemType} == 'put-tires'
                  then:
                    - scroll: #not required , suprinder
                       direction: down
                       untilIdentifier: us.mappings.acc.item.putLabel

                    - verifyIdentifier:
                        present:
                          - identifier: us.mappings.acc.item.putLabel
                  
                    # - verifyIdentifier: #item with only PUT not available, suprinder
                    #     notPresent:
                    #       - identifier: us.mappings.acc.item.s2sLabel
      - click: 
          identifier: us.mappings.item.closeItemDetailsPage
  
######################### ACC Tires ###################################

  - name: function.item.sfs.verify2DayBadge
    platform: ios
    flow:
      - if: 
          condition: ${itemType} == 's2s-tires'
          then:
            - scroll: 
                direction: down
                untilIdentifier: us.mappings.acc.item.s2sLabel

            - verifyIdentifier:
                present:
                  - identifier: us.mappings.acc.item.s2sLabel
          else:
              - if:
                  condition: ${itemType} == 'put-tires'
                  then:
                    - scroll: 
                       direction: down
                       untilIdentifier: us.mappings.acc.item.putLabel

                    - verifyIdentifier:
                        present:
                          - identifier: us.mappings.acc.item.putLabel
                  
                    - verifyIdentifier:
                        notPresent:
                          - identifier: us.mappings.acc.item.s2sLabel
  
  - name: function.item.marketplace.verify3PWFSProSeller
    platform: ios
    flow:
        - sleep:
            duration: 10000
        - verifyIdentifier:
            present:
              - identifier: us.mappings.item.3P_ProSeller_WFS

  - name: us.functions.item.switching.validateFulfillmentDetails
    platform: android
    flow:
        - sleep:
            duration: 15000
        - executeFunction:
            name: us.functions.utils.tryAgainWhenThereIsError 

        - if:
            identifier:
              present:
                - identifier: mapping.item.moreShippingOptionLink    
            then: 
              - click:
                  identifier: mapping.item.moreShippingOptionLink
              - sleep:
                  duration: 10000
              - scroll:
                  direction: down
                  untilIdentifier: us.mappings.item.switching.fulfillment.pickupText
                  position: center
              - verifyIdentifier:
                  present:
                    - identifier: us.mappings.item.switching.fulfillment.shippingText
                    - identifier: us.mappings.item.switching.fulfillment.pickupText
                    - identifier: us.mappings.item.switching.fulfillment.deliverystoreText

            # text:
            #   - identifier: us.mappings.item.switching.fulfillment.pickupText
            #     contains: pickup
            #   - identifier: us.mappings.item.switching.fulfillment.deliverystoreText
            #     contains: Delivery from store
            #   - identifier: us.mappings.item.switching.fulfillment.shippingText
            #     contains: shipping

  - name: us.functions.item.switching.validateFulfillmentDetails
    platform: ios
    flow:
        - sleep:
            duration: 15000
        - executeFunction:
            name: us.functions.utils.tryAgainWhenThereIsError
        - if:
            identifier:
              present:
                - identifier: mapping.item.moreShippingOptionLink    
            then: 
              - click:
                  identifier: mapping.item.moreShippingOptionLink
              - sleep:
                  duration: 10000
        - scroll:
            direction: down
            untilIdentifier: us.mappings.item.switching.fulfillment.pickupText
            position: center
        - sleep:
            duration: 15000
        - verifyIdentifier:
            present:
              - identifier: us.mappings.item.switching.fulfillment.shippingText
              - identifier: us.mappings.item.switching.fulfillment.pickupText
              - identifier: us.mappings.item.switching.fulfillment.deliverystoreText

            # label:
              # - identifier: us.mappings.item.switching.fulfillment.pickupText
              #   contains: Pickup
              # - identifier: us.mappings.item.switching.fulfillment.deliverystoreText
              #   contains: Delivery from store
              # - identifier: us.mappings.item.switching.fulfillment.shippingText
              #   contains: shipping

 ######################### Gifting ###################################

  - name: us.functions.item.gift.verifyGiftItem
    platform: android
    flow:
        - sleep:
            duration: 7000
        - scroll:
            direction: down
            untilIdentifier: us.mappings.gifting.itempage.giftbadge
        - verifyIdentifier:
            present:
              - identifier:  us.mappings.gifting.itempage.giftbadge

  - name: us.functions.item.gift.verifyGiftItem
    platform: ios
    flow:
        - sleep:
            duration: 7000
        - scroll:
            direction: down
            untilIdentifier: us.mappings.gifting.itempage.giftbadge
        - if:
            identifier:
              present:
                - identifier: us.mappings.gifting.itempage.giftbadge
            then: 
              - verifyIdentifier:
                  present:
                    - identifier:  us.mappings.gifting.itempage.giftbadge
  
  # - name: us.functions.item.checkAvailibility  # to be updated
  #   platform: ios
  #   flow:
  #     - sleep:
  #         duration: 8000
  #     - click:
  #         identifier: us.mappings.itempage.checkAvailability


  - name: us.functions.item.buyNow.newUser
    platform: ios
    flow:
      - verifyIdentifier:
          timeout: 120000
          present:
            - identifier: us.mappings.buyNow.buyNowButton
      - click:
          identifier: us.mappings.buyNow.buyNowButton
      - sleep:
          duration: 10000

  - name: us.functions.item.buyNow.newUser
    platform: android
    flow:
      - verifyIdentifier:
          timeout: 120000
          present:
            - identifier: us.mappings.buyNow.buyNowButton
      - click:
          identifier: us.mappings.buyNow.buyNowButton
      - sleep:
          duration: 10000 
  
  - name: us.functions.item.deliveryFulfillment.checkAvaiability
    platform: android
    flow:
      - sleep:
          duration: 15000
      - if: 
         identifier:
           present:
             - identifier: us.mappings.item.fulfillment.checkavailability 
         then:
            - click:
                identifier: us.mappings.item.fulfillment.checkavailability
                wait : 10000
         else:
           - verifyIdentifier:
               present:
                 - identifier: us.mappings.item.itemPageStoreName
                 
  - name: us.functions.item.deliveryFulfillment.checkAvaiability.selectAdressandContinue
    platform: android
    flow:
      - sleep:
          duration: 15000
      - if:
          identifier:
            present:
              - identifier: us.mappings.selectaddress.chooseaddressradio
            enabled:
              - identifier: us.mappings.selectaddress.chooseaddressradio
                value: true
          then:
            - click:
                identifier: us.mappings.selectaddress.continue
            - sleep:
                duration: 15000   
            - scroll:
                direction: down
                untilIdentifier: us.mappings.item.fulfillment.checkavailability.verifyAddress
                position: center         
            - verifyIdentifier:
                text:
                  - identifier: us.mappings.item.fulfillment.checkavailability.verifyAddress
                    contains : 1120 S Walton Blvd 
  
################### Marketplace Pickup

  - name: us.function.item.mppickup.verifyPartnerBadge
    platform: android
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.marketplacePickupLabel
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.marketplacePickupLabel   

  - name: us.function.item.mppickup.verifyPartnerBadge
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.marketplacePickupLabel   

  - name: us.functions.item.verifyReviewsScreenAndSubmitReview
    platform: ios
    flow:
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.reviewLink
      - click: 
          identifier: us.mappings.item.reviewLink         
      - verifyIdentifier:
          timeout: 370000  
          present:
              - identifier: us.mappings.item.customerReviewsListSubpage.title
    # Write a review module will no longer available from item page https://walmart.slack.com/archives/C01211L4N13/p1724411946772289?thread_ts=1724410682.439439&cid=C01211L4N13
      # - click: 
      #     identifier: us.mappings.item.writeReviewButton
      # - verifyIdentifier:
      #     timeout: 10000
      #     present:
      #         - identifier: us.mappings.item.reviewPageTitle
      # - verifyIdentifier:
      #     timeout: 50000
      #     present:
      #         - identifier: us.mappings.feedback.threestarRating
      # - click: 
      #     identifier: us.mappings.feedback.threestarRating
      # # - click:
      # #     identifier: us.mappings.item.addNickName
      # # - enterText:
      # #     identifier: us.mappings.item.addNickName
      # #     string: TestReview
      # # - click:
      # #     identifier: Done
      # # - scroll:
      # #     direction: down
      # # - click: 
      # #     identifier: us.mappings.item.submitReviewButton
      # # - verifyIdentifier:
      # #     timeout: 4000
      # #     present:
      # #         - identifier: us.mappings.item.thankYouScreen
      # #     label:
      # #       - identifier: us.mappings.item.thankYouScreen
      # #         equals: Thank you for your review!
      # - click: 
      #     identifier: us.mappings.item.backButton
      # - if:
      #     identifier:
      #       present:
      #         - identifier: us.mappings.item.discardButton
      #     then:
      #       - click:
      #           identifier: us.mappings.item.discardButton
      # - sleep:
      #     duration: 2000
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.backButton
          then:
            - click: 
                identifier: us.mappings.item.backButton
          else:
            - click:
                identifier: us.mappings.global.closeButton
 
  - name: us.functions.item.verifyProductAndAddToListAndAddToRegistery
    platform: ios
    flow:
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.productTitleViewpProductTitle
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.productNonConfigBundleView
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.item.productNonConfigBundleView
          then:
              - failTest:
                  message: "FAILURE - ${env} - Bundle text is not present in the item page"
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.productNonConfigBundleView
              - identifier: us.mappings.item.productAddToListButtonView
              - identifier: us.mappings.item.productAddToRegistryButtonView
      - click: 
          identifier: us.mappings.item.productAddToListButtonView
      - sleep:
          duration: 4000
      - click: 
          identifier: us.mappings.item.productAddItemListPage
      - sleep:
          duration: 2000                                        
      - click: 
          identifier: us.mappings.item.productAddItemListPageSaveButton
      - sleep:
          duration: 2000
      #Back Navigation causing failure
      # - click:
      #     identifier: us.mappings.global.navigateBackArrow
      - click: 
          identifier: us.mappings.item.closeButton 
                     
  - name: us.functions.item.verifyReturnDetailsLink
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.productReturnInfoDetailsLink
            - name: direction
              string: down
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.productReturnInfoDetailsLink
      - click: 
          identifier: us.mappings.item.productReturnInfoDetailsLink
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.returnPolicyPageLabel
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.returnPolicyPageLabelBackButton
          then:
            - click: 
                identifier: us.mappings.item.returnPolicyPageLabelBackButton
          else:
            - click:
                identifier: us.mappings.global.closeButton


  - name: us.functions.item.verifyGiftEligibleLearnMoreLink
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.giftEligibleLearnMoreLink
            - name: direction
              string: down    
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.giftEligibleLearnMoreLink


  - name: us.functions.item.verifyCCLearnHowLink
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.ccLearnHowLink
          wait: 2000
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.item.ccLearnHowLink
          then:
              - failTest:
                  message: "FAILURE - ${env} - CreditCard Learn Link is not displayed "
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.ccLearnHowLink
      - click: 
          identifier: us.mappings.item.ccLearnHowLink
      - verifyIdentifier:
          timeout: 50000
          present:
              - identifier: us.mappings.item.ccLearnHowLinkRedirection
          label:
            - identifier: us.mappings.item.ccLearnHowLinkRedirection
              contains: 10% cash back at Walmart in-store or online

  - name: us.functions.item.ad.validateSkylineAd
    platform: ios
    flow:
      - sleep: 
          duration: 5000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.skyline
      - click:
          identifier: us.mappings.item.ad.skyline
      - sleep: 
          duration: 3000
      - executeFunction:
          name: us.functions.search.closeHowDoYouWantYourOrderBottomTray
      - try:
          flow:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.closeItemDetailsPage
          catch:
            flow:
              - executeFunction:
                  name: us.functions.utils.scrollIfNotVisible
                  params:
                    - name: identifier
                      string: us.mappings.search.firstProductNameTitle
                    - name: direction
                      string: down
              - verifyIdentifier:
                  present:
                    - identifier: us.mappings.search.firstProductNameTitle

  - name: us.functions.item.ad.validateSkylineAdInItemPage
    platform: ios
    flow:
      - loop:
          each: ${adItems}
          storeElement: items
          storeIndex: itemIndex
          flow:
              - executeFunction:
                  name: us.functions.global.navigation.goToDeepLink
                  params:
                    - name: deepLinkUrl
                      string: walmart://item/$items
              - sleep: 
                  duration: 5000  
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.item.ad.skyline
                  then:
                    - executeFunction:
                        name: us.functions.item.ad.validateSkylineAd
                    - storeIn:
                        key: skylinead
                        value: true                            
                    - break: true
      - if:
          condition: ${skylinead} != true
          then:
            - failTest:
                message: "FAILURE - ${env} - No skyline ad present for three items" 

##################################################################

  - name: us.functions.item.handleWalmart+BottomTray
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.walmart+BottomTrayText
          then:
            - click:
                identifier: us.mappings.item.walmart+BottomTrayCloseButton

  - name: us.functions.item.verifyReviewsScreenAndSubmitReview
    platform: android
    flow:
      - sleep:
          duration: 3000     
      - scroll: 
          direction: up
          untilIdentifier: us.mappings.item.reviewLink  
      
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.reviewLink            

# Write a review functionality was disabled, will keep all the steps below in case Write a reviewfeature is back
      # - click: 
      #     identifier: us.mappings.item.writeReviewButton
      # - verifyIdentifier:
      #     present:
      #         - identifier: us.mappings.item.reviewPageTitle
      # - click: 
      #     identifier: us.mappings.feedback.threestarRating
      # - click:
      #     identifier: us.mappings.feedback.continueButton
      # - if:
      #     identifier:
      #       present:
      #         - identifier: us.mappings.feedback.skipButton
      #     then:
      #       - click:
      #           identifier: us.mappings.feedback.skipButton
      # - click: 
      #     identifier: us.mappings.item.addReviewTitle
      # - enterText:
      #     identifier: us.mappings.item.addReviewTitle
      #     string: Test Review
      #     pressEnter: true
      # - executeFunction:
      #     name: us.functions.utils.scrollIfNotVisible
      #     params:
      #       - name: identifier
      #         string: us.mappings.item.submitReviewButton
      #       - name: direction
      #         string: down
      # - verifyIdentifier:
      #     present:
      #         - identifier: us.mappings.item.submitReviewButton
      # - click: 
      #     identifier: us.mappings.item.submitReviewButton
      # - sleep:
      #     duration: 4000
      # - verifyIdentifier:
      #     present:
      #         - identifier: us.mappings.item.thankYouScreen
      #     text:
      #       - identifier: us.mappings.item.thankYouScreen
      #         equals: Thank you for your review!
      # - sleep:
      #     duration: 3000
      # - click: 
      #     identifier: us.mappings.global.closeButton
      # - click:
      #     identifier: us.mappings.feedback.discardButton


  - name: us.functions.item.ad.validateSkylineAd
    platform: android
    flow:
      - sleep: 
          duration: 5000  
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.skylineLogo
            - identifier: us.mappings.item.ad.skylineHeadline
            # - identifier: us.mappings.search.ad.skylineCTA          
            - identifier: us.mappings.search.ad.skylineSponsoredText
          text:
            - identifier: us.mappings.search.ad.skylineSponsoredText
              equals: Sponsored                
      - click: 
          identifier: us.mappings.item.ad.skylineLogo
      - sleep:
          duration: 7000
      - log: Verify skyline Logo is clickable     
      - executeFunction:
          name: us.functions.search.closeHowDoYouWantYourOrderBottomTray
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.ad.skylineitems
          then:
            - verifyIdentifier:
                present:
                  - identifier:  us.mappings.item.ad.skylineitems
          else:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.homePage.campaignAdSection

      - executeFunction:
          name: us.functions.global.navigation.goToDeepLink
          params:
            - name: deepLinkUrl
              string: ${deepLinkUrl}
      - sleep: 
          duration: 2000  
      - click: 
          identifier: us.mappings.item.ad.skylineHeadline
      - sleep:
          duration: 7000          
      - log: Verify skyline Headline is clickable    
      - executeFunction:
          name: us.functions.search.closeHowDoYouWantYourOrderBottomTray
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.ad.skylineitems
          then:
            - verifyIdentifier:
                present:
                  - identifier:  us.mappings.item.ad.skylineitems
          else:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.homePage.campaignAdSection

      - executeFunction:
           name: us.functions.global.navigation.goToDeepLink
           params:
             - name: deepLinkUrl
               string: ${deepLinkUrl}

      - sleep: 
          duration: 2000  

      - if:
          identifier:
            present:
              - identifier: us.mappings.search.ad.skylineCTA
          then:
            - click: 
                identifier: us.mappings.search.ad.skylineCTA
            - sleep:
                duration: 7000
            - log: Verify skyline CTA is clickable  
            - executeFunction:
                name: us.functions.search.closeHowDoYouWantYourOrderBottomTray
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.ad.skylineitems
          then:
            - verifyIdentifier:
                present:
                  - identifier:  us.mappings.item.ad.skylineitems
          else:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.homePage.campaignAdSection

  - name: us.functions.item.ad.validateSkylineAdInItemPage
    platform: android
    flow:

      - loop:
          each: ${adItems}
          storeElement: items
          storeIndex: itemIndex
          flow:
              - executeFunction:
                  name: us.functions.global.navigation.goToDeepLink
                  params:
                    - name: deepLinkUrl
                      string: walmart://item/$items
              - sleep: 
                  duration: 5000  
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.item.ad.skylineLogo
                  then:
                    - executeFunction:
                        name: us.functions.item.ad.validateSkylineAd    
                    - storeIn:
                        key: skylinead
                        value: true                            
                    - break: true
      - if:
          condition: ${skylinead} != true
          then:
            - failTest:
                message: "FAILURE - ${env} - No skyline ad present for three items"   

  - name: us.functions.item.verifyReturnDetailsLink
    platform: android
    flow:
      - sleep:
          duration: 5000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params: 
            - name: identifier
              string: us.mappings.item.returnDetailsLink
            - name: direction
              string: down
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.returnDetailsLink
      - click: 
          identifier: us.mappings.item.returnDetailsLink
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.returnPolicyPageLabel
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.backButton
          then:
            - click: 
                identifier: us.mappings.item.backButton
          else:
            - click:
                identifier: us.mappings.global.closeButton


  - name: us.functions.item.verifyGiftEligibleLearnMoreLink
    platform: android
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params: 
            - name: identifier
              string: us.mappings.item.giftEligibleLearnMoreLink
            - name: direction
              string: down
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.giftEligibleLearnMoreLink


  - name: us.functions.item.verifyCCLearnHowLink
    platform: android
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params: 
            - name: identifier
              string: us.mappings.item.ccLearnHowLink
            - name: direction
              string: down
            - name: scrollLimit
              string: 15
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params: 
            - name: identifier
              string: us.mappings.item.ccLearnHowLink
            - name: direction
              string: down
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.item.ccLearnHowLink
          then:
              - failTest:
                  message: "FAILURE - ${env} - CreditCard Learn Link is not displayed "
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.ccLearnHowLink
      - click: 
          identifier: us.mappings.item.ccLearnHowLink
      - sleep:
          duration: 4000
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.ccLearnHowLinkRedirection
          text:
            - identifier: us.mappings.item.ccLearnHowLinkRedirection
              contains: 10% cash back at Walmart in-store or online

      - click: 
          identifier: us.mappings.item.ccLinkCloseButton


  - name: us.functions.item.verifyAddToRewardCheckboxandClipRewardFromItemPage
    platform: android
    flow:
      - sleep:
          duration: 7000  
      - executeFunction:
          name: us.functions.wplus.switchToOriginalAppTileClose
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params: 
            - name: identifier
              string: us.mappings.search.rewardsCheckBox
            - name: direction
              string: down
      - if:
          identifier:
            present:
              - identifier: us.mappings.search.rewardsCheckBox
          then:          
              - click:
                  identifier: us.mappings.search.rewardsCheckBox
                  wait: 3000
              - verifyIdentifier: 
                  present:
                    - identifier: us.mappings.search.rewardsAddedItem
          else:
              - scroll:
                  direction: up
                  untilIdentifier: us.mappings.search.rewardsAddedItem
              - verifyIdentifier: 
                  present:
                      - identifier: us.mappings.search.rewardsAddedItem

  - name: us.functions.item.verifyJoinWalmartPlusCTAWithRewardsInItemPage
    platform: android
    flow:
      - sleep:
          duration: 7000  
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params: 
            - name: identifier
              string: us.mappings.search.rewardsTitle
            - name: direction
              string: down
      - verifyIdentifier:
          present:
              - identifier: us.mappings.search.rewardsTitle
              - identifier: us.mappings.item.joinWalmartPlusCTA              
      - click: 
          identifier: us.mappings.global.closeButton

  - name: us.functions.item.verifyJoinWalmartPlusCTAWithRewardsInItemPage
    platform: ios
    flow:
      - sleep:
          duration: 7000  
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params: 
            - name: identifier
              string: us.mappings.item.joinWalmartPlusCTA
            - name: direction
              string: down
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.joinWalmartPlusCTA 
          then:
            - log: "Join W+ CTA present as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Join W+ CTA should  be present but not available"
      # - verifyIdentifier:
      #     present:
      #         - identifier: us.mappings.item.joinWalmartPlusCTA 

  - name: us.functions.item.validateZeekit
    platform: android
    flow:
      - sleep:
          duration: 10000
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.zeekit.chooseModelFirstLabelButtonText
              - identifier: us.mappings.item.zeekit.chooseModelIcon
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.zeekit.chooseModelSecondText
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.zeekit.chooseModelSecondText
      - scroll:
          direction: up
          untilIdentifier: us.mappings.item.zeekit.chooseModelFirstLabelButtonText
      - click: 
          identifier: us.mappings.item.zeekit.chooseModelFirstLabelButtonText
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.zeekit.switchModelViewTab
          then:
            - click:
                identifier: us.mappings.item.zeekit.switchModelViewTab        
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.zeekit.chooseModelSeeStylesImageView
            - identifier: us.mappings.item.zeekit.chooseModelSeeStylesInMoreSizesText
            - identifier: us.mappings.item.zeekit.chooseModelSeeStylesDescription
            - identifier: us.mappings.item.zeekit.chooseModelSeeStylesContinueButton
            - identifier: us.mappings.item.zeekit.chooseModelSeeStylesNoThanksButton
      
  - name: us.functions.item.validateZeekitChooseMyModelScreen
    platform: android
    flow:
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.item.zeekit.chooseModelSeeStylesContinueButton
      # - click: 
      #     identifier: us.mappings.item.zeekit.chooseModelSeeStylesContinueButton
      - verifyIdentifier: 
          present:
            - identifier: us.mappings.item.zeekit.chooseMyModelTitle
            - identifier: us.mappings.item.zeekit.chooseMyModelFilterDescription
            - identifier: us.mappings.item.zeekit.chooseMyModelFilterChooseSizeText
            - identifier: us.mappings.item.zeekit.chooseMyModelFilterSizeGuide
            - identifier: us.mappings.item.zeekit.chooseMyModelFilterSizeChips
            - identifier: us.mappings.item.zeekit.chooseMyModelChooseHeightText
            - identifier: us.mappings.item.zeekit.chooseMyModelChangeUnitsDropdown
            - identifier: us.mappings.item.zeekit.chooseMyModelChooseHeightCount
            - identifier: us.mappings.item.zeekit.chooseMyModelDecreaseHeight
            - identifier: us.mappings.item.zeekit.chooseMyModelIncreaseHeight
            - identifier: us.mappings.item.zeekit.chooseMyModelSeeModelsButton
      - if:
          identifier:
            present:
              - identifier: us.mappings.global.chooseSize
          then:
            - click:
                identifier: us.mappings.global.chooseSize
      # - verifyIdentifier: 
      #     present: 
      #       - identifier: us.mappings.item.zeekit.chooseMyModelSelectionInfo
      - click:
          identifier: us.mappings.item.zeekit.chooseMyModelSeeModelsButton
      - sleep:
          duration: 10000   

  - name: us.functions.item.validateZeekitModelUpdateScreen
    platform: android
    flow:
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.zeekit.chooseMyModelUpdateValidation
              - identifier: us.mappings.item.zeekit.chooseMyModelUpdateChooseModelButton
              - identifier: us.mappings.item.zeekit.resetToOriginalModel
      - click: 
          identifier: us.mappings.item.zeekit.chooseMyModelUpdateChooseModelButton

  - name: us.functions.item.validateZeekitEditModel
    platform: android
    flow:
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.zeekit.EditModelText
              - identifier: us.mappings.item.zeekit.chooseModelIcon
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params: 
            - name: identifier
              string: us.mappings.item.zeekit.chooseMyModelUpdateValidation
            - name: direction
              string: down              
      - verifyIdentifier:
          present:        
              - identifier: us.mappings.item.zeekit.chooseMyModelUpdateValidation

  - name: us.functions.item.validateZeekitResetModel
    platform: android
    flow:
      - sleep:
          duration: 5000  
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params: 
            - name: identifier
              string: us.mappings.item.zeekit.EditModelText
            - name: direction
              string: up          
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.zeekit.EditModelText
      - click: 
          identifier: us.mappings.item.zeekit.EditModelText  
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.zeekit.switchModelText
          then:
            - click:
                identifier: us.mappings.item.zeekit.switchModelText
      - sleep:
          duration: 10000                   
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.zeekit.resetToOriginalModel
      - click: 
          identifier:  us.mappings.item.zeekit.resetToOriginalModel   
      - sleep:
          duration: 3000                  
      - click:
          identifier: us.mappings.item.zeekit.resetModelConfirmButton
      - sleep:
          duration: 3000     
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.zeekit.chooseModelFirstText                

  - name: us.functions.item.validateZeekit
    platform: ios
    flow:
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.zeekit.chooseModelFirstText
              - identifier: us.mappings.item.zeekit.chooseModelIcon
              - identifier: us.mappings.item.zeekit.chooseModelSecondText
      - click: 
          identifier: us.mappings.item.zeekit.chooseModelIcon
          
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.zeekit.modelSelection
          then:
            - click:
                identifier: us.mappings.item.zeekit.modelSelection                      

      - sleep:
          duration: 3000

      - if:
         identifier:
           present:
             - identifier: us.mappings.item.zeekit.chooseModelSeeStylesImageView
         then:
           - verifyIdentifier:
               present:
                 - identifier: us.mappings.item.zeekit.chooseModelSeeStylesImageView
                 - identifier: us.mappings.item.zeekit.chooseModelSeeStylesInMoreSizesText
                 - identifier: us.mappings.item.zeekit.chooseModelSeeStylesDescription
                 - identifier: us.mappings.item.zeekit.chooseModelSeeStylesContinueButton
                 - identifier: us.mappings.item.zeekit.chooseModelSeeStylesNoThanksButton
         else:
           - verifyIdentifier:
               present:
                 - identifier: us.mappings.item.zeekit.chooseModelVirtualTryOn

  - name: us.functions.item.validateZeekitChooseMyModelScreen
    platform: ios
    flow:    
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.zeekit.chooseModelSeeStylesContinueButton
          then:
            - click:
                identifier: us.mappings.item.zeekit.chooseModelSeeStylesContinueButton
      - sleep:
          duration: 4000

      - verifyIdentifier: 
          present:
            - identifier: us.mappings.item.zeekit.chooseMyModelTitle
            - identifier: us.mappings.item.zeekit.chooseMyModelFilterDescription
            - identifier: us.mappings.item.zeekit.chooseMyModelFilterChooseSizeText
            - identifier: us.mappings.item.zeekit.chooseMyModelFilterSizeGuide
            - identifier: us.mappings.item.zeekit.chooseMyModelFilterSizeChips
            - identifier: us.mappings.item.zeekit.chooseMyModelChooseHeightText
            - identifier: us.mappings.item.zeekit.chooseMyModelChangeUnitsDropdown
            - identifier: us.mappings.item.zeekit.chooseMyModelChooseHeightCount
            - identifier: us.mappings.item.zeekit.chooseMyModelDecreaseHeight
            - identifier: us.mappings.item.zeekit.chooseMyModelIncreaseHeight
            - identifier: us.mappings.item.zeekit.chooseMyModelSeeModelsButton
      - if:
          identifier:
            present:
              - identifier: us.mappings.global.chooseSize
          then:
            - click:
                identifier: us.mappings.global.chooseSize
      - click:
          identifier:  us.mappings.global.chooseSize.variant
      - verifyIdentifier: 
          present: 
            - identifier: us.mappings.item.zeekit.chooseMyModelSeeModelsButton
      - click:
          identifier: us.mappings.item.zeekit.chooseMyModelSeeModelsButton 
      - sleep:
          duration: 3000

  - name: us.functions.item.validateZeekitModelEditModelScreen
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.zeekit.switchModelText
      - click: 
          identifier: us.mappings.item.zeekit.switchModelText            
      - sleep:
          duration: 3000 

  - name: us.functions.item.validateZeekitModelUpdateScreen
    platform: ios
    flow:
      - verifyIdentifier:
          present:
              # - identifier: us.mappings.item.zeekit.chooseMyModelUpdateValidation
              - identifier: us.mappings.item.zeekit.chooseMyModelUpdateChooseModelButton
              - identifier: us.mappings.item.zeekit.resetToOriginalModel
      - sleep:
          duration: 3000               
      - click: 
          identifier: us.mappings.item.zeekit.chooseMyModelUpdateChooseModelButton
      - sleep:
          duration: 3000     

  - name: us.functions.item.validateZeekitResetModel
    platform: ios
    flow:
      - verifyIdentifier:
          present:
              # - identifier: us.mappings.item.zeekit.chooseMyModelUpdateValidation
              - identifier: us.mappings.item.zeekit.chooseMyModelUpdateChooseModelButton
              - identifier: us.mappings.item.zeekit.resetToOriginalModel
      - click: 
          identifier: us.mappings.item.zeekit.resetToOriginalModel
      - sleep:
          duration: 3000                  
      - click:
          identifier: us.mappings.item.zeekit.resetModelConfirmButton
      - sleep:
          duration: 3000     
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.zeekit.chooseModelFirstText          
          
  - name: us.functions.item.verifyAddToRewardCheckboxandClipRewardFromItemPage
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.wplus.travel.banner.learnMoreLink
      - scroll:
          direction: up
          untilIdentifier: us.mappings.itemPage.rewardsCheckBox
      - click:
          identifier: us.mappings.itemPage.rewardsCheckBox
          wait: 3000
      - verifyIdentifier: 
          present:
              - identifier: us.mappings.search.rewardsAddedItem
      - executeFunction:
          name: us.functions.item.verifyReward.mustBuy


  - name: us.functions.item.clipOnRewardCheckboxandFromItemPage
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.search.rewardsCheckBox
          then:
              - scroll:
                  direction: down          
              - click:
                  identifier: us.mappings.search.rewardsCheckBox 
              - sleep:
                  duration: 2000
              - verifyIdentifier: 
                  present:
                    - identifier: us.mappings.search.rewardsAddedItem
              - sleep:
                  duration: 2000
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.search.rewardDetailsBottomSheet
                  then:
                      - click: 
                          identifier: us.mappings.search.rewardsCloseButton


  - name: us.functions.item.validateZeekitEditModel
    platform: ios
    flow:
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.zeekit.EditModelIcon
      - click:
          identifier: us.mappings.item.zeekit.EditModelIcon

      - executeFunction:
          name: us.functions.item.validateZeekitModelEditModelScreen

#Sponsor ad in grid
  - name: us.functions.item.ad.SponsoredAd.InGrid
    platform: ios
    flow:
      - scroll:
          direction: up
      - sleep: 
          duration: 5000
      - if:
          identifier: 
            present:
              - identifier: us.mappings.item.ad.SponsoredAd.Gridview
          then:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.Gridview
                  - identifier: us.mappings.item.ad.SponsoredAd.sponsorKeyword
            - executeFunction:
                name: us.functions.search.applyRetailerFilter
                params:
                    - name: option
                      string: Walmart
            - sleep: 
                duration: 5000
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.Gridview
                  - identifier: us.mappings.item.ad.SponsoredAd.sponsorKeyword
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.ATCbutton 
            - click: 
                identifier: us.mappings.item.ad.SponsoredAd.ATCbutton 
            # - click: 
            #     identifier: us.mappings.item.ad.SponsoredAd.ATCbutton.increment 
            # - click: 
            #     identifier: us.mappings.item.ad.SponsoredAd.ATCbutton.decrement
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.clickonitem
            - click: 
                identifier: us.mappings.item.ad.SponsoredAd.clickonitem
            - verifyIdentifier:
                timeout: 100000
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.item.brandName
                  - identifier: us.mappings.item.ad.SponsoredAd.item.title
                  - identifier: us.mappings.item.sponsored.ratings
            - executeFunction:
                name: us.functions.item.closeItemPage
      - if:
          identifier: 
            present:
              - identifier: us.mappings.item.ad.SponsoredAd.Variantview
          then:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.Variantview
                  - identifier: us.mappings.item.ad.SponsoredAd.VariantsponsorKeyword
            - executeFunction:
                name: us.functions.search.sort.applyRetailerFilter
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.Variant.clickonitem
            - click: 
                identifier: us.mappings.item.ad.SponsoredAd.Variant.clickonitem
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.item.brandName
                  - identifier: us.mappings.item.ad.SponsoredAd.item.title
                  - identifier: us.mappings.item.sponsored.ratings
            - executeFunction: 
                name: us.functions.item.closeItemPage

#Sponsor ad in grid
  - name: us.functions.item.ad.SponsoredAd.InGrid
    platform: android
    flow:
      - if:
          identifier: 
            present:
              - identifier: us.mappings.item.ad.SponsoredAd.productgrid
          then:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.Gridview
                  - identifier: us.mappings.item.ad.SponsoredAd.sponsorKeyword
                  - identifier: us.mappings.item.ad.SponsoredAd.RatingGrid
            - verifyValue:
                identifier: us.mappings.item.ad.SponsoredAd.sponsorKeyword
                contains: Sponsored 
            - executeFunction:
                name: us.functions.search.sort.applyRetailerFilter
            - sleep: 
                duration: 5000
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.Gridview
                  - identifier: us.mappings.item.ad.SponsoredAd.sponsorKeyword
                  - identifier: us.mappings.item.ad.SponsoredAd.RatingGrid
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.ATCbutton
            - click: 
                identifier: us.mappings.item.ad.SponsoredAd.ATCbutton
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.ATCbutton.increment
                  - identifier: us.mappings.item.ad.SponsoredAd.ATCbutton.decrement 
            # - click: 
            #     identifier: us.mappings.item.ad.SponsoredAd.ATCbutton.increment 
            # - click: 
            #     identifier: us.mappings.item.ad.SponsoredAd.ATCbutton.decrement
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.productgrid
            - click: 
                identifier: us.mappings.item.ad.SponsoredAd.productgrid
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.item.brandName
                  - identifier: us.mappings.item.ad.SponsoredAd.item.title
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.item.ad.SponsoredAd.item.ratings
                  - name: direction
                    string: down
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.item.ratings
            - executeFunction:
                name: us.functions.item.closeItemPage
      - if:
          identifier: 
            present:
              - identifier: us.mappings.item.ad.SponsoredAd.Variantview
          then:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.Variantview
                  - identifier: us.mappings.item.ad.SponsoredAd.sponsorKeyword
                  - identifier: us.mappings.item.ad.SponsoredAd.RatingGrid
            # - verifyValue:
            #     identifier: us.mappings.search.ad.skylineSponsoredText
            #     contains: Sponsored 
            - executeFunction:
                name: us.functions.search.sort.applyRetailerFilter
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.Variantview
                  - identifier: us.mappings.item.ad.SponsoredAd.sponsorKeyword
                  - identifier: us.mappings.item.ad.SponsoredAd.RatingGrid
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.Variantview
            - click: 
                identifier: us.mappings.item.ad.SponsoredAd.Variantview
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.item.brandName
                  - identifier: us.mappings.item.ad.SponsoredAd.item.title
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.item.ad.SponsoredAd.item.ratings
                  - name: direction
                    string: down
                  - name: scrollPosition
                    string: center    
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.SponsoredAd.item.ratings
            - executeFunction:
                name: us.functions.item.closeItemPage

  - name: us.functions.item.ad.validateMarquee1Ad
    platform: android
    flow:
      - sleep: 
          duration: 5000
      - loop:
         begin: 1
         end: 3
         flow:    
           - executeFunction:
               name: us.functions.utils.scrollIfNotVisible
               params:
                 - name: identifier
                   string: us.mappings.item.ad.Marquee1
                 - name: direction
                   string: down
                 - name: scrollPosition
                   string: center
      - try:
          flow: 
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.ad.Marquee1Logo
                  - identifier: us.mappings.item.ad.Marquee1Headline
                  - identifier: us.mappings.search.ad.Marquee1SponsoredText
                text:
                  - identifier: us.mappings.search.ad.Marquee1SponsoredText
                    equals: Sponsored
          catch:
            flow:
              - failTest:
                  message: ENV_FAILURE - ${env} - Marquee ads missing in item page
            
      - click: 
          identifier: us.mappings.item.ad.Marquee1Logo

      - executeFunction:
          name: us.functions.search.closeHowDoYouWantYourOrderBottomTray

  - name: us.functions.item.ad.validateMarquee1Ad
    platform: ios
    flow:
      - scroll:
          direction: down          
          untilIdentifier: us.mappings.item.ad.Marquee1          
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.Marquee1
      - click:
          identifier: us.mappings.item.ad.Marquee1
      - try:
          flow:
            - verifyIdentifier:
                timeout: 30000
                present:
                  - identifier:  us.mappings.search.firstProductNameTitle  
          catch:
            flow:
              - verifyIdentifier:
                  timeout: 30000
                  present:
                    - identifier: us.mappings.search.ModuleView 

  - name: us.functions.item.ad.validateBuyboxAdview
    platform: android
    flow:
      - sleep: 
          duration: 5000 
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.ad.buyboxFlags  
            - name: direction
              string: down
            - name: scrollPosition
              string: center                                  
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.buyboxAd
            - identifier: us.mappings.item.ad.buyboxFlags  
            - identifier: us.mappings.item.ad.buyboxRatings
            - identifier: us.mappings.item.ad.buyboxReviews
            - identifier: us.mappings.item.ad.buyboxFulfillmentInfo
            - identifier: us.mappings.item.ad.buyboxSponsoredLabel
          text:
            - identifier: us.mappings.item.ad.buyboxSponsoredLabel
              contains: us.data.sbaAd.prod.textSponsored
      - sleep: 
          duration: 5000   
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.item.ad.buyboxad.ATCbutton
          then:
            - log: 'Button present'
            - click:
                identifier: us.mappings.item.ad.buyboxad.ATCbutton

     # Verify Buybox ad Item stepper
      - executeFunction:
          name: us.functions.itemPage.verifyStepper                

      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.buyboxad.clickonitem
      - click: 
          identifier: us.mappings.item.ad.buyboxad.clickonitem
          wait: 5000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.buyboxad.item.brandName
            - identifier: us.mappings.item.ad.buyboxad.item.title
            - identifier: us.mappings.item.ad.buyboxRatings
      # - click: 
      #     identifier: us.mappings.item.ad.buyboxad.item.close

  - name: us.functions.item.verifyProductAndAddToListAndAddToRegistery
    platform: android
    flow:
      - verifyIdentifier:
          present:
              - identifier: us.mappings.item.productNonConfigBundleView
              - identifier: us.mappings.itemPage.addToListOption
              - identifier: us.mappings.myitems.addregistrylink
      - click: 
          identifier: us.mappings.itemPage.addToListOption
      - sleep:
          duration: 4000
      - click: 
          identifier: us.mappings.item.productAddItemListPage
      - sleep:
          duration: 2000                                        
      - click: 
          identifier: us.mappings.global.saveButton
      - sleep:
          duration: 2000
      - click: 
          identifier: us.mappings.global.closeButton

  - name: us.functions.item.addRewardItemToList
    platform: android
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.itemPage.addToListOption
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - sleep:
          duration: 2000    
      - click: 
          identifier: us.mappings.itemPage.addToListOption
      - sleep:
          duration: 4000
      - click: 
          identifier: us.mappings.item.productAddItemListPage
      - sleep:
          duration: 2000                                        
      - click: 
          identifier: us.mappings.global.saveButton
      - sleep:
          duration: 2000

  - name: us.functions.item.addRewardItemToList
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.itemPage.addToListOption
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - click: 
          identifier: us.mappings.itemPage.addToListOption
      - sleep:
          duration: 4000
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.itemPage.createNewList
          then:
            - log: 'Create New list present'
            - click:
                identifier: us.mappings.itemPage.createNewList
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.itemPage.enterListName
            - enterText:
                identifier: us.mappings.itemPage.enterListName
                string: My List
            - sleep:
                duration: 2000
            - click: 
                identifier: us.mappings.itemPage.clickCreateList
          else:
            #  - click: 
            #      identifier: us.mappings.item.productAddItemListPage
            #  - sleep:
            #      duration: 2000                                        
             - click: 
                 identifier: us.mappings.item.productAddItemListPageSaveButton
             - sleep:
                 duration: 2000

  - name: us.functions.item.list.checkIfRewardAddedinTheList
    platform: android
    flow:
      - verifyIdentifier:
          present: 
              - identifier: us.mappings.list.earnedRewardTagWithCash
      # - click: 
      #     identifier: us.mappings.cart.navigateBackToMyItemsListPage

  - name: us.functions.item.list.checkIfRewardAddedinTheList
    platform: ios
    flow:
      - verifyIdentifier:
          present:
              - identifier: us.mappings.itemPage.clickOnFirstList
      - click: 
          identifier: us.mappings.itemPage.clickOnFirstList
      - verifyIdentifier:
          present: 
              - identifier: us.mappings.list.earnedRewardTagWithCash

  - name: us.functions.myItems.navigateToRegistriesTab
    platform: android
    flow: 
      - scroll:
          direction: down
      - scroll:
          direction: up         
      - executeFunction:
          name: us.functions.global.navigation.goToAccountFromTabBar
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.account.Registry
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - click:
          identifier: us.mappings.account.Registry

  - name: us.functions.myItems.registries.checkForRewardsOnItemPageInRegistry
    platform: android
    flow: 
      - verifyIdentifier:
          present:
              - identifier: us.mappings.account.registryDetails
      - click: 
          identifier: us.mappings.account.registryDetails
      - sleep:
          duration: 5000
      - click: 
          identifier: us.mappings.myItems.registries.clickFirstItemInRegistry
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.list.earnedRewardTagWithCash
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      
  - name: us.functions.item.ad.validateSpCarouselads
    platform: android
    flow:
      - sleep: 
          duration: 10000 
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.ad.spCarouselView
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.SpCarouselads.MoreItemstoConsider
      - sleep:
          duration: 3000
      - scroll:
          direction: left
          scrollLimit: 2
          withinIdentifier: us.mappings.item.ad.spCarouselView
      - sleep: 
          duration: 3000       
      - scroll:
          direction: right
          scrollLimit: 2 
          withinIdentifier: us.mappings.item.ad.spCarouselView
      - sleep: 
          duration: 3000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.ad.SpCarouseladsFulfillmentInfo 
            - name: direction
              string: down
            - name: scrollPosition
              string: center 
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.paneFirstitem
            - identifier: us.mappings.item.ad.paneSeconditem  
            - identifier: us.mappings.item.ad.SpCarouseladsRatings
            - identifier: us.mappings.item.ad.SpCarouseladsReviews          
            - identifier: us.mappings.item.ad.SpCarouseladsFulfillmentInfo

      - if: 
          identifier:
            present: 
              - identifier: us.mappings.item.ad.SponsoredAd.ATCbutton
          then:
            - log: 'Button present'
            - click:
                identifier: us.mappings.item.ad.SponsoredAd.ATCbutton

            - verifyIdentifier:
                text:
                  - identifier: us.mappings.item.ad.SpCarouselads.ItemCount
                    contains: 1                                 
            # - click:
            #     identifier: us.mappings.item.ad.SponsoredAd.ATCbutton
            # - click:
            #     identifier: us.mappings.item.ad.SponsoredAd.ATCbutton.increment               
            # - verifyIdentifier:
            #     text:
            #       - identifier: us.mappings.item.ad.SpCarouselads.ItemCount
            #         contains: 2     
            # - click:
            #     identifier: us.mappings.item.ad.SponsoredAd.ATCbutton
            #     longClick: true
            # - click:
            #     identifier: us.mappings.item.ad.SponsoredAd.ATCbutton.decrement
            # - verifyIdentifier:
            #     text:
            #       - identifier: us.mappings.item.ad.SpCarouselads.ItemCount
            #         contains: 1  
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.item.ad.SponsoredAd.ATCbutton 
      # - click: 
      #     identifier: us.mappings.item.ad.SponsoredAd.ATCbutton 
      # - sleep: 
      #     duration: 3000           
      # - if:
      #     identifier: 
      #       present:
      #         - identifier: us.mappings.item.ad.SpCarouselads.ItemCount
      #     then:    
      #       - click:
      #           identifier: us.mappings.item.ad.SpCarouselads.ItemCount        
      # - click: 
      #     identifier: us.mappings.item.ad.SponsoredAd.ATCbutton.increment 
      # - if:
      #     identifier: 
      #       present:
      #         - identifier: us.mappings.item.ad.SpCarouselads.ItemCount
      #     then:    
      #       - click:
      #           identifier: us.mappings.item.ad.SpCarouselads.ItemCount       
      # - click: 
      #     identifier: us.mappings.item.ad.SponsoredAd.ATCbutton.decrement
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.SpCarouseladsFulfillmentInfo 
      - click: 
          identifier: us.mappings.item.ad.SpCarouseladsFulfillmentInfo
      - sleep:
         duration: 5000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.SponsoredAd.item.brandName
            - identifier: us.mappings.item.ad.SponsoredAd.item.title
      - executeFunction:
         name: us.functions.item.closeItemPage


  - name: us.functions.item.ad.validateSpCarouselads
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.ad.spCarouselView
          position: center               
      - verifyIdentifier:
          timeout: 110000
          present:
            - identifier: us.mappings.item.ad.paneFirstitem
            - identifier: us.mappings.item.ad.paneSeconditem  
            - identifier: us.mappings.item.ad.SponsoredAd.item.ratings
            - identifier: us.mappings.item.ad.SpCarouseladsReviews 
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.item.ad.SpCarouselads.ATCbutton
          then:
            - log: 'Button present'
            - click:
                identifier: us.mappings.item.ad.SpCarouselads.ATCbutton
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.item.ad.SpCarouselads.ATCQuantityListView
          then:
            - log: 'pop up present'
            - click:
                identifier: us.mappings.item.ad.SpCarouselads.ATCQuantityListView1             
            - verifyIdentifier:
                label:
                  - identifier: us.mappings.item.ad.SpCarouselads.ItemCount
                    contains: 1                                 
            - click:
                identifier: us.mappings.item.ad.SpCarouselads.ATCbutton
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.item.ad.SpCarouselads.ATCQuantityListView
          then:
            - log: 'pop up present'
            - click:
                identifier: us.mappings.item.ad.SpCarouselads.ATCQuantityListView1                
            - click:
                identifier: us.mappings.item.ad.SponsoredAd.ATCbutton.increment
            - verifyIdentifier:
                label:
                  - identifier: us.mappings.item.ad.SpCarouselads.ItemCount
                    contains: 2     
            - click:
                identifier: us.mappings.item.ad.SpCarouselads.ATCbutton
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.item.ad.SpCarouselads.ATCQuantityListView
          then:
            - log: 'pop up present'
            - click:
                identifier: us.mappings.item.ad.SpCarouselads.ATCQuantityListView2                
            - click:
                identifier: us.mappings.item.ad.SponsoredAd.ATCbutton.decrement
            - verifyIdentifier:
                label:
                  - identifier: us.mappings.item.ad.SpCarouselads.ItemCount
                    contains: 1                  
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.item.ad.SpCarouselads.PostAddToCartView
          then:
            - log: 'pop up present'
            - click:
                identifier: us.mappings.item.ad.SpCarouselads.ClosePostAddToCartView

      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.paneFirstitem     
      - click: 
          identifier: us.mappings.item.ad.paneFirstitem          
      - verifyIdentifier:
          timeout: 180000
          present:
            - identifier: us.mappings.item.ad.SponsoredAd.item.brandName
            - identifier: us.mappings.item.ad.SponsoredAd.item.title
            - identifier: us.mappings.item.ad.SponsoredAd.item.ratings
      # - click: 
      #     identifier: us.mappings.item.ad.SponsoredAd.item.close

  - name: us.function.item.verifyACCModule.DetailsLink
    platform: android 
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ACCdetailsLink  
      - click: 
          identifier: us.mappings.item.ACCdetailsLink
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ACCdetailsPageHeading            
      - executeFunction:
          name: us.functions.global.navigation.backNavigation   
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.ACCdetailsPageHeading
          then:
            - executeFunction:
                name: us.functions.global.navigation.backNavigation 
                          
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ACCdetailsLink         

  - name: us.functions.item.verifyBuynowButton
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.buyNow.buyNowButton      
          then:
            - failTest:
                message: ENV_FAILURE - ${env} - Buynow Button is not disabled
          else: 
            - log: 'Buynow Button Disabled'

  - name: us.function.item.verifyACCModule.verifyInstallation
    platform: android
    flow:
      - if:
          condition: ${checkboxPresent}
          then:
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.item.getExpertTireInstallationCheckBox
                then:
                  - click:
                      identifier: us.mappings.item.getExpertTireInstallationCheckBox
                  - sleep: 
                      duration: 5000
                  - verifyIdentifier:
                      checked:
                        - identifier: us.mappings.item.getExpertTireInstallationCheckBox
                          value: true
                  - log: 'checkbox already selected'
                  - sleep: 
                      duration: 5000
                  - click:
                      identifier: us.mappings.item.getExpertTireInstallationCheckBox
                  - log: 'checkbox not selected'
                else:
                  - if:
                      identifier:
                        present:
                          - identifier: us.mappings.associateDiscount.VerifyDiscountpolicyArrow
                      then:                     
                        - click:
                            identifier: us.mappings.associateDiscount.VerifyDiscountpolicyArrow   
                        - verifyIdentifier:
                            timeout: 10000
                            notPresent:
                              - identifier: us.mappings.item.idontNeedInstallationRadioButtonSelected
                        - log: 'ACC Module collapsed'                     
                        - sleep: 
                            duration: 5000 
                        - verifyIdentifier:
                            present:             
                              - identifier: us.mappings.associateDiscount.VerifyDiscountpolicyArrow 
                        - click:
                            identifier: us.mappings.associateDiscount.VerifyDiscountpolicyArrow 
                        - executeFunction:
                            name: us.functions.utils.scrollIfNotVisible
                            params:
                              - name: identifier
                                string: us.mappings.item.idontNeedInstallationRadioButtonSelected
                              - name: direction
                                string: down
                        - verifyIdentifier:
                            present:      
                              - identifier: us.mappings.item.idontNeedInstallationRadioButtonSelected     
                        - log: ACC Module Expanded
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.item.tireInstallationRadioButtonNotSelected         
                  - click:
                      identifier: us.mappings.item.tireInstallationRadioButtonNotSelected
                  - sleep: 
                      duration: 5000 
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.item.tireInstallationRadioButtonSelected             
                  - click:
                      identifier: us.mappings.associateDiscount.VerifyDiscountpolicyArrow               
                  - sleep: 
                      duration: 5000 
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.item.tireInstallationTitle   
                  - click:
                      identifier: us.mappings.associateDiscount.VerifyDiscountpolicyArrow             
                  - sleep: 
                      duration: 5000 
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.item.tireInstallationRadioButtonSelected             
                  - sleep: 
                      duration: 5000 
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.item.idontNeedInstallationRadioButtonNotSelected            
                  - click:
                      identifier: us.mappings.item.idontNeedInstallationRadioButtonNotSelected            
                  - sleep: 
                      duration: 5000 
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.item.idontNeedInstallationRadioButtonSelected                     

  - name: us.function.item.verifyACCModule.DetailsLink
    platform: ios 
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ACCdetailsLink  
      - click: 
          identifier: us.mappings.item.ACCdetailsLink
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ACCdetailsPageHeading
      - sleep: 
          duration: 5000    
      - verifyIdentifier:
          present:
            - identifier: us.mappings.global.navigateBackArrow 
      - loop:
          begin: 0
          end: 3
          storeIndex: i
          flow:
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.global.navigateBackArrow
                then:
                  - click:
                      identifier: us.mappings.global.navigateBackArrow
                else:
                  - break: true                        
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ACCdetailsLink         

  - name: us.functions.item.verifyBuynowButton
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.buyNow.buyNowButton      
          then:
            - failTest:
                message: ENV_FAILURE - ${env} - Buynow Button is not disabled
          else: 
            - log: 'Buynow Button Disabled'

  - name: us.function.item.verifyACCModule.verifyInstallation
    platform: ios
    flow:
      - if:
          condition: ${checkboxPresent}
          then:
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.item.getExpertTireInstallationCheckBox
                then:
                  - click:
                      identifier: us.mappings.item.getExpertTireInstallationCheckBox
                  - sleep: 
                      duration: 5000
                  - verifyIdentifier:
                      value:
                        - identifier: us.mappings.item.getExpertTireInstallationCheckBox
                          equals: 1
                  - log: 'checkbox already selected'
                  - sleep: 
                      duration: 5000
                  - click:
                      identifier: us.mappings.item.getExpertTireInstallationCheckBox
                  - log: 'checkbox not selected'
                else:
                  - if:
                      identifier:
                        notPresent:
                          - identifier: us.mappings.item.idontNeedInstallationRadioButtonSelected
                      then:
                        - log:  ACC Module collapsed
                        - verifyIdentifier:
                            present:
                              - identifier: us.mappings.item.AccModule.ExpandButton
                        - click:
                            identifier: us.mappings.item.AccModule.ExpandButton
                        - log:  ACC Module Expanded
                      else:
                        - log:  ACC Module Expanded
                        - verifyIdentifier:
                            present:
                              - identifier: us.mappings.item.AccModule.CollapseButton
                        - click:
                            identifier: us.mappings.item.AccModule.CollapseButton
                        - log:  ACC Module collapsed
                        - verifyIdentifier:
                            present:
                              - identifier: us.mappings.item.AccModule.ExpandButton
                        - click:
                            identifier: us.mappings.item.AccModule.ExpandButton
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.item.tireInstallationRadioButtonNotSelected
                  - click:
                      identifier: us.mappings.item.tireInstallationRadioButtonNotSelected
                  - sleep:
                      duration: 5000
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.item.tireInstallationRadioButtonSelected
                  - click:
                      identifier:  us.mappings.item.AccModule.CollapseButton
                  - sleep:
                      duration: 5000
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.item.tireInstallationTitle
                  - click:
                      identifier:  us.mappings.item.AccModule.ExpandButton
                  - sleep:
                      duration: 5000
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.item.tireInstallationRadioButtonSelected
                  - sleep:
                      duration: 5000
                  - verifyIdentifier:
                      selected:
                        - identifier: us.mappings.item.idontNeedInstallationRadioButtonSelected
                          value: false
                  - click:
                      identifier: us.mappings.item.idontNeedInstallationRadioButtonSelected
                  - sleep:
                      duration: 5000
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.item.idontNeedInstallationRadioButtonSelected

  - name: us.functions.item.reviewlink
    platform: ios
    flow:
      - storeIn:
          key: reviewlinkbutton
          value: false    
      - loop:
          each: ${reviewlink}
          storeElement: items
          storeIndex: itemIndex
          flow:
              - executeFunction:
                  name: us.functions.search.searchItem
                  params:
                    - name: searchTerm
                      string: $items
              - sleep: 
                  duration: 5000  

              - executeFunction:
                  name: us.functions.gic.changeFulfillment
                  params:
                    - name: option
                      string: Shipping

              - executeFunction:
                  name: us.functions.search.applyGiftFilter                    
              - executeFunction:
                  name: us.functions.search.clickOnFirstItem                 
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.item.reviewLink
                  then:
                    - log: 'Review link is present'
                    - storeIn:
                        key: reviewlinkbutton
                        value: true                            
                    - break: true
                  else:  
                    - verifyIdentifier:
                        notPresent:
                          - identifier: us.mappings.item.reviewLink                
                    - click:
                        wait: 3000
                        identifier: us.mappings.item.closeButton

  - name: us.functions.item.ad.validatePickupInItemPage
    platform: android
    flow:

      - loop:
          each: ${pickupItems}
          storeElement: items
          storeIndex: itemIndex
          flow:
              - executeFunction:
                  name: us.functions.global.navigation.goToDeepLink
                  params:
                    - name: deepLinkUrl
                      string: walmart://item/$items
              - sleep: 
                  duration: 5000  
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.item.showShippingDeliveryAndPickupOptionsButton    
                  then: 
                    - click:
                        identifier: us.mappings.item.showShippingDeliveryAndPickupOptionsButton                  
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.item.marketplacePickupLabel
                  then:
                    - executeFunction:
                        name: us.function.item.mppickup.verifyPartnerBadge   
                    - storeIn:
                        key: Pickup
                        value: true                            
                    - break: true
      - if:
          condition: ${Pickup} != true
          then:
            - failTest:
                message: "DATA_FAILURE - ${env} - No Pickup Fulfilment present for three items"

  - name: us.functions.item.ad.validatePickupInItemPage
    platform: ios
    flow:
      - scroll:
          direction: down 
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.showShippingDeliveryAndPickupOptionsButton    
          then: 
            - click:
                identifier: us.mappings.item.showShippingDeliveryAndPickupOptionsButton 

      # - executeFunction:
      #     name: us.functions.utils.scrollIfNotVisible
      #     params:
      #       - name: identifier
      #         string: us.mappings.item.switching.fulfillment.pickupText 
      #       - name: direction
      #         string: down
      #       - name: scrollPosition
      #         string: center
      - click:
          identifier: us.mappings.item.switching.fulfillment.pickupText                    
      - if:
          identifier:
            present:   
              - identifier: us.mappings.item.marketplacePickupLabelNotAvailable 
          then: 
              - click:
                  identifier: us.mappings.item.marketplacePickupLabelNotAvailable 
              - click:
                  identifier:  us.mappings.item.marketplacePickupChangeStoreRadioButton 
              - click:
                  identifier:  us.mappings.gic.selectStore.save.button # us.mappings.home.selectStoreSaveButton 
              - sleep: 
                  duration: 5000
              - scroll:
                  direction: up
      - if:
          identifier:
            present:   
              - identifier: us.mappings.item.marketplacePickupLabel  
          then: 
            - log: MP Pickup Item Validated
          else:
            - failTest:
                message: "DATA_FAILURE - ${env} - MP Pickup item not available"


  - name: us.functions.item.addFitmentDetails
    platform: ios
    flow:
      - scroll:
          direction: down
      - if: 
          identifier:
              present:
              - identifier: us.mappings.search.fitmentDetailsChangeButton
          then:
            - click:
                identifier: us.mappings.search.fitmentDetailsChangeButton
            - click:
                identifier: us.mappings.item.removeVehicleCta

      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.addVechicleCta
            - name: direction
              string: up
            - name: scrollPosition
              string: center
      - click:
          identifier: us.mappings.item.addVechicleCta
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.addVechicleFormTitle
      - log: Add vehicle details
      - click:
          identifier: us.mappings.search.fitment.selectYeardropdown
      - sleep:  
          duration: 2000
      - enterText:
          identifier: us.mappings.search.fitment.pickerWheel 
          string: ${year}  
      - click:
          identifier: done 
      - click:
          identifier:  us.mappings.search.fitment.selectMakedropdown
          wait: 3000
      - enterText:
          identifier: us.mappings.search.fitment.pickerWheel 
          string: ${make}
      - click:
          identifier: done  
      - click:
          identifier: us.mappings.search.fitment.selectModeldropdown
      - enterText:
          identifier: us.mappings.search.fitment.pickerWheel 
          string: ${model} 
      - click:
          identifier: done 
      - click:
          identifier: us.mappings.search.fitment.selectSubmodeldropdown
      - enterText:
          identifier: us.mappings.search.fitment.pickerWheel 
          string: ${submodel} 
      - click:
          identifier: done 
      - click:
          identifier:  us.mappings.search.fitment.selectTireSizedropdown
      - click:
          identifier: done
      - click:
          identifier: us.mappings.search.fitment.viewResultButton
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.addVechicleSuccessText
            - name: direction
              string: up
            - name: scrollPosition
              string: center

  - name: us.functions.item.addFitmentDetails
    platform: android
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.changeVehicleCta
            - name: direction
              string: down
            - name: scrollPosition
              string: center  
      - if: 
          identifier:
              present:
              - identifier: us.mappings.item.changeVehicleCta
          then:
            - click:
                identifier: us.mappings.item.changeVehicleCta
            - click:
                identifier: us.mappings.item.removeVehicleCta
          # else:
          #   - log: Vechile is alredy added   
      - if: 
          identifier:
              notPresent:
              - identifier: us.mappings.item.addVechicleCta
          then:
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.item.addVechicleCta
                  - name: direction
                    string: down
                  - name: scrollPosition
                    string: center
            - click:
                identifier: us.mappings.item.addVechicleCta
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.addVechicleFormTitle
            - log: Add vehicle details
            - click:
                identifier: us.mappings.search.fitment.selectYeardropdown
            - click:
                identifier: us.mappings.search.fitment.year
            - click:
                identifier: us.mappings.search.fitment.selectMakedropdown 
                wait: 3000  
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.search.fitment.make
                  - name: direction
                    string: down  
            - click:
                identifier: us.mappings.search.fitment.make
            - click:
                identifier: us.mappings.item.vehicle.selectModeldropdown   
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.search.fitment.model 
                  - name: direction
                    string: down
            - click:
                identifier: us.mappings.search.fitment.model 
            - click:
                identifier: us.mappings.search.fitment.selectSubmodeldropdown   
            - click:
                identifier: us.mappings.search.fitment.submodel
            - click:
                identifier: us.mappings.search.fitment.selectTireSizedropdown  
            - click:
                identifier: us.mappings.search.fitment.tireSize  
            - click:
                identifier: us.mappings.search.fitment.viewResultButton
            - verifyIdentifier:
                text:
                  - identifier: us.mappings.search.fitmentStatusMessage 
                    contains: This tire is a good fit

  - name: us.functions.item.selectItemVariants
    platform: android
    flow:
      - sleep:
          duration: 5000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.variant.firstContainerVariant
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.variant.firstContainerVariant
      - click:
          identifier: us.mappings.item.variant.firstContainerVariant
      - sleep:
          duration: 5000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.variant.secondContainerVariant
            - name: direction
              string: right
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.variant.secondContainerVariant
      - click:
          identifier: us.mappings.item.variant.secondContainerVariant
      - sleep:
          duration: 5000
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.variant.thirdContainerVariant
            - name: direction
              string: right
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.variant.thirdContainerVariant
      - click:
          identifier: us.mappings.item.variant.thirdContainerVariant
      - sleep:
          duration: 5000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.variant.secondContainerVariant
      - click:
          identifier: us.mappings.item.variant.secondContainerVariant
      - sleep:
          duration: 5000
      - getString:
          identifier: us.mappings.item.variant.selectedVariantTitle
          attribute: text
          storeIn: itemPageVariant
      - log: $itemPageVariant

  - name: us.functions.cart.verifySingleVariantDetails
    platform: android
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.cart.singleItemvariant
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      # Validate variant section
      - verifyIdentifier:
          present:
            - identifier: us.mappings.cart.itemPresent.itemNameLabel
      - getString:
          identifier: us.mappings.cart.singleItemvariant
          attribute: text
          storeIn: cartSingleVariant
      - verifyIdentifier:
          text:
            - identifier: us.mappings.cart.singleItemvariant
              contains: ${itemPageVariant}
      - log: Variant selected in item page is displayed in cart

  - name: us.functions.item.selectItemVariants
    platform: ios
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.item.variant.firstContainerVariant
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - loop:
          begin: 2
          end: 3
          mode: increment
          storeIndex: index
          flow:
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.item.variant.secondContainerVariant
                  - name: direction
                    string: right
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.item.variant.secondContainerVariant
            - click:
                identifier: us.mappings.item.variant.secondContainerVariant
            - sleep:
                duration: 2000    
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.item.variant.firstContainerVariant
                  - name: direction
                    string: up
                  - name: scrollPosition
                    string: center          
      - getString:
          identifier: us.mappings.item.variant.singleVariantOptionsText
          attribute: label
          storeIn: itemPageVariant
      - try:
          flow: 
            - verifyIdentifier:
                label:
                  - identifier: us.mappings.item.variant.singleVariantOptionsText
                    contains: select
            - executeNode:
                file: us/e2e-tests/helpers/splitString.js
                args:
                  - value: ${itemPageVariant}
                  - value: select Actual
                getResponse:
                  storeIn: itemPageVariant
            - log: $itemPageVariant    
          catch:
            flow:
              - log: $itemPageVariant  

  - name: us.functions.item.deepLink.checkItemAvailable
    platform: android
    flow:
      - storeIn:
          key: failedItems
          value: 'Items used : '
      - loop:
          each: ${itemArray}
          storeElement: items
          storeIndex: itemIndex
          flow:
              - executeFunction:
                  name: us.functions.global.navigation.goToDeepLink
                  params:
                    - name: deepLinkUrl
                      string: walmart://item/$items
              - sleep: 
                  duration: 5000  
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.item.addToCartButton
                  then:
                    - log: "$items Item Available"                            
                    - break: true
                  else:
                    - log: $items Not Available.
                    - storeIn:
                        key: failedItems
                        value: ${failedItems} , $items
      - storeIn:
          key: itemDataDetails
          value: ${failedItems}

  - name: us.functions.item.benefitCenter.verifyBCBSEligibility
    platform: android
    flow:
      - loop:
         begin: 1
         end: 6
         flow:    
           - executeFunction:
               name: us.functions.utils.scrollIfNotVisible
               params:
                 - name: identifier
                   string: us.mappings.item.benefitscard.verifyBCBSEligibleText
                 - name: direction
                   string: down
                 - name: scrollPosition
                   string: center
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.benefitscard.verifyBCBSEligibleText
            - identifier: us.mappings.item.verifyBCBSEligibilityDetailsBtn

  - name: us.functions.item.benefitCenter.clickOnDetailsBtn
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.verifyBCBSEligibilityDetailsBtn
      - log: Before Click clickOnViewBnftTrackr
      - click:
          identifier: us.mappings.item.verifyBCBSEligibilityDetailsBtn

  - name: us.functions.item.benefitCenter.verifyBCBSDtlsCTA
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.benefitscard.BCBSProgramDtlsCTA.BCBSBnftPrgrmHeadr
            - identifier: us.mappings.item.benefitscard.BCBSProgramDtlsCTA.backBtnOnCTA
      - log: Before Click clickOnViewBnftTrackrOK
      - click:
          identifier: us.mappings.item.benefitscard.BCBSProgramDtlsCTA.backBtnOnCTA


  - name: us.functions.item.3pSeller
    platform: ios
    flow:
      - storeIn:
          key: soldAndShippedByText
          value: false    
      - loop:
          each: ${3pSellerItem}
          storeElement: items
          storeIndex: itemIndex
          flow:
              - executeFunction:
                  name: us.functions.search.searchItem
                  params:
                    - name: searchTerm
                      string: $items
              - sleep: 
                  duration: 5000            
              - executeFunction:
                  name: us.functions.search.clickOnFirstItem                 
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.item.soldAndShippedBy
                  then:
                    - storeIn:
                        key: soldAndShippedByText
                        value: true                            
                    - break: true
                  else:                
                    - click:
                        wait: 3000
                        identifier: us.mappings.item.closeButton

  - name: us.functions.item.deepLink.multiboxItems
    platform: ios
    flow:
      - loop:
          each: ${mbtItemArray}
          storeElement: items
          storeIndex: itemIndex
          flow:
              - executeFunction:
                  name: us.functions.global.navigation.goToDeepLink
                  params:
                    - name: deepLinkUrl
                      string: walmart://item/$items
              - sleep: 
                  duration: 5000  
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.item.addToCartButton
                  then:
                    - log: "$items Item Available" 
                    - break: true 
                  else:
                      - log: $items Not Available.

  # Verify petrx item prescription badge
  - name: us.functions.item.petrxItem.verifyPresentInSearchResults
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.itemPage.petRXitemName
            - identifier: us.mappings.item.petrxprescriptionBadge

  - name: us.functions.item.visionItem.verifyRestrictedAddressText
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.switching.fulfillment.shippingText
          position: center
      - click:
          identifier: us.mappings.item.switching.fulfillment.shippingText 
      - sleep:
         duration: 2000                        
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.vision.restrictedAdressText     
      - getString:
          identifier: us.mappings.item.vision.restrictedAdressText
          attribute: text
          storeIn: restrictedAdressText
      - log: $restrictedAdressText text is displayed on item page         

  - name: us.functions.item.visionItem.verifySearchPage
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.search.badging.shipping    
            # - identifier: us.mappings.search.prescriptionAvailable.icon
            - identifier: us.mappings.search.prescriptionAvailable.text
            - identifier: us.mappings.search.item.optionsBtn
      - log: Verified delivery fulfillment and PD icon & text on vision item search page   
      - click:
          identifier: us.mappings.search.item.optionsBtn
      - log: Navigating to vision item page           
      - sleep:
          duration: 3000          

  - name: us.functions.item.addVisionPDImage
    platform: ios
    flow:
      - click:
          identifier: us.mappings.visionItem.addPrescription.AddPhoto
      - verifyIdentifier:
          timeout: 40000
          present:
            - identifier: us.mappings.visionItem.verifyprescriptionContinueCTA           
      - click:
          identifier: us.mappings.visionItem.verifyprescriptionContinueCTA
      - verifyIdentifier:
          present:
            - identifier: us.mappings.visionItem.chooseExistingCTA           
      - click:
          identifier: us.mappings.visionItem.chooseExistingCTA
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.item.addPrescription.accessPhotos.continue
          then:
            - click:
                identifier: us.mappings.item.addPrescription.accessPhotos.continue  
      - sleep:
          duration: 3000
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.item.addPrescription.photos.allowAccess 
          then:
            - click:
                identifier: us.mappings.item.addPrescription.photos.allowAccess
      - verifyIdentifier:
          timeout: 80000
          present:
            - identifier: us.mappings.visionItem.selectImage 
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.visionItem.selectImage 
          then:
            - click:
                identifier: us.mappings.visionItem.selectImage  
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - PD image is not available" 
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.item.addPrescription.done
          then:
            - click:
                identifier: us.mappings.item.addPrescription.done                        
      - if: 
          identifier:
            present: 
              - identifier: us.mappings.item.addPrescription.accessPhotosPopUp
          then:
            - click:
                identifier: us.mappings.item.addPrescription.accessPhotosPopUp     
      - sleep:
         duration: 5000               

  - name: us.functions.itemPage.verifyStepper
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.buyboxad.ATCbutton
          label:
            - identifier: us.mappings.item.ad.buyboxad.ATCbuttonCount
              contains: 1
      - log: QTY '1' is displayed item buy box atc validated.  
      # - log: Verifying if stepper value can be increased.
      # - verifyIdentifier:
      #       timeout: 50000
      #       present:
      #         - identifier: us.mappings.itemPage.buyboxAd.stepper.incrementBtn
      # - executeFunction:
      #     name: us.functions.utils.scrollIfNotVisible
      #     params:
      #       - name: identifier
      #         string: us.mappings.item.ad.buyboxFulfillmentInfo
      #       - name: direction
      #         string: up
      #       - name: limit
      #         string: 15
      # - click: 
      #     identifier: us.mappings.itemPage.buyboxAd.stepper.incrementBtn
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.item.verifyAddToCartCTA
      #     label:
      #       - identifier: us.mappings.item.verifyAddToCartCTA
      #         contains: 2         
      # - log: Stepper value is increased and QTY = 2
      - log: Verifying if stepper value can be decreased.
      - click: 
          identifier: us.mappings.item.ad.buyboxad.ATCbutton.decrementBtn
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.ad.buyboxad.ATCbutton
          label:
            - identifier: us.mappings.item.ad.buyboxad.ATCbutton
              contains: Add to Cart      
      - log: Stepper value is decreased and QTY 0            

  - name: us.functions.itemPage.verifyStepper
    platform: android
    flow:
      - verifyIdentifier:
          text:
            - identifier: us.mappings.item.ad.buyboxad.ATCbuttonCount
              contains: 1  
      - log: Default QTY '1' is displayed.  
      - log: Verifying if stepper value can be increased.
      - sleep:
          duration: 3000
      - click:
          identifier: us.mappings.item.ad.buyboxad.ATCbuttonCount 
      - click: 
          identifier: us.mappings.item.ad.SponsoredAd.ATCbutton.increment
      - verifyIdentifier:
          text:
            - identifier: us.mappings.item.ad.buyboxad.ATCbuttonCount
              contains: 2         
      - log: Stepper value is increased and QTY = 2
      - log: Verifying if stepper value can be decreased.
      - sleep:
          duration: 3000      
      - click:
          identifier: us.mappings.item.ad.buyboxad.ATCbuttonCount            
      - click: 
          identifier: us.mappings.item.ad.buyboxad.ATCbutton.decrement
      - verifyIdentifier:
          text:
            - identifier: us.mappings.item.ad.buyboxad.ATCbuttonCount
              contains: 1          
      - log: Stepper value is decreased and QTY = 1       

  - name: us.functions.item.visionItem.selectLenses.verifyNavigations
    platform: ios
    flow: 
      - storeIn:
          key: executionStage
          value: Transactions              
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.verifySelectLensesCTA
          position: center                        
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.verifySelectLensesCTA
      - click: 
          identifier: us.mappings.item.verifySelectLensesCTA
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.verifySelectYourLensesTitle   
            - identifier: us.mappings.item.verifySingleVisionLense                
            - identifier: us.mappings.item.continueButton 
            - identifier: us.mappings.item.selectLensCloseButton             
      - click: 
          identifier: us.mappings.item.verifySingleVisionLense
      - click: 
          identifier: us.mappings.item.continueButton
      - sleep:
          duration: 4000          
      - log: Successfully navigated to next screen by selecting 'Continue' 
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.verifyWhatTypesOfLesesYouNeed     
            - identifier: us.mappings.global.navigation.backNav.resourceId 
            - identifier: us.mappings.item.iTooltip
      - log: Lens demo i tooltip is displayed           
      - click: 
          identifier: us.mappings.item.iTooltip
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.lenseDemoTitle    
            # - identifier: us.mappings.item.lenseDemoGotIt 
            - identifier: us.mappings.item.lenseDemoCloseBtn
      - log: Lens demo bottom sheet is displayed             
      - click: 
          identifier: us.mappings.item.lenseDemoCloseBtn
      - log: '< is displayed'
      - click: 
          identifier: us.mappings.global.navigation.backNav.resourceId
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.verifySelectYourLensesTitle 
            - identifier: us.mappings.item.selectLensCloseButton
      - log: Successfully navigated to previous screen by selecting '<'
      - click: 
          identifier: us.mappings.item.selectLensCloseButton
      - sleep:
         duration: 3000
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.verifySelectLensesCTA 
      - log: Successfully navigated to item page by selecting 'X'

  - name: us.functions.item.verifyNonConfigItem.bundleDetails
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.nonConfigItemBundleTitle
          position: center   
      - verifyIdentifier:
          text:
            - identifier: us.mappings.item.nonConfigItemBundleTitle
              contains: This bundle includes
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.nonConfigItemBundleoptions


  - name: us.functions.item.verifyNonConfigItem.bundleDetails
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.nonConfigItemBundleTitle
          position: center   
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.nonConfigItemBundleTitle
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.nonConfigItemBundleoptions

  - name: us.functions.item.verifyBackOrderTagIsSeenInItemDetailsPage
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.itemDetails.backOrderPriceGuarantee
          then:
            - log: "The backorder price guarantee is shown as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Backordered badge is not present as expected"

  - name: us.functions.item.verifyBackOrderTagIsSeenInItemDetailsPage
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.itemDetails.backOrderPriceGuarantee
          then:
            - log: "The backorder price guarantee is shown as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Backordered badge is not present as expected"

  - name: us.functions.item.verifyBackOrderPriceGuaranteeDetailsLink
    platform: ios
    flow:
      - click:
          identifier: us.mapping.item.itemDetails.backOrderPriceGuaranteeDetailsButton
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.itemDetails.backOrderPriceGuaranteeBottomSheetHeader
          then:
            - log: "Backorder bottomsheet is shown as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Details link is non functional"

  - name: us.functions.item.verifyBackOrderPriceGuaranteeDetailsLink
    platform: android
    flow:
      - click:
          identifier: us.mapping.item.itemDetails.backOrderPriceGuaranteeDetailsButton
      - if:
          identifier:
            present:
              - identifier: us.mappings.item.itemDetails.backOrderPriceGuaranteeBottomSheetHeader
          then:
            - log: "Backorder bottomsheet is shown as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Details link is non functional"

  - name: us.functions.item.verifyBackorderPriceGuaranteeBottomsheet
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.itemDetails.backOrderPriceGuaranteeBottomSheetHeader
            - identifier: us.mappings.item.itemDetails.instructionReadingBanner
            - identifier: us.mappings.item.itemDetails.termsBottomsheetGotItButton
      - click:
          identifier: us.mappings.item.itemDetails.termsBottomsheetGotItButton

  - name: us.functions.item.verifyBackorderPriceGuaranteeBottomsheet
    platform: android
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.item.itemDetails.backOrderPriceGuaranteeBottomSheetHeader
            - identifier: us.mappings.item.itemDetails.instructionReadingBanner
            - identifier: us.mappings.item.itemDetails.termsBottomsheetGotItButton
      - click:
          identifier: us.mappings.item.itemDetails.termsBottomsheetGotItButton