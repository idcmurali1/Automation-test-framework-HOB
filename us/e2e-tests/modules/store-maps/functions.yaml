functions:

#**************************************************************** iOS ******************************************************
  - name: us.functions.storeMaps.mapView
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.search.storeMapsAisle
          then:
            - click:
                identifier: us.mappings.search.storeMapsAisle
                wait: 4000
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.storeMaps.mapView
            - click:
                identifier:  us.mappings.storeMaps.mapViewCloseButton
          else:
            - log: Direct map link unavailable in search results, validating same in item page

  - name: us.functions.inStorePickup.filter
    platform: ios
    flow:
      - scroll:
          direction: up
      - click:
          identifier: us.mappings.choice.inStore.filter
          wait: 7000

  - name: us.functions.storeMaps.itemPage.mapView
    platform: ios
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.storeMaps.centerIntentView
          position: center
          timeout: 600000  
      - if:
          identifier:
            present:
              - identifier: us.mappings.storeMaps.itemPage.aisleNumber
          then:
            - click:
                identifier: us.mappings.storeMaps.itemPage.aisleNumber              
                # coordinates: 203, 1615
                wait: 4000
          else:
            - click:
                identifier: us.mappings.item.switching.fulfillment.pickupText
            - sleep:
                duration: 2000
            - click:
                identifier: us.mappings.item.inStoreMapsProductLocation 
      # - click:
      #     identifier: us.mappings.storeMaps.itemPage.aisleNumber
      #     wait: 4000
      - if:
          identifier:
            present:
              - identifier: us.mappings.storeMaps.mapView
          then:
            - log: "Map view displayed as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Map view not displayed as expected"
      - if:
          identifier:
            present:
              - identifier: us.mappings.storeMaps.mapViewBackButton
          then:
            - click:
                identifier: us.mappings.storeMaps.mapViewBackButton
          else:
            - click:
                identifier:  us.mappings.storeMaps.mapViewCloseButton

  - name: us.functions.storeMaps.services.storeMap.mapView
    platform: ios
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.storeMaps.services.mapView            
          then:
            - log: "Map view displayed as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Map view not displayed as expected"
      - if:
          identifier:
            present:
              - identifier: us.mappings.storeMaps.map            
          then:
            - log: "Map displayed as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Map not displayed as expected"

  #****************************************************** Android *********************************************************

  - name: us.functions.storeMaps.mapView
    platform: android
    flow:
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.storeMaps.aisleNumber
            - name: direction
              string: down
      - click:
          identifier: us.mappings.storeMaps.aisleNumber
          wait: 10000
      - if:
          identifier:
            present:
              - identifier: us.mappings.storeMaps.mapView
          then:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.storeMaps.mapView.itemCard
                  - identifier: us.mappings.storeMaps.mapView.itemCard.aisle
            - log: "Map view displayed as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Map view not displayed as expected"

      - click:
          identifier:  us.mappings.storeMaps.mapViewCloseButton

  - name: us.functions.inStorePickup.filter
    platform: android
    flow:
      - scroll:
          direction: up
      - click:
          identifier: us.mappings.choice.inStore.filter
          wait: 7000

  - name: us.functions.storeMaps.itemPage.mapView
    platform: android
    flow:
      - scroll:
          direction: down
          untilIdentifier: us.mappings.item.switching.fulfillment.pickupText
          scrollLimit: 3
      - if:
          identifier:
            present:
              - identifier: us.mappings.storeMaps.itemPage.aisleNumber
          then:
            - click:
                identifier: us.mappings.storeMaps.itemPage.aisleNumber
                wait: 4000
          else:
            - click:
                identifier: us.mappings.item.switching.fulfillment.pickupText
            - sleep:
                duration: 2000
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.storeMaps.itemPage.aisleNumber
                  - name: direction
                    string: down
            - click:
                identifier: us.mappings.storeMaps.itemPage.aisleNumber
      - if:
          identifier:
            present:
              - identifier: us.mappings.storeMaps.mapView
          then:
            - log: "Map view displayed as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Map view not displayed as expected"
      # - verifyIdentifier:
      #     present:
      #       - identifier: us.mappings.storeMaps.mapView
      - if:
          identifier:
            present:
              - identifier: us.mappings.storeMaps.backButton
          then:
            - click:
                identifier:  us.mappings.storeMaps.backButton
          else:
            - click:
                identifier: us.mappings.global.closeButton

  - name: us.functions.storeMaps.services.storeMap.mapView
    platform: android
    flow:
      - if:
          identifier:
            present:
              - identifier: us.mappings.storeMaps.services.mapView         
          then:
            - log: "Map view stor name displayed as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Map view store name not displayed as expected"
      - if:
          identifier:
            present:
              - identifier: us.mappings.storeMaps.map         
          then:
            - log: "Map displayed as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Map not displayed as expected"