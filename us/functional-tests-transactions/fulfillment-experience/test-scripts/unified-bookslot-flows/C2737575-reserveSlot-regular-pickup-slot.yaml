general:
  tags: prod-functional-bookslot, C2737575
  inherit:
    filesRunAll:
    - us-errors-helpers.yaml
  testCaseId: C2737575

scenarios:
  - name: Before
    before: true
    endTestOnFailure: true
    flow:
      # Get Environment Values
      - executeFunction:
          name: us.function.utils.getEnvironmentValue

      # Set Platform Values
      - executeFunction:
          name: functions.utils.setPlatformInfo

      - log: End Before test
  # * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      - log: 'R2_SUBFLOW_PRE_TRANSACTION'
  # * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

  - name: Main
    flow:
    - log: Start Main

    # Navigate onboarding to home
    - executeFunction:
        name: us.functions.global.onboarding.navigateOnboardingToHome

    # Navigate to sign in page
    - executeFunction:
        name: us.functions.home.navigateHomeToSignIn

    # Sign in with default account
    - executeFunction:
        name: us.functions.global.authentication.signInAccount
        params:
        - name: email
          string: us.data.prod.reserveSlot.regular.pickup.email
        - name: password
          string: us.data.prod.reserveSlot.regular.pickup.password

    #Navigate back to Home
    - executeFunction:
        name: us.functions.global.navigation.accountToHome

    # Tap on ViewAllTimes button
    - executeFunction:
        name: us.functions.bookslot.seeAllTimes.pickup

    # Select first time slot and reserve
    - executeFunction:
        name: us.functions.bookslot.reserveASlot
        params:
          - name: slotIndex
            string: 1

    # Validate the reservation
    - executeFunction:
        name: us.functions.bookslot.validateReservation

    - storeIn:
          key: testStatus
          value: passed

  - name: After
    after: true
    flow:
    - executeFunction:
        name: us.functions.utils.afterSteps