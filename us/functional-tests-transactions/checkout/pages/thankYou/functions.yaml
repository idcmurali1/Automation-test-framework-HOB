functions:
  - name: us.functions.functional.checkout.thankyou.orderConfirmation.getOrderNumber
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.functional.checkout.thankyou.orderConfirmation.orderNumber
      - getString:
          identifier: us.mappings.functional.checkout.thankyou.orderConfirmation.orderNumber
          extractNumbers: true
          storeIn: orderNumber
      - log: Order number $orderNumber
  # NOTE Moved these functions to this new file as part of refactoring, functionality to be updated with latest
  # during unified test automation. Update to support both platforms
  - name: us.functions.checkout.thankyou.validateThankYouFulfillmentModule
    flow:
      - executeFunction:
          name: us.functions.functional.checkout.reviewOrder.fulfillment.validateCardImageAndTitle
      - if:
          condition: ${isMultipleItems} == true
          then:
            - arithmetic:
                expression: ${fulfillmentItemCount} + 1
                storeIn: numItems
            - loop:
                begin: 1
                end: ${numItems}
                storeIndex: itemIndex
                flow:
                  - if:
                      identifier:
                        notPresent:
                          - identifier: us.mappings.functional.checkout.reviewOrder.itemDetails.itemContainer
                      then:
                        - scroll:
                            direction: down
                            untilIdentifier: us.mappings.functional.checkout.reviewOrder.itemDetails.itemContainer
                            scrollLimit: 1
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.functional.checkout.reviewOrder.itemDetails.itemPreviewImage
                      label:
                        - identifier: us.mappings.functional.checkout.reviewOrder.itemDetails.itemArriveByLabel
                          contains: Arrives by
                        - identifier: us.mappings.functional.checkout.reviewOrder.itemDetails.itemCountLabel
                          contains: 1 item
          else:
            - executeFunction:
                name: us.functions.functional.checkout.reviewOrder.validatePromiseDate
            - if:
                condition: ${fulfillmentText} == 'MPDelivery' ||  ${fulfillmentText} == 'mpDelivery'
                then:
                  - verifyIdentifier:
                      value:
                        - identifier: us.mappings.functional.checkout.reviewOrder.itemDetailsSection.lmp.itemCount
                          contains: ${fulfillmentItemCount} item
                else:
                  - verifyIdentifier:
                      value:
                        - identifier: us.mappings.functional.checkout.reviewOrder.itemDetailsSection.itemCount
                          contains: ${fulfillmentItemCount} item

  - name: us.functions.functional.thankyou.orderConfirmation.itemDetailsValidation
    flow:
      - executeFunction:
          name: us.functions.functional.checkout.reviewOrder.validatePromiseDate
      - verifyIdentifier:
          value:
            - identifier: us.mappings.functional.checkout.reviewOrder.itemDetailsSection.itemCount
              contains: ${itemCount}

  - name: us.functions.functional.checkout.thankyou.verifyMQDOrderDetails
    flow:
      - executeFunction:
          name: us.functions.functional.checkout.thankyou.orderConfirmation.getOrderNumber

      - verifyIdentifier:
          present:
            - identifier: us.mappings.functional.checkout.thankyou.orderConfirmation.youSavedToday
            - identifier: us.mappings.functional.checkout.thankyou.mqdQuantityValueItemsText

      - executeFunction:
          name: unified.us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.functional.checkout.thankyou.orderConfirmation.totalOrderSavings
            - name: direction
              string: down
            - name: scrollPosition
              string: center

      - verifyIdentifier:
          present:
            - identifier: us.mappings.functional.checkout.thankyou.orderConfirmation.totalOrderSavings
            - identifier: us.mappings.functional.checkout.thankyou.orderConfirmation.totalSavingsValue
  # NOTE Moved these functions to this new file as part of refactoring, functionality to be updated with latest
  # during unified test automation. Update to support both platforms
  - name: us.functions.functional.checkout.reviewOrder.validateThankYouMixedFulfillmentModules
    flow:
      # Different 1p-pickup module than in TY than checkout
      - if:
          condition: ${1p-pickup} == true
          then:
            - verifyIdentifier:
                label:
                  - identifier: us.mappings.functional.checkout.reviewOrder.TY.fulfillmentTitleView.curbsidePickupTitle
                    contains: Curbside pickup
      - storeIn:
          key: 1p-pickup
          value: false
      - executeFunction:
          name: us.functions.functional.checkout.reviewOrder.fulfillment.validateMixedFulfillmentModules
  # NOTE Moved these functions to this new file as part of refactoring, functionality to be updated with latest
  # during unified test automation. Update to support both platforms
  - name: us.functions.functional.checkout.reviewOrder.TY.validateUnscheduledPickupModule
    platform: ios
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.functional.checkout.reviewOrder.fulfillmentSummaryView.nameLabel
            - identifier: us.mappings.functional.checkout.reviewOrder.fulfillmentSummaryView.addressLabel
            - identifier: us.mappings.functional.checkout.reviewOrder.TY.pickupInstructionsView.titleLabel
            - identifier: us.mappings.functional.checkout.reviewOrder.TY.pickupInstructionsView.detailLabel
          label:
            - identifier: us.mappings.functional.checkout.reviewOrder.TY.fulfillmentTitleView.curbsidePickupTitle
              contains: Curbside pickup
            - identifier: us.mappings.functional.checkout.reviewOrder.fulfillmentSection.fulfillmentTime
              contains: Anytime after
            - identifier: us.mappings.functional.checkout.reviewOrder.fulfillmentSummaryView.commentLabel.unscheduledPickup
              contains: We'll hold your order for
