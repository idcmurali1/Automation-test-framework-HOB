general:
  platform: ios
  tags: prod-functional-cart, C2737033
  inherit:
    filesRunAll:
    - us-errors-helpers.yaml
  testCaseId: C2737033

scenarios:
- name: Before
  before: true
  endTestOnFailure: true
  flow:
  # * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  - log: 'R2_SUBFLOW_PRE_TRANSACTION'
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

- name: Main
  flow:
  - log: Start Main

  # Navigate onboarding to home
  - executeFunction:
      name: us.functions.global.onboarding.navigateOnboardingToHome

  # Navigate to sign in page
  - executeFunction:
      name: us.functions.home.navigateHomeToSignIn

  # Sign in with default account
  - executeFunction:
      name: us.functions.global.authentication.signInAccount
      params:
      - name: email
        string: us.data.prod.flow9242.ios.email
      - name: password
        string: us.data.prod.flow9242.ios.password

  #Navigate back to Home
  - executeFunction:
      name: us.functions.global.navigation.accountToHome

  # Navigate to cart
  - executeFunction:
      name: us.functions.global.navigation.toCartFromNavBar

  # Remove items from cart
  - executeFunction:
      name: us.functions.cart.removeAllCartItems
  - executeFunction:
      name: us.functions.cart.removeUnavailableItemsFromCart

  # Navigate back to Home
  - executeFunction:
      name: us.functions.global.navigation.accountToHome

  # search for fc item
  - executeFunction:
      name: us.functions.search.addItemtoCart
      params:
      - name: searchTerm
        string: us.data.flow003.prod.itemID.fcUnscheduledDelivery
      - name: expectedItemCount
        string: 1

  # search for sc item
  - executeFunction:
      name: us.functions.search.addItemtoCart
      params:
      - name: searchTerm
        string: "banana"
      - name: expectedItemCount
        string: 2

  # Navigate to cart and verify Items on Cart
  - executeFunction:
      name: us.functions.global.navigation.toCartFromNavBar

  # Verify the  number of items added to cart
  - executeFunction:
      name: us.functions.cart.verifyItemCountinCart

  - executeFunction:
      name: us.functions.cart.verifyCardDetails
      params:
      - name: fulfillmentText
        string: Shipping
      - name: validationScope
        string: detailed

  # Validate by incrementing and decrementing the count
  - executeFunction:
      name: us.functions.cart.verifyByChangingItemCount

  - storeIn:
      key: testStatus
      value: passed

- name: After
  after: true
  flow:
  - executeFunction:
      name: us.functions.utils.afterSteps
