functions:
  
    - name: unified.us.functions.benefits.navigateToManageMembership
      flow:
          - verifyIdentifier:
                timeout: 50000
                present:
                    - identifier: us.mappings.wplus.manageMembership.gearIcon
          - click:
                identifier: us.mappings.wplus.manageMembership.gearIcon
          - sleep:
                duration: 2000

    # Deeplink to MMP Flow
    - name: unified.us.functions.wplus.newMmpRedesign.expo.deeplink
      flow:
          - if:
                condition: ${platform} == 'Android'
                then:
                    - executeFunction:
                          name: unified.us.functions.global.navigation.goToDeepLink
                          params:
                              - name: deepLinkUrl
                                string: us.data.mmpredesign.expo.android.deepLink
          - if:
                condition: ${platform} == 'iOS'
                then:
                    - executeFunction:
                          name: unified.us.functions.global.navigation.goToDeepLink
                          params:
                              - name: deepLinkUrl
                                string: us.data.mmpredesign.expo.ios.deepLink


    - name: unified.us.functions.wplus.membership.changePaymentMethodToPaypal
      flow:
          - if:
                identifier:
                    present:
                        - identifier: us.mappings.managemembership.paymentMethod.overlay.module
                then:
                    - click:
                          identifier: us.mappings.managemembership.paymentMethod.overlay.module
          - if:
                condition: ${platform} == 'iOS'
                then:
                    # There is no identifier for "Change" button on Payments banner, for temporary purpose using Coordinates.
                    - click:
                          coordinates: 350, 476
                else:
                    - verifyIdentifier:
                          present:
                              - identifier: us.mappings.managemembership.paymentMethod.change.cta
                    - click:
                          identifier: us.mappings.managemembership.paymentMethod.change.cta

          - verifyIdentifier:
                present:
                    - identifier: us.mappings.paymentMethod.selectPaypal
          - click:
                identifier: us.mappings.paymentMethod.selectPaypal

          - verifyIdentifier:
                present:
                    - identifier: us.mappings.wrs.saveButton
          - click:
                identifier: us.mappings.wrs.saveButton

          - verifyIdentifier:
                present:
                    - identifier: us.mappings.paymentMethod.paypalImage

    - name: unified.us.functions.wplus.membership.resetPaymentMethod
      flow:
          - if:
                condition: ${platform} == 'iOS'
                then:
                    # There is no identifier for "Change" button on Payments banner, for temporary purpose using Coordinates.
                    - click:
                          coordinates: 350, 476
                else:
                    - verifyIdentifier:
                          present:
                              - identifier: us.mappings.managemembership.paymentMethod.change.cta
                    - click:
                          identifier: us.mappings.managemembership.paymentMethod.change.cta

          - verifyIdentifier:
                present:
                    - identifier: us.mappings.paymentMethod.selectCard
          - click:
                identifier: us.mappings.paymentMethod.selectCard

          - verifyIdentifier:
                present:
                    - identifier: us.mappings.wrs.saveButton
          - click:
                identifier: us.mappings.wrs.saveButton

    - name: unified.functions.wplus.validate.verizontracfone
      flow:
          - if:
                identifier:
                    present:
                        - identifier: us.mappings.wplus.managemembership.walmartplus.straighttalk.label
                then:
                    - log: "Monthly plan with Straight talk text present as expected"
                    - verifyIdentifier:
                          present:
                              - identifier: us.mappings.wplus.managemembership.verizonMonthlyPlanLabel
                              - identifier: us.mappings.wplus.managemembership.walmartplus.straighttalkSupportText
                else:
                    - if:
                          identifier:
                              present:
                                  - identifier: us.mappings.wplus.managemembership.managewalmartplus.cta
                          then:
                              - verifyIdentifier:
                                    present:
                                        - identifier: us.mappings.wplus.managemembership.walmartplus.planoverview.planname.paid.title
                                        - identifier: us.mappings.wplus.managemembership.walmartplus.planoverview.planname.freeplan.title
                              - executeFunction:
                                    name: unified.us.functions.wplus.managemembership.findManageCTAAndNavigateToL2Page
                              - verifyIdentifier:
                                    present:
                                        - identifier: us.mappings.wplus.managemembership.managescreentitle
                                        - identifier: us.mappings.wplus.managemembership.walmartplus.straighttalk.label
                              - log: "Monthly plan with Straight talk text present as expected"

    - name: unified.us.functions.wplus.managemembership.findManageCTAAndNavigateToL2Page
      flow:
          - scroll:
                direction: down
                untilIdentifier: us.mappings.wplus.managemembership.managewalmartplus.cta
          - click:
                identifier: us.mappings.wplus.managemembership.managewalmartplus.cta
          - sleep:
                duration: 5000

    - name: unified.us.functions.benefits.navigateToManageMembership
      flow:
        - verifyIdentifier:
            timeout: 50000
            present:
                - identifier: us.mappings.wplus.manageMembership.gearIcon
        - click:
            identifier: us.mappings.wplus.manageMembership.gearIcon
        - sleep:
            duration: 2000

    # Deeplink to MMP Flow
    - name: unified.us.functions.wplus.newMmpRedesign.expo.deeplink
      flow:
          - if:
                condition: ${platform} == 'Android'
                then:
                    - executeFunction:
                          name: unified.us.functions.global.navigation.goToDeepLink
                          params:
                              - name: deepLinkUrl
                                string: us.data.mmpredesign.expo.android.deepLink
          - if:
                condition: ${platform} == 'iOS'
                then:
                    - executeFunction:
                          name: unified.us.functions.global.navigation.goToDeepLink
                          params:
                              - name: deepLinkUrl
                                string: us.data.mmpredesign.expo.ios.deepLink

                                

    - name: unified.us.functions.wplus.membership.changePaymentMethodToPaypal
      flow:
        - if:
            identifier:
              present:
                - identifier: us.mappings.managemembership.paymentMethod.overlay.module
            then:
              - click:
                  identifier: us.mappings.managemembership.paymentMethod.overlay.module 
        - if:
            condition: ${platform} == 'iOS'        
            then:
              # There is no identifier for "Change" button on Payments banner, for temporary purpose using Coordinates.   
              - click:
                  coordinates: 350, 476
            else:
              - verifyIdentifier:
                      present:
                          - identifier: us.mappings.managemembership.paymentMethod.change.cta
              - click:
                      identifier: us.mappings.managemembership.paymentMethod.change.cta 
            
        - verifyIdentifier:
            present:
                - identifier: us.mappings.paymentMethod.selectPaypal
        - click:
            identifier: us.mappings.paymentMethod.selectPaypal

        - verifyIdentifier:
            present:
                - identifier: us.mappings.wrs.saveButton
        - click:
            identifier: us.mappings.wrs.saveButton
            
        - verifyIdentifier:
            present:
            - identifier: us.mappings.paymentMethod.paypalImage

    - name: unified.us.functions.wplus.membership.resetPaymentMethod
      flow:
        - if:
            condition: ${platform} == 'iOS'        
            then:
            # There is no identifier for "Change" button on Payments banner, for temporary purpose using Coordinates.  
              - click:
                  coordinates: 350, 476
            else:
              - verifyIdentifier:
                      present:
                          - identifier: us.mappings.managemembership.paymentMethod.change.cta
              - click:
                      identifier: us.mappings.managemembership.paymentMethod.change.cta 

        - verifyIdentifier:
            present:
                - identifier: us.mappings.paymentMethod.selectCard
        - click:
            identifier: us.mappings.paymentMethod.selectCard

        - verifyIdentifier:
            present:
                - identifier: us.mappings.wrs.saveButton
        - click:
            identifier: us.mappings.wrs.saveButton


    - name: unified.functions.wplus.validate.verizontracfone
      flow:
          - if:
                identifier:
                    present:
                        - identifier: us.mappings.wplus.managemembership.walmartplus.straighttalk.label
                then:
                    - log: "Monthly plan with Straight talk text present as expected"
                    - verifyIdentifier:
                          present:
                              - identifier: us.mappings.wplus.managemembership.verizonMonthlyPlanLabel
                              - identifier: us.mappings.wplus.managemembership.walmartplus.straighttalkSupportText
                else:
                    - if:
                          identifier:
                              present:
                                  - identifier: us.mappings.wplus.managemembership.managewalmartplus.cta
                          then:
                              - verifyIdentifier:
                                    present:
                                        - identifier: us.mappings.wplus.managemembership.walmartplus.planoverview.planname.paid.title
                                        - identifier: us.mappings.wplus.managemembership.walmartplus.planoverview.planname.freeplan.title
                              - executeFunction:
                                    name: unified.us.functions.wplus.managemembership.findManageCTAAndNavigateToL2Page
                              - verifyIdentifier:
                                    present:
                                        - identifier: us.mappings.wplus.managemembership.managescreentitle
                                        - identifier: us.mappings.wplus.managemembership.walmartplus.straighttalk.label
                              - log: "Monthly plan with Straight talk text present as expected"

    - name: unified.us.functions.wplus.managemembership.findManageCTAAndNavigateToL2Page
      flow:
          - scroll:
                direction: down
                untilIdentifier: us.mappings.wplus.managemembership.managewalmartplus.cta
          - click:
                identifier: us.mappings.wplus.managemembership.managewalmartplus.cta
          - sleep:
                duration: 5000

    #Upgrade membership to annual
    - name: unified.us.functions.wplus.manageMembership.upgradeToAnnual
      flow:
          - if:
                condition: ${platform} == 'iOS'
                then:
                  # Click the upgrade to annual button
                  - click:
                        identifier: us.mappings.wplus.managemembership.nbacard.upgradetoannual.cta
            #   - click:
            #         identifier: us.mappings.wplus.annualTenurePlan
                  - verifyIdentifier:
                      timeout: 20000
                      present:
                        - identifier: us.mappings.wplus.changePlanButton

                  - scroll:
                      direction: down
                      untilIdentifier: us.mappings.wplus.changePlan.agreeCheckbox
                      position: center
                  
                  - click:
                      identifier: us.mappings.wplus.changePlan.agreeCheckbox
                  
                  - log: "Annual Plan selected"
                  - scroll:
                        direction: down
                  - click:
                        identifier: us.mappings.wplus.changePlanButton

                  - if:
                        identifier:
                          present:
                            - identifier: us.mappings.wlus.membershipBottomsheetClose
                        then:
                              - click:
                                    identifier: us.mappings.wlus.membershipBottomsheetClose
                              - log : Confirmation Bottom Sheet Closed

          - if:
                condition: ${platform} == 'Android'
                then:
                  # Click the upgrade to annual button
                  - click:
                        wait: 2000
                        identifier: us.mappings.wplus.managemembership.nbacard.upgradetoannual.cta
                  - scroll:
                        direction: down
                        untilIdentifier: us.mappings.wplus.changePlan.agreeCheckbox
                  - click:
                        identifier: us.mappings.wplus.changePlan.agreeCheckbox
                  - click:
                        identifier: us.mappings.wplus.changePlanButton
                  - sleep:
                      duration: 10000
                  - if:
                      identifier:
                        present:
                          - identifier: us.mappings.wplus.upgradeToAnnual.succesPopUp.closeIcon
                      then:
                        - click:
                            identifier: us.mappings.wplus.upgradeToAnnual.succesPopUp.closeIcon

    # Cancel Free trial Member
    - name: unified.us.functions.wplus.managemembership.cancelFreeTrialMember
      flow:
        - sleep:
            duration: 5000
        - executeFunction: 
            name: unified.us.functions.wplus.managemembership.navigateToCancelFreeTrialMemberFromMemberShipPage
        - executeFunction: 
            name: unified.us.functions.wplus.navigateToCancelFeedbackFreeTrialOrCancelFeedbackWalmartPlusPageFromCancelConfirmationPage
        - executeFunction:
            name: unified.us.functions.wplus.completeCancelFreeTrialOrCancelWplus
    
    
    # Navigate to Cancel Membership Screen from Manage Membership settings page
    - name: unified.us.functions.wplus.managemembership.navigateToCancelPaidMemberFromMemberShipPage
      flow:
        - verifyIdentifier: 
            timeout: 3000
            present: 
                - identifier: us.mappings.wplus.managemembership.walmartplusmodule.title
                - identifier: us.mappings.wplus.managemembership.managewalmartplus.cta
                - identifier: us.mappings.wplus.managemembership.walmartplus.planoverview.planname.paid.title
                - identifier: us.mappings.wplus.managemembership.walmartplus.planoverview.planname.paid.price.title
        - executeFunction:
            name: unified.us.functions.wplus.managemembership.navigateToManageyourplanpageFromMemberShipPage
        - click:
            identifier: us.mappings.wplus.managemembership.walmartplus.managemodule.cancelmembership.cancel.cta
    
    # Navigate to Cancel Membership Screen from Manage Membership settings page
    - name: unified.us.functions.wplus.managemembership.navigateToCancelFreeTrialMemberFromMemberShipPage
      flow:
        - verifyIdentifier: 
            timeout: 5000
            present: 
                - identifier: us.mappings.wplus.managemembership.walmartplusmodule.title
                - identifier: us.mappings.wplus.managemembership.managewalmartplus.cta
        - executeFunction:
            name: unified.us.functions.wplus.managemembership.navigateToManageyourplanpageFromMemberShipPage
        - click:
            identifier: us.mappings.wplus.managemembership.walmartplus.managemodule.cancelmembership.cancel.cta
    
    # Navigate to L2 Membership Screen from Manage Membership settings page
    - name: unified.us.functions.wplus.managemembership.navigateToManageyourplanpageFromMemberShipPage
      flow:
        - executeFunction:
            name: unified.us.functions.wplus.managemembership.findManageCTAAndNavigateToL2Page
        - verifyIdentifier: 
            timeout: 5000
            present: 
                - identifier: us.mappings.wplus.managemembership.walmartplus.managemodule
                - identifier: us.mappings.wplus.managemembership.walmartplus.managemodule.cancelmembership.title

    # Navigate to Cancel Membership or Free trial Feedback page from Cancel Confirmation page
    - name: unified.us.functions.wplus.navigateToCancelFeedbackFreeTrialOrCancelFeedbackWalmartPlusPageFromCancelConfirmationPage
      flow:
        - verifyIdentifier:
            timeout: 5000
            present:
                - identifier: us.mapppings.wplus.cancelConfirmationOrcancelMembershipFeedback.cancelFreeTrialOrCancelWalmartPlusLink
        - click:
            identifier: us.mapppings.wplus.cancelConfirmationOrcancelMembershipFeedback.cancelFreeTrialOrCancelWalmartPlusLink
    
    # Function to click the cancel button on feedback page on Android
    - name: unified.us.functions.wplus.completeCancelFreeTrialOrCancelWplus
      flow:
        - if:
            condition: ${platform} == 'Android'
            then:
                - verifyIdentifier:
                    text:
                        - identifier: us.mapppings.wplus.cancelMembershipFeedback.cancelFreeTrialOrCancelWalmartPlusHeader
                          contains: Your feedback matters
                - click:
                    identifier: us.mappings.wplus.cancelMembershipFeedback.chooseOptionToCancel
                - verifyIdentifier:
                    present:
                        - identifier: us.mapppings.wplus.cancelConfirmationOrcancelMembershipFeedback.submitFeedbackButton
                - click:
                    identifier: us.mapppings.wplus.cancelConfirmationOrcancelMembershipFeedback.submitFeedbackButton
        - if:
            condition: ${platform} == 'iOS'
            then:
                - verifyIdentifier:
                    timeout: 5000
                    value:
                        - identifier: us.mappings.wplus.cancelMembershipFeedback.title
                          contains: Your feedback matters
                - click:
                    identifier: us.mappings.wplus.cancelMembershipFeedback.chooseOptionToCancel
                - verifyIdentifier:
                    present:
                        - identifier: us.mappings.wplus.clickCancelMembershipButton
                - click:
                    identifier: us.mappings.wplus.clickCancelMembershipButton

    # - name: unified.us.functions.wplus.manageMembership.pauseMembership
    #   flow:

    #     # Navigate to Manage Wplus plan screen
    #       - verifyIdentifier:
    #           timeout: 50000
    #           present:
    #             - identifier: us.mappings.wplus.managemembership.managewalmartplus.cta
    #       - click:
    #           identifier: us.mappings.wplus.managemembership.managewalmartplus.cta

    #       - click:
    #           identifier: us.mappings.pause.pauseMembershipManageScreen
    #       - verifyIdentifier:
    #           present:
    #               - identifier: us.mappings.pause.membershipPauseSheetHeader
    #               - identifier: us.mappings.pause.pauseMembershipConfirmButton
    #               - identifier: us.mappings.pause.doNotPauseMemButton
    #       - click:
    #           identifier: us.mappings.pause.pauseMembershipConfirmButton

    #       - verifyIdentifier:
    #           timeout: 50000
    #           present:
    #           - identifier: us.mappings.pause.membershipPauseConfirmationSheetHeader
    #           - identifier: us.mappings.pause.gotItButton
    #       - click:
    #           identifier: us.mappings.pause.gotItButton

    #       - verifyIdentifier:
    #           timeout: 50000
    #           present:
    #             - identifier: us.mappings.pause.manageYourPlanScreen  
          
    #       - click:
    #           identifier: us.mappings.global.navigateBackArrow

    #       - if:
    #           identifier:
    #               present:
    #               - identifier: us.mappings.wplus.managemembership.nbacard.pause.initiated.title
    #           then:
    #               - log: "Pause membership alert displayed correctly"
    #           else:
    #               - failTest:
    #                   message: "ENV_FAILURE - ${env} - Pause initiation not happened successfully"
    #       - verifyIdentifier:
    #           present:
    #               - identifier: us.mappings.wplus.managemembership.nbacard.pause.initiated.title
    #               - identifier: us.mappings.wplus.managemembership.nbacard.pause.undopause.cta
    #               - identifier: us.mappings.wplus.managemembership.walmartplus.planoverview.planname.pauses.text
    #               - identifier: us.mappings.wplus.managemembership.walmartplus.planoverview.planname.paid.title
    #               - identifier: us.mappings.wplus.managemembership.walmartplus.planoverview.planname.paid.price.title

    # - name: unified.us.functions.wplus.membership.expandDiscoverModule
    #   flow:
    #     - if:
    #         identifier:
    #           present:
    #             - identifier: us.mappings.managemembership.discover.module
    #         then:
    #           - click:
    #               identifier: us.mappings.managemembership.discover.module


    # - name: unified.us.functions.wplus.membership.expandDiscoverModule.exploreInHome
    #   flow:
    #     - scroll:
    #         direction: down
    #         untilIdentifier: us.mappings.managemembership.discoverModule.exploreInHome
    #     - click:
    #         identifier: us.mappings.managemembership.discoverModule.exploreInHome


    # - name: unified.us.functions.wplus.inHome.validateMyPlusUpsDetailsOnManageMembershipPage
    #   flow:
    #   - log: Verifying PlusUps Membership Details on Manage Membership
    #   - if:
    #       condition: ${membershipType} == 'paid'
    #       then:
    #           - if:
    #               condition: ${tenure} == 'annual'
    #               then:
    #               - log: Verifying Paid Annual Tenure Details
    #               - verifyIdentifier: 
    #                       timeout: 3000
    #                       present: 
    #                       - identifier: us.mappings.wplus.managemembership.plusups.title
    #                       - identifier: us.mappings.wplus.managemembership.manageplusups.cta
    #                       - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.paid.title
    #                       - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.paid.annual.price.title
    #               else:
    #               - log: Verifying Paid Monthly Tenure Details
    #               - verifyIdentifier: 
    #                       timeout: 3000
    #                       present: 
    #                       - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.paid.title
    #                       - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.paid.monthly.price.title
    #                       - identifier: us.mappings.wplus.managemembership.nbacard.upgradetoannual.cta
    #   - if:
    #       condition: ${membershipType} == 'trial'
    #       then:
    #           - if:
    #               condition: ${tenure} == 'annual'
    #               then:
    #               - log: Verifying Trial Annual Tenure Details
    #               - verifyIdentifier: 
    #                       timeout: 3000
    #                       present: 
    #                       - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.trial.title
    #                       - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.trial.annual.price.title
    #               else:
    #               - log: Verifying Trial Monthly Tenure Details
    #               - verifyIdentifier: 
    #                       timeout: 3000
    #                       present: 
    #                       - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.trial.title
    #                       - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.trial.monthly.price.title

    # - name: unified.us.functions.wplus.inHome.managePlusUpsScreen.verifyPlusUpDetails
    #   flow:
    #     - if:
    #         condition: ${tenure} == 'monthly'
    #         then:
    #           - log: Verifying Monthly trial Tenure Details
    #           - if:
    #               condition: ${platform} == 'Android'
    #               then:            
    #                 - verifyIdentifier: 
    #                       text:
    #                         - identifier: us.mappings.inHome.managePlusUpsScreen.addOnPrice
    #                           contains: $7/month
                  
    #                 - verifyIdentifier: 
    #                       text:
    #                         - identifier: us.mappings.inHome.managePlusUpsScreen.30DayFreeTrialLabel
    #                           contains: 30-day free trial
    #           - if:
    #               condition: ${platform} == 'ios'
    #               then:
    #                 - verifyIdentifier: 
    #                       label:
    #                         - identifier: us.mappings.inHome.managePlusUpsAddOnPrice
    #                           contains: $7 per month

    #                 - verifyIdentifier: 
    #                       label:
    #                         - identifier: us.mappings.inHome.monthlyFreetrial
    #                           contains: 30-day free trial
    #         else:
    #           - log: Verifying Annual trial tenure Details
    #           - if:
    #               condition: ${platform} == 'Android'
    #               then:
    #                 - verifyIdentifier:
    #                     text:
    #                       - identifier: us.mappings.inHome.annualMemberShipPrice
    #                         contains: $40
            
    #                 - verifyIdentifier: 
    #                     text:
    #                       - identifier: us.mappings.inHome.annualMemberTrial
    #                         contains: 30 day free trial


    - name: unified.us.functions.wplus.nonMemberClaimOffers
      flow:
        - if:
            identifier:
                present:
                    - identifier: us.mappings.wplus.addPaypal.claimOffers
            then:
                - click:
                    identifier: us.mappings.wplus.addPaypal.claimOffers
                - sleep:
                    duration: 3000
            else:
                - failTest:
                    message: "ENV_FAILURE - ${env} - Claim Offer is not Available"


    - name: unified.us.functions.paypalPaymentMethod
      flow:
        - verifyIdentifier:
            timeout: 20000
            present:
                - identifier: us.maappings.wplus.managemembership.paymentsAndBillingCard
        
        - click:
            identifier: us.maappings.wplus.managemembership.paymentsAndBillingCard
            wait: 1000

        - verifyIdentifier:
            timeout: 20000
            present:
                - identifier: us.maappings.wplus.managemembership.paymentPayPal

                - verifyIdentifier: 
                      text:
                        - identifier:  us.mappings.inHome.managePlusUpsScreen.addOnPrice
                          contains: $40/year

                - verifyIdentifier: 
                      text:
                        - identifier: us.mappings.inHome.managePlusUpsScreen.30DayFreeTrialLabel
                          contains: 30-day free trial
        - if:
            condition: ${platform} == 'ios'
            then:
              - verifyIdentifier: 
                    label:
                      - identifier:  us.mappings.inHome.managePlusUpsAddOnPrice
                        contains: $40 per year  

              - verifyIdentifier: 
                    label:
                      - identifier: us.mappings.inHome.monthlyFreetrial
                        contains: 30-day free trial


    # # # Manage PlusUps page validations for cancel member
    # # - name: unified.us.functions.wplus.inHome.validateCancelMemberManagePlusUps
    # #   flow:
    # #     - scroll:
    # #         direction: down
    # #         untilIdentifier: us.mappings.manageMembership.inHome.managePlusUpsButton
    # #     - if:
    # #         identifier:
    # #           present:
    # #             - identifier: us.mappings.manageMembership.inHome.managePlusUpsButton
    # #         then:
    # #           - log: "Manage Plus Ups button is present as expected"
    # #           - click:
    # #               identifier: us.mappings.manageMembership.inHome.managePlusUpsButton
    # #         else:
    # #           - failTest:
    # #               message: "Manage Plus Ups button should be present but is not"
    # #     - sleep:
    # #         duration: 5000
    # #     - verifyIdentifier:
    # #         present:
    # #           - identifier: us.mappings.inHome.cancelMember.reviewchangesbtnDisabled
    # #     - click:
    # #         identifier: us.mappings.inHome.selectInhomeCheckbox
    # #     - sleep:
    # #         duration: 5000
    # #     - verifyIdentifier:
    # #         present:
    # #           - identifier:  us.mappings.inHome.cancelWarningMsgmanagePlusUps
    # #           - identifier:  us.mappings.inHome.cancelMember.reviewchangesbtnEnabled
    # #     - click:
    # #         identifier: us.mappings.inHome.cancelMember.reviewchangesbtnEnabled
    # #     - sleep:
    # #         duration: 5000

    # # Validate Inhome Review membership details    
    # - name: unified.us.functions.wplus.inHome.cancelmember.verifyReviewmembershipDetails
    #   flow:
    #     - if:
    #         condition: ${platform} == 'Android'
    #         then:
    #           - verifyIdentifier:
    #               text:
    #                 - identifier:  us.mappings.inHome.confirmPage.addonsReviewTitle
    #                   contains:  ${firstName} , Before you cancel...
    #     - if:
    #         condition: ${platform} == 'ios'
    #         then:
    #           - verifyIdentifier:
    #                 value:
    #                   - identifier:  us.mappings.inHome.confirmPage.addonsReviewTitle
    #                     contains:  ${firstName} , Before you cancel...
    #     - verifyIdentifier:
    #         present:
    #           - identifier: us.mappings.inHome.confirmPage.addonsReviewSubTitle
    #           - identifier: us.mappings.inHome.confirmPage.cancellationTerms
    #           - identifier: us.mappings.inHome.confirmPage.cancelInHomeBtn
    #           - identifier: us.mappings.inHome.confirmPage.keepInHomeBtn
    
    #     - click:
    #         identifier: us.mappings.inHome.confirmPage.cancelInHomeBtn
    #     - sleep:
    #         duration: 5000
    #     - if:
    #         condition: ${platform} == 'ios'
    #         then:
    #           - click:
    #               identifier: us.mappings.inHome.cancelInHomeBtn.closeCancelFeedbackBottomsheet

    # # Validate Inhome Manage membership details  
    # - name: unified.us.functions.wplus.inHome.validateCancelMemberPlusUpsOnManageMembershipPage
    #   flow:
    #     - log: Verifying PlusUps Membership Details on Manage Membership
    #     - if:
    #         condition: ${membershipType} == 'paid'
    #         then:
    #           - if:
    #               condition: ${tenure} == 'annual'
    #               then:
    #                 - log: Verifying Paid Annual Tenure Details
    #                 - verifyIdentifier: 
    #                       timeout: 3000
    #                       present: 
    #                         - identifier: us.mappings.wplus.managemembership.plusups.title
    #                         - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.paid.title
    #                         - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.paid.annual.price.title
    #                         - identifier: us.mappings.wplus.managemembership.plusups.planoverview.paid.canceled.title
    #                 - verifyIdentifier: 
    #                       timeout: 3000
    #                       notPresent:                    
    #                         - identifier: us.mappings.wplus.managemembership.manageplusups.cta

    #               else:
    #                 - log: Verifying Paid Monthly Tenure Details
    #                 - verifyIdentifier: 
    #                       timeout: 3000
    #                       present: 
    #                         - identifier: us.mappings.wplus.managemembership.plusups.title
    #                         - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.paid.title
    #                         - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.paid.monthly.price.title
    #                         - identifier: us.mappings.wplus.managemembership.plusups.planoverview.paid.canceled.title
    #                 - verifyIdentifier: 
    #                       timeout: 3000
    #                       notPresent:                    
    #                         - identifier: us.mappings.wplus.managemembership.manageplusups.cta
    #     - if:
    #         condition: ${membershipType} == 'trial'
    #         then:
    #           - if:
    #               condition: ${tenure} == 'annual'
    #               then:
    #                 - log: Verifying Trial Annual Tenure Details
    #                 - verifyIdentifier: 
    #                       timeout: 3000
    #                       notPresent:
    #                         - identifier: us.mappings.wplus.managemembership.plusups.title
    #                         - identifier: us.mappings.wplus.managemembership.manageplusups.cta
    #                         - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.trial.title
    #                         - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.trial.annual.price.title
    #               else:
    #                 - log: Verifying Trial Monthly Tenure Details
    #                 - verifyIdentifier: 
    #                       timeout: 3000
    #                       notPresent: 
    #                         - identifier: us.mappings.wplus.managemembership.plusups.title
    #                         - identifier: us.mappings.wplus.managemembership.manageplusups.cta
    #                         - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.trial.title
    #                         - identifier: us.mappings.wplus.managemembership.plusups.planoverview.planname.trial.monthly.price.title

    - name: unified.us.functions.inHome.navigateToInHomeMLP
      flow:
        - executeFunction:
            name: unified.us.functions.global.navigation.goToDeepLink
            params:
              - name: deepLinkUrl
                string: walmart://plus/inhomeAddress

    - name: unified.us.functions.mlp.inhome.bundleSignUp.validation
      flow:
        - if:
            condition: ${platform} == 'Android'
            then:
              # Confirm address for in-home
              - executeFunction:
                  name: us.functions.wplus.inHome.confirmAddress
              - log: "Clicked on the confirm address button"

              # Close the error bottom sheet CTA
              - executeFunction:
                  name: us.functions.wplus.inHome.cancel.bottomSheet.error.cta

              # Close view full screen overlay
              - executeFunction:
                  name: us.functions.wplus.handle.viewFullScreen
              - log: "Landed on the MLP inHome trial page"
              - verifyIdentifier:
                  present:
                    - identifier: us.mappings.mlp.inhome.choose.annualplan
                    - identifier: us.mappings.wplus.inhome.MLP.chooseplan.monthlyprice
                    - identifier: us.mappings.wplus.inhome.MLP.startFreeTrialCTA
              - log: "Verified Monthly and Annual plans bundle singup prices"
        - if:
            condition: ${platform} == 'ios'
            then:
              - log: "Landed on inhome confirm address page"
              - if: 
                  identifier:
                    present:
                      - identifier: us.mappings.benefitHub.inHome.confirmButton
                  then:
                    - click:
                        identifier: us.mappings.benefitHub.inHome.confirmButton
                        wait: 3000
              - log: "Clicked on the confirm address button"
              - if: 
                  identifier:
                    present:
                      - identifier: us.mappings.page.retryAgainButton
                  then:
                    - click:
                        identifier: us.mappings.page.retryAgainButton
                        wait: 3000                                        
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.inHome.errorPopUp
                  then:
                    - failTest:
                        message: "ENV_FAILURE - ${env} - something went wrong technical issue"
              - verifyIdentifier:
                  present:
                    - identifier: us.mappings.wplus.inhome.MLP.chooseplan.bundletitleannualeprice
                    - identifier: us.mappings.wplus.inhome.MLP.chooseplan.inhomeannualprice
                    - identifier: us.mappings.wplus.inhome.MLP.startFreeTrialCTA
                    - identifier: us.mappings.wplus.inhome.MLP.chooseplan.annualprice                                                     
              - verifyIdentifier: 
                  value:
                    - identifier: us.mappings.wplus.inhome.MLP.chooseplan.annualprice
                      contains: $98 per year
              - verifyIdentifier: 
                  value:
                    - identifier: us.mappings.wplus.inhome.MLP.chooseplan.monthlyprice
                      contains: $12.95 per month
              - log: "Verified Monthly and Annual plans bundle singup prices"

    #MLP InHome 30day free trail Monthly Bundle sign up
    - name: unified.us.functions.mlp.inhome.bundleSignUp.monthly
      flow:
        - log: "Landed on the MLP inHome trial page"
        - verifyIdentifier:
            present:
              - identifier: us.mappings.wplus.inhome.MLP.chooseplan.monthlyprice           
        - click:
            identifier: us.mappings.wplus.inhome.MLP.chooseplan.monthlyprice
            wait: 1500
        - log: "Selected Monthly Tenure"
        - executeFunction:
            name: unified.us.functions.utils.scrollIfNotVisible
            params:
              - name: identifier
                string: us.mappings.reviewOrder.splash.walmartPlusAgreeTermsCheckBox
              - name: direction
                string: down
              - name: scrollPosition
                string: center
        - if:
            identifier:
              present:
                - identifier: us.mappings.reviewOrder.splash.walmartPlusAgreeTermsCheckBox  
            then:
              - click:
                  identifier: us.mappings.reviewOrder.splash.walmartPlusAgreeTermsCheckBox
        - if:
              identifier:
                present:
                  - identifier: us.mappings.wplus.inhome.MLP.startFreeTrialCTA
              then:
                - click:
                    identifier: us.mappings.wplus.inhome.MLP.startFreeTrialCTA
            
        - log: "Clicked on Start 30-day Free trial"
        - if:
            condition: ${platform} == 'ios'
            then:
              - verifyIdentifier:
                  label:
                    - identifier: us.mappings.wplus.membershipBottomsheetTitle
                      contains: Welcome! Weâ€™re ready to tackle your to-dos

              - log: "InHome Confirmation screen loaded"          
        - verifyIdentifier: 
            present:
              - identifier: us.mappings.wlus.membershipBottomsheetClose
        - click:
            identifier: us.mappings.wlus.membershipBottomsheetClose 
            wait: 1500   

    - name: unified.us.functions.wplus.inHome.manageMembership.managePlusUps
      flow:
        - sleep:
            duration: 5000
        - click:
            identifier: us.mappings.manageMembership.inHome.managePlusUpsButton
                        
    # Validate Manage PlusUps Inhome signup details 
    - name: unified.us.functions.wplus.inHome.optInForInHomeOnManagePlusUpsPage
      flow:
        - verifyIdentifier:
            present:
              - identifier: us.mappings.inHome.unSelectCheckbox
        - verifyIdentifier:
            present:
              - identifier:  us.mappings.inHome.monthlyFreetrial
              - identifier:  us.mappings.inHome.monthlyFreetrialMsg
        - click:
            identifier: us.mappings.inHome.managePlusUpscheckbox
        - sleep:
            duration: 5000                
        - click:
            identifier: us.mappings.inHome.monthlyReviewchangesBtn

  # Validate Inhome Review membership details    
    - name: unified.us.functions.wplus.manageMembership.inHome.verifyReviewmembershipDetails.startinHomeMembership
      flow:
        - executeFunction:
            name: unified.us.functions.utils.scrollIfNotVisible
            params:
              - name: identifier
                string: us.mappings.inHome.agreeCheckbox
              - name: direction
                string: down
              - name: scrollPosition
                string: center
        - if:
            identifier:
              present:
                - identifier: us.mappings.inHome.agreeCheckbox
            then:
              - log: "Clicking on I Agree Checkbox"
              - click:
                  identifier: us.mappings.inHome.agreeCheckbox
        - click:
            identifier: us.mappings.inHome.revieMembership.startInhometrial
        - sleep:
            duration: 5000
        - click:
            identifier: us.mappings.inHome.monthlyReviewchangeDoneButton
        - sleep:
            duration: 5000
    
    - name: unified.us.functions.wplus.manageMembership.navigateToCancelMemScreenFromManageMemScreen
      flow:
        - if:
            identifier:
              present:
                - identifier: us.mappings.wplus.managemembership.walmartplus.managemodule.cancelmembership.cancel.cta
            then:
              - click:
                  identifier: us.mappings.wplus.managemembership.walmartplus.managemodule.cancelmembership.cancel.cta
            else:
              - if:
                  identifier:
                    present:
                      - identifier: us.mappings.wplus.managemembership.managewalmartplus.cta
                  then:
                    - click:
                        identifier: us.mappings.wplus.managemembership.managewalmartplus.cta
                    - verifyIdentifier:
                        timeout: 50000
                        present:
                          - identifier: us.mappings.wplus.managemembership.walmartplus.managemodule.cancelmembership.cancel.cta
                    - click:
                        identifier: us.mappings.wplus.managemembership.walmartplus.managemodule.cancelmembership.cancel.cta  

    - name: unified.us.functions.wplus.manageMembership.keepMembershipValidation
      flow:
        - verifyIdentifier:
            timeout: 50000
            present:
                - identifier: us.mapppings.wplus.cancelMembershipScreen.keepMembership
                - identifier: us.mapppings.wplus.cancelConfirmation.cancelmembershipbutton
                - identifier: us.mapppings.wplus.cancelConfirmationOrcancelMembershipFeedback.RemindmeLaterbtn
                - identifier: us.mapppings.wplus.cancelConfirmationOrcancelMembershipFeedback.remindmelatersubtext

        - click:
              identifier: us.mapppings.wplus.cancelMembershipScreen.keepMembership

        # Due to a bug (CEPG-285099), we are having different validations for iOS and Android below. 
        # This is a minor bug and both the validations are valid.
        - if:
            condition: ${platform} == 'Android'
            then:
              - verifyIdentifier:
                  timeout: 50000
                  present:
                    - identifier: us.mappings.pause.manageYourPlanScreen
            else:
              - verifyIdentifier:
                  timeout: 50000
                  present:
                    - identifier: us.mappings.wplus.managemembership.title

    - name: unified.us.functions.wplus.manageMembership.remindMeLaterValidation
      flow:
      
        # This function will do nothing if we are already in Cancel membership screen.
        - executeFunction: 
            name: unified.us.functions.wplus.manageMembership.navigateToCancelMemScreenFromManageMemScreen

        - verifyIdentifier:
            timeout: 50000
            present:
                - identifier: us.mapppings.wplus.cancelConfirmationOrcancelMembershipFeedback.RemindmeLaterbtn
                - identifier: us.mapppings.wplus.cancelConfirmationOrcancelMembershipFeedback.remindmelatersubtext

        - click:
              identifier: us.mapppings.wplus.cancelConfirmationOrcancelMembershipFeedback.RemindmeLaterbtn

        # reminder popup verification
        - verifyIdentifier:
            present:
                - identifier: us.mappings.wplus.RML.reminder.titleLabel
                - identifier: us.mappings.wplus.RML.reminder.subtitleLabel
                - identifier: us.mappings.wplus.RML.reminder.exploreyourbenefitslink

        - click:
            identifier: us.mappings.wplus.RML.reminder.exploreyourbenefitslink

        - verifyIdentifier:
            present:
                - identifier: us.mappings.benefits.title

        # Remind me later button should not be visible anymore on cancel screen.

        - click:
            identifier: us.mappings.wplus.manageMembership.gearIcon 
        
        - executeFunction: 
            name: unified.us.functions.wplus.manageMembership.navigateToCancelMemScreenFromManageMemScreen

        - verifyIdentifier:
            notPresent:
              - identifier: us.mapppings.wplus.cancelConfirmationOrcancelMembershipFeedback.RemindmeLaterbtn
              - identifier: us.mapppings.wplus.cancelConfirmationOrcancelMembershipFeedback.remindmelatersubtext 

    - name: unified.us.functions.ibotta.verifyIbottaRewards.on.itemSearch
      flow:
        - if:
            identifier:
              notPresent:
                - identifier: us.mappings.ibottaRewards.walmartCash.rewards.checkbox
            then:
              - log: "Walmart Offer Clipping check box not Displayed"
              - failTest:
                  message: "ENV_FAILURE - ${env} - Walmart Offer Clipping check box not Displayed"

        - verifyIdentifier:
            present:
              - identifier: us.mappings.ibottaRewards.walmartCash.rewards.checkbox
              - identifier: us.mappings.ibottaRewards.walmartCash.rewards.text
        - if:
            condition: ${mustBuy2items} != null
            then:
              - verifyIdentifier:
                  present:
                    - identifier: us.mappings.ibottaRewards.walmartCash.mustBy2.text

    - name: unified.us.functions.ibotta.selectIbottaSubscription.on.itemPage.AddSubscription
      flow:
        - sleep:
            duration: 5000
        - if:
            identifier:
              notPresent:
                - identifier: us.mappings.ibottaRewards.walmartCash.rewards.checkbox
            then:
              - log: Couldn't find the rewards checkbox, Scrolling down.
              - scroll:
                  direction: down
                  untilIdentifier: us.mappings.ibottaRewards.walmartCash.rewards.checkbox
                  scrollLimit: 10
                  position: center
        - click:
            identifier: us.mappings.ibottaRewards.walmartCash.rewards.checkbox
            wait: 2000
        - verifyIdentifier:
            present:
              - identifier: us.mappings.ibottaRewards.walmartCash.claimed
              - identifier: us.mappings.ibottaRewards.walmartCash.info.button
        - sleep:
            duration: 3000
        - if:
            identifier:
              notPresent:
                - identifier: us.mappings.ibottaRewards.subscriptionRadioButton
            then:
              - log: Couldn't find the subscription radio button, Scrolling up.
              - scroll:
                  direction: up
                  untilIdentifier: us.mappings.ibottaRewards.subscriptionRadioButton
                  scrollLimit: 10
                  position: center
        - click:
            identifier: us.mappings.ibottaRewards.subscriptionRadioButton
        - sleep:
            duration: 2000
        - click:
            identifier: us.mappings.ibottaRewards.setUpSubscription.button
        - sleep:
            duration: 5000


    - name: unified.us.functions.ibotta.verifyibottaRewards.on.cartPage
      flow:    
        - verifyIdentifier:
            present:
            - identifier: us.mappings.ibottaRewards.walmartCash.claimed.text
        - log: "Walmart cash claimed badge is present in cart page"

    - name: unified.us.functions.orderDetails.verifyWalmartCashPendingAndSubscriptionText
      flow:
        - scroll:
            direction: down
            untilIdentifier: us.mappings.orderDetails.WalmartCashPendingText
            wait: 3000
            scrollLimit: 2

        - verifyIdentifier:
            present:
              - identifier: us.mappings.orderDetails.WalmartCashPendingText
              - identifier: us.mappings.orderDetails.SubscriptionBannerText

    - name: unified.us.functions.wplus.inHome.validateOnMMPafterInHomeCancelled
      flow:
        - executeFunction:
            name: unified.us.functions.wplus.membership.expandDiscoverModule
        - executeFunction:
            name: unified.us.functions.wplus.membership.expandDiscoverModule.exploreInHome
        - if:
            condition: ${platform} == 'iOS'
            then:
                - verifyIdentifier:
                    timeout: 5000
                    value:
                      - identifier: us.mappings.inHome.managePlusUpsAddOnPrice       
                        contains: $40 per year
                - log: InHome cancelled successfully       
        - if:
            condition: ${platform} == 'Android'
            then:
                - verifyIdentifier:
                    timeout: 5000
                    text:
                      - identifier: us.mappings.inHome.managePlusUpsAddOnPrice        
                        contains: $40/year
                - log: InHome cancelled successfully"                