functions:
  - name: unified.us.functions.wplus.navigateToManageMembershipFromBenefitsPage
    flow:
      - sleep:
          duration: 5000
      - if:
          identifier:
            notPresent:
              - identifier: us.mappings.wplus.manageMembership.gearIcon
          then:
            - scroll:
                direction: up
                untilIdentifier: us.mappings.wplus.manageMembership.gearIcon
                scrollLimit: 4
      - verifyIdentifier:
          timeout: 5000
          present:
            - identifier: us.mappings.wplus.manageMembership.gearIcon
      - click:
          identifier: us.mappings.wplus.manageMembership.gearIcon
      - sleep:
          duration: 5000
    
  - name: unified.us.functions.wplus.benefits.wplusTravel
    flow:
      - scroll:
          direction: up
          untilIdentifier: us.mappings.benefits.title
          position: center
      - verifyIdentifier:
          timeout: 2000
          present:
            - identifier: us.mappings.benefits.title
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.benefits.wPlusTravel.tile
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - if:
          condition: ${platform} == 'iOS'
          then:
            - if:
                condition: ${collapsed} == y
                then: 
                  - sleep:
                      duration: 1000
                  - verifyIdentifier:
                      notPresent:
                        - identifier: us.mappings.benefits.wplusTravel.exploreTravelButton
                  - verifyIdentifier:
                      label:
                        - identifier: us.mappings.benefits.wplusTravel.title
                          contains: collapsed
                  - log: W+ Travel is not expanded
            - if:
                condition: ${expanded} == y
                then:
                  - sleep:
                      duration: 1000
                  - click:
                      identifier: us.mappings.benefits.wPlusTravel.tile
                  - verifyIdentifier:
                      label:
                        - identifier: us.mappings.benefits.wplusTravel.title
                          contains: expanded
                  - if:
                      condition: ${pausedMember} == y
                      then:
                        - verifyIdentifier:
                            present:
                              - identifier: us.mappings.benefits.wplusTravel.resumeMemberShip
                      else:
                        - verifyIdentifier:
                            present:
                              - identifier: us.mappings.benefits.wplusTravel.exploreTravelButton
                  - log: W+ Travel is expanded
            - if:
                condition: ${usedBenefit} == y
                then: 
                  - verifyIdentifier:
                      label:
                        - identifier: us.mappings.benefits.wplusTravel.title
                          contains: benefit is used
                  - log: W+ Travel is in used benefits list
                else:
                  - verifyIdentifier:
                      label:
                        - identifier: us.mappings.benefits.wplusTravel.title
                          notContains: benefit is used
                  - log: W+ Travel is not in used benefits list
            - if:
                condition: ${exploreTravel} == y
                then:
                  - sleep:
                      duration: 1000
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.benefits.wplusTravel.exploreTravelButton
                  - click:
                      identifier: us.mappings.wplus.benefits.rewardsTile.learnMoreButton
                  # - verifyIdentifier:
                  #     present:
                  #       - identifier: us.mappings.benefits.wplusTravel.startShoppingScreen
                  # - click:
                  #     identifier: us.mappings.global.navigateBackArrow
                  # - verifyIdentifier:
                  #     present:
                  #       - identifier: us.mappings.benefits.fsnm.tile
      - if:
          condition: ${platform} == 'Android'
          then:
            - if:
                condition: ${collapsed} == y
                then: 
                  - sleep:
                      duration: 1000
                  - verifyIdentifier:
                      notPresent:
                        - identifier: us.mappings.benefits.wPlusTravel.getWPlusTravel
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.benefits.wPlusTravel.title.collapsed                 
                  - log: W+ Travel is not expanded    
            - if:
                condition: ${expanded} == y
                then:
                  - sleep:
                      duration: 1000
                  - click:
                      identifier: us.mappings.benefits.wPlusTravel.tile
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.benefits.wPlusTravel.title.expanded
                  - if:
                      condition: ${pausedMember} == y
                      then:
                        - scroll: 
                            direction: down
                            untilIdentifier: us.mappings.benefits.wPlusTravel.resumeMemberShip                
                        - verifyIdentifier:
                            present:
                              - identifier: us.mappings.benefits.wPlusTravel.resumeMemberShip
                      else:
                        # - scroll: 
                        #     direction: down
                        #     untilIdentifier: us.mappings.benefits.wPlusTravel.getWPlusTravel
                        - verifyIdentifier:
                            present:
                              - identifier: us.mappings.benefits.wPlusTravel.getWPlusTravel
                  - log: W+ Travel is expanded
            - if:
                condition: ${usedBenefit} == y
                then: 
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.benefits.wPlusTravel.title.usedBenefit           
                  - log: W+ Travel is in used benefits list
                else:
                 - verifyIdentifier:
                     present:
                       - identifier: us.mappings.benefits.wPlusTravel.title.unUsedBenefit                 
                 - log: W+ Travel is not in used benefits list
            - if:
                condition: ${exploreTravel} == y
                then:
                  - sleep:
                      duration: 1000
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.benefits.wPlusTravel.getWPlusTravel
                  - click:
                      identifier: us.mappings.item.ccLearnHowLink
  
  # Validate the CTAs on W+ travel BDP
  - name: unified.us.functions.wplus.benefitScreen.travelBDP
    flow:
      - try:
          flow:
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.wplus.travel.travelBDP.title
                  - identifier: us.mappings.wplus.travel.bookTripbtn
                  #- identifier: us.mappings.wplus.travel.travelBDP.seeBookedTripsbtn
                  - identifier: us.mappings.wplus.travel.travelBDP.subtitleExpedia
          catch:
            flow:
              - failTest:
                  message: "ENV_FAILURE - ${env} - identifier is missing on travel BDP"
      - if:
          condition: ${platform} == 'Android'
          then:
            - scroll:
                direction: down
                untilIdentifier: us.mappings.wplus.travel.travelBDP.bookTripOnBottom
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.wplus.travel.travelBDP.ViewallFAQ
                  - identifier: us.mappings.wplus.travel.travelBDP.bookTripOnBottom
      - if:
          condition: ${platform} == 'iOS'
          then:
            # View All FAQ
            - scroll:
                direction: down
                untilIdentifier: us.mappings.wplus.travel.travelBDP.ViewallFAQ #us.mappings.wplus.travel.bookTripbtn
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.wplus.travel.travelBDP.ViewallFAQ
                  #- identifier: us.mappings.wplus.travel.bookTripbtn
            # Walmart Plus Cash
      - scroll:
          direction: up
      - if:
           identifier: 
             present:
               - identifier: us.mappings.wplus.travel.travelBDP.viewWalmartCash
           then:
           - click:
               identifier: us.mappings.wplus.travel.travelBDP.viewWalmartCash  
               wait: 5000
          #  - sleep:
          #        duration: 3000

      
      - if:
          condition: ${platform} == 'Android'
          then:
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.wplus.WalmartRewardCenterTitle
                  - name: direction
                    string: down
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.wplus.WalmartRewardCenterTitle
            - click:
                identifier: us.mappings.global.navigateBackArrow
      - if:
          condition: ${platform} == 'iOS'
          then: 
            - try:
                flow:
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.savings.wplus.WalmartRewardCenterTitle
                catch:
                  flow:
                    - log: "Failed to Verify Rewards Title"        
            - click:
               identifier: us.mappings.wplus.backBtn           
  
  - name: unified.us.functions.wplus.benefitsScreen.clickViewAllMemberBenefitsAndVerifyParamount
    flow:
      - if:
          condition: ${platform} == 'Android'
          then:
            - click:
                identifier: us.mappings.wplus.benefits.paramountTile.Howstreamingworkslink
            - log: "Clicked on How streaming works Link from paramount tile"
            - sleep:
                duration: 5000
            - verifyIdentifier:
                timeout: 30000
                present:
                  - identifier: us.mappings.wplus.benefits.paramountpage.paramountlogo
                  - identifier: us.mappings.wplus.benefits.paramountTile.header
                  - identifier: us.mappings.wplus.benefits.paramountTile.subtitle
            - sleep:
                duration: 5000            
            - click:
                identifier: us.mappings.wplus.savings.LTORedeemOfferCTA
            - log: "Clicked on GetParamount button from paramount page"  
            #Below Validation are commented because it navigates us to webpage and sometimes asks for robot verification. 
            # - sleep:
            #     duration: 10000
            # - verifyIdentifier:
            #     present:
            #       - identifier: us.mappings.wplus.benefits.paramount.webPageTitle                                    
            # - log: "Navigated to Mobile Web Page Succesfully"
            - log: "Verified the Web Page Navigation with Get Paramount+ Tile"

      - if:
          condition: ${platform} == 'iOS'
          then:
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.wplus.benefitsTabSelected
                then:
                  - executeFunction:
                      name: us.functions.wplus.account.NavigateToBenefitsTab
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.wplus.benefits.viewAllMemberBenefitsAndOffersLinkbtn
                  - name: direction
                    string: down
            - click:
                identifier: us.mappings.wplus.benefits.viewAllMemberBenefitsAndOffersLinkbtn
            - log: "Clicked on viewAllMemberBenefitsAndOffers Link"
            - sleep:
                duration: 30000
            - verifyIdentifier:
                present:
                  - identifier: us.maappings.wplus.benefits.webview
            - log: "Navigated to Mobile Web Page Succesfully"
            # - scroll:
            #     untilIdentifier: us.mappings.wplus.benefits.webPageGetParamount
            #     direction: down
            #     position: center
            # - verifyIdentifier:
            #     present:
            #       - identifier: us.mappings.wplus.benefits.webPageGetParamount

            - log: "Verified the Web Page Navigation with Get Paramount+ Tile"

  - name: unified.us.functions.wplus.benefitsScreen.paramountTile
    flow:

      - scroll:
          direction: down
          untilIdentifier: us.mappings.wplus.benefits.paramountTile.benefitImage
          position: center

      - if: 
          identifier:
            present:
              - identifier: us.mappings.wplus.benefits.paramountCollapsedView
          then:
            - click:
                identifier: us.mappings.wplus.benefits.paramountCollapsedView
        
      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.benefits.paramountTile.header
            - identifier: us.mappings.wplus.benefits.paramountTile.subtitle            
            - identifier: us.mappings.wplus.benefits.paramountTile.GetParamountlink
            - identifier: us.mappings.wplus.benefits.paramountTile.Howstreamingworkslink
      - log: "Verified paramount tile details on Benefits screen"
  
  - name: unified.us.functions.wplus.benefitsScreen.viewLimitedTimeOffer
    flow:
      - if:
          condition: ${platform} == 'iOS'
          then:
            - scroll:
                untilIdentifier: us.mappings.wplus.viewLimitedTimeOfferTitle
                direction: down
                position: center
            - verifyIdentifier:
                timeout: 20000
                present:
                  - identifier: us.mappings.wplus.viewLimitedTimeOfferTitle
            - log: "Verified LTO on Savings screen Under W+ Benifits section"
          else:
            - scroll:
                untilIdentifier: us.mappings.wplus.viewLimitedTimeOfferSavingsTab
                direction: down
                position: center
            - verifyIdentifier:
                timeout: 20000
                present:
                  - identifier: us.mappings.wplus.viewLimitedTimeOfferSavingsTab
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.wplus.limitedTimeSavingsTabOffers
            - log: "Verified LTO on Savings screen Under W+ Benifits section"
  
  - name: unified.us.functions.wplus.benefitsScreen.clickLTOViewAllAndGoToLTOListPage
    flow:
      - if:
          condition: ${platform} == 'Android'
          then:
            - click:
                identifier: us.mappings.wplus.savings.viewOfferCTA
                wait: 10000

            - if:
                identifier:
                  present:
                    - identifier: us.mappings.benefits.LTO.listPageTitle
                then: 
                    - log : "Verified LTO navigation Successfully"
          else:
            # LTO detail page
            - click:
                identifier: us.mappings.benefits.limitedTimeOffers.viewOffersButton
                wait: 10000
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.benefits.LTO.listPageTitle
                then: 
                    - log : "Verified LTO navigation Successfully"


    
  - name: unified.us.functions.wplus.benefitsScreen.clickLTOfferAndValidateCode
    flow:
      - click:
          identifier: us.mappings.wplus.viewLimitedTimeOfferSavingsTab
      - log: "Clicked on LOT offer"
      - if:
          identifier:
            present:
              - identifier: us.mappings.wplus.savings.LTORedeemOfferCode
          then: 
            - verifyIdentifier:
                timeout: 40000
                present:
                  - identifier: us.mappings.wplus.savings.LTORedeemOfferCode
                  - identifier: us.mappings.wplus.savings.LTORedeemOfferCodeCTA
            - if:
                condition: ${platform} == 'Android'
                then:
                  - click:
                      identifier: us.mappings.wplus.savings.LTORedeemOfferCodeCTA 
                  - log: "Navigated to Mobile Web Page Succesfully"
                  - goBack: true
          else: 
            - verifyIdentifier:
                timeout: 40000
                present:
                  - identifier: us.mappings.wplus.savings.LTORedeemOfferCTA

  - name: unified.us.functions.wplus.account.clickOnJoinWplusFromMlp
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.reactivate.clickPrimaryCtaButton
      - if: 
          condition: ${flow} == 'reactivate'
          then:
            - click:
                identifier: us.mappings.wplus.reactivate.clickPrimaryCtaButton
          else:
            - log: Churned Expired user is navigated to W+ MLP

  - name: unified.us.functions.wplus.account.chooseWplusPlan
    flow:
      - if: 
          condition: ${plan} == 'annual'
          then:
            - click: 
                identifier: us.mappings.wplus.annualTenurePlan
            - log: 'Annual Plan selected'
          else:
            - click: 
                identifier: us.mappings.wplus.monthlyTenurePlan
            - log: 'Monthly Plan selected'         
      - scroll:
          direction: down
      - sleep:
          duration: 5000      
      - if:
          identifier:
            present:
              - identifier: us.mappings.wplus.splashPage.IagreeTermsAndConditionCheckBox
          then:
            - click: 
                identifier: us.mappings.wplus.splashPage.IagreeTermsAndConditionCheckBox 
      - click: 
          identifier: us.mappings.wplus.reactivate.clickPrimaryCtaButton
      - sleep:
          duration: 8000 
      - if:
          identifier:
            present:
              - identifier: us.mappings.wlus.membershipBottomsheetClose
          then:
            - click:
                identifier: us.mappings.wlus.membershipBottomsheetClose
            - if:
                condition: ${platform} == 'iOS'
                then:
                  - executeFunction:
                      name: unified.us.functions.global.navigation.goToAccountFromTabBar
                  # - executeFunction:
                  #     name: unified.us.functions.account.navigateToWalmartPlusBenefits
                else:
                  - goBack: true
      - if:
          identifier:
            notPresent:
            - identifier: us.mappings.account.walmartplus
          then:
            - scroll:
                direction: up 
      - executeFunction:
          name: us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.account.walmartplus 
            - name: direction
              string: down
      - click : 
         identifier: us.mappings.account.walmartplus 

  - name: unified.us.functions.benefits.clickChurnedActiveReactivateWplus
    flow:
      - if:
          identifier:
            present:
                - identifier: us.mappings.wplus.benefits.reactivateCTAForChurnedActive
          then:
            - log: Reactive CTA is showing on Benefits screen
          else:
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.wplus.benefits.reactivateCTAForChurnedActive
                  - name: direction
                    string: down
      - click:
          identifier: us.mappings.wplus.benefits.reactivateCTAForChurnedActive
      - sleep:
          duration: 10000

  - name: unified.us.functions.wplus.benefitScreen.benefitScreenDetails
    flow:
      - if:
          condition: ${platform} == 'iOS'
          then:
            - if:
                condition: ${membershipType} == 'extendedTrial'
                then:
                  - scroll:
                      direction: up
                      untilIdentifier: us.mappings.benefits.title
                      position: center
                  - verifyIdentifier:
                      timeout: 2000
                      present:
                        - identifier: us.mappings.benefits.title
                else:
                  - verifyIdentifier:
                      timeout: 10000
                      present:
                        - identifier: us.mappings.wPlus.newBenifitsTabHeader
                        - identifier: us.mappings.wPlus.hiCustomerGreetings
      - if:
          condition: ${platform} == 'Android'
          then:
            - if:
                condition: ${membershipType} == 'extendedTrial'
                then:
                  - scroll:
                      direction: up
                      untilIdentifier: us.mappings.benefits.title
                      position: center
                  - verifyIdentifier:
                      timeout: 2000
                      present:
                        - identifier: us.mappings.benefits.title
                else:
                    - verifyIdentifier:
                        timeout: 20000
                        present:
                          #- identifier: us.mappings.wplus.savings.benefitsList
                          - identifier: us.mappings.benefits.title


  - name: unified.us.functions.wplus.benefitsScreen.verifyExploreAllYourExcitingWplusBenefitsTile
    flow:
      - if:
          condition: ${platform} == 'iOS'
          then:
            - executeFunction:
                name: us.functions.utils.scrollIfNotVisible
                params:
                  - name: identifier
                    string: us.mappings.benefits.viewAllBenefits.tile ##us.mappings.wplus.benefits.exploreAllYourExcitingWplusBenefitsSection Delete this once hub redesign is enabled 100%
                  - name: direction
                    string: down
                  - name: scrollPosition
                    string: center 
            - log: "Verified Explore all your exciting W+ benefits section displayed on Benefits screen footer section"     
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.benefits.viewAllBenefits.tile

                
  - name: unified.us.functions.wplus.inHome.benefitshubsignup
    flow:
      - sleep:
          duration: 5000
      - scroll:
          direction: up
          untilIdentifier: us.mappings.benefits.title
          position: center
      - verifyIdentifier:
          timeout: 2000
          present:
            - identifier: us.mappings.benefits.title
      - scroll:
          direction: down
          untilIdentifier: us.mappings.benefits.inhome.tryInhomePlusupsForFree
      - click:
            wait: 1000
            identifier: us.mappings.benefits.inhome.tryInhomePlusupsForFree

  - name: unified.us.functions.wplus.inHome.confirmAddress
    flow:
      - sleep:
          duration: 2000
      - if:
          identifier:
               present:
                 - identifier: us.mappings.benefitHub.inHome.confirmButton
          then:
            - click:
               wait: 1000
               identifier: us.mappings.benefitHub.inHome.confirmButton
               wait: 1000

  - name: unified.us.functions.wplus.inHome.startInHomeFreeTrial
    flow:
      - if:
          condition: ${platform} == 'Android'
          then:
            # Close the error bottom sheet CTA
            - executeFunction:
                name: us.functions.wplus.inHome.cancel.bottomSheet.error.cta

            # Close view full screen overlay
            - executeFunction:
                name: us.functions.wplus.handle.viewFullScreen
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.benefitHub.inHome.startInHomeFreeTrialButton
          then:
            - log: "Start In Home free trial button present as expected"           
            - scroll:
                direction: down
                untilIdentifier: us.mappings.inHome.bookSlot.activateInHomeIagree
            - click:
                identifier: us.mappings.inHome.bookSlot.activateInHomeIagree
            - click:
                wait: 3000
                identifier: us.mappings.benefitHub.inHome.startInHomeFreeTrialButton
                wait: 3000
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Start In Home pfree trial button should be present but is not"

  - name: unified.us.functions.wplus.inHome.validateStartInHomeFreeTrialPage
    flow:
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.benefitHub.inHome.startInHomeFreeTrialButton
          then:
            - log: "Start In Home trial option is present as expected"
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Start In Home free trial button should be present but is not"
      - verifyIdentifier:
          present:
            - identifier: us.mappings.benefitHub.inHome.paymentDetailsAndTerms.30DayFreeTrialLabel
      
  - name: unified.us.functions.wplus.inHome.exploreW+BenefitsAfterInHomeFreeTrial
    flow:
      - sleep:
          duration: 5000
      - if:
          identifier:
            present:
              - identifier: us.mappings.benefitHub.inHome.exploreWalmartPlusBenefits
          then:
            - log: "Explore W+ Benefits button is present as expected"
            - click:
                wait: 1000
                identifier: us.mappings.benefitHub.inHome.exploreWalmartPlusBenefits
                wait: 3000
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Explore W+ Benefits button should be present but is not"

  - name: unified.us.functions.wplus.inHome.validatePlusUpsbenefitsDetails
    flow:
      - executeFunction:
          name: unified.us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.inHome.benefitscardInHomeDelivery
            - name: direction
              string: down
            - name: scrollPosition
              string: center
      - if:
          identifier:
            present:
              - identifier: us.mappings.inHome.benefitscardInHomeDelivery
          then:
            - log: "Plus Ups benefits details displayed as expected"
            - verifyIdentifier:
                present:
                  - identifier:  us.mappings.inHome.benefitscardInHomeDelivery
          else:
            - failTest:
                message: "ENV_FAILURE - ${env} - Plus ups benefits details not displayed properly"

  - name: unified.us.functions.wplus.inHome.goToTopOfBenefitsPage
    flow:
      - scroll:
          direction: up
          untilIdentifier: us.mappings.wplus.manageMembership.gearIcon

  - name: unified.us.functions.wplus.benefits.fdfs
    flow:
      - executeFunction:
          name: unified.us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.benefits.title
            - name: direction
              string: up
            - name: position
              string: center

      - verifyIdentifier:
          present:
            - identifier: us.mappings.benefits.title

      - executeFunction:
          name: unified.us.functions.utils.scrollIfNotVisible
          params:
            - name: identifier
              string: us.mappings.benefits.fdfs.tile
            - name: direction
              string: down
            - name: position
              string: center

      - if:
          condition: ${collapsed} == y
          then: 
            - verifyIdentifier:
                notPresent:
                  - identifier: us.mappings.benefits.fdfs.reserveSlotButton
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.benefits.fdfs.title.collapsed
            - log: FDFS is not expanded
            
      - if:
          condition: ${expanded} == y
          then:
            - click:
                identifier: us.mappings.benefits.fdfs.tile
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.benefits.fdfs.title.expanded
            - if:
                condition: ${pausedMember} == y
                then:
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.benefits.fdfs.resumeMemberShip
                else:
                  - verifyIdentifier:
                      present:
                        - identifier: us.mappings.benefits.fdfs.reserveSlotButton
            - log: FDFS is expanded
      - if:
          condition: ${usedBenefit} == y
          then: 
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.benefits.fdfs.title.usedBenefit
            - log: FDFS is in used benefits list
          else:
            - verifyIdentifier:
                notPresent:
                  - identifier: us.mappings.benefits.fdfs.title.usedBenefit
            - log: FDFS is not in used benefits list
      - if:
          condition: ${reservetime} == y
          then:
            - verifyIdentifier:
                timeout: 50000
                present:
                  - identifier: us.mappings.benefits.fdfs.reserveSlotButton
            - click:
                identifier: us.mappings.benefits.fdfs.reserveSlotButton
            - verifyIdentifier:
                timeout: 50000
                present:
                  - identifier: us.mappings.benefits.fdfs.reserveSlotScreen
            - click:
                identifier: us.mappings.global.navigateBackArrow
            - verifyIdentifier:
                present:
                  - identifier: us.mappings.benefits.fdfs.tile

  - name: unified.us.functions.wplus.changeMembership
    flow:
      - if:
          condition: ${platform} == 'iOS'
          then:
            - scroll:
                direction: up
            - click: 
                identifier: us.mappings.global.changeButton
            - log: "Clicked on Upgrade to annual button"
            - scroll:
                direction: down
                untilIdentifier: us.mappings.wplus.changePlan.agreeCheckbox
            - scroll:
                direction: down
            - if:
                identifier:
                  present:
                    - identifier: us.mappings.wplus.changePlan.agreeCheckbox                    
                then:
                    - log: "Legal Error Alert Message is displayed"
                    - click:
                        identifier: us.mappings.wplus.changePlan.agreeCheckbox
                    - log: "Check box to Agree Terms is checked"
            - if: 
                condition: ${membership} == 'Annual plan'
                then:
                  - click: 
                      identifier: us.mappings.wplus.annualTenurePlanCTA
                  - log: 'Annual Plan selected'
                else:
                  - click: 
                      identifier: us.mappings.wplus.monthlyTenurePlan
                  - log: 'Monthly Plan selected'
      - if:
          condition: ${platform} == 'Android'
          then:
            - if:
                identifier: 
                  text:
                      - identifier: us.mappings.wplus.membership.plan
                        contains: ${membership}
                then:
                  - log: "Membership plan is already set to : ${membership}"
                else:
                  - scroll:
                      direction: up
                      untilIdentifier: us.mappings.global.changeButton
                  - click: 
                      identifier: us.mappings.global.changeButton
                  - sleep:
                      duration: 5000
                  - scroll:
                      direction: down
                      untilIdentifier: us.mappings.manageMembership.upgradeMembership.iAgreeCheckbox
                  - click:
                      identifier: us.mappings.manageMembership.upgradeMembership.iAgreeCheckbox
                  - if: 
                      condition: ${membership} == 'Annual plan'
                      then:
                        - click: 
                            identifier: us.mappings.wplus.annualTenurePlan
                        - log: 'Annual Plan selected'
                      else:
                        - click: 
                            identifier: us.mappings.wplus.monthlyTenurePlan
                        - log: 'Monthly Plan selected'         
                  # - click: 
                  #     identifier: us.mappings.wplus.changePlanButton
      - click: 
          identifier: us.mappings.wlus.membershipBottomsheetClose

# Deeplink to Exxon Flow
  - name: unified.us.functions.wplus.exxon.deeplink
    flow:
      # Deeplink to exxon flow
      - executeFunction:
          name: unified.us.functions.global.navigation.goToDeepLink
          params:
          - name: deepLinkUrl
            string: us.data.exxon.deepLink

      # On enter pump verifies station name and address and 
      - verifyIdentifier:
          timeout: 40000
          present:
            - identifier: us.mappings.wplus.exxon.stationNameLabel
            - identifier: us.mappings.wplus.exxon.stationAddressLabel
            - identifier: us.mappings.wplus.exxon.enterPumpNumberLabel

  # Enter pump number and select pump
  - name: unified.us.functions.wplus.exxon.selectPumpNumber
    flow:
      # Enter pump number 
      - enterText:
            identifier: us.mapping.wplus.exxon.enterPumpTextField
            string: ${pumpNumber}
      
      # Tap select pump CTA
      - click: 
          identifier: us.mappings.wplus.exxon.selectPumpButton

  # Try maximum 5 times to do the payment
  - name: unified.us.functions.wplus.exxon.selectCard
    flow:
      - click:
          wait: 5000
          identifier: us.mappings.wplus.exxon.continueWithThisCardButton
      - sleep:
          duration: 10000
      - loop:
          begin: 2
          end: 6
          storeIndex: i
          flow:
            - if:
                identifier:
                  present:
                    - identifier: us.mapping.wplus.exxon.tryAgainButton
                then:
                  - click:
                      wait: 5000
                      identifier: us.mapping.wplus.exxon.tryAgainButton
                  - click:
                      wait: 5000
                      identifier: us.mappings.wplus.exxon.selectPumpButton
                  - click:
                      wait: 5000
                      identifier: us.mappings.wplus.exxon.continueWithThisCardButton
                  - sleep:
                      duration: 10000
            - if:
                condition: ${platform} == 'Android'
                then:                      
                  - if:
                      identifier:
                        present:
                          - identifier: us.mapping.wplus.exxon.fuelingAnimation
                          - identifier: us.mapping.wplus.exxon.selectedPumpLabel
                      then:
                        - log: Transaction succeed
                        - break: true
                      else:
                        - log: Payment failed ${i} times
                        - if:
                            condition: ${i} == 5
                            then:
                              - failTest:
                                  message: "TEST_FAILURE - ${env} - fuel payment failed for 5 times"            
            - if:
                condition: ${platform} == 'ios'
                then:
                  - verifyIdentifier:
                      present:
                        - identifier: us.mapping.wplus.exxon.findFuelGradeLabel
                      label:
                        - identifier: us.mapping.wplus.exxon.selectedPumpLabel
                          contains: Pump ${pumpNumber}
                  - log: Transaction succeed

  - name: unified.us.functions.wplus.exxon.paymentSummaryValidations
    flow:
      - verifyIdentifier:
          timeout: 150000
          present:
            - identifier: us.mapping.wplus.exxon.paymentCompleteTitleLable
            - identifier: us.mapping.wplus.exxon.gradeLabel
            - identifier: us.mapping.wplus.exxon.quantityLabel
            - identifier: us.mapping.wplus.exxon.rateLabel
            - identifier: us.mapping.wplus.exxon.cardLabel
            - identifier: us.mapping.wplus.exxon.totalLabel
            - identifier: us.mapping.wplus.exxon.transactionIdLabel
            - identifier: us.mapping.wplus.exxon.giveFeedBackLinkButton
  
  # Function to check Trail membership status after cancellation
  - name: unified.us.functions.wplus.membership.afterTrialMembershipCancellation
    flow:
      - sleep:
          duration: 5000
      - verifyIdentifier:
          notPresent:
            - identifier: us.mappings.wplus.manageMembership.gearIcon
      - if:
          condition: ${platform} == 'Android'
          then:
            - scroll:
                direction: down
                untilIdentifier: us.mappings.wplus.churnedExpired.reactivateWplusButton
            - verifyIdentifier:
                timeout: 5000
                present:
                  - identifier: us.mappings.wplus.churnedExpired.reactivateWplusButton
      - if:
          condition: ${platform} == 'iOS'
          then:
            - click:
                identifier: us.mappings.wplus.backBtn
            - verifyIdentifier: 
                present: 
                  - identifier: us.mapppings.wplus.reactivateMembership.cta

  - name: unified.us.functions.wplus.reserveSlotfromSplashPage
    flow:
      - verifyIdentifier:
          present:
            - identifier: us.mappings.wplus.reactivate.splashPage
      - log: "Splash page is displayed"
      - log: "Selecting delivery slot from Splash page"
      - click:
          identifier: us.mappings.wplus.reactivate.bookslot.splashPage
      - click: 
          identifier: us.mapping.wplus.reserveTimeCTA
      - log: "Delivery time slot is reserved"
          
